/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.381669, Loss 1.791167, forward nfe 104, backward nfe 0, Train: 0.2667, Val: 0.2761, Test: 0.3129, Best time: 47.2507
Epoch: 002/100, Runtime 0.340034, Loss 1.756348, forward nfe 360, backward nfe 0, Train: 0.4000, Val: 0.4297, Test: 0.4468, Best time: 48.7520
Epoch: 003/100, Runtime 0.319117, Loss 1.717807, forward nfe 622, backward nfe 0, Train: 0.5667, Val: 0.5333, Test: 0.5306, Best time: 47.0563
Epoch: 004/100, Runtime 0.319928, Loss 1.688364, forward nfe 878, backward nfe 0, Train: 0.6000, Val: 0.5674, Test: 0.5532, Best time: 47.2638
Epoch: 005/100, Runtime 0.338016, Loss 1.636899, forward nfe 1134, backward nfe 0, Train: 0.6000, Val: 0.6196, Test: 0.6048, Best time: 47.8349
Epoch: 006/100, Runtime 0.314585, Loss 1.594098, forward nfe 1396, backward nfe 0, Train: 0.6083, Val: 0.6290, Test: 0.6145, Best time: 48.6918
Epoch: 007/100, Runtime 0.352158, Loss 1.617685, forward nfe 1658, backward nfe 0, Train: 0.6417, Val: 0.6580, Test: 0.6371, Best time: 15.0000
Epoch: 008/100, Runtime 0.324511, Loss 1.558298, forward nfe 1914, backward nfe 0, Train: 0.6667, Val: 0.6739, Test: 0.6532, Best time: 41.3641
Epoch: 009/100, Runtime 0.302288, Loss 1.537917, forward nfe 2164, backward nfe 0, Train: 0.7750, Val: 0.6993, Test: 0.6855, Best time: 4.5762
Epoch: 010/100, Runtime 0.301036, Loss 1.536703, forward nfe 2408, backward nfe 0, Train: 0.7750, Val: 0.7355, Test: 0.7194, Best time: 7.8853
Epoch: 011/100, Runtime 0.296988, Loss 1.509354, forward nfe 2658, backward nfe 0, Train: 0.7750, Val: 0.7355, Test: 0.7194, Best time: 15.0000
Epoch: 012/100, Runtime 0.307506, Loss 1.486054, forward nfe 2896, backward nfe 0, Train: 0.7750, Val: 0.7377, Test: 0.7242, Best time: 11.2638
Epoch: 013/100, Runtime 0.292089, Loss 1.470879, forward nfe 3134, backward nfe 0, Train: 0.7667, Val: 0.7420, Test: 0.7290, Best time: 25.5032
Epoch: 014/100, Runtime 0.314198, Loss 1.427157, forward nfe 3372, backward nfe 0, Train: 0.7583, Val: 0.7442, Test: 0.7355, Best time: 26.2466
Epoch: 015/100, Runtime 0.295974, Loss 1.394971, forward nfe 3604, backward nfe 0, Train: 0.7583, Val: 0.7514, Test: 0.7403, Best time: 38.2508
Epoch: 016/100, Runtime 0.279408, Loss 1.418114, forward nfe 3842, backward nfe 0, Train: 0.7583, Val: 0.7601, Test: 0.7403, Best time: 39.9484
Epoch: 017/100, Runtime 0.279042, Loss 1.369640, forward nfe 4068, backward nfe 0, Train: 0.7583, Val: 0.7601, Test: 0.7403, Best time: 15.0000
Epoch: 018/100, Runtime 0.279403, Loss 1.330449, forward nfe 4294, backward nfe 0, Train: 0.7583, Val: 0.7601, Test: 0.7403, Best time: 15.0000
Epoch: 019/100, Runtime 0.292287, Loss 1.304611, forward nfe 4520, backward nfe 0, Train: 0.7583, Val: 0.7601, Test: 0.7403, Best time: 15.0000
Epoch: 020/100, Runtime 0.272616, Loss 1.270192, forward nfe 4746, backward nfe 0, Train: 0.7583, Val: 0.7601, Test: 0.7403, Best time: 15.0000
Epoch: 021/100, Runtime 0.274652, Loss 1.221309, forward nfe 4960, backward nfe 0, Train: 0.7583, Val: 0.7601, Test: 0.7403, Best time: 15.0000
Epoch: 022/100, Runtime 0.269924, Loss 1.243746, forward nfe 5174, backward nfe 0, Train: 0.7583, Val: 0.7601, Test: 0.7403, Best time: 15.0000
Epoch: 023/100, Runtime 0.268902, Loss 1.156608, forward nfe 5388, backward nfe 0, Train: 0.7583, Val: 0.7601, Test: 0.7403, Best time: 15.0000
Epoch: 024/100, Runtime 0.279206, Loss 1.167624, forward nfe 5596, backward nfe 0, Train: 0.8917, Val: 0.7609, Test: 0.7419, Best time: 25.3979
Epoch: 025/100, Runtime 0.266834, Loss 1.134338, forward nfe 5810, backward nfe 0, Train: 0.8917, Val: 0.7609, Test: 0.7419, Best time: 15.0000
Epoch: 026/100, Runtime 0.297026, Loss 1.091413, forward nfe 6018, backward nfe 0, Train: 0.8917, Val: 0.7609, Test: 0.7419, Best time: 15.0000
Epoch: 027/100, Runtime 0.253429, Loss 1.097492, forward nfe 6220, backward nfe 0, Train: 0.8917, Val: 0.7609, Test: 0.7419, Best time: 15.0000
Epoch: 028/100, Runtime 0.250257, Loss 1.078680, forward nfe 6416, backward nfe 0, Train: 0.8917, Val: 0.7609, Test: 0.7419, Best time: 15.0000
Epoch: 029/100, Runtime 0.249929, Loss 1.049004, forward nfe 6612, backward nfe 0, Train: 0.8667, Val: 0.7616, Test: 0.7323, Best time: 41.8256
Epoch: 030/100, Runtime 0.258229, Loss 0.966051, forward nfe 6808, backward nfe 0, Train: 0.8667, Val: 0.7616, Test: 0.7323, Best time: 15.0000
Epoch: 031/100, Runtime 0.245850, Loss 1.042017, forward nfe 7004, backward nfe 0, Train: 0.8667, Val: 0.7616, Test: 0.7323, Best time: 15.0000
Epoch: 032/100, Runtime 0.243869, Loss 1.039936, forward nfe 7200, backward nfe 0, Train: 0.8667, Val: 0.7616, Test: 0.7323, Best time: 15.0000
Epoch: 033/100, Runtime 0.237975, Loss 1.094315, forward nfe 7384, backward nfe 0, Train: 0.8667, Val: 0.7616, Test: 0.7323, Best time: 15.0000
Epoch: 034/100, Runtime 0.241497, Loss 1.102145, forward nfe 7568, backward nfe 0, Train: 0.8667, Val: 0.7616, Test: 0.7323, Best time: 15.0000
Epoch: 035/100, Runtime 0.229136, Loss 1.033059, forward nfe 7752, backward nfe 0, Train: 0.8667, Val: 0.7616, Test: 0.7323, Best time: 15.0000
Epoch: 036/100, Runtime 0.236232, Loss 0.976007, forward nfe 7936, backward nfe 0, Train: 0.8667, Val: 0.7616, Test: 0.7323, Best time: 15.0000
Epoch: 037/100, Runtime 0.222939, Loss 0.952499, forward nfe 8120, backward nfe 0, Train: 0.8667, Val: 0.7616, Test: 0.7323, Best time: 15.0000
Epoch: 038/100, Runtime 0.226226, Loss 0.965348, forward nfe 8292, backward nfe 0, Train: 0.8667, Val: 0.7616, Test: 0.7323, Best time: 15.0000
Epoch: 039/100, Runtime 0.220527, Loss 0.988865, forward nfe 8464, backward nfe 0, Train: 0.8667, Val: 0.7616, Test: 0.7323, Best time: 15.0000
Epoch: 040/100, Runtime 0.222706, Loss 1.056799, forward nfe 8636, backward nfe 0, Train: 0.8667, Val: 0.7616, Test: 0.7323, Best time: 15.0000
Epoch: 041/100, Runtime 0.225073, Loss 1.014485, forward nfe 8808, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 31.9792
Epoch: 042/100, Runtime 0.207826, Loss 0.999177, forward nfe 8980, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 043/100, Runtime 0.209027, Loss 1.023961, forward nfe 9140, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 044/100, Runtime 0.202867, Loss 1.028755, forward nfe 9300, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 045/100, Runtime 0.210250, Loss 0.960481, forward nfe 9460, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 046/100, Runtime 0.198864, Loss 1.004272, forward nfe 9620, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 047/100, Runtime 0.206115, Loss 0.932309, forward nfe 9780, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 048/100, Runtime 0.209889, Loss 0.946339, forward nfe 9940, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 049/100, Runtime 0.200536, Loss 0.924197, forward nfe 10100, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 050/100, Runtime 0.214926, Loss 0.976413, forward nfe 10260, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 051/100, Runtime 0.205851, Loss 0.833624, forward nfe 10420, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 052/100, Runtime 0.207940, Loss 1.037116, forward nfe 10580, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 053/100, Runtime 0.223030, Loss 0.971759, forward nfe 10740, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 054/100, Runtime 0.212305, Loss 0.991834, forward nfe 10906, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 055/100, Runtime 0.221554, Loss 0.987535, forward nfe 11078, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 056/100, Runtime 0.220690, Loss 0.958001, forward nfe 11250, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 057/100, Runtime 0.223454, Loss 0.941459, forward nfe 11422, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 058/100, Runtime 0.213180, Loss 0.932466, forward nfe 11594, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 059/100, Runtime 0.216378, Loss 0.928212, forward nfe 11766, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 060/100, Runtime 0.225589, Loss 0.967020, forward nfe 11938, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 061/100, Runtime 0.218286, Loss 0.922128, forward nfe 12110, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 062/100, Runtime 0.231577, Loss 0.975255, forward nfe 12282, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 063/100, Runtime 0.222337, Loss 0.827430, forward nfe 12454, backward nfe 0, Train: 0.8833, Val: 0.7659, Test: 0.7387, Best time: 15.0000
Epoch: 064/100, Runtime 0.231531, Loss 0.981778, forward nfe 12626, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 065/100, Runtime 0.228050, Loss 1.002234, forward nfe 12798, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 066/100, Runtime 0.224653, Loss 1.058079, forward nfe 12976, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 067/100, Runtime 0.224170, Loss 0.930166, forward nfe 13148, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 068/100, Runtime 0.222397, Loss 1.033915, forward nfe 13320, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 069/100, Runtime 0.229304, Loss 0.811271, forward nfe 13498, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 070/100, Runtime 0.229870, Loss 0.906202, forward nfe 13676, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 071/100, Runtime 0.247639, Loss 0.975691, forward nfe 13854, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 072/100, Runtime 0.224320, Loss 0.915394, forward nfe 14032, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 073/100, Runtime 0.227842, Loss 0.929392, forward nfe 14210, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 074/100, Runtime 0.225582, Loss 0.919245, forward nfe 14388, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 075/100, Runtime 0.226202, Loss 0.931727, forward nfe 14566, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 076/100, Runtime 0.217829, Loss 0.936330, forward nfe 14744, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 077/100, Runtime 0.221387, Loss 0.927177, forward nfe 14922, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 078/100, Runtime 0.217018, Loss 0.936156, forward nfe 15100, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 079/100, Runtime 0.239055, Loss 0.906065, forward nfe 15278, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 080/100, Runtime 0.225134, Loss 0.938187, forward nfe 15456, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 081/100, Runtime 0.223067, Loss 0.833437, forward nfe 15634, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 082/100, Runtime 0.231771, Loss 0.958349, forward nfe 15812, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 083/100, Runtime 0.221449, Loss 0.877320, forward nfe 15990, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 084/100, Runtime 0.218436, Loss 0.976358, forward nfe 16162, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 085/100, Runtime 0.225881, Loss 0.804719, forward nfe 16334, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 086/100, Runtime 0.227925, Loss 0.929021, forward nfe 16512, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 087/100, Runtime 0.224710, Loss 0.831929, forward nfe 16690, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 088/100, Runtime 0.223396, Loss 0.936445, forward nfe 16868, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 089/100, Runtime 0.223986, Loss 0.914261, forward nfe 17040, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 090/100, Runtime 0.215769, Loss 0.832419, forward nfe 17212, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 091/100, Runtime 0.221827, Loss 0.826128, forward nfe 17384, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 092/100, Runtime 0.212161, Loss 0.878722, forward nfe 17550, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 093/100, Runtime 0.219142, Loss 0.901526, forward nfe 17716, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 094/100, Runtime 0.210773, Loss 0.864104, forward nfe 17882, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 095/100, Runtime 0.205722, Loss 0.933197, forward nfe 18048, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 096/100, Runtime 0.213675, Loss 0.855704, forward nfe 18214, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 097/100, Runtime 0.211688, Loss 0.957114, forward nfe 18380, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 098/100, Runtime 0.226433, Loss 0.898622, forward nfe 18546, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
Epoch: 099/100, Runtime 0.211608, Loss 0.896674, forward nfe 18712, backward nfe 0, Train: 0.8917, Val: 0.7674, Test: 0.7435, Best time: 15.0000
best val accuracy 0.767391 with test accuracy 0.743548 at epoch 64 and best time 15.000000