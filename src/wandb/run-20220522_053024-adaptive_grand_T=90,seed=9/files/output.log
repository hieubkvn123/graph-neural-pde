/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 5.502891, Loss 1.946702, forward nfe 170, backward nfe 0, Train: 0.1929, Val: 0.1993, Test: 0.1949, Best time: 0.0928
Epoch: 002/100, Runtime 6.206043, Loss 1.957158, forward nfe 828, backward nfe 0, Train: 0.5571, Val: 0.5941, Test: 0.5706, Best time: 7.5075
Epoch: 003/100, Runtime 6.531762, Loss 1.838485, forward nfe 1462, backward nfe 0, Train: 0.6143, Val: 0.7265, Test: 0.6944, Best time: 10.1656
Epoch: 004/100, Runtime 6.121137, Loss 1.776806, forward nfe 2084, backward nfe 0, Train: 0.6571, Val: 0.7426, Test: 0.7157, Best time: 13.7737
Epoch: 005/100, Runtime 6.375254, Loss 1.600830, forward nfe 2682, backward nfe 0, Train: 0.6571, Val: 0.7426, Test: 0.7157, Best time: 90.0000
Epoch: 006/100, Runtime 4.288301, Loss 1.397291, forward nfe 3274, backward nfe 0, Train: 0.7929, Val: 0.7441, Test: 0.7411, Best time: 8.2816
Epoch: 007/100, Runtime 4.165187, Loss 1.207005, forward nfe 3854, backward nfe 0, Train: 0.8000, Val: 0.7816, Test: 0.7766, Best time: 19.9484
Epoch: 008/100, Runtime 4.413326, Loss 1.019131, forward nfe 4416, backward nfe 0, Train: 0.8000, Val: 0.7816, Test: 0.7766, Best time: 90.0000
Epoch: 009/100, Runtime 4.237201, Loss 0.882852, forward nfe 4966, backward nfe 0, Train: 0.8000, Val: 0.7904, Test: 0.7787, Best time: 64.2896
Epoch: 010/100, Runtime 4.056499, Loss 0.811424, forward nfe 5510, backward nfe 0, Train: 0.8000, Val: 0.7904, Test: 0.7787, Best time: 90.0000
Epoch: 011/100, Runtime 4.100488, Loss 0.777749, forward nfe 6042, backward nfe 0, Train: 0.8000, Val: 0.7904, Test: 0.7787, Best time: 90.0000
Epoch: 012/100, Runtime 4.025304, Loss 0.761369, forward nfe 6556, backward nfe 0, Train: 0.8500, Val: 0.8103, Test: 0.8020, Best time: 59.3846
Epoch: 013/100, Runtime 3.869942, Loss 0.686222, forward nfe 7046, backward nfe 0, Train: 0.8500, Val: 0.8272, Test: 0.8061, Best time: 106.2613
Epoch: 014/100, Runtime 3.835449, Loss 0.684079, forward nfe 7530, backward nfe 0, Train: 0.8500, Val: 0.8272, Test: 0.8061, Best time: 90.0000
Epoch: 015/100, Runtime 3.755316, Loss 0.657196, forward nfe 7996, backward nfe 0, Train: 0.8500, Val: 0.8272, Test: 0.8061, Best time: 90.0000
Epoch: 016/100, Runtime 3.636262, Loss 0.718247, forward nfe 8456, backward nfe 0, Train: 0.8500, Val: 0.8272, Test: 0.8061, Best time: 90.0000
Epoch: 017/100, Runtime 3.578809, Loss 0.671438, forward nfe 8910, backward nfe 0, Train: 0.8500, Val: 0.8272, Test: 0.8061, Best time: 90.0000
Epoch: 018/100, Runtime 3.477443, Loss 0.625714, forward nfe 9352, backward nfe 0, Train: 0.8500, Val: 0.8272, Test: 0.8061, Best time: 90.0000
Epoch: 019/100, Runtime 3.408502, Loss 0.622432, forward nfe 9788, backward nfe 0, Train: 0.8500, Val: 0.8272, Test: 0.8061, Best time: 90.0000
Epoch: 020/100, Runtime 3.329727, Loss 0.649417, forward nfe 10206, backward nfe 0, Train: 0.8500, Val: 0.8272, Test: 0.8061, Best time: 90.0000
Epoch: 021/100, Runtime 3.268908, Loss 0.647004, forward nfe 10612, backward nfe 0, Train: 0.8500, Val: 0.8272, Test: 0.8061, Best time: 90.0000
Epoch: 022/100, Runtime 3.155443, Loss 0.570257, forward nfe 11006, backward nfe 0, Train: 0.8500, Val: 0.8316, Test: 0.8071, Best time: 108.3516
Epoch: 023/100, Runtime 3.116502, Loss 0.588316, forward nfe 11388, backward nfe 0, Train: 0.8500, Val: 0.8316, Test: 0.8071, Best time: 90.0000
Epoch: 024/100, Runtime 3.051522, Loss 0.580589, forward nfe 11764, backward nfe 0, Train: 0.8500, Val: 0.8316, Test: 0.8071, Best time: 90.0000
Epoch: 025/100, Runtime 2.962492, Loss 0.585580, forward nfe 12134, backward nfe 0, Train: 0.8500, Val: 0.8316, Test: 0.8071, Best time: 90.0000
Epoch: 026/100, Runtime 2.959441, Loss 0.527552, forward nfe 12504, backward nfe 0, Train: 0.8500, Val: 0.8316, Test: 0.8071, Best time: 90.0000
Epoch: 027/100, Runtime 2.873457, Loss 0.550800, forward nfe 12868, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 121.4208
Epoch: 028/100, Runtime 2.875456, Loss 0.485016, forward nfe 13226, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 029/100, Runtime 2.756362, Loss 0.533268, forward nfe 13578, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 030/100, Runtime 2.755113, Loss 0.423421, forward nfe 13918, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 031/100, Runtime 2.597315, Loss 0.450036, forward nfe 14252, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 032/100, Runtime 2.715497, Loss 0.473068, forward nfe 14574, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 033/100, Runtime 2.566264, Loss 0.428108, forward nfe 14902, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 034/100, Runtime 2.654918, Loss 0.366233, forward nfe 15224, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 035/100, Runtime 2.598611, Loss 0.401611, forward nfe 15540, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 036/100, Runtime 2.152789, Loss 0.346098, forward nfe 15856, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 037/100, Runtime 2.372630, Loss 0.372503, forward nfe 16160, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 038/100, Runtime 2.384159, Loss 0.335729, forward nfe 16458, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 039/100, Runtime 2.359531, Loss 0.313660, forward nfe 16756, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 040/100, Runtime 2.442133, Loss 0.351316, forward nfe 17048, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 041/100, Runtime 2.376278, Loss 0.331204, forward nfe 17334, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 042/100, Runtime 2.329071, Loss 0.287231, forward nfe 17620, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 043/100, Runtime 2.277329, Loss 0.270297, forward nfe 17894, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 044/100, Runtime 2.271026, Loss 0.305929, forward nfe 18168, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 045/100, Runtime 2.236480, Loss 0.282309, forward nfe 18442, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 046/100, Runtime 2.235784, Loss 0.220407, forward nfe 18710, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 047/100, Runtime 2.243989, Loss 0.279912, forward nfe 18978, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 048/100, Runtime 2.188713, Loss 0.309446, forward nfe 19246, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 049/100, Runtime 2.119695, Loss 0.215196, forward nfe 19502, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 050/100, Runtime 2.120734, Loss 0.228273, forward nfe 19758, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 051/100, Runtime 2.115491, Loss 0.163958, forward nfe 20014, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 052/100, Runtime 2.141166, Loss 0.207197, forward nfe 20264, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 053/100, Runtime 2.148232, Loss 0.171908, forward nfe 20520, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 054/100, Runtime 2.019449, Loss 0.163661, forward nfe 20770, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 055/100, Runtime 2.075447, Loss 0.182088, forward nfe 21014, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 056/100, Runtime 1.961715, Loss 0.206362, forward nfe 21258, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 057/100, Runtime 1.971702, Loss 0.210242, forward nfe 21496, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 058/100, Runtime 1.920902, Loss 0.125488, forward nfe 21728, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 059/100, Runtime 1.920087, Loss 0.133537, forward nfe 21954, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 060/100, Runtime 1.879400, Loss 0.143055, forward nfe 22180, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 061/100, Runtime 1.871495, Loss 0.158571, forward nfe 22400, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 062/100, Runtime 1.883559, Loss 0.170382, forward nfe 22620, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 063/100, Runtime 1.871450, Loss 0.113950, forward nfe 22840, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 064/100, Runtime 1.836762, Loss 0.127346, forward nfe 23060, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 065/100, Runtime 1.818903, Loss 0.113637, forward nfe 23280, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 066/100, Runtime 1.751911, Loss 0.081623, forward nfe 23500, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 067/100, Runtime 1.775718, Loss 0.097309, forward nfe 23720, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 068/100, Runtime 1.784101, Loss 0.077069, forward nfe 23940, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 069/100, Runtime 1.850069, Loss 0.058355, forward nfe 24160, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 070/100, Runtime 1.875545, Loss 0.054021, forward nfe 24380, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 071/100, Runtime 1.881645, Loss 0.098888, forward nfe 24600, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 072/100, Runtime 1.744409, Loss 0.059656, forward nfe 24820, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 073/100, Runtime 1.945972, Loss 0.043962, forward nfe 25040, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 074/100, Runtime 1.954705, Loss 0.093430, forward nfe 25260, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 075/100, Runtime 1.943450, Loss 0.064383, forward nfe 25486, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 076/100, Runtime 1.904497, Loss 0.038585, forward nfe 25712, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 077/100, Runtime 1.911834, Loss 0.076817, forward nfe 25938, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 078/100, Runtime 1.922788, Loss 0.041425, forward nfe 26164, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 079/100, Runtime 1.899531, Loss 0.069187, forward nfe 26390, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 080/100, Runtime 1.898237, Loss 0.050862, forward nfe 26616, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 081/100, Runtime 1.861156, Loss 0.064221, forward nfe 26842, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 082/100, Runtime 1.898222, Loss 0.041811, forward nfe 27062, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 083/100, Runtime 1.863989, Loss 0.028921, forward nfe 27288, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 084/100, Runtime 1.922581, Loss 0.032057, forward nfe 27520, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 085/100, Runtime 2.037325, Loss 0.031844, forward nfe 27758, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 086/100, Runtime 2.102595, Loss 0.072145, forward nfe 28008, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 087/100, Runtime 2.174676, Loss 0.038228, forward nfe 28258, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 088/100, Runtime 2.224390, Loss 0.053627, forward nfe 28508, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 089/100, Runtime 2.195429, Loss 0.069869, forward nfe 28764, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 090/100, Runtime 2.233047, Loss 0.064487, forward nfe 29020, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 091/100, Runtime 2.136950, Loss 0.051958, forward nfe 29276, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 092/100, Runtime 2.142179, Loss 0.100760, forward nfe 29526, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 093/100, Runtime 2.110470, Loss 0.066746, forward nfe 29776, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 094/100, Runtime 2.045252, Loss 0.105207, forward nfe 30020, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 095/100, Runtime 2.031302, Loss 0.032473, forward nfe 30264, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 096/100, Runtime 1.821407, Loss 0.067032, forward nfe 30502, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 097/100, Runtime 1.791272, Loss 0.029615, forward nfe 30728, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 098/100, Runtime 1.790005, Loss 0.033179, forward nfe 30954, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
Epoch: 099/100, Runtime 1.803137, Loss 0.058553, forward nfe 31180, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8183, Best time: 90.0000
best val accuracy 0.836029 with test accuracy 0.818274 at epoch 27 and best time 90.000000