/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 1.122019, Loss 1.948063, forward nfe 50, backward nfe 0, Train: 0.4571, Val: 0.2566, Test: 0.2538, Best time: 0.0957
Epoch: 002/100, Runtime 1.112840, Loss 1.885660, forward nfe 210, backward nfe 0, Train: 0.6500, Val: 0.4272, Test: 0.4234, Best time: 3.6959
Epoch: 003/100, Runtime 1.088940, Loss 1.724533, forward nfe 370, backward nfe 0, Train: 0.8357, Val: 0.6904, Test: 0.6751, Best time: 9.6823
Epoch: 004/100, Runtime 1.117474, Loss 1.517442, forward nfe 524, backward nfe 0, Train: 0.9143, Val: 0.7963, Test: 0.7919, Best time: 7.2727
Epoch: 005/100, Runtime 1.136989, Loss 1.257703, forward nfe 684, backward nfe 0, Train: 0.9286, Val: 0.8213, Test: 0.8162, Best time: 21.4459
Epoch: 006/100, Runtime 1.102227, Loss 0.994228, forward nfe 844, backward nfe 0, Train: 0.9500, Val: 0.8368, Test: 0.8284, Best time: 12.8053
Epoch: 007/100, Runtime 1.094560, Loss 0.703984, forward nfe 1004, backward nfe 0, Train: 0.9500, Val: 0.8404, Test: 0.8335, Best time: 13.0572
Epoch: 008/100, Runtime 1.095041, Loss 0.496154, forward nfe 1158, backward nfe 0, Train: 0.9500, Val: 0.8404, Test: 0.8335, Best time: 15.0000
Epoch: 009/100, Runtime 1.082822, Loss 0.378253, forward nfe 1312, backward nfe 0, Train: 0.9500, Val: 0.8404, Test: 0.8335, Best time: 15.0000
Epoch: 010/100, Runtime 0.966362, Loss 0.251290, forward nfe 1466, backward nfe 0, Train: 0.9786, Val: 0.8419, Test: 0.8345, Best time: 14.4100
Epoch: 011/100, Runtime 1.005838, Loss 0.221568, forward nfe 1608, backward nfe 0, Train: 0.9714, Val: 0.8434, Test: 0.8426, Best time: 25.7253
Epoch: 012/100, Runtime 0.896276, Loss 0.176534, forward nfe 1750, backward nfe 0, Train: 0.9714, Val: 0.8434, Test: 0.8426, Best time: 15.0000
Epoch: 013/100, Runtime 0.908496, Loss 0.168500, forward nfe 1886, backward nfe 0, Train: 0.9714, Val: 0.8434, Test: 0.8426, Best time: 15.0000
Epoch: 014/100, Runtime 0.981550, Loss 0.172454, forward nfe 2022, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8437, Best time: 39.1831
Epoch: 015/100, Runtime 0.853782, Loss 0.123126, forward nfe 2158, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8437, Best time: 15.0000
Epoch: 016/100, Runtime 0.976932, Loss 0.161462, forward nfe 2294, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8437, Best time: 15.0000
Epoch: 017/100, Runtime 1.004159, Loss 0.151812, forward nfe 2430, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8437, Best time: 15.0000
Epoch: 018/100, Runtime 0.812089, Loss 0.198981, forward nfe 2566, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8437, Best time: 15.0000
Epoch: 019/100, Runtime 0.907671, Loss 0.138434, forward nfe 2690, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8437, Best time: 15.0000
Epoch: 020/100, Runtime 0.788927, Loss 0.156595, forward nfe 2808, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8437, Best time: 15.0000
Epoch: 021/100, Runtime 0.859160, Loss 0.156082, forward nfe 2926, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 022/100, Runtime 0.782808, Loss 0.199389, forward nfe 3044, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 023/100, Runtime 0.908451, Loss 0.181410, forward nfe 3162, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 024/100, Runtime 0.871090, Loss 0.214990, forward nfe 3286, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 025/100, Runtime 0.940624, Loss 0.167695, forward nfe 3410, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 026/100, Runtime 0.695389, Loss 0.201140, forward nfe 3534, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 027/100, Runtime 0.757768, Loss 0.185172, forward nfe 3646, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 028/100, Runtime 0.855655, Loss 0.152886, forward nfe 3758, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 029/100, Runtime 0.730208, Loss 0.128981, forward nfe 3870, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 030/100, Runtime 0.849399, Loss 0.110982, forward nfe 3982, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 031/100, Runtime 0.740519, Loss 0.107167, forward nfe 4088, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 032/100, Runtime 0.671692, Loss 0.163899, forward nfe 4194, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 033/100, Runtime 0.794380, Loss 0.111288, forward nfe 4300, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 034/100, Runtime 0.772224, Loss 0.123799, forward nfe 4406, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 035/100, Runtime 0.701841, Loss 0.121960, forward nfe 4518, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 036/100, Runtime 0.901448, Loss 0.099955, forward nfe 4630, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 037/100, Runtime 0.720310, Loss 0.103122, forward nfe 4742, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 038/100, Runtime 0.767642, Loss 0.094618, forward nfe 4854, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 039/100, Runtime 0.816534, Loss 0.148753, forward nfe 4966, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 040/100, Runtime 0.736913, Loss 0.137446, forward nfe 5078, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 041/100, Runtime 0.884958, Loss 0.104285, forward nfe 5190, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 042/100, Runtime 0.696560, Loss 0.078750, forward nfe 5296, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 043/100, Runtime 0.650902, Loss 0.074640, forward nfe 5396, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 044/100, Runtime 0.741437, Loss 0.086050, forward nfe 5496, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 045/100, Runtime 0.760660, Loss 0.083451, forward nfe 5596, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 046/100, Runtime 0.669023, Loss 0.136487, forward nfe 5696, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 047/100, Runtime 0.672905, Loss 0.101697, forward nfe 5796, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 048/100, Runtime 0.712707, Loss 0.111418, forward nfe 5896, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 049/100, Runtime 0.786722, Loss 0.073623, forward nfe 5996, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 050/100, Runtime 0.721591, Loss 0.096189, forward nfe 6096, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 051/100, Runtime 0.711722, Loss 0.127305, forward nfe 6202, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 052/100, Runtime 0.903577, Loss 0.074274, forward nfe 6308, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 053/100, Runtime 0.703878, Loss 0.089349, forward nfe 6414, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 054/100, Runtime 0.720201, Loss 0.079021, forward nfe 6520, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 055/100, Runtime 0.832035, Loss 0.072401, forward nfe 6626, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 056/100, Runtime 0.699994, Loss 0.075967, forward nfe 6732, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 057/100, Runtime 0.671401, Loss 0.070494, forward nfe 6832, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 058/100, Runtime 0.777404, Loss 0.062600, forward nfe 6932, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 059/100, Runtime 0.713235, Loss 0.057453, forward nfe 7032, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 060/100, Runtime 0.668956, Loss 0.076869, forward nfe 7132, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 061/100, Runtime 0.708178, Loss 0.091647, forward nfe 7232, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 062/100, Runtime 0.819600, Loss 0.085485, forward nfe 7332, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 063/100, Runtime 0.754135, Loss 0.089465, forward nfe 7432, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 064/100, Runtime 0.682968, Loss 0.061965, forward nfe 7532, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 065/100, Runtime 0.655410, Loss 0.077248, forward nfe 7632, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 066/100, Runtime 0.760401, Loss 0.066551, forward nfe 7726, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 067/100, Runtime 0.684120, Loss 0.035939, forward nfe 7820, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 068/100, Runtime 0.637346, Loss 0.064218, forward nfe 7914, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 069/100, Runtime 0.606965, Loss 0.055753, forward nfe 8002, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 070/100, Runtime 0.619802, Loss 0.053707, forward nfe 8090, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 071/100, Runtime 0.625566, Loss 0.064710, forward nfe 8178, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 072/100, Runtime 0.722745, Loss 0.071828, forward nfe 8266, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 073/100, Runtime 0.606878, Loss 0.085035, forward nfe 8354, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 074/100, Runtime 0.655316, Loss 0.051961, forward nfe 8442, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 075/100, Runtime 0.649997, Loss 0.072109, forward nfe 8530, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 076/100, Runtime 0.615274, Loss 0.055040, forward nfe 8618, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 077/100, Runtime 0.623037, Loss 0.066692, forward nfe 8706, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 078/100, Runtime 0.598361, Loss 0.073277, forward nfe 8794, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 079/100, Runtime 0.653823, Loss 0.077864, forward nfe 8882, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 080/100, Runtime 0.663151, Loss 0.068494, forward nfe 8970, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 081/100, Runtime 0.697615, Loss 0.054915, forward nfe 9058, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 082/100, Runtime 0.664224, Loss 0.062461, forward nfe 9146, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 083/100, Runtime 0.692651, Loss 0.048076, forward nfe 9234, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 084/100, Runtime 0.797652, Loss 0.072172, forward nfe 9334, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 085/100, Runtime 0.763190, Loss 0.045708, forward nfe 9440, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 086/100, Runtime 0.684417, Loss 0.041743, forward nfe 9540, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 087/100, Runtime 0.822744, Loss 0.049302, forward nfe 9640, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 088/100, Runtime 0.794286, Loss 0.065336, forward nfe 9752, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 089/100, Runtime 0.749763, Loss 0.049977, forward nfe 9864, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 090/100, Runtime 0.917164, Loss 0.052862, forward nfe 9976, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 091/100, Runtime 0.866748, Loss 0.066823, forward nfe 10094, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 092/100, Runtime 0.865212, Loss 0.057224, forward nfe 10218, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 093/100, Runtime 0.920074, Loss 0.054849, forward nfe 10342, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 094/100, Runtime 0.781946, Loss 0.036017, forward nfe 10466, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 095/100, Runtime 0.948546, Loss 0.059051, forward nfe 10590, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 096/100, Runtime 0.842745, Loss 0.039940, forward nfe 10714, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 097/100, Runtime 1.013930, Loss 0.058676, forward nfe 10850, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 098/100, Runtime 1.046898, Loss 0.049247, forward nfe 10986, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
Epoch: 099/100, Runtime 1.085510, Loss 0.033466, forward nfe 11128, backward nfe 0, Train: 0.9857, Val: 0.8588, Test: 0.8569, Best time: 15.0000
best val accuracy 0.858824 with test accuracy 0.856853 at epoch 21 and best time 15.000000