/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.785603, Loss 1.792812, forward nfe 194, backward nfe 0, Train: 0.2917, Val: 0.1754, Test: 0.1871, Best time: 213.2143
Epoch: 002/100, Runtime 0.682289, Loss 1.764015, forward nfe 810, backward nfe 0, Train: 0.4583, Val: 0.3072, Test: 0.2919, Best time: 208.5138
Epoch: 003/100, Runtime 0.713956, Loss 1.732136, forward nfe 1426, backward nfe 0, Train: 0.4417, Val: 0.3884, Test: 0.3565, Best time: 70.0000
Epoch: 004/100, Runtime 0.672207, Loss 1.671535, forward nfe 2030, backward nfe 0, Train: 0.6667, Val: 0.6217, Test: 0.5661, Best time: 97.4527
Epoch: 005/100, Runtime 0.678041, Loss 1.654378, forward nfe 2628, backward nfe 0, Train: 0.6750, Val: 0.6978, Test: 0.6710, Best time: 138.0971
Epoch: 006/100, Runtime 0.665965, Loss 1.585901, forward nfe 3226, backward nfe 0, Train: 0.6750, Val: 0.6978, Test: 0.6710, Best time: 70.0000
Epoch: 007/100, Runtime 0.642177, Loss 1.581859, forward nfe 3806, backward nfe 0, Train: 0.6750, Val: 0.6978, Test: 0.6710, Best time: 70.0000
Epoch: 008/100, Runtime 0.664125, Loss 1.530280, forward nfe 4380, backward nfe 0, Train: 0.6750, Val: 0.6978, Test: 0.6710, Best time: 70.0000
Epoch: 009/100, Runtime 0.657488, Loss 1.514495, forward nfe 4954, backward nfe 0, Train: 0.6750, Val: 0.6978, Test: 0.6710, Best time: 70.0000
Epoch: 010/100, Runtime 0.627843, Loss 1.497607, forward nfe 5522, backward nfe 0, Train: 0.6750, Val: 0.6978, Test: 0.6710, Best time: 70.0000
Epoch: 011/100, Runtime 0.617910, Loss 1.474481, forward nfe 6072, backward nfe 0, Train: 0.7250, Val: 0.7246, Test: 0.7210, Best time: 9.2066
Epoch: 012/100, Runtime 0.615923, Loss 1.479679, forward nfe 6616, backward nfe 0, Train: 0.7000, Val: 0.7312, Test: 0.7226, Best time: 11.2109
Epoch: 013/100, Runtime 0.612345, Loss 1.437006, forward nfe 7160, backward nfe 0, Train: 0.7000, Val: 0.7312, Test: 0.7226, Best time: 70.0000
Epoch: 014/100, Runtime 0.608065, Loss 1.394370, forward nfe 7698, backward nfe 0, Train: 0.7000, Val: 0.7312, Test: 0.7226, Best time: 70.0000
Epoch: 015/100, Runtime 0.603798, Loss 1.367436, forward nfe 8218, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7403, Best time: 14.1230
Epoch: 016/100, Runtime 0.577764, Loss 1.382211, forward nfe 8732, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7403, Best time: 70.0000
Epoch: 017/100, Runtime 0.571314, Loss 1.297674, forward nfe 9234, backward nfe 0, Train: 0.7500, Val: 0.7399, Test: 0.7548, Best time: 15.0166
Epoch: 018/100, Runtime 0.585273, Loss 1.299161, forward nfe 9742, backward nfe 0, Train: 0.7500, Val: 0.7399, Test: 0.7548, Best time: 70.0000
Epoch: 019/100, Runtime 0.571076, Loss 1.258786, forward nfe 10244, backward nfe 0, Train: 0.7500, Val: 0.7399, Test: 0.7548, Best time: 70.0000
Epoch: 020/100, Runtime 0.553751, Loss 1.229141, forward nfe 10734, backward nfe 0, Train: 0.7500, Val: 0.7399, Test: 0.7548, Best time: 70.0000
Epoch: 021/100, Runtime 0.543841, Loss 1.303267, forward nfe 11212, backward nfe 0, Train: 0.7500, Val: 0.7399, Test: 0.7548, Best time: 70.0000
Epoch: 022/100, Runtime 0.533538, Loss 1.202001, forward nfe 11678, backward nfe 0, Train: 0.7500, Val: 0.7399, Test: 0.7548, Best time: 70.0000
Epoch: 023/100, Runtime 0.532368, Loss 1.219423, forward nfe 12132, backward nfe 0, Train: 0.7500, Val: 0.7399, Test: 0.7548, Best time: 70.0000
Epoch: 024/100, Runtime 0.514528, Loss 1.207713, forward nfe 12586, backward nfe 0, Train: 0.7500, Val: 0.7399, Test: 0.7548, Best time: 70.0000
Epoch: 025/100, Runtime 0.501854, Loss 1.156908, forward nfe 13034, backward nfe 0, Train: 0.7500, Val: 0.7399, Test: 0.7548, Best time: 70.0000
Epoch: 026/100, Runtime 0.514202, Loss 1.138131, forward nfe 13470, backward nfe 0, Train: 0.7500, Val: 0.7399, Test: 0.7548, Best time: 70.0000
Epoch: 027/100, Runtime 0.497488, Loss 1.129254, forward nfe 13900, backward nfe 0, Train: 0.7083, Val: 0.7406, Test: 0.7306, Best time: 109.0319
Epoch: 028/100, Runtime 0.478687, Loss 1.255376, forward nfe 14324, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 52.7198
Epoch: 029/100, Runtime 0.486988, Loss 1.164473, forward nfe 14748, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 030/100, Runtime 0.478863, Loss 1.194997, forward nfe 15166, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 031/100, Runtime 0.473419, Loss 1.122683, forward nfe 15584, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 032/100, Runtime 0.460800, Loss 1.145393, forward nfe 16002, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 033/100, Runtime 0.480962, Loss 1.214937, forward nfe 16402, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 034/100, Runtime 0.442295, Loss 1.186344, forward nfe 16796, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 035/100, Runtime 0.445472, Loss 1.211888, forward nfe 17178, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 036/100, Runtime 0.435693, Loss 1.274605, forward nfe 17560, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 037/100, Runtime 0.444706, Loss 1.135119, forward nfe 17936, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 038/100, Runtime 0.422293, Loss 1.188144, forward nfe 18300, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 039/100, Runtime 0.426244, Loss 1.158011, forward nfe 18652, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 040/100, Runtime 0.424356, Loss 1.148404, forward nfe 19010, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 041/100, Runtime 0.412984, Loss 1.177013, forward nfe 19368, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 042/100, Runtime 0.416644, Loss 1.314732, forward nfe 19714, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 043/100, Runtime 0.417128, Loss 1.172458, forward nfe 20066, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 044/100, Runtime 0.416797, Loss 1.204273, forward nfe 20412, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 045/100, Runtime 0.393870, Loss 1.176868, forward nfe 20752, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 046/100, Runtime 0.380852, Loss 1.167751, forward nfe 21086, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 047/100, Runtime 0.389201, Loss 1.183763, forward nfe 21414, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 048/100, Runtime 0.374345, Loss 1.237440, forward nfe 21742, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 049/100, Runtime 0.390381, Loss 1.173490, forward nfe 22064, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 050/100, Runtime 0.385113, Loss 1.221445, forward nfe 22386, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 051/100, Runtime 0.389254, Loss 1.077230, forward nfe 22708, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 052/100, Runtime 0.398228, Loss 1.208066, forward nfe 23024, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 053/100, Runtime 0.539420, Loss 1.144036, forward nfe 23340, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 054/100, Runtime 0.383120, Loss 1.229638, forward nfe 23656, backward nfe 0, Train: 0.7667, Val: 0.7442, Test: 0.7339, Best time: 70.0000
Epoch: 055/100, Runtime 0.398354, Loss 1.215041, forward nfe 23972, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 116.4530
Epoch: 056/100, Runtime 0.383803, Loss 1.130643, forward nfe 24288, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 057/100, Runtime 0.371768, Loss 1.324180, forward nfe 24604, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 058/100, Runtime 0.377956, Loss 1.162929, forward nfe 24920, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 059/100, Runtime 0.386935, Loss 1.211856, forward nfe 25236, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 060/100, Runtime 0.372437, Loss 1.287560, forward nfe 25552, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 061/100, Runtime 0.372400, Loss 1.075548, forward nfe 25868, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 062/100, Runtime 0.383574, Loss 0.966982, forward nfe 26184, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 063/100, Runtime 0.383100, Loss 1.201903, forward nfe 26500, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 064/100, Runtime 0.377288, Loss 1.235532, forward nfe 26816, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 065/100, Runtime 0.379721, Loss 1.273398, forward nfe 27126, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 066/100, Runtime 0.375453, Loss 1.216841, forward nfe 27436, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 067/100, Runtime 0.364979, Loss 1.192059, forward nfe 27746, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 068/100, Runtime 0.374450, Loss 1.233500, forward nfe 28056, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 069/100, Runtime 0.367841, Loss 1.187417, forward nfe 28366, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 070/100, Runtime 0.379586, Loss 1.139896, forward nfe 28676, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 071/100, Runtime 0.372115, Loss 1.052991, forward nfe 28986, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 072/100, Runtime 0.363972, Loss 1.223145, forward nfe 29290, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 073/100, Runtime 0.375398, Loss 1.250576, forward nfe 29594, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 074/100, Runtime 0.373747, Loss 1.088782, forward nfe 29898, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 075/100, Runtime 0.379266, Loss 1.061103, forward nfe 30202, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 076/100, Runtime 0.366336, Loss 1.259539, forward nfe 30506, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 077/100, Runtime 0.381494, Loss 1.160445, forward nfe 30810, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 078/100, Runtime 0.379887, Loss 1.212780, forward nfe 31114, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 079/100, Runtime 0.375417, Loss 1.079320, forward nfe 31418, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 080/100, Runtime 0.356928, Loss 1.060831, forward nfe 31722, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 081/100, Runtime 0.394930, Loss 1.103434, forward nfe 32020, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 082/100, Runtime 0.363458, Loss 1.147344, forward nfe 32318, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 083/100, Runtime 0.359159, Loss 1.037804, forward nfe 32622, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 084/100, Runtime 0.364736, Loss 1.058956, forward nfe 32920, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 085/100, Runtime 0.354998, Loss 1.066171, forward nfe 33218, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 086/100, Runtime 0.371031, Loss 1.042597, forward nfe 33516, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 087/100, Runtime 0.353765, Loss 1.104904, forward nfe 33814, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 088/100, Runtime 0.369354, Loss 1.105686, forward nfe 34112, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 089/100, Runtime 0.354222, Loss 1.080848, forward nfe 34410, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 090/100, Runtime 0.371556, Loss 1.189783, forward nfe 34708, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 091/100, Runtime 0.362918, Loss 0.948040, forward nfe 35006, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 092/100, Runtime 0.379680, Loss 1.178083, forward nfe 35304, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 093/100, Runtime 0.357026, Loss 1.075081, forward nfe 35602, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 094/100, Runtime 0.413008, Loss 1.070127, forward nfe 35894, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 095/100, Runtime 0.364986, Loss 1.014879, forward nfe 36192, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 096/100, Runtime 0.357055, Loss 1.208743, forward nfe 36484, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 097/100, Runtime 0.373268, Loss 1.049280, forward nfe 36776, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 098/100, Runtime 0.428085, Loss 1.017044, forward nfe 37068, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
Epoch: 099/100, Runtime 0.358000, Loss 1.075303, forward nfe 37354, backward nfe 0, Train: 0.7500, Val: 0.7457, Test: 0.7468, Best time: 70.0000
best val accuracy 0.745652 with test accuracy 0.746774 at epoch 55 and best time 70.000000