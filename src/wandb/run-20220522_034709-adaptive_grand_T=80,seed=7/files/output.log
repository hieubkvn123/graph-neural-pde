/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 4.796025, Loss 1.944103, forward nfe 152, backward nfe 0, Train: 0.2500, Val: 0.2140, Test: 0.2396, Best time: 5.1525
Epoch: 002/100, Runtime 4.635678, Loss 2.358758, forward nfe 750, backward nfe 0, Train: 0.2357, Val: 0.3831, Test: 0.3452, Best time: 15.9291
Epoch: 003/100, Runtime 4.497731, Loss 1.919371, forward nfe 1324, backward nfe 0, Train: 0.4714, Val: 0.5456, Test: 0.5330, Best time: 0.9617
Epoch: 004/100, Runtime 4.471859, Loss 1.923889, forward nfe 1886, backward nfe 0, Train: 0.6929, Val: 0.7015, Test: 0.6914, Best time: 7.3688
Epoch: 005/100, Runtime 4.223399, Loss 1.902660, forward nfe 2436, backward nfe 0, Train: 0.6929, Val: 0.7015, Test: 0.6914, Best time: 80.0000
Epoch: 006/100, Runtime 4.103893, Loss 1.900659, forward nfe 2974, backward nfe 0, Train: 0.6929, Val: 0.7015, Test: 0.6914, Best time: 80.0000
Epoch: 007/100, Runtime 3.803287, Loss 1.899842, forward nfe 3500, backward nfe 0, Train: 0.6929, Val: 0.7015, Test: 0.6914, Best time: 80.0000
Epoch: 008/100, Runtime 3.835071, Loss 1.888620, forward nfe 4014, backward nfe 0, Train: 0.6929, Val: 0.7015, Test: 0.6914, Best time: 80.0000
Epoch: 009/100, Runtime 3.830091, Loss 1.859597, forward nfe 4516, backward nfe 0, Train: 0.6929, Val: 0.7015, Test: 0.6914, Best time: 80.0000
Epoch: 010/100, Runtime 3.756523, Loss 1.822450, forward nfe 5012, backward nfe 0, Train: 0.6786, Val: 0.7471, Test: 0.7411, Best time: 4.4030
Epoch: 011/100, Runtime 3.652210, Loss 1.754269, forward nfe 5496, backward nfe 0, Train: 0.7286, Val: 0.8022, Test: 0.7909, Best time: 9.2005
Epoch: 012/100, Runtime 3.733052, Loss 1.668494, forward nfe 5968, backward nfe 0, Train: 0.7286, Val: 0.8022, Test: 0.7909, Best time: 80.0000
Epoch: 013/100, Runtime 3.602156, Loss 1.570715, forward nfe 6428, backward nfe 0, Train: 0.7286, Val: 0.8022, Test: 0.7909, Best time: 80.0000
Epoch: 014/100, Runtime 3.605004, Loss 1.464638, forward nfe 6876, backward nfe 0, Train: 0.7286, Val: 0.8022, Test: 0.7909, Best time: 80.0000
Epoch: 015/100, Runtime 3.490208, Loss 1.347425, forward nfe 7324, backward nfe 0, Train: 0.7286, Val: 0.8022, Test: 0.7909, Best time: 80.0000
Epoch: 016/100, Runtime 3.476460, Loss 1.235143, forward nfe 7766, backward nfe 0, Train: 0.7286, Val: 0.8022, Test: 0.7909, Best time: 80.0000
Epoch: 017/100, Runtime 3.418977, Loss 1.131480, forward nfe 8190, backward nfe 0, Train: 0.7286, Val: 0.8022, Test: 0.7909, Best time: 80.0000
Epoch: 018/100, Runtime 3.308446, Loss 1.043579, forward nfe 8614, backward nfe 0, Train: 0.7286, Val: 0.8022, Test: 0.7909, Best time: 80.0000
Epoch: 019/100, Runtime 3.297855, Loss 0.944026, forward nfe 9032, backward nfe 0, Train: 0.7286, Val: 0.8022, Test: 0.7909, Best time: 80.0000
Epoch: 020/100, Runtime 3.226820, Loss 0.854351, forward nfe 9438, backward nfe 0, Train: 0.8714, Val: 0.8206, Test: 0.8294, Best time: 39.1169
Epoch: 021/100, Runtime 3.072318, Loss 0.789014, forward nfe 9838, backward nfe 0, Train: 0.8429, Val: 0.8375, Test: 0.8386, Best time: 86.9760
Epoch: 022/100, Runtime 3.093199, Loss 0.730396, forward nfe 10226, backward nfe 0, Train: 0.8429, Val: 0.8375, Test: 0.8386, Best time: 80.0000
Epoch: 023/100, Runtime 2.785609, Loss 0.668649, forward nfe 10608, backward nfe 0, Train: 0.8429, Val: 0.8375, Test: 0.8386, Best time: 80.0000
Epoch: 024/100, Runtime 2.810049, Loss 0.638422, forward nfe 10978, backward nfe 0, Train: 0.8429, Val: 0.8375, Test: 0.8386, Best time: 80.0000
Epoch: 025/100, Runtime 2.706567, Loss 0.595925, forward nfe 11336, backward nfe 0, Train: 0.8429, Val: 0.8375, Test: 0.8386, Best time: 80.0000
Epoch: 026/100, Runtime 2.606883, Loss 0.554395, forward nfe 11682, backward nfe 0, Train: 0.8429, Val: 0.8375, Test: 0.8386, Best time: 80.0000
Epoch: 027/100, Runtime 2.488804, Loss 0.527114, forward nfe 12016, backward nfe 0, Train: 0.9143, Val: 0.8463, Test: 0.8426, Best time: 54.3184
Epoch: 028/100, Runtime 2.584634, Loss 0.485140, forward nfe 12344, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 91.9499
Epoch: 029/100, Runtime 2.571988, Loss 0.491086, forward nfe 12666, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 030/100, Runtime 2.526736, Loss 0.435289, forward nfe 12994, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 031/100, Runtime 2.445862, Loss 0.408980, forward nfe 13298, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 032/100, Runtime 2.259531, Loss 0.441631, forward nfe 13590, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 033/100, Runtime 2.245558, Loss 0.461561, forward nfe 13870, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 034/100, Runtime 2.270709, Loss 0.351993, forward nfe 14162, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 035/100, Runtime 2.187298, Loss 0.384669, forward nfe 14442, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 036/100, Runtime 2.265926, Loss 0.427786, forward nfe 14716, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 037/100, Runtime 2.094671, Loss 0.289963, forward nfe 14984, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 038/100, Runtime 2.064178, Loss 0.335094, forward nfe 15246, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 039/100, Runtime 1.986713, Loss 0.336767, forward nfe 15484, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 040/100, Runtime 2.024436, Loss 0.338156, forward nfe 15728, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 041/100, Runtime 1.990658, Loss 0.314283, forward nfe 15966, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 042/100, Runtime 1.966932, Loss 0.245972, forward nfe 16204, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 043/100, Runtime 1.889860, Loss 0.260071, forward nfe 16436, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 044/100, Runtime 1.873477, Loss 0.263039, forward nfe 16668, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 045/100, Runtime 1.805281, Loss 0.262534, forward nfe 16900, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 046/100, Runtime 1.827383, Loss 0.242791, forward nfe 17132, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 047/100, Runtime 1.775083, Loss 0.177762, forward nfe 17364, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 048/100, Runtime 1.769545, Loss 0.167130, forward nfe 17590, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 049/100, Runtime 1.804274, Loss 0.175464, forward nfe 17810, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 050/100, Runtime 1.873328, Loss 0.200985, forward nfe 18030, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 051/100, Runtime 1.833211, Loss 0.183683, forward nfe 18250, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 052/100, Runtime 1.832335, Loss 0.149535, forward nfe 18470, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 053/100, Runtime 1.803106, Loss 0.155419, forward nfe 18690, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 054/100, Runtime 1.807137, Loss 0.160458, forward nfe 18910, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 055/100, Runtime 1.828290, Loss 0.145580, forward nfe 19136, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 056/100, Runtime 1.702611, Loss 0.221526, forward nfe 19362, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 057/100, Runtime 1.781197, Loss 0.146572, forward nfe 19588, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 058/100, Runtime 1.782966, Loss 0.151136, forward nfe 19820, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 059/100, Runtime 1.848913, Loss 0.162017, forward nfe 20052, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 060/100, Runtime 1.837551, Loss 0.135605, forward nfe 20284, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 061/100, Runtime 1.886613, Loss 0.130308, forward nfe 20516, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 062/100, Runtime 1.955945, Loss 0.109457, forward nfe 20754, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 063/100, Runtime 1.834802, Loss 0.081591, forward nfe 20980, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 064/100, Runtime 1.873523, Loss 0.087349, forward nfe 21212, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 065/100, Runtime 1.936284, Loss 0.107207, forward nfe 21456, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 066/100, Runtime 1.957008, Loss 0.094500, forward nfe 21700, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 067/100, Runtime 1.867795, Loss 0.114329, forward nfe 21944, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 068/100, Runtime 1.759723, Loss 0.099839, forward nfe 22188, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 069/100, Runtime 1.955515, Loss 0.063682, forward nfe 22432, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 070/100, Runtime 1.849785, Loss 0.079094, forward nfe 22676, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 071/100, Runtime 1.829479, Loss 0.093776, forward nfe 22920, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 072/100, Runtime 1.850022, Loss 0.100400, forward nfe 23158, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 073/100, Runtime 1.959968, Loss 0.082208, forward nfe 23396, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 074/100, Runtime 1.891746, Loss 0.112502, forward nfe 23646, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 075/100, Runtime 1.939995, Loss 0.074986, forward nfe 23890, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 076/100, Runtime 1.813034, Loss 0.072804, forward nfe 24134, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 077/100, Runtime 1.969849, Loss 0.065969, forward nfe 24384, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 078/100, Runtime 1.981971, Loss 0.072695, forward nfe 24628, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 079/100, Runtime 1.974935, Loss 0.063671, forward nfe 24872, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 080/100, Runtime 2.163620, Loss 0.070905, forward nfe 25116, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 081/100, Runtime 2.052516, Loss 0.088504, forward nfe 25360, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 082/100, Runtime 1.965159, Loss 0.060555, forward nfe 25604, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 083/100, Runtime 1.931200, Loss 0.104948, forward nfe 25848, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 084/100, Runtime 2.000610, Loss 0.050821, forward nfe 26092, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 085/100, Runtime 1.899380, Loss 0.090000, forward nfe 26336, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 086/100, Runtime 1.899955, Loss 0.081158, forward nfe 26574, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 087/100, Runtime 2.048204, Loss 0.056599, forward nfe 26812, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 088/100, Runtime 2.004221, Loss 0.067755, forward nfe 27056, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 089/100, Runtime 2.002292, Loss 0.057055, forward nfe 27300, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 090/100, Runtime 2.001182, Loss 0.056141, forward nfe 27544, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 091/100, Runtime 1.925977, Loss 0.064712, forward nfe 27788, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 092/100, Runtime 1.982607, Loss 0.090184, forward nfe 28020, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 093/100, Runtime 1.924911, Loss 0.048916, forward nfe 28258, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 094/100, Runtime 1.914074, Loss 0.042134, forward nfe 28490, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 095/100, Runtime 1.917307, Loss 0.092419, forward nfe 28722, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 096/100, Runtime 1.917498, Loss 0.052567, forward nfe 28954, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 097/100, Runtime 1.913761, Loss 0.043631, forward nfe 29186, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 098/100, Runtime 1.934673, Loss 0.051166, forward nfe 29418, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
Epoch: 099/100, Runtime 1.900448, Loss 0.097911, forward nfe 29650, backward nfe 0, Train: 0.9143, Val: 0.8515, Test: 0.8396, Best time: 80.0000
best val accuracy 0.851471 with test accuracy 0.839594 at epoch 28 and best time 80.000000