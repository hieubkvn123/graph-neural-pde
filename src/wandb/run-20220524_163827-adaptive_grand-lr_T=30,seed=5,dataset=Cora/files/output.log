/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.749248, Loss 1.948809, forward nfe 74, backward nfe 0, Train: 0.2571, Val: 0.2397, Test: 0.2508, Best time: 9.9638
Epoch: 002/100, Runtime 0.685155, Loss 1.931737, forward nfe 342, backward nfe 0, Train: 0.2929, Val: 0.2500, Test: 0.2528, Best time: 0.0896
Epoch: 003/100, Runtime 0.647911, Loss 1.836046, forward nfe 598, backward nfe 0, Train: 0.5643, Val: 0.5250, Test: 0.5188, Best time: 2.2592
Epoch: 004/100, Runtime 0.681140, Loss 1.653876, forward nfe 842, backward nfe 0, Train: 0.7571, Val: 0.7588, Test: 0.7624, Best time: 7.4450
Epoch: 005/100, Runtime 0.657065, Loss 1.404078, forward nfe 1092, backward nfe 0, Train: 0.9071, Val: 0.8272, Test: 0.8274, Best time: 7.5175
Epoch: 006/100, Runtime 0.615549, Loss 1.130202, forward nfe 1330, backward nfe 0, Train: 0.9071, Val: 0.8272, Test: 0.8274, Best time: 30.0000
Epoch: 007/100, Runtime 0.594016, Loss 0.862176, forward nfe 1574, backward nfe 0, Train: 0.9071, Val: 0.8272, Test: 0.8274, Best time: 30.0000
Epoch: 008/100, Runtime 0.594790, Loss 0.635821, forward nfe 1818, backward nfe 0, Train: 0.9071, Val: 0.8272, Test: 0.8274, Best time: 30.0000
Epoch: 009/100, Runtime 0.556023, Loss 0.481829, forward nfe 2038, backward nfe 0, Train: 0.9071, Val: 0.8272, Test: 0.8274, Best time: 30.0000
Epoch: 010/100, Runtime 0.533147, Loss 0.448673, forward nfe 2258, backward nfe 0, Train: 0.9071, Val: 0.8272, Test: 0.8274, Best time: 30.0000
Epoch: 011/100, Runtime 0.510002, Loss 0.335598, forward nfe 2472, backward nfe 0, Train: 0.9071, Val: 0.8272, Test: 0.8274, Best time: 30.0000
Epoch: 012/100, Runtime 0.543930, Loss 0.303186, forward nfe 2686, backward nfe 0, Train: 0.9071, Val: 0.8272, Test: 0.8274, Best time: 30.0000
Epoch: 013/100, Runtime 0.509873, Loss 0.242982, forward nfe 2894, backward nfe 0, Train: 0.9071, Val: 0.8272, Test: 0.8274, Best time: 30.0000
Epoch: 014/100, Runtime 0.535226, Loss 0.241043, forward nfe 3096, backward nfe 0, Train: 0.9071, Val: 0.8272, Test: 0.8274, Best time: 30.0000
Epoch: 015/100, Runtime 0.521514, Loss 0.242810, forward nfe 3298, backward nfe 0, Train: 0.9071, Val: 0.8272, Test: 0.8274, Best time: 30.0000
Epoch: 016/100, Runtime 0.509382, Loss 0.249138, forward nfe 3500, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 63.7314
Epoch: 017/100, Runtime 0.510428, Loss 0.192357, forward nfe 3690, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 018/100, Runtime 0.454462, Loss 0.210965, forward nfe 3880, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 019/100, Runtime 0.477950, Loss 0.202921, forward nfe 4058, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 020/100, Runtime 0.446854, Loss 0.220748, forward nfe 4236, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 021/100, Runtime 0.440510, Loss 0.185733, forward nfe 4414, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 022/100, Runtime 0.456015, Loss 0.248586, forward nfe 4592, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 023/100, Runtime 0.443199, Loss 0.212233, forward nfe 4764, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 024/100, Runtime 0.435102, Loss 0.258988, forward nfe 4936, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 025/100, Runtime 0.439513, Loss 0.229018, forward nfe 5102, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 026/100, Runtime 0.437114, Loss 0.176898, forward nfe 5268, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 027/100, Runtime 0.396083, Loss 0.261215, forward nfe 5428, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 028/100, Runtime 0.393233, Loss 0.173533, forward nfe 5582, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 029/100, Runtime 0.415483, Loss 0.209666, forward nfe 5742, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 030/100, Runtime 0.414077, Loss 0.165878, forward nfe 5902, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 031/100, Runtime 0.413860, Loss 0.195687, forward nfe 6062, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 032/100, Runtime 0.407713, Loss 0.149726, forward nfe 6222, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 033/100, Runtime 0.402711, Loss 0.139713, forward nfe 6382, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 034/100, Runtime 0.399972, Loss 0.151602, forward nfe 6536, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 035/100, Runtime 0.404546, Loss 0.131215, forward nfe 6690, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 036/100, Runtime 0.395237, Loss 0.136238, forward nfe 6844, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 037/100, Runtime 0.410312, Loss 0.118936, forward nfe 6998, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 038/100, Runtime 0.392043, Loss 0.139902, forward nfe 7152, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 039/100, Runtime 0.412898, Loss 0.115566, forward nfe 7306, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 040/100, Runtime 0.405134, Loss 0.077581, forward nfe 7466, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 041/100, Runtime 0.402466, Loss 0.155330, forward nfe 7620, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 042/100, Runtime 0.395113, Loss 0.130867, forward nfe 7774, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 043/100, Runtime 0.396341, Loss 0.092825, forward nfe 7928, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 044/100, Runtime 0.371335, Loss 0.102618, forward nfe 8082, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 045/100, Runtime 0.383281, Loss 0.176910, forward nfe 8230, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 046/100, Runtime 0.382235, Loss 0.098127, forward nfe 8378, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 047/100, Runtime 0.379190, Loss 0.116848, forward nfe 8526, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 048/100, Runtime 0.383999, Loss 0.111525, forward nfe 8674, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 049/100, Runtime 0.406000, Loss 0.105560, forward nfe 8822, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 050/100, Runtime 0.387612, Loss 0.088933, forward nfe 8970, backward nfe 0, Train: 0.9714, Val: 0.8309, Test: 0.8426, Best time: 30.0000
Epoch: 051/100, Runtime 0.398379, Loss 0.089965, forward nfe 9118, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 052/100, Runtime 0.377260, Loss 0.082732, forward nfe 9266, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 053/100, Runtime 0.365837, Loss 0.066088, forward nfe 9414, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 054/100, Runtime 0.404477, Loss 0.079537, forward nfe 9562, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 055/100, Runtime 0.403963, Loss 0.080794, forward nfe 9710, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 056/100, Runtime 0.396892, Loss 0.071854, forward nfe 9858, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 057/100, Runtime 0.370358, Loss 0.085530, forward nfe 10006, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 058/100, Runtime 0.376109, Loss 0.080383, forward nfe 10154, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 059/100, Runtime 0.384302, Loss 0.078837, forward nfe 10302, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 060/100, Runtime 0.382046, Loss 0.098303, forward nfe 10450, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 061/100, Runtime 0.355650, Loss 0.130829, forward nfe 10598, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 062/100, Runtime 0.358584, Loss 0.087159, forward nfe 10734, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 063/100, Runtime 0.359617, Loss 0.082172, forward nfe 10870, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 064/100, Runtime 0.359649, Loss 0.098473, forward nfe 11006, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 065/100, Runtime 0.359509, Loss 0.070018, forward nfe 11142, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 066/100, Runtime 0.367533, Loss 0.069519, forward nfe 11278, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 067/100, Runtime 0.355123, Loss 0.092522, forward nfe 11414, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 068/100, Runtime 0.352003, Loss 0.063207, forward nfe 11550, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 069/100, Runtime 0.350448, Loss 0.149031, forward nfe 11686, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 070/100, Runtime 0.333017, Loss 0.055765, forward nfe 11822, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 071/100, Runtime 0.328465, Loss 0.038057, forward nfe 11958, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 072/100, Runtime 0.359146, Loss 0.070208, forward nfe 12094, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 073/100, Runtime 0.353323, Loss 0.070548, forward nfe 12242, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 074/100, Runtime 0.341378, Loss 0.067242, forward nfe 12390, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 075/100, Runtime 0.337492, Loss 0.051366, forward nfe 12526, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 076/100, Runtime 0.326323, Loss 0.041076, forward nfe 12662, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 077/100, Runtime 0.330496, Loss 0.048376, forward nfe 12798, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 078/100, Runtime 0.356178, Loss 0.046819, forward nfe 12934, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 079/100, Runtime 0.359000, Loss 0.060709, forward nfe 13070, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 080/100, Runtime 0.358907, Loss 0.085632, forward nfe 13206, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 081/100, Runtime 0.354183, Loss 0.057931, forward nfe 13342, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 082/100, Runtime 0.360201, Loss 0.075411, forward nfe 13478, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 083/100, Runtime 0.365095, Loss 0.074262, forward nfe 13614, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 084/100, Runtime 0.362255, Loss 0.064515, forward nfe 13750, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 085/100, Runtime 0.355771, Loss 0.052687, forward nfe 13892, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 086/100, Runtime 0.361823, Loss 0.053767, forward nfe 14028, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 087/100, Runtime 0.355789, Loss 0.051537, forward nfe 14164, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 088/100, Runtime 0.365041, Loss 0.037948, forward nfe 14300, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 089/100, Runtime 0.359158, Loss 0.051878, forward nfe 14436, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 090/100, Runtime 0.362970, Loss 0.075583, forward nfe 14572, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 091/100, Runtime 0.357661, Loss 0.073470, forward nfe 14708, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 092/100, Runtime 0.359513, Loss 0.034883, forward nfe 14844, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 093/100, Runtime 0.359323, Loss 0.029600, forward nfe 14980, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 094/100, Runtime 0.367434, Loss 0.022117, forward nfe 15116, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 095/100, Runtime 0.354559, Loss 0.028357, forward nfe 15252, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 096/100, Runtime 0.354899, Loss 0.024059, forward nfe 15388, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 097/100, Runtime 0.374481, Loss 0.026692, forward nfe 15524, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 098/100, Runtime 0.362076, Loss 0.035973, forward nfe 15660, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
Epoch: 099/100, Runtime 0.373072, Loss 0.031165, forward nfe 15808, backward nfe 0, Train: 0.9929, Val: 0.8360, Test: 0.8315, Best time: 30.0000
best val accuracy 0.836029 with test accuracy 0.831472 at epoch 51 and best time 30.000000