/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.666363, Loss 1.792994, forward nfe 164, backward nfe 0, Train: 0.2583, Val: 0.2558, Test: 0.2452, Best time: 0.0409
Epoch: 002/100, Runtime 0.626593, Loss 1.785366, forward nfe 678, backward nfe 0, Train: 0.3000, Val: 0.3138, Test: 0.2984, Best time: 0.0394
Epoch: 003/100, Runtime 0.629376, Loss 1.756148, forward nfe 1204, backward nfe 0, Train: 0.4667, Val: 0.4486, Test: 0.4403, Best time: 0.8598
Epoch: 004/100, Runtime 0.596284, Loss 1.721989, forward nfe 1718, backward nfe 0, Train: 0.5417, Val: 0.6058, Test: 0.5677, Best time: 61.0612
Epoch: 005/100, Runtime 0.598282, Loss 1.693384, forward nfe 2232, backward nfe 0, Train: 0.5917, Val: 0.6478, Test: 0.5887, Best time: 48.1656
Epoch: 006/100, Runtime 0.590739, Loss 1.620230, forward nfe 2746, backward nfe 0, Train: 0.5917, Val: 0.6478, Test: 0.5887, Best time: 55.0000
Epoch: 007/100, Runtime 0.575879, Loss 1.598326, forward nfe 3260, backward nfe 0, Train: 0.5917, Val: 0.6478, Test: 0.5887, Best time: 55.0000
Epoch: 008/100, Runtime 0.569757, Loss 1.588616, forward nfe 3756, backward nfe 0, Train: 0.6417, Val: 0.6536, Test: 0.6274, Best time: 4.6618
Epoch: 009/100, Runtime 0.573774, Loss 1.521522, forward nfe 4246, backward nfe 0, Train: 0.6750, Val: 0.6638, Test: 0.6274, Best time: 11.1123
Epoch: 010/100, Runtime 0.561271, Loss 1.520712, forward nfe 4736, backward nfe 0, Train: 0.7083, Val: 0.6804, Test: 0.6403, Best time: 15.6851
Epoch: 011/100, Runtime 0.559348, Loss 1.488176, forward nfe 5214, backward nfe 0, Train: 0.7083, Val: 0.7109, Test: 0.6597, Best time: 22.4041
Epoch: 012/100, Runtime 0.544567, Loss 1.472793, forward nfe 5674, backward nfe 0, Train: 0.7583, Val: 0.7239, Test: 0.6968, Best time: 23.4017
Epoch: 013/100, Runtime 0.536241, Loss 1.505662, forward nfe 6146, backward nfe 0, Train: 0.7417, Val: 0.7261, Test: 0.6984, Best time: 20.7232
Epoch: 014/100, Runtime 0.533821, Loss 1.381847, forward nfe 6606, backward nfe 0, Train: 0.7417, Val: 0.7261, Test: 0.6984, Best time: 55.0000
Epoch: 015/100, Runtime 0.535052, Loss 1.371805, forward nfe 7048, backward nfe 0, Train: 0.7583, Val: 0.7391, Test: 0.7161, Best time: 37.1945
Epoch: 016/100, Runtime 0.516572, Loss 1.341316, forward nfe 7484, backward nfe 0, Train: 0.7667, Val: 0.7449, Test: 0.7210, Best time: 38.2661
Epoch: 017/100, Runtime 0.517461, Loss 1.359299, forward nfe 7932, backward nfe 0, Train: 0.7667, Val: 0.7449, Test: 0.7210, Best time: 55.0000
Epoch: 018/100, Runtime 0.534226, Loss 1.336896, forward nfe 8374, backward nfe 0, Train: 0.7667, Val: 0.7449, Test: 0.7210, Best time: 55.0000
Epoch: 019/100, Runtime 0.503978, Loss 1.317821, forward nfe 8816, backward nfe 0, Train: 0.7667, Val: 0.7449, Test: 0.7210, Best time: 55.0000
Epoch: 020/100, Runtime 0.495396, Loss 1.324070, forward nfe 9234, backward nfe 0, Train: 0.7667, Val: 0.7449, Test: 0.7210, Best time: 55.0000
Epoch: 021/100, Runtime 0.480394, Loss 1.167553, forward nfe 9652, backward nfe 0, Train: 0.7667, Val: 0.7449, Test: 0.7210, Best time: 55.0000
Epoch: 022/100, Runtime 0.470105, Loss 1.245454, forward nfe 10058, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 46.8639
Epoch: 023/100, Runtime 0.490747, Loss 1.183908, forward nfe 10458, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 024/100, Runtime 0.458282, Loss 1.167590, forward nfe 10858, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 025/100, Runtime 0.475936, Loss 1.217631, forward nfe 11246, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 026/100, Runtime 0.475141, Loss 1.184844, forward nfe 11640, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 027/100, Runtime 0.449606, Loss 1.294317, forward nfe 12028, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 028/100, Runtime 0.448788, Loss 1.171038, forward nfe 12398, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 029/100, Runtime 0.437546, Loss 1.185502, forward nfe 12774, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 030/100, Runtime 0.441990, Loss 1.212511, forward nfe 13138, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 031/100, Runtime 0.419374, Loss 1.140364, forward nfe 13496, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 032/100, Runtime 0.403427, Loss 1.158882, forward nfe 13848, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 033/100, Runtime 0.397133, Loss 1.208562, forward nfe 14194, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 034/100, Runtime 0.395109, Loss 1.199313, forward nfe 14534, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 035/100, Runtime 0.410071, Loss 1.205938, forward nfe 14874, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 036/100, Runtime 0.391411, Loss 1.213483, forward nfe 15214, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 037/100, Runtime 0.397635, Loss 1.136053, forward nfe 15548, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 038/100, Runtime 0.397095, Loss 1.166785, forward nfe 15882, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 039/100, Runtime 0.372566, Loss 1.111058, forward nfe 16204, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 040/100, Runtime 0.380528, Loss 1.085889, forward nfe 16520, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 041/100, Runtime 0.373596, Loss 1.178645, forward nfe 16830, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 042/100, Runtime 0.372010, Loss 1.159301, forward nfe 17140, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 043/100, Runtime 0.370714, Loss 1.191671, forward nfe 17450, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 044/100, Runtime 0.368423, Loss 1.154181, forward nfe 17760, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 045/100, Runtime 0.369624, Loss 1.205888, forward nfe 18070, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 046/100, Runtime 0.363982, Loss 1.179353, forward nfe 18368, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 047/100, Runtime 0.349642, Loss 1.178931, forward nfe 18672, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 048/100, Runtime 0.344549, Loss 1.239931, forward nfe 18970, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 049/100, Runtime 0.353916, Loss 1.134186, forward nfe 19262, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 050/100, Runtime 0.360466, Loss 1.225269, forward nfe 19554, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 051/100, Runtime 0.355987, Loss 1.129383, forward nfe 19846, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 052/100, Runtime 0.353379, Loss 1.168829, forward nfe 20138, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 053/100, Runtime 0.340923, Loss 1.323675, forward nfe 20424, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 054/100, Runtime 0.347409, Loss 1.237087, forward nfe 20710, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 055/100, Runtime 0.330681, Loss 1.142321, forward nfe 20990, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 056/100, Runtime 0.347617, Loss 1.273282, forward nfe 21270, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 057/100, Runtime 0.342592, Loss 1.160826, forward nfe 21544, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 058/100, Runtime 0.329204, Loss 1.108901, forward nfe 21818, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 059/100, Runtime 0.324822, Loss 1.153756, forward nfe 22086, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 060/100, Runtime 0.329963, Loss 1.136715, forward nfe 22354, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 061/100, Runtime 0.321764, Loss 1.188848, forward nfe 22628, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 062/100, Runtime 0.327840, Loss 1.107109, forward nfe 22896, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 063/100, Runtime 0.341505, Loss 1.177041, forward nfe 23164, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 064/100, Runtime 0.336840, Loss 1.107144, forward nfe 23438, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 065/100, Runtime 0.332773, Loss 1.204350, forward nfe 23712, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 066/100, Runtime 0.331250, Loss 1.168235, forward nfe 23986, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 067/100, Runtime 0.337233, Loss 1.204491, forward nfe 24260, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 068/100, Runtime 0.331030, Loss 1.121954, forward nfe 24534, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 069/100, Runtime 0.341991, Loss 1.164185, forward nfe 24808, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 070/100, Runtime 0.334333, Loss 1.199431, forward nfe 25082, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 071/100, Runtime 0.329693, Loss 1.264469, forward nfe 25356, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 072/100, Runtime 0.332193, Loss 1.172536, forward nfe 25624, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 073/100, Runtime 0.328634, Loss 1.079844, forward nfe 25892, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 074/100, Runtime 0.327016, Loss 1.198440, forward nfe 26160, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 075/100, Runtime 0.328646, Loss 1.139719, forward nfe 26428, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 076/100, Runtime 0.476113, Loss 1.167374, forward nfe 26696, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 077/100, Runtime 0.343341, Loss 1.098696, forward nfe 26964, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 078/100, Runtime 0.335666, Loss 1.113896, forward nfe 27232, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 079/100, Runtime 0.339236, Loss 1.126258, forward nfe 27500, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 080/100, Runtime 0.330595, Loss 1.127294, forward nfe 27768, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 081/100, Runtime 0.337841, Loss 1.075917, forward nfe 28036, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 082/100, Runtime 0.347400, Loss 1.200821, forward nfe 28304, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 083/100, Runtime 0.334401, Loss 1.035349, forward nfe 28572, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 084/100, Runtime 0.333863, Loss 1.111197, forward nfe 28840, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 085/100, Runtime 0.337798, Loss 1.105022, forward nfe 29108, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 086/100, Runtime 0.332163, Loss 1.112607, forward nfe 29376, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 087/100, Runtime 0.327711, Loss 1.134684, forward nfe 29644, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 088/100, Runtime 0.342972, Loss 1.149190, forward nfe 29900, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 089/100, Runtime 0.340474, Loss 1.025788, forward nfe 30162, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 090/100, Runtime 0.333576, Loss 1.058975, forward nfe 30430, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 091/100, Runtime 0.322592, Loss 1.035435, forward nfe 30692, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 092/100, Runtime 0.323464, Loss 1.029838, forward nfe 30954, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 093/100, Runtime 0.322964, Loss 1.074036, forward nfe 31210, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 094/100, Runtime 0.306901, Loss 1.091365, forward nfe 31466, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 095/100, Runtime 0.319497, Loss 0.941296, forward nfe 31722, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 096/100, Runtime 0.324738, Loss 1.085242, forward nfe 31978, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 097/100, Runtime 0.332762, Loss 1.090896, forward nfe 32234, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 098/100, Runtime 0.311254, Loss 1.070807, forward nfe 32490, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
Epoch: 099/100, Runtime 0.337295, Loss 1.044224, forward nfe 32746, backward nfe 0, Train: 0.7583, Val: 0.7580, Test: 0.7113, Best time: 55.0000
best val accuracy 0.757971 with test accuracy 0.711290 at epoch 22 and best time 55.000000