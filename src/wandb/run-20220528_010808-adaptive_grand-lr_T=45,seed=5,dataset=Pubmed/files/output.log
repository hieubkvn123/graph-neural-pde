/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 377.501657, Loss 1.098902, forward nfe 98, backward nfe 44533, Train: 0.5167, Val: 0.6007, Test: 0.5952, Best time: 35.5154
Epoch: 002/100, Runtime 233.305833, Loss 1.097787, forward nfe 642, backward nfe 71819, Train: 0.5167, Val: 0.6007, Test: 0.5952, Best time: 45.0000
Epoch: 003/100, Runtime 294.985914, Loss 1.092633, forward nfe 1186, backward nfe 107107, Train: 0.6500, Val: 0.6431, Test: 0.6609, Best time: 5.9275
Epoch: 004/100, Runtime 247.222690, Loss 1.080899, forward nfe 1736, backward nfe 135861, Train: 0.7000, Val: 0.7014, Test: 0.7102, Best time: 30.9532
Epoch: 005/100, Runtime 650.267126, Loss 1.065977, forward nfe 2292, backward nfe 214174, Train: 0.7500, Val: 0.7215, Test: 0.7193, Best time: 5.6201
Epoch: 006/100, Runtime 731.919270, Loss 1.040094, forward nfe 2854, backward nfe 301373, Train: 0.7333, Val: 0.7368, Test: 0.7294, Best time: 9.4879
Epoch: 007/100, Runtime 992.584038, Loss 1.012711, forward nfe 3416, backward nfe 420474, Train: 0.7333, Val: 0.7444, Test: 0.7387, Best time: 9.3377
Epoch: 008/100, Runtime 960.368766, Loss 0.974962, forward nfe 3978, backward nfe 534576, Train: 0.7167, Val: 0.7472, Test: 0.7458, Best time: 9.2098
Epoch: 009/100, Runtime 1699.651366, Loss 0.933669, forward nfe 4540, backward nfe 744198, Train: 0.7667, Val: 0.7507, Test: 0.7511, Best time: 5.2866
Epoch: 010/100, Runtime 998.316096, Loss 0.890952, forward nfe 5108, backward nfe 863610, Train: 0.7667, Val: 0.7535, Test: 0.7547, Best time: 5.2318
Epoch: 011/100, Runtime 1417.019876, Loss 0.826637, forward nfe 5682, backward nfe 1037154, Train: 0.7833, Val: 0.7569, Test: 0.7576, Best time: 5.1898
Epoch: 012/100, Runtime 916.979324, Loss 0.776092, forward nfe 6256, backward nfe 1145760, Train: 0.7667, Val: 0.7646, Test: 0.7610, Best time: 5.1527
Epoch: 013/100, Runtime 828.040606, Loss 0.730022, forward nfe 6842, backward nfe 1243800, Train: 0.7833, Val: 0.7757, Test: 0.7713, Best time: 5.1248
Epoch: 014/100, Runtime 740.568048, Loss 0.671633, forward nfe 7428, backward nfe 1332113, Train: 0.7833, Val: 0.7868, Test: 0.7809, Best time: 5.1075
Epoch: 015/100, Runtime 861.957057, Loss 0.635605, forward nfe 8014, backward nfe 1433619, Train: 0.7833, Val: 0.7868, Test: 0.7809, Best time: 45.0000
Epoch: 016/100, Runtime 995.828563, Loss 0.594274, forward nfe 8606, backward nfe 1552758, Train: 0.7833, Val: 0.7868, Test: 0.7809, Best time: 45.0000
Epoch: 017/100, Runtime 876.119398, Loss 0.557623, forward nfe 9198, backward nfe 1657453, Train: 0.7833, Val: 0.7868, Test: 0.7809, Best time: 45.0000
Epoch: 018/100, Runtime 516.799359, Loss 0.507472, forward nfe 9790, backward nfe 1719125, Train: 0.7833, Val: 0.7868, Test: 0.7809, Best time: 45.0000
Epoch: 019/100, Runtime 913.572976, Loss 0.503450, forward nfe 10382, backward nfe 1827744, Train: 0.7833, Val: 0.7868, Test: 0.7809, Best time: 45.0000
Epoch: 020/100, Runtime 846.383685, Loss 0.484047, forward nfe 10974, backward nfe 1929546, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 62.3946
Epoch: 021/100, Runtime 464.708941, Loss 0.496389, forward nfe 11566, backward nfe 1985598, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 022/100, Runtime 879.931751, Loss 0.506553, forward nfe 12158, backward nfe 2090865, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 023/100, Runtime 802.896198, Loss 0.498693, forward nfe 12750, backward nfe 2187491, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 024/100, Runtime 1219.778625, Loss 0.475310, forward nfe 13336, backward nfe 2335583, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 025/100, Runtime 971.234179, Loss 0.460466, forward nfe 13922, backward nfe 2452507, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 026/100, Runtime 813.580939, Loss 0.466540, forward nfe 14508, backward nfe 2549891, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 027/100, Runtime 756.492208, Loss 0.471242, forward nfe 15094, backward nfe 2641037, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 028/100, Runtime 447.987278, Loss 0.471035, forward nfe 15680, backward nfe 2694467, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 029/100, Runtime 724.474638, Loss 0.468616, forward nfe 16266, backward nfe 2781315, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 030/100, Runtime 561.258384, Loss 0.519484, forward nfe 16858, backward nfe 2847749, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 031/100, Runtime 939.401381, Loss 0.463400, forward nfe 17450, backward nfe 2962062, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 032/100, Runtime 662.536311, Loss 0.484052, forward nfe 18042, backward nfe 3042048, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 033/100, Runtime 596.745976, Loss 0.413817, forward nfe 18634, backward nfe 3114127, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 034/100, Runtime 613.970135, Loss 0.455488, forward nfe 19220, backward nfe 3187729, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 035/100, Runtime 928.924840, Loss 0.452805, forward nfe 19806, backward nfe 3299987, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 036/100, Runtime 834.546224, Loss 0.412936, forward nfe 20392, backward nfe 3400206, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 037/100, Runtime 636.793606, Loss 0.438141, forward nfe 20978, backward nfe 3476028, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 038/100, Runtime 629.877259, Loss 0.407481, forward nfe 21564, backward nfe 3552534, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 039/100, Runtime 730.512360, Loss 0.401330, forward nfe 22150, backward nfe 3640504, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 040/100, Runtime 783.497041, Loss 0.449046, forward nfe 22736, backward nfe 3734358, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 041/100, Runtime 666.192124, Loss 0.517121, forward nfe 23322, backward nfe 3814130, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 042/100, Runtime 577.216624, Loss 0.465544, forward nfe 23908, backward nfe 3882222, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 043/100, Runtime 722.178662, Loss 0.444486, forward nfe 24494, backward nfe 3968400, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 044/100, Runtime 674.245376, Loss 0.423487, forward nfe 25080, backward nfe 4049369, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 045/100, Runtime 771.058423, Loss 0.479666, forward nfe 25678, backward nfe 4143761, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 046/100, Runtime 366.205629, Loss 0.496717, forward nfe 26276, backward nfe 4187421, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 047/100, Runtime 484.481637, Loss 0.426345, forward nfe 26880, backward nfe 4245277, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 048/100, Runtime 170.135468, Loss 0.357853, forward nfe 27484, backward nfe 4265212, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 049/100, Runtime 366.582306, Loss 0.434106, forward nfe 28088, backward nfe 4308809, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 050/100, Runtime 523.591576, Loss 0.457547, forward nfe 28692, backward nfe 4372472, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 051/100, Runtime 545.009039, Loss 0.439787, forward nfe 29296, backward nfe 4437646, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 052/100, Runtime 385.100436, Loss 0.442896, forward nfe 29906, backward nfe 4484240, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 053/100, Runtime 832.318089, Loss 0.562191, forward nfe 30516, backward nfe 4584499, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 054/100, Runtime 501.519726, Loss 0.448819, forward nfe 31126, backward nfe 4644785, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 055/100, Runtime 609.036381, Loss 0.414861, forward nfe 31736, backward nfe 4718542, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 056/100, Runtime 538.934894, Loss 0.432908, forward nfe 32346, backward nfe 4783031, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 057/100, Runtime 655.304309, Loss 0.404786, forward nfe 32956, backward nfe 4861160, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 058/100, Runtime 790.099210, Loss 0.488621, forward nfe 33566, backward nfe 4955778, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 059/100, Runtime 1000.983941, Loss 0.477697, forward nfe 34176, backward nfe 5076381, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 060/100, Runtime 635.173837, Loss 0.372574, forward nfe 34786, backward nfe 5152665, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 061/100, Runtime 732.757795, Loss 0.459292, forward nfe 35396, backward nfe 5240933, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 062/100, Runtime 650.407439, Loss 0.394573, forward nfe 36006, backward nfe 5318774, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 063/100, Runtime 679.815309, Loss 0.391625, forward nfe 36616, backward nfe 5400590, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 064/100, Runtime 803.752742, Loss 0.362093, forward nfe 37226, backward nfe 5496771, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 065/100, Runtime 819.646862, Loss 0.376054, forward nfe 37836, backward nfe 5595473, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 066/100, Runtime 618.575690, Loss 0.367248, forward nfe 38446, backward nfe 5670058, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 067/100, Runtime 926.296958, Loss 0.364801, forward nfe 39056, backward nfe 5782572, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 068/100, Runtime 498.497945, Loss 0.360810, forward nfe 39666, backward nfe 5842047, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 069/100, Runtime 800.029553, Loss 0.401734, forward nfe 40276, backward nfe 5938608, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 070/100, Runtime 1240.195519, Loss 0.370646, forward nfe 40886, backward nfe 6093003, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 071/100, Runtime 956.054471, Loss 0.395455, forward nfe 41496, backward nfe 6209647, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 072/100, Runtime 400.188378, Loss 0.373713, forward nfe 42106, backward nfe 6257633, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 073/100, Runtime 632.895547, Loss 0.310156, forward nfe 42716, backward nfe 6334418, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 074/100, Runtime 387.358840, Loss 0.347877, forward nfe 43326, backward nfe 6380718, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 075/100, Runtime 802.969497, Loss 0.396735, forward nfe 43936, backward nfe 6478240, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 076/100, Runtime 694.737866, Loss 0.413816, forward nfe 44546, backward nfe 6562153, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 077/100, Runtime 612.610941, Loss 0.368238, forward nfe 45156, backward nfe 6635929, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 078/100, Runtime 709.651583, Loss 0.374396, forward nfe 45766, backward nfe 6721433, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 079/100, Runtime 611.804685, Loss 0.387948, forward nfe 46376, backward nfe 6795548, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 080/100, Runtime 686.608650, Loss 0.391432, forward nfe 46986, backward nfe 6878296, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 081/100, Runtime 350.407665, Loss 0.354472, forward nfe 47590, backward nfe 6920462, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 082/100, Runtime 618.171234, Loss 0.374440, forward nfe 48194, backward nfe 6995281, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 083/100, Runtime 859.524549, Loss 0.395764, forward nfe 48798, backward nfe 7099196, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 084/100, Runtime 677.763409, Loss 0.387763, forward nfe 49402, backward nfe 7181395, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 085/100, Runtime 378.419143, Loss 0.427986, forward nfe 50006, backward nfe 7226976, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 086/100, Runtime 429.671661, Loss 0.369660, forward nfe 50610, backward nfe 7278154, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 087/100, Runtime 547.639857, Loss 0.380096, forward nfe 51214, backward nfe 7343765, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 088/100, Runtime 1104.651599, Loss 0.405378, forward nfe 51818, backward nfe 7478083, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 089/100, Runtime 619.189677, Loss 0.346961, forward nfe 52422, backward nfe 7552107, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 090/100, Runtime 428.902870, Loss 0.406726, forward nfe 53026, backward nfe 7603130, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 091/100, Runtime 248.441967, Loss 0.357037, forward nfe 53630, backward nfe 7632538, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 092/100, Runtime 366.860683, Loss 0.321296, forward nfe 54234, backward nfe 7676227, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 093/100, Runtime 476.633021, Loss 0.318813, forward nfe 54838, backward nfe 7733881, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 094/100, Runtime 1478.530288, Loss 0.341110, forward nfe 55442, backward nfe 7916041, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 095/100, Runtime 527.557983, Loss 0.315551, forward nfe 56046, backward nfe 7979016, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 096/100, Runtime 796.859930, Loss 0.400610, forward nfe 56650, backward nfe 8074965, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 097/100, Runtime 804.393499, Loss 0.355895, forward nfe 57254, backward nfe 8171596, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 098/100, Runtime 740.515297, Loss 0.370856, forward nfe 57858, backward nfe 8260413, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
Epoch: 099/100, Runtime 460.504243, Loss 0.358466, forward nfe 58462, backward nfe 8316516, Train: 0.8333, Val: 0.7965, Test: 0.8005, Best time: 45.0000
best val accuracy 0.796528 with test accuracy 0.800461 at epoch 20 and best time 45.000000