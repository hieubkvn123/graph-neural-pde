/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 34.245581, Loss 1.098545, forward nfe 92, backward nfe 3347, Train: 0.6333, Val: 0.5667, Test: 0.5703, Best time: 0.2416
Epoch: 002/100, Runtime 40.913841, Loss 1.088902, forward nfe 570, backward nfe 7495, Train: 0.8167, Val: 0.7181, Test: 0.7177, Best time: 2.7280
Epoch: 003/100, Runtime 85.438666, Loss 1.070793, forward nfe 1042, backward nfe 17000, Train: 0.7833, Val: 0.7222, Test: 0.7139, Best time: 6.0020
Epoch: 004/100, Runtime 156.607832, Loss 1.043876, forward nfe 1514, backward nfe 35165, Train: 0.7833, Val: 0.7222, Test: 0.7139, Best time: 40.0000
Epoch: 005/100, Runtime 34.953856, Loss 1.009585, forward nfe 2004, backward nfe 38643, Train: 0.7833, Val: 0.7222, Test: 0.7139, Best time: 40.0000
Epoch: 006/100, Runtime 62.278153, Loss 0.968510, forward nfe 2494, backward nfe 45447, Train: 0.7833, Val: 0.7222, Test: 0.7139, Best time: 40.0000
Epoch: 007/100, Runtime 105.295990, Loss 0.905926, forward nfe 2984, backward nfe 57624, Train: 0.7833, Val: 0.7222, Test: 0.7139, Best time: 40.0000
Epoch: 008/100, Runtime 134.295585, Loss 0.849613, forward nfe 3480, backward nfe 73342, Train: 0.7833, Val: 0.7222, Test: 0.7139, Best time: 40.0000
Epoch: 009/100, Runtime 141.027943, Loss 0.798235, forward nfe 3982, backward nfe 89765, Train: 0.7833, Val: 0.7222, Test: 0.7139, Best time: 40.0000
Epoch: 010/100, Runtime 136.793777, Loss 0.733601, forward nfe 4484, backward nfe 105706, Train: 0.7833, Val: 0.7229, Test: 0.7233, Best time: 14.0500
Epoch: 011/100, Runtime 124.283525, Loss 0.664957, forward nfe 4986, backward nfe 120235, Train: 0.8167, Val: 0.7299, Test: 0.7287, Best time: 13.9585
Epoch: 012/100, Runtime 91.276979, Loss 0.626337, forward nfe 5488, backward nfe 130791, Train: 0.8333, Val: 0.7361, Test: 0.7312, Best time: 8.8540
Epoch: 013/100, Runtime 138.503450, Loss 0.564093, forward nfe 5996, backward nfe 146998, Train: 0.8333, Val: 0.7375, Test: 0.7376, Best time: 13.9016
Epoch: 014/100, Runtime 98.905689, Loss 0.513598, forward nfe 6504, backward nfe 158358, Train: 0.8333, Val: 0.7375, Test: 0.7376, Best time: 40.0000
Epoch: 015/100, Runtime 38.839164, Loss 0.504001, forward nfe 7012, backward nfe 162390, Train: 0.8333, Val: 0.7424, Test: 0.7486, Best time: 13.9528
Epoch: 016/100, Runtime 58.452734, Loss 0.519177, forward nfe 7520, backward nfe 168822, Train: 0.8667, Val: 0.7660, Test: 0.7713, Best time: 18.2855
Epoch: 017/100, Runtime 32.363863, Loss 0.421953, forward nfe 8028, backward nfe 172106, Train: 0.8667, Val: 0.7674, Test: 0.7780, Best time: 41.0549
Epoch: 018/100, Runtime 142.730705, Loss 0.408478, forward nfe 8530, backward nfe 188789, Train: 0.8667, Val: 0.7674, Test: 0.7780, Best time: 40.0000
Epoch: 019/100, Runtime 218.721522, Loss 0.409470, forward nfe 9044, backward nfe 214760, Train: 0.9167, Val: 0.7785, Test: 0.7829, Best time: 18.2101
Epoch: 020/100, Runtime 253.193813, Loss 0.377745, forward nfe 9558, backward nfe 244971, Train: 0.9167, Val: 0.7910, Test: 0.8026, Best time: 18.1962
Epoch: 021/100, Runtime 266.221233, Loss 0.392754, forward nfe 10066, backward nfe 276722, Train: 0.9167, Val: 0.7910, Test: 0.8026, Best time: 40.0000
Epoch: 022/100, Runtime 203.287894, Loss 0.391588, forward nfe 10574, backward nfe 300740, Train: 0.9167, Val: 0.7910, Test: 0.8026, Best time: 40.0000
Epoch: 023/100, Runtime 202.900104, Loss 0.369543, forward nfe 11082, backward nfe 324931, Train: 0.9167, Val: 0.7910, Test: 0.8026, Best time: 40.0000
Epoch: 024/100, Runtime 325.391120, Loss 0.385144, forward nfe 11602, backward nfe 364064, Train: 0.9333, Val: 0.7944, Test: 0.7982, Best time: 22.0362
Epoch: 025/100, Runtime 303.662977, Loss 0.366138, forward nfe 12116, backward nfe 400629, Train: 0.9333, Val: 0.7944, Test: 0.7982, Best time: 40.0000
Epoch: 026/100, Runtime 309.661894, Loss 0.392705, forward nfe 12630, backward nfe 437817, Train: 0.9333, Val: 0.7944, Test: 0.7982, Best time: 40.0000
Epoch: 027/100, Runtime 250.002429, Loss 0.389808, forward nfe 13144, backward nfe 467612, Train: 0.9333, Val: 0.7944, Test: 0.7982, Best time: 40.0000
Epoch: 028/100, Runtime 274.074288, Loss 0.404688, forward nfe 13658, backward nfe 500154, Train: 0.9333, Val: 0.7944, Test: 0.7982, Best time: 40.0000
Epoch: 029/100, Runtime 252.980431, Loss 0.378548, forward nfe 14172, backward nfe 530121, Train: 0.9333, Val: 0.7944, Test: 0.7982, Best time: 40.0000
Epoch: 030/100, Runtime 241.478431, Loss 0.375903, forward nfe 14686, backward nfe 558539, Train: 0.9333, Val: 0.7944, Test: 0.7982, Best time: 40.0000
Epoch: 031/100, Runtime 291.945667, Loss 0.376408, forward nfe 15200, backward nfe 593470, Train: 0.9333, Val: 0.7944, Test: 0.7982, Best time: 40.0000
Epoch: 032/100, Runtime 201.101964, Loss 0.382309, forward nfe 15714, backward nfe 617265, Train: 0.9333, Val: 0.7944, Test: 0.7982, Best time: 40.0000
Epoch: 033/100, Runtime 271.889000, Loss 0.351063, forward nfe 16222, backward nfe 649596, Train: 0.9333, Val: 0.7944, Test: 0.7982, Best time: 40.0000
Epoch: 034/100, Runtime 181.570020, Loss 0.350054, forward nfe 16736, backward nfe 670813, Train: 0.9167, Val: 0.7965, Test: 0.8012, Best time: 25.9708
Epoch: 035/100, Runtime 274.000729, Loss 0.282686, forward nfe 17250, backward nfe 703447, Train: 0.9167, Val: 0.8021, Test: 0.8050, Best time: 9.8629
Epoch: 036/100, Runtime 277.277243, Loss 0.353074, forward nfe 17764, backward nfe 736455, Train: 0.9167, Val: 0.8021, Test: 0.8050, Best time: 40.0000
Epoch: 037/100, Runtime 469.992972, Loss 0.292548, forward nfe 18272, backward nfe 793194, Train: 0.9167, Val: 0.8021, Test: 0.8050, Best time: 40.0000
Epoch: 038/100, Runtime 271.837283, Loss 0.358284, forward nfe 18792, backward nfe 825912, Train: 0.9167, Val: 0.8021, Test: 0.8050, Best time: 40.0000
Epoch: 039/100, Runtime 246.369570, Loss 0.318318, forward nfe 19312, backward nfe 855446, Train: 0.9167, Val: 0.8035, Test: 0.8023, Best time: 18.4384
Epoch: 040/100, Runtime 294.293618, Loss 0.326877, forward nfe 19832, backward nfe 890849, Train: 0.9167, Val: 0.8035, Test: 0.8023, Best time: 40.0000
Epoch: 041/100, Runtime 210.556201, Loss 0.327927, forward nfe 20352, backward nfe 916029, Train: 0.9167, Val: 0.8035, Test: 0.8023, Best time: 40.0000
Epoch: 042/100, Runtime 243.174922, Loss 0.357692, forward nfe 20872, backward nfe 944785, Train: 0.9167, Val: 0.8035, Test: 0.8023, Best time: 40.0000
Epoch: 043/100, Runtime 354.647565, Loss 0.304178, forward nfe 21392, backward nfe 987626, Train: 0.9167, Val: 0.8035, Test: 0.8023, Best time: 40.0000
Epoch: 044/100, Runtime 314.681651, Loss 0.308937, forward nfe 21912, backward nfe 1025168, Train: 0.9167, Val: 0.8035, Test: 0.8023, Best time: 40.0000
Epoch: 045/100, Runtime 321.966122, Loss 0.288381, forward nfe 22426, backward nfe 1063744, Train: 0.9167, Val: 0.8035, Test: 0.8023, Best time: 40.0000
Epoch: 046/100, Runtime 196.015123, Loss 0.296806, forward nfe 22952, backward nfe 1086774, Train: 0.9167, Val: 0.8035, Test: 0.8023, Best time: 40.0000
Epoch: 047/100, Runtime 238.031636, Loss 0.278159, forward nfe 23478, backward nfe 1115289, Train: 0.9167, Val: 0.8035, Test: 0.8023, Best time: 40.0000
Epoch: 048/100, Runtime 243.381440, Loss 0.284077, forward nfe 24004, backward nfe 1144310, Train: 0.9167, Val: 0.8035, Test: 0.8023, Best time: 40.0000
Epoch: 049/100, Runtime 282.008657, Loss 0.276245, forward nfe 24536, backward nfe 1178056, Train: 0.9167, Val: 0.8035, Test: 0.8023, Best time: 40.0000
Epoch: 050/100, Runtime 285.812775, Loss 0.268663, forward nfe 25068, backward nfe 1212241, Train: 0.9167, Val: 0.8035, Test: 0.8023, Best time: 40.0000
Epoch: 051/100, Runtime 204.036266, Loss 0.283009, forward nfe 25600, backward nfe 1236426, Train: 0.9167, Val: 0.8035, Test: 0.8023, Best time: 40.0000
Epoch: 052/100, Runtime 229.336049, Loss 0.268991, forward nfe 26132, backward nfe 1263734, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 18.2575
Epoch: 053/100, Runtime 284.046863, Loss 0.275539, forward nfe 26664, backward nfe 1297924, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 054/100, Runtime 301.240976, Loss 0.264717, forward nfe 27202, backward nfe 1334112, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 055/100, Runtime 344.127278, Loss 0.258197, forward nfe 27740, backward nfe 1375361, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 056/100, Runtime 282.433892, Loss 0.272215, forward nfe 28278, backward nfe 1409320, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 057/100, Runtime 227.511297, Loss 0.229919, forward nfe 28828, backward nfe 1436640, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 058/100, Runtime 358.570453, Loss 0.238080, forward nfe 29378, backward nfe 1479872, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 059/100, Runtime 228.294707, Loss 0.244743, forward nfe 29928, backward nfe 1507123, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 060/100, Runtime 245.791821, Loss 0.272132, forward nfe 30478, backward nfe 1536423, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 061/100, Runtime 653.392048, Loss 0.228573, forward nfe 31028, backward nfe 1615949, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 062/100, Runtime 168.505668, Loss 0.213548, forward nfe 31578, backward nfe 1635817, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 063/100, Runtime 153.330534, Loss 0.235266, forward nfe 32134, backward nfe 1653772, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 064/100, Runtime 156.525821, Loss 0.235629, forward nfe 32690, backward nfe 1672331, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 065/100, Runtime 255.167728, Loss 0.197422, forward nfe 33246, backward nfe 1703055, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 066/100, Runtime 184.393635, Loss 0.279185, forward nfe 33802, backward nfe 1725069, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 067/100, Runtime 303.283642, Loss 0.248810, forward nfe 34358, backward nfe 1761613, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 068/100, Runtime 225.098899, Loss 0.244308, forward nfe 34914, backward nfe 1788547, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 069/100, Runtime 245.617100, Loss 0.247120, forward nfe 35464, backward nfe 1817804, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 070/100, Runtime 232.952816, Loss 0.227124, forward nfe 36014, backward nfe 1845566, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 071/100, Runtime 160.906314, Loss 0.192354, forward nfe 36564, backward nfe 1864689, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 072/100, Runtime 224.617723, Loss 0.238391, forward nfe 37114, backward nfe 1891393, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 073/100, Runtime 298.492097, Loss 0.195646, forward nfe 37664, backward nfe 1927291, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 074/100, Runtime 254.176255, Loss 0.222028, forward nfe 38220, backward nfe 1957675, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 075/100, Runtime 255.196276, Loss 0.178742, forward nfe 38782, backward nfe 1988367, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 076/100, Runtime 256.133950, Loss 0.211024, forward nfe 39344, backward nfe 2018961, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 077/100, Runtime 277.994698, Loss 0.185966, forward nfe 39906, backward nfe 2052237, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 078/100, Runtime 258.380860, Loss 0.181179, forward nfe 40468, backward nfe 2082892, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 079/100, Runtime 353.131142, Loss 0.192603, forward nfe 41024, backward nfe 2125161, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 080/100, Runtime 191.776824, Loss 0.177688, forward nfe 41580, backward nfe 2148062, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 081/100, Runtime 177.041149, Loss 0.156263, forward nfe 42136, backward nfe 2169350, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 082/100, Runtime 85.472824, Loss 0.146326, forward nfe 42686, backward nfe 2179176, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 083/100, Runtime 144.002468, Loss 0.170110, forward nfe 43236, backward nfe 2196276, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 084/100, Runtime 306.918277, Loss 0.186409, forward nfe 43786, backward nfe 2233223, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 085/100, Runtime 177.555052, Loss 0.174733, forward nfe 44336, backward nfe 2254466, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 086/100, Runtime 317.158512, Loss 0.218925, forward nfe 44880, backward nfe 2292479, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 087/100, Runtime 357.829295, Loss 0.154247, forward nfe 45424, backward nfe 2335629, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 088/100, Runtime 394.077873, Loss 0.185469, forward nfe 45968, backward nfe 2383526, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 089/100, Runtime 288.127997, Loss 0.154776, forward nfe 46512, backward nfe 2418300, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 090/100, Runtime 222.050092, Loss 0.171978, forward nfe 47050, backward nfe 2444974, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 091/100, Runtime 209.575921, Loss 0.160781, forward nfe 47588, backward nfe 2469853, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 092/100, Runtime 126.463130, Loss 0.093233, forward nfe 48126, backward nfe 2484646, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 093/100, Runtime 122.242760, Loss 0.147829, forward nfe 48664, backward nfe 2498895, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 094/100, Runtime 75.132247, Loss 0.098087, forward nfe 49202, backward nfe 2507493, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 095/100, Runtime 162.784316, Loss 0.078248, forward nfe 49740, backward nfe 2526738, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 096/100, Runtime 182.919970, Loss 0.125509, forward nfe 50284, backward nfe 2548417, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 097/100, Runtime 108.440225, Loss 0.066914, forward nfe 50828, backward nfe 2561082, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 098/100, Runtime 186.852125, Loss 0.096662, forward nfe 51366, backward nfe 2583093, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
Epoch: 099/100, Runtime 214.172167, Loss 0.075261, forward nfe 51904, backward nfe 2608497, Train: 0.9333, Val: 0.8049, Test: 0.8008, Best time: 40.0000
best val accuracy 0.804861 with test accuracy 0.800790 at epoch 52 and best time 40.000000