/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.428611, Loss 1.795792, forward nfe 116, backward nfe 0, Train: 0.3250, Val: 0.3971, Test: 0.3484, Best time: 5.4572
Epoch: 002/100, Runtime 0.355076, Loss 1.776608, forward nfe 402, backward nfe 0, Train: 0.6417, Val: 0.5558, Test: 0.5500, Best time: 0.0393
Epoch: 003/100, Runtime 0.354981, Loss 1.753942, forward nfe 700, backward nfe 0, Train: 0.7917, Val: 0.6725, Test: 0.6839, Best time: 1.4231
Epoch: 004/100, Runtime 0.353406, Loss 1.754940, forward nfe 986, backward nfe 0, Train: 0.7917, Val: 0.6725, Test: 0.6839, Best time: 20.0000
Epoch: 005/100, Runtime 0.387933, Loss 1.725750, forward nfe 1278, backward nfe 0, Train: 0.7917, Val: 0.6725, Test: 0.6839, Best time: 20.0000
Epoch: 006/100, Runtime 0.377111, Loss 1.691126, forward nfe 1570, backward nfe 0, Train: 0.7917, Val: 0.6725, Test: 0.6839, Best time: 20.0000
Epoch: 007/100, Runtime 0.358071, Loss 1.677528, forward nfe 1856, backward nfe 0, Train: 0.7917, Val: 0.6725, Test: 0.6839, Best time: 20.0000
Epoch: 008/100, Runtime 0.350120, Loss 1.663091, forward nfe 2142, backward nfe 0, Train: 0.7917, Val: 0.6725, Test: 0.6839, Best time: 20.0000
Epoch: 009/100, Runtime 0.363745, Loss 1.665797, forward nfe 2416, backward nfe 0, Train: 0.7917, Val: 0.6725, Test: 0.6839, Best time: 20.0000
Epoch: 010/100, Runtime 0.349623, Loss 1.660067, forward nfe 2702, backward nfe 0, Train: 0.7917, Val: 0.6725, Test: 0.6839, Best time: 20.0000
Epoch: 011/100, Runtime 0.331918, Loss 1.628199, forward nfe 2976, backward nfe 0, Train: 0.7917, Val: 0.6725, Test: 0.6839, Best time: 20.0000
Epoch: 012/100, Runtime 0.336000, Loss 1.618401, forward nfe 3244, backward nfe 0, Train: 0.7917, Val: 0.6725, Test: 0.6839, Best time: 20.0000
Epoch: 013/100, Runtime 0.338088, Loss 1.574024, forward nfe 3506, backward nfe 0, Train: 0.7917, Val: 0.6725, Test: 0.6839, Best time: 20.0000
Epoch: 014/100, Runtime 0.316269, Loss 1.574194, forward nfe 3768, backward nfe 0, Train: 0.7917, Val: 0.6725, Test: 0.6839, Best time: 20.0000
Epoch: 015/100, Runtime 0.323039, Loss 1.567310, forward nfe 4030, backward nfe 0, Train: 0.7917, Val: 0.6725, Test: 0.6839, Best time: 20.0000
Epoch: 016/100, Runtime 0.326706, Loss 1.480594, forward nfe 4292, backward nfe 0, Train: 0.7917, Val: 0.6725, Test: 0.6839, Best time: 20.0000
Epoch: 017/100, Runtime 0.307117, Loss 1.512626, forward nfe 4554, backward nfe 0, Train: 0.8333, Val: 0.6899, Test: 0.6903, Best time: 1.8179
Epoch: 018/100, Runtime 0.329464, Loss 1.478246, forward nfe 4810, backward nfe 0, Train: 0.8333, Val: 0.7210, Test: 0.7016, Best time: 4.5472
Epoch: 019/100, Runtime 0.295626, Loss 1.417659, forward nfe 5054, backward nfe 0, Train: 0.8167, Val: 0.7225, Test: 0.6855, Best time: 4.6397
Epoch: 020/100, Runtime 0.313473, Loss 1.355177, forward nfe 5298, backward nfe 0, Train: 0.8167, Val: 0.7225, Test: 0.6855, Best time: 20.0000
Epoch: 021/100, Runtime 0.311421, Loss 1.293539, forward nfe 5548, backward nfe 0, Train: 0.8167, Val: 0.7225, Test: 0.6855, Best time: 20.0000
Epoch: 022/100, Runtime 0.308609, Loss 1.268896, forward nfe 5798, backward nfe 0, Train: 0.8167, Val: 0.7225, Test: 0.6855, Best time: 20.0000
Epoch: 023/100, Runtime 0.310107, Loss 1.211735, forward nfe 6048, backward nfe 0, Train: 0.8167, Val: 0.7225, Test: 0.6855, Best time: 20.0000
Epoch: 024/100, Runtime 0.307275, Loss 1.273050, forward nfe 6292, backward nfe 0, Train: 0.8167, Val: 0.7225, Test: 0.6855, Best time: 20.0000
Epoch: 025/100, Runtime 0.298288, Loss 1.182327, forward nfe 6530, backward nfe 0, Train: 0.8750, Val: 0.7333, Test: 0.7129, Best time: 7.7139
Epoch: 026/100, Runtime 0.297038, Loss 1.257102, forward nfe 6762, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 9.5359
Epoch: 027/100, Runtime 0.279589, Loss 1.249559, forward nfe 6994, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 028/100, Runtime 0.285924, Loss 1.161331, forward nfe 7220, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 029/100, Runtime 0.293656, Loss 1.147014, forward nfe 7446, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 030/100, Runtime 0.268203, Loss 1.058833, forward nfe 7666, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 031/100, Runtime 0.263705, Loss 1.175424, forward nfe 7880, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 032/100, Runtime 0.262767, Loss 1.130479, forward nfe 8088, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 033/100, Runtime 0.269012, Loss 1.061875, forward nfe 8296, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 034/100, Runtime 0.265869, Loss 1.082977, forward nfe 8504, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 035/100, Runtime 0.269272, Loss 1.117862, forward nfe 8712, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 036/100, Runtime 0.257377, Loss 0.962042, forward nfe 8914, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 037/100, Runtime 0.259585, Loss 1.033706, forward nfe 9116, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 038/100, Runtime 0.245885, Loss 1.129678, forward nfe 9312, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 039/100, Runtime 0.245447, Loss 0.933195, forward nfe 9508, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 040/100, Runtime 0.233425, Loss 0.926545, forward nfe 9698, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 041/100, Runtime 0.236109, Loss 1.011196, forward nfe 9888, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 042/100, Runtime 0.238052, Loss 0.983559, forward nfe 10078, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 043/100, Runtime 0.240674, Loss 1.056942, forward nfe 10262, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 044/100, Runtime 0.239053, Loss 1.012573, forward nfe 10446, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 045/100, Runtime 0.250774, Loss 0.944169, forward nfe 10630, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 046/100, Runtime 0.228856, Loss 1.063062, forward nfe 10808, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 047/100, Runtime 0.233523, Loss 1.044491, forward nfe 10986, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 048/100, Runtime 0.226838, Loss 1.027589, forward nfe 11164, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 049/100, Runtime 0.274036, Loss 1.002358, forward nfe 11342, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 050/100, Runtime 0.223225, Loss 1.082765, forward nfe 11520, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 051/100, Runtime 0.231541, Loss 1.024151, forward nfe 11698, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 052/100, Runtime 0.233238, Loss 1.075248, forward nfe 11882, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 053/100, Runtime 0.232155, Loss 1.006236, forward nfe 12066, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 054/100, Runtime 0.245071, Loss 0.958156, forward nfe 12250, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 055/100, Runtime 0.242475, Loss 0.984577, forward nfe 12434, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 056/100, Runtime 0.259779, Loss 1.036979, forward nfe 12624, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 057/100, Runtime 0.262159, Loss 0.932854, forward nfe 12814, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 058/100, Runtime 0.249141, Loss 1.007136, forward nfe 13004, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 059/100, Runtime 0.237978, Loss 1.022951, forward nfe 13194, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 060/100, Runtime 0.242193, Loss 0.983035, forward nfe 13384, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 061/100, Runtime 0.242229, Loss 0.948405, forward nfe 13574, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 062/100, Runtime 0.245759, Loss 0.895914, forward nfe 13764, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 063/100, Runtime 0.233266, Loss 1.017880, forward nfe 13954, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 064/100, Runtime 0.238377, Loss 1.019294, forward nfe 14144, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 065/100, Runtime 0.237723, Loss 1.071432, forward nfe 14334, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 066/100, Runtime 0.235828, Loss 0.941852, forward nfe 14524, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 067/100, Runtime 0.230666, Loss 0.987127, forward nfe 14714, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 068/100, Runtime 0.246458, Loss 1.052013, forward nfe 14904, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 069/100, Runtime 0.245601, Loss 1.022431, forward nfe 15094, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 070/100, Runtime 0.267522, Loss 0.888668, forward nfe 15290, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 071/100, Runtime 0.245728, Loss 0.959731, forward nfe 15480, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 072/100, Runtime 0.239566, Loss 0.983217, forward nfe 15670, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 073/100, Runtime 0.241553, Loss 1.013299, forward nfe 15866, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 074/100, Runtime 0.253830, Loss 0.939613, forward nfe 16062, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 075/100, Runtime 0.240198, Loss 0.961350, forward nfe 16252, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 076/100, Runtime 0.254061, Loss 0.896705, forward nfe 16448, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 077/100, Runtime 0.254678, Loss 0.888228, forward nfe 16650, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 078/100, Runtime 0.262312, Loss 0.928355, forward nfe 16852, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 079/100, Runtime 0.234733, Loss 0.977650, forward nfe 17048, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 080/100, Runtime 0.247060, Loss 0.827063, forward nfe 17244, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 081/100, Runtime 0.244242, Loss 1.038909, forward nfe 17440, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 082/100, Runtime 0.246687, Loss 1.027694, forward nfe 17636, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 083/100, Runtime 0.247920, Loss 0.835399, forward nfe 17832, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 084/100, Runtime 0.249513, Loss 0.980537, forward nfe 18028, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 085/100, Runtime 0.246686, Loss 0.943800, forward nfe 18218, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 086/100, Runtime 0.255069, Loss 0.879168, forward nfe 18408, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 087/100, Runtime 0.242666, Loss 0.825242, forward nfe 18598, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 088/100, Runtime 0.250006, Loss 0.965379, forward nfe 18788, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 089/100, Runtime 0.245312, Loss 0.976097, forward nfe 18978, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 090/100, Runtime 0.255087, Loss 0.900098, forward nfe 19168, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 091/100, Runtime 0.238302, Loss 0.980523, forward nfe 19358, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 092/100, Runtime 0.240322, Loss 0.904267, forward nfe 19548, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 093/100, Runtime 0.244452, Loss 0.997882, forward nfe 19738, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 094/100, Runtime 0.383674, Loss 0.927981, forward nfe 19928, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 095/100, Runtime 0.240113, Loss 0.976782, forward nfe 20118, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 096/100, Runtime 0.248785, Loss 0.842274, forward nfe 20308, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 097/100, Runtime 0.243658, Loss 0.984132, forward nfe 20498, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 098/100, Runtime 0.247756, Loss 1.036822, forward nfe 20688, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
Epoch: 099/100, Runtime 0.237803, Loss 0.958877, forward nfe 20878, backward nfe 0, Train: 0.8583, Val: 0.7362, Test: 0.7210, Best time: 20.0000
best val accuracy 0.736232 with test accuracy 0.720968 at epoch 26 and best time 20.000000