/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.447889, Loss 1.790453, forward nfe 122, backward nfe 0, Train: 0.4500, Val: 0.3587, Test: 0.3339, Best time: 0.0410
Epoch: 002/100, Runtime 0.378704, Loss 1.774334, forward nfe 438, backward nfe 0, Train: 0.7000, Val: 0.6761, Test: 0.6613, Best time: 3.5562
Epoch: 003/100, Runtime 0.393446, Loss 1.730126, forward nfe 754, backward nfe 0, Train: 0.7417, Val: 0.6812, Test: 0.6677, Best time: 2.7412
Epoch: 004/100, Runtime 0.412044, Loss 1.708953, forward nfe 1076, backward nfe 0, Train: 0.7083, Val: 0.7087, Test: 0.7016, Best time: 12.9369
Epoch: 005/100, Runtime 0.406833, Loss 1.675506, forward nfe 1398, backward nfe 0, Train: 0.7083, Val: 0.7087, Test: 0.7016, Best time: 25.0000
Epoch: 006/100, Runtime 0.395391, Loss 1.652185, forward nfe 1720, backward nfe 0, Train: 0.7083, Val: 0.7087, Test: 0.7016, Best time: 25.0000
Epoch: 007/100, Runtime 0.379274, Loss 1.632366, forward nfe 2042, backward nfe 0, Train: 0.7083, Val: 0.7087, Test: 0.7016, Best time: 25.0000
Epoch: 008/100, Runtime 0.379488, Loss 1.615231, forward nfe 2352, backward nfe 0, Train: 0.7750, Val: 0.7225, Test: 0.7048, Best time: 9.1194
Epoch: 009/100, Runtime 0.376846, Loss 1.601780, forward nfe 2668, backward nfe 0, Train: 0.7750, Val: 0.7225, Test: 0.7048, Best time: 25.0000
Epoch: 010/100, Runtime 0.353730, Loss 1.600208, forward nfe 2972, backward nfe 0, Train: 0.7750, Val: 0.7225, Test: 0.7048, Best time: 25.0000
Epoch: 011/100, Runtime 0.354231, Loss 1.547291, forward nfe 3270, backward nfe 0, Train: 0.7750, Val: 0.7225, Test: 0.7048, Best time: 25.0000
Epoch: 012/100, Runtime 0.359611, Loss 1.565958, forward nfe 3574, backward nfe 0, Train: 0.7750, Val: 0.7225, Test: 0.7048, Best time: 25.0000
Epoch: 013/100, Runtime 0.372159, Loss 1.555720, forward nfe 3872, backward nfe 0, Train: 0.7750, Val: 0.7225, Test: 0.7048, Best time: 25.0000
Epoch: 014/100, Runtime 0.361674, Loss 1.513660, forward nfe 4158, backward nfe 0, Train: 0.7500, Val: 0.7333, Test: 0.7258, Best time: 21.0246
Epoch: 015/100, Runtime 0.351931, Loss 1.484491, forward nfe 4444, backward nfe 0, Train: 0.7500, Val: 0.7333, Test: 0.7258, Best time: 25.0000
Epoch: 016/100, Runtime 0.355655, Loss 1.453393, forward nfe 4724, backward nfe 0, Train: 0.7500, Val: 0.7333, Test: 0.7258, Best time: 25.0000
Epoch: 017/100, Runtime 0.347905, Loss 1.434401, forward nfe 5004, backward nfe 0, Train: 0.7500, Val: 0.7333, Test: 0.7258, Best time: 25.0000
Epoch: 018/100, Runtime 0.355908, Loss 1.385756, forward nfe 5284, backward nfe 0, Train: 0.7500, Val: 0.7333, Test: 0.7258, Best time: 25.0000
Epoch: 019/100, Runtime 0.358883, Loss 1.374838, forward nfe 5570, backward nfe 0, Train: 0.7500, Val: 0.7333, Test: 0.7258, Best time: 25.0000
Epoch: 020/100, Runtime 0.326993, Loss 1.251568, forward nfe 5838, backward nfe 0, Train: 0.7500, Val: 0.7333, Test: 0.7258, Best time: 25.0000
Epoch: 021/100, Runtime 0.338038, Loss 1.324033, forward nfe 6106, backward nfe 0, Train: 0.7500, Val: 0.7333, Test: 0.7258, Best time: 25.0000
Epoch: 022/100, Runtime 0.315392, Loss 1.246855, forward nfe 6374, backward nfe 0, Train: 0.7500, Val: 0.7333, Test: 0.7258, Best time: 25.0000
Epoch: 023/100, Runtime 0.317165, Loss 1.230670, forward nfe 6630, backward nfe 0, Train: 0.7500, Val: 0.7333, Test: 0.7258, Best time: 25.0000
Epoch: 024/100, Runtime 0.316638, Loss 1.210380, forward nfe 6886, backward nfe 0, Train: 0.7500, Val: 0.7333, Test: 0.7258, Best time: 25.0000
Epoch: 025/100, Runtime 0.305780, Loss 1.221552, forward nfe 7136, backward nfe 0, Train: 0.7500, Val: 0.7333, Test: 0.7258, Best time: 25.0000
Epoch: 026/100, Runtime 0.299613, Loss 1.180789, forward nfe 7386, backward nfe 0, Train: 0.7500, Val: 0.7333, Test: 0.7258, Best time: 25.0000
Epoch: 027/100, Runtime 0.299309, Loss 1.236863, forward nfe 7630, backward nfe 0, Train: 0.8167, Val: 0.7413, Test: 0.7258, Best time: 18.0808
Epoch: 028/100, Runtime 0.297168, Loss 1.238483, forward nfe 7874, backward nfe 0, Train: 0.8167, Val: 0.7478, Test: 0.7403, Best time: 39.0481
Epoch: 029/100, Runtime 0.281491, Loss 1.138475, forward nfe 8112, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 33.9492
Epoch: 030/100, Runtime 0.293931, Loss 1.163370, forward nfe 8344, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 031/100, Runtime 0.283768, Loss 1.144615, forward nfe 8576, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 032/100, Runtime 0.295769, Loss 1.107355, forward nfe 8808, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 033/100, Runtime 0.286756, Loss 1.085520, forward nfe 9040, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 034/100, Runtime 0.266558, Loss 1.125475, forward nfe 9260, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 035/100, Runtime 0.282118, Loss 1.179401, forward nfe 9480, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 036/100, Runtime 0.265299, Loss 1.161632, forward nfe 9700, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 037/100, Runtime 0.262688, Loss 1.181967, forward nfe 9920, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 038/100, Runtime 0.270186, Loss 1.130590, forward nfe 10134, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 039/100, Runtime 0.260605, Loss 1.064155, forward nfe 10342, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 040/100, Runtime 0.251742, Loss 1.079717, forward nfe 10550, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 041/100, Runtime 0.245837, Loss 1.039116, forward nfe 10758, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 042/100, Runtime 0.247893, Loss 1.184245, forward nfe 10954, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 043/100, Runtime 0.246325, Loss 1.120242, forward nfe 11144, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 044/100, Runtime 0.239554, Loss 1.113233, forward nfe 11334, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 045/100, Runtime 0.245601, Loss 1.120809, forward nfe 11524, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 046/100, Runtime 0.241690, Loss 1.130533, forward nfe 11714, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 047/100, Runtime 0.242362, Loss 1.055586, forward nfe 11904, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 048/100, Runtime 0.231511, Loss 1.200823, forward nfe 12094, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 049/100, Runtime 0.246197, Loss 1.065579, forward nfe 12290, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 050/100, Runtime 0.250817, Loss 1.072138, forward nfe 12486, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 051/100, Runtime 0.255570, Loss 1.045444, forward nfe 12682, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 052/100, Runtime 0.240383, Loss 1.155374, forward nfe 12878, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 053/100, Runtime 0.257007, Loss 1.109527, forward nfe 13080, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 054/100, Runtime 0.244115, Loss 1.063493, forward nfe 13282, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 055/100, Runtime 0.252479, Loss 1.075922, forward nfe 13484, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 056/100, Runtime 0.253170, Loss 1.103835, forward nfe 13686, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 057/100, Runtime 0.252223, Loss 0.962403, forward nfe 13888, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 058/100, Runtime 0.250915, Loss 0.999484, forward nfe 14090, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 059/100, Runtime 0.262219, Loss 1.018618, forward nfe 14292, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 060/100, Runtime 0.273325, Loss 1.074520, forward nfe 14494, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 061/100, Runtime 0.244030, Loss 0.988640, forward nfe 14696, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 062/100, Runtime 0.247506, Loss 1.077564, forward nfe 14898, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 063/100, Runtime 0.263994, Loss 0.991416, forward nfe 15100, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 064/100, Runtime 0.254107, Loss 0.978203, forward nfe 15302, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 065/100, Runtime 0.269638, Loss 1.028235, forward nfe 15510, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 066/100, Runtime 0.259595, Loss 1.055341, forward nfe 15712, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 067/100, Runtime 0.283353, Loss 0.995993, forward nfe 15920, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 068/100, Runtime 0.278224, Loss 1.014843, forward nfe 16128, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 069/100, Runtime 0.273818, Loss 0.973785, forward nfe 16336, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 070/100, Runtime 0.277595, Loss 1.075794, forward nfe 16550, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 071/100, Runtime 0.281310, Loss 0.936710, forward nfe 16764, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 072/100, Runtime 0.264534, Loss 0.959506, forward nfe 16978, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 073/100, Runtime 0.258590, Loss 1.129595, forward nfe 17186, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 074/100, Runtime 0.279780, Loss 1.114784, forward nfe 17388, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 075/100, Runtime 0.261425, Loss 1.012041, forward nfe 17590, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 076/100, Runtime 0.261748, Loss 0.956302, forward nfe 17792, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 077/100, Runtime 0.267361, Loss 0.995268, forward nfe 17994, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 078/100, Runtime 0.263434, Loss 0.926708, forward nfe 18208, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 079/100, Runtime 0.262514, Loss 0.978574, forward nfe 18422, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 080/100, Runtime 0.275836, Loss 1.022162, forward nfe 18636, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 081/100, Runtime 0.269420, Loss 1.038421, forward nfe 18844, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 082/100, Runtime 0.260408, Loss 1.031480, forward nfe 19052, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 083/100, Runtime 0.257138, Loss 0.971712, forward nfe 19260, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 084/100, Runtime 0.268376, Loss 1.162711, forward nfe 19462, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 085/100, Runtime 0.257187, Loss 0.964629, forward nfe 19664, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 086/100, Runtime 0.248482, Loss 1.076987, forward nfe 19866, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 087/100, Runtime 0.258498, Loss 0.933214, forward nfe 20068, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 088/100, Runtime 0.257118, Loss 0.914583, forward nfe 20270, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 089/100, Runtime 0.268962, Loss 1.016889, forward nfe 20478, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 090/100, Runtime 0.248820, Loss 1.033804, forward nfe 20680, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 091/100, Runtime 0.256720, Loss 1.001317, forward nfe 20882, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 092/100, Runtime 0.250114, Loss 0.940934, forward nfe 21084, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 093/100, Runtime 0.248818, Loss 0.900262, forward nfe 21286, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 094/100, Runtime 0.396018, Loss 1.005250, forward nfe 21488, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 095/100, Runtime 0.257071, Loss 0.904188, forward nfe 21696, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 096/100, Runtime 0.267253, Loss 0.978512, forward nfe 21898, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 097/100, Runtime 0.269695, Loss 0.998231, forward nfe 22106, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 098/100, Runtime 0.250632, Loss 0.961109, forward nfe 22314, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
Epoch: 099/100, Runtime 0.264582, Loss 0.926605, forward nfe 22516, backward nfe 0, Train: 0.8250, Val: 0.7536, Test: 0.7274, Best time: 25.0000
best val accuracy 0.753623 with test accuracy 0.727419 at epoch 29 and best time 25.000000