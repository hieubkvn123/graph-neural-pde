/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 3.877738, Loss 1.947245, forward nfe 122, backward nfe 0, Train: 0.1786, Val: 0.1176, Test: 0.1218, Best time: 0.0945
Epoch: 002/100, Runtime 3.829490, Loss 1.909007, forward nfe 606, backward nfe 0, Train: 0.4357, Val: 0.3963, Test: 0.4223, Best time: 1.0222
Epoch: 003/100, Runtime 3.811213, Loss 1.813759, forward nfe 1078, backward nfe 0, Train: 0.6214, Val: 0.5853, Test: 0.5827, Best time: 7.7670
Epoch: 004/100, Runtime 3.744656, Loss 1.673410, forward nfe 1544, backward nfe 0, Train: 0.7929, Val: 0.7338, Test: 0.7188, Best time: 45.9878
Epoch: 005/100, Runtime 3.440715, Loss 1.454154, forward nfe 1998, backward nfe 0, Train: 0.8500, Val: 0.7743, Test: 0.7645, Best time: 14.2312
Epoch: 006/100, Runtime 3.482264, Loss 1.256134, forward nfe 2440, backward nfe 0, Train: 0.8500, Val: 0.7743, Test: 0.7645, Best time: 65.0000
Epoch: 007/100, Runtime 3.470032, Loss 1.044174, forward nfe 2876, backward nfe 0, Train: 0.8143, Val: 0.7765, Test: 0.7655, Best time: 8.5097
Epoch: 008/100, Runtime 3.319827, Loss 0.877568, forward nfe 3300, backward nfe 0, Train: 0.8071, Val: 0.7949, Test: 0.7848, Best time: 11.8284
Epoch: 009/100, Runtime 3.267277, Loss 0.742241, forward nfe 3718, backward nfe 0, Train: 0.8643, Val: 0.8176, Test: 0.8051, Best time: 16.3358
Epoch: 010/100, Runtime 3.020633, Loss 0.685428, forward nfe 4130, backward nfe 0, Train: 0.8786, Val: 0.8206, Test: 0.8051, Best time: 17.1003
Epoch: 011/100, Runtime 3.168897, Loss 0.596486, forward nfe 4524, backward nfe 0, Train: 0.8786, Val: 0.8206, Test: 0.8051, Best time: 65.0000
Epoch: 012/100, Runtime 3.014356, Loss 0.527341, forward nfe 4912, backward nfe 0, Train: 0.8786, Val: 0.8206, Test: 0.8051, Best time: 65.0000
Epoch: 013/100, Runtime 2.641935, Loss 0.494745, forward nfe 5276, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 20.0502
Epoch: 014/100, Runtime 3.312146, Loss 0.453683, forward nfe 5634, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 015/100, Runtime 3.504375, Loss 0.459679, forward nfe 5986, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 016/100, Runtime 3.192954, Loss 0.433338, forward nfe 6326, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 017/100, Runtime 3.017343, Loss 0.400541, forward nfe 6672, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 018/100, Runtime 3.148390, Loss 0.401424, forward nfe 7012, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 019/100, Runtime 3.185958, Loss 0.371034, forward nfe 7334, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 020/100, Runtime 3.057553, Loss 0.400180, forward nfe 7644, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 021/100, Runtime 2.946568, Loss 0.357786, forward nfe 7954, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 022/100, Runtime 3.035974, Loss 0.368272, forward nfe 8240, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 023/100, Runtime 2.123545, Loss 0.363193, forward nfe 8526, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 024/100, Runtime 2.107296, Loss 0.336799, forward nfe 8812, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 025/100, Runtime 2.153340, Loss 0.404142, forward nfe 9098, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 026/100, Runtime 2.052829, Loss 0.311802, forward nfe 9378, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 027/100, Runtime 2.213710, Loss 0.385625, forward nfe 9646, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 028/100, Runtime 2.189085, Loss 0.332672, forward nfe 9914, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 029/100, Runtime 2.026462, Loss 0.356103, forward nfe 10176, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 030/100, Runtime 2.102729, Loss 0.330337, forward nfe 10420, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 031/100, Runtime 2.023370, Loss 0.278204, forward nfe 10664, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 032/100, Runtime 1.916596, Loss 0.303475, forward nfe 10908, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 033/100, Runtime 1.870535, Loss 0.275933, forward nfe 11152, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 034/100, Runtime 2.061865, Loss 0.267724, forward nfe 11396, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 035/100, Runtime 2.004417, Loss 0.258690, forward nfe 11640, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 036/100, Runtime 1.979840, Loss 0.224108, forward nfe 11884, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 037/100, Runtime 2.008501, Loss 0.319414, forward nfe 12122, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 038/100, Runtime 1.983199, Loss 0.180013, forward nfe 12360, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 039/100, Runtime 1.970731, Loss 0.301300, forward nfe 12592, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 040/100, Runtime 1.876463, Loss 0.286635, forward nfe 12824, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 041/100, Runtime 1.884997, Loss 0.253374, forward nfe 13050, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 042/100, Runtime 1.873522, Loss 0.174702, forward nfe 13276, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 043/100, Runtime 1.837883, Loss 0.298384, forward nfe 13502, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 044/100, Runtime 1.739539, Loss 0.208866, forward nfe 13728, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 045/100, Runtime 1.887738, Loss 0.183906, forward nfe 13954, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 046/100, Runtime 1.853780, Loss 0.215864, forward nfe 14180, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 047/100, Runtime 1.850399, Loss 0.187541, forward nfe 14400, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8234, Best time: 65.0000
Epoch: 048/100, Runtime 1.869121, Loss 0.159829, forward nfe 14626, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8000, Best time: 115.5033
Epoch: 049/100, Runtime 1.867338, Loss 0.125868, forward nfe 14852, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8000, Best time: 65.0000
Epoch: 050/100, Runtime 1.800421, Loss 0.185577, forward nfe 15078, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8000, Best time: 65.0000
Epoch: 051/100, Runtime 1.723379, Loss 0.175119, forward nfe 15304, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8000, Best time: 65.0000
Epoch: 052/100, Runtime 1.640680, Loss 0.118829, forward nfe 15530, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8000, Best time: 65.0000
Epoch: 053/100, Runtime 1.650882, Loss 0.180005, forward nfe 15738, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8000, Best time: 65.0000
Epoch: 054/100, Runtime 1.739144, Loss 0.151947, forward nfe 15964, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8000, Best time: 65.0000
Epoch: 055/100, Runtime 1.615413, Loss 0.115645, forward nfe 16184, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8000, Best time: 65.0000
Epoch: 056/100, Runtime 1.759543, Loss 0.107408, forward nfe 16410, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8000, Best time: 65.0000
Epoch: 057/100, Runtime 1.719484, Loss 0.137711, forward nfe 16636, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8000, Best time: 65.0000
Epoch: 058/100, Runtime 1.773698, Loss 0.104963, forward nfe 16862, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8000, Best time: 65.0000
Epoch: 059/100, Runtime 1.725848, Loss 0.206066, forward nfe 17088, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8000, Best time: 65.0000
Epoch: 060/100, Runtime 1.678036, Loss 0.109742, forward nfe 17314, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8000, Best time: 65.0000
Epoch: 061/100, Runtime 1.735911, Loss 0.103248, forward nfe 17540, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8000, Best time: 65.0000
Epoch: 062/100, Runtime 1.774104, Loss 0.095783, forward nfe 17766, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 170.4128
Epoch: 063/100, Runtime 1.723852, Loss 0.085836, forward nfe 17992, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 064/100, Runtime 1.782874, Loss 0.093326, forward nfe 18218, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 065/100, Runtime 1.885391, Loss 0.071610, forward nfe 18444, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 066/100, Runtime 1.870104, Loss 0.095883, forward nfe 18670, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 067/100, Runtime 1.811174, Loss 0.056882, forward nfe 18896, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 068/100, Runtime 1.632385, Loss 0.067013, forward nfe 19122, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 069/100, Runtime 1.888770, Loss 0.083823, forward nfe 19336, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 070/100, Runtime 1.714928, Loss 0.067646, forward nfe 19544, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 071/100, Runtime 1.802083, Loss 0.118962, forward nfe 19746, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 072/100, Runtime 1.712045, Loss 0.072434, forward nfe 19948, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 073/100, Runtime 2.143919, Loss 0.059920, forward nfe 20150, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 074/100, Runtime 1.963280, Loss 0.056783, forward nfe 20352, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 075/100, Runtime 2.210071, Loss 0.089356, forward nfe 20554, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 076/100, Runtime 2.317953, Loss 0.087566, forward nfe 20744, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 077/100, Runtime 2.196737, Loss 0.061049, forward nfe 20940, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 078/100, Runtime 2.169874, Loss 0.061138, forward nfe 21124, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 079/100, Runtime 1.964186, Loss 0.074526, forward nfe 21308, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 080/100, Runtime 1.888152, Loss 0.088366, forward nfe 21492, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 081/100, Runtime 2.203778, Loss 0.053375, forward nfe 21682, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 082/100, Runtime 2.063158, Loss 0.036721, forward nfe 21872, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 083/100, Runtime 2.095783, Loss 0.040549, forward nfe 22062, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 084/100, Runtime 2.030898, Loss 0.085030, forward nfe 22252, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 085/100, Runtime 2.172923, Loss 0.071879, forward nfe 22442, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 086/100, Runtime 2.013261, Loss 0.028433, forward nfe 22626, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 087/100, Runtime 0.657667, Loss 0.037286, forward nfe 22810, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 088/100, Runtime 0.603321, Loss 0.055793, forward nfe 23000, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 089/100, Runtime 0.656295, Loss 0.043627, forward nfe 23190, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 090/100, Runtime 0.610648, Loss 0.070757, forward nfe 23380, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 091/100, Runtime 0.622733, Loss 0.060749, forward nfe 23570, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 092/100, Runtime 0.603986, Loss 0.082348, forward nfe 23754, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 093/100, Runtime 0.601045, Loss 0.055932, forward nfe 23938, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 094/100, Runtime 0.692106, Loss 0.025696, forward nfe 24122, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 095/100, Runtime 0.630574, Loss 0.031340, forward nfe 24306, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 096/100, Runtime 0.680026, Loss 0.116902, forward nfe 24490, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 097/100, Runtime 0.687290, Loss 0.056965, forward nfe 24674, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 098/100, Runtime 0.688929, Loss 0.068894, forward nfe 24858, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
Epoch: 099/100, Runtime 0.673431, Loss 0.081282, forward nfe 25042, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8041, Best time: 65.0000
best val accuracy 0.833088 with test accuracy 0.804061 at epoch 62 and best time 65.000000