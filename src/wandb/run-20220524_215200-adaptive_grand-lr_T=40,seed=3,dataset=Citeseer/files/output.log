/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.552505, Loss 1.791217, forward nfe 140, backward nfe 0, Train: 0.1833, Val: 0.1906, Test: 0.1871, Best time: 40.0000
Epoch: 002/100, Runtime 0.479871, Loss 1.763072, forward nfe 558, backward nfe 0, Train: 0.4333, Val: 0.5145, Test: 0.4710, Best time: 122.6994
Epoch: 003/100, Runtime 0.479071, Loss 1.727508, forward nfe 970, backward nfe 0, Train: 0.5333, Val: 0.6283, Test: 0.5855, Best time: 103.7408
Epoch: 004/100, Runtime 0.514292, Loss 1.684076, forward nfe 1400, backward nfe 0, Train: 0.6583, Val: 0.6812, Test: 0.6548, Best time: 12.8181
Epoch: 005/100, Runtime 0.483578, Loss 1.654827, forward nfe 1830, backward nfe 0, Train: 0.6583, Val: 0.6928, Test: 0.6677, Best time: 7.2017
Epoch: 006/100, Runtime 0.474305, Loss 1.624532, forward nfe 2242, backward nfe 0, Train: 0.6833, Val: 0.6986, Test: 0.6629, Best time: 10.0615
Epoch: 007/100, Runtime 0.475984, Loss 1.583307, forward nfe 2648, backward nfe 0, Train: 0.7583, Val: 0.7304, Test: 0.6855, Best time: 8.9815
Epoch: 008/100, Runtime 0.482708, Loss 1.605394, forward nfe 3054, backward nfe 0, Train: 0.7250, Val: 0.7413, Test: 0.6887, Best time: 24.2112
Epoch: 009/100, Runtime 0.451968, Loss 1.559522, forward nfe 3448, backward nfe 0, Train: 0.7250, Val: 0.7413, Test: 0.6887, Best time: 40.0000
Epoch: 010/100, Runtime 0.453447, Loss 1.539499, forward nfe 3830, backward nfe 0, Train: 0.7250, Val: 0.7413, Test: 0.6887, Best time: 40.0000
Epoch: 011/100, Runtime 0.452734, Loss 1.548351, forward nfe 4224, backward nfe 0, Train: 0.7250, Val: 0.7413, Test: 0.6887, Best time: 40.0000
Epoch: 012/100, Runtime 0.447572, Loss 1.487188, forward nfe 4600, backward nfe 0, Train: 0.7250, Val: 0.7413, Test: 0.6887, Best time: 40.0000
Epoch: 013/100, Runtime 0.418676, Loss 1.501515, forward nfe 4970, backward nfe 0, Train: 0.7250, Val: 0.7413, Test: 0.6887, Best time: 40.0000
Epoch: 014/100, Runtime 0.429100, Loss 1.414845, forward nfe 5334, backward nfe 0, Train: 0.7250, Val: 0.7413, Test: 0.6887, Best time: 40.0000
Epoch: 015/100, Runtime 0.425932, Loss 1.371035, forward nfe 5704, backward nfe 0, Train: 0.7250, Val: 0.7413, Test: 0.6887, Best time: 40.0000
Epoch: 016/100, Runtime 0.440117, Loss 1.380028, forward nfe 6068, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 32.1351
Epoch: 017/100, Runtime 0.420616, Loss 1.307674, forward nfe 6420, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 018/100, Runtime 0.394411, Loss 1.327138, forward nfe 6772, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 019/100, Runtime 0.395908, Loss 1.269115, forward nfe 7112, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 020/100, Runtime 0.401540, Loss 1.270616, forward nfe 7452, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 021/100, Runtime 0.396996, Loss 1.210079, forward nfe 7792, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 022/100, Runtime 0.402020, Loss 1.157917, forward nfe 8120, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 023/100, Runtime 0.386777, Loss 1.223951, forward nfe 8454, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 024/100, Runtime 0.376678, Loss 1.125512, forward nfe 8782, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 025/100, Runtime 0.377465, Loss 1.200980, forward nfe 9104, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 026/100, Runtime 0.370942, Loss 1.159308, forward nfe 9414, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 027/100, Runtime 0.374694, Loss 1.158341, forward nfe 9724, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 028/100, Runtime 0.370672, Loss 1.170252, forward nfe 10034, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 029/100, Runtime 0.382828, Loss 1.121793, forward nfe 10344, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 030/100, Runtime 0.357705, Loss 1.125326, forward nfe 10648, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 031/100, Runtime 0.359696, Loss 1.172662, forward nfe 10946, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 032/100, Runtime 0.341315, Loss 1.117170, forward nfe 11238, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 033/100, Runtime 0.348126, Loss 1.160349, forward nfe 11524, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 034/100, Runtime 0.339130, Loss 1.045084, forward nfe 11810, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 035/100, Runtime 0.330570, Loss 1.097859, forward nfe 12096, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 036/100, Runtime 0.338387, Loss 1.128638, forward nfe 12376, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 037/100, Runtime 0.334520, Loss 1.027003, forward nfe 12656, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 038/100, Runtime 0.318559, Loss 1.138652, forward nfe 12924, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 039/100, Runtime 0.329993, Loss 1.089558, forward nfe 13192, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 040/100, Runtime 0.325240, Loss 1.115446, forward nfe 13454, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 041/100, Runtime 0.314092, Loss 1.083155, forward nfe 13722, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 042/100, Runtime 0.311283, Loss 1.035320, forward nfe 13978, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 043/100, Runtime 0.313530, Loss 1.146420, forward nfe 14234, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 044/100, Runtime 0.302202, Loss 0.972155, forward nfe 14490, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 045/100, Runtime 0.308575, Loss 1.008099, forward nfe 14734, backward nfe 0, Train: 0.7083, Val: 0.7428, Test: 0.6952, Best time: 40.0000
Epoch: 046/100, Runtime 0.294193, Loss 1.239552, forward nfe 14978, backward nfe 0, Train: 0.7917, Val: 0.7435, Test: 0.7065, Best time: 40.0000
Epoch: 047/100, Runtime 0.297743, Loss 1.075053, forward nfe 15222, backward nfe 0, Train: 0.7917, Val: 0.7435, Test: 0.7065, Best time: 40.0000
Epoch: 048/100, Runtime 0.304521, Loss 1.100916, forward nfe 15466, backward nfe 0, Train: 0.7917, Val: 0.7435, Test: 0.7065, Best time: 40.0000
Epoch: 049/100, Runtime 0.296542, Loss 1.042348, forward nfe 15710, backward nfe 0, Train: 0.7917, Val: 0.7435, Test: 0.7065, Best time: 40.0000
Epoch: 050/100, Runtime 0.295227, Loss 0.993673, forward nfe 15954, backward nfe 0, Train: 0.7917, Val: 0.7435, Test: 0.7065, Best time: 40.0000
Epoch: 051/100, Runtime 0.296080, Loss 0.996833, forward nfe 16198, backward nfe 0, Train: 0.7917, Val: 0.7435, Test: 0.7065, Best time: 40.0000
Epoch: 052/100, Runtime 0.305184, Loss 1.026362, forward nfe 16442, backward nfe 0, Train: 0.7917, Val: 0.7435, Test: 0.7065, Best time: 40.0000
Epoch: 053/100, Runtime 0.288275, Loss 1.099988, forward nfe 16686, backward nfe 0, Train: 0.7917, Val: 0.7435, Test: 0.7065, Best time: 40.0000
Epoch: 054/100, Runtime 0.293817, Loss 1.054395, forward nfe 16930, backward nfe 0, Train: 0.7917, Val: 0.7435, Test: 0.7065, Best time: 40.0000
Epoch: 055/100, Runtime 0.299728, Loss 1.093674, forward nfe 17174, backward nfe 0, Train: 0.7917, Val: 0.7435, Test: 0.7065, Best time: 40.0000
Epoch: 056/100, Runtime 0.292758, Loss 1.063732, forward nfe 17418, backward nfe 0, Train: 0.7917, Val: 0.7435, Test: 0.7065, Best time: 40.0000
Epoch: 057/100, Runtime 0.324450, Loss 1.037822, forward nfe 17662, backward nfe 0, Train: 0.7917, Val: 0.7435, Test: 0.7065, Best time: 40.0000
Epoch: 058/100, Runtime 0.308341, Loss 1.069687, forward nfe 17912, backward nfe 0, Train: 0.8583, Val: 0.7457, Test: 0.7226, Best time: 99.0383
Epoch: 059/100, Runtime 0.311917, Loss 0.982605, forward nfe 18162, backward nfe 0, Train: 0.8583, Val: 0.7457, Test: 0.7226, Best time: 40.0000
Epoch: 060/100, Runtime 0.311032, Loss 0.970645, forward nfe 18412, backward nfe 0, Train: 0.8583, Val: 0.7457, Test: 0.7226, Best time: 40.0000
Epoch: 061/100, Runtime 0.314364, Loss 1.078985, forward nfe 18662, backward nfe 0, Train: 0.8583, Val: 0.7457, Test: 0.7226, Best time: 40.0000
Epoch: 062/100, Runtime 0.308266, Loss 1.082563, forward nfe 18912, backward nfe 0, Train: 0.8583, Val: 0.7457, Test: 0.7226, Best time: 40.0000
Epoch: 063/100, Runtime 0.311438, Loss 0.973427, forward nfe 19162, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 76.2082
Epoch: 064/100, Runtime 0.313860, Loss 0.949470, forward nfe 19412, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 065/100, Runtime 0.326073, Loss 1.087421, forward nfe 19662, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 066/100, Runtime 0.306494, Loss 1.056083, forward nfe 19912, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 067/100, Runtime 0.303879, Loss 1.112665, forward nfe 20162, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 068/100, Runtime 0.304376, Loss 1.131662, forward nfe 20412, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 069/100, Runtime 0.301550, Loss 1.110132, forward nfe 20662, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 070/100, Runtime 0.451419, Loss 1.068167, forward nfe 20912, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 071/100, Runtime 0.305908, Loss 0.951507, forward nfe 21162, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 072/100, Runtime 0.300725, Loss 1.083347, forward nfe 21406, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 073/100, Runtime 0.316422, Loss 0.975548, forward nfe 21650, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 074/100, Runtime 0.307775, Loss 1.004643, forward nfe 21894, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 075/100, Runtime 0.301360, Loss 1.034102, forward nfe 22138, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 076/100, Runtime 0.303182, Loss 0.982640, forward nfe 22382, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 077/100, Runtime 0.305804, Loss 0.992475, forward nfe 22626, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 078/100, Runtime 0.311404, Loss 1.005798, forward nfe 22870, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 079/100, Runtime 0.301939, Loss 1.038422, forward nfe 23114, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 080/100, Runtime 0.299832, Loss 1.021046, forward nfe 23358, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 081/100, Runtime 0.309411, Loss 1.043061, forward nfe 23602, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 082/100, Runtime 0.306318, Loss 1.025593, forward nfe 23846, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 083/100, Runtime 0.299935, Loss 1.131867, forward nfe 24090, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 084/100, Runtime 0.315493, Loss 1.156544, forward nfe 24334, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 085/100, Runtime 0.302433, Loss 1.067085, forward nfe 24578, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 086/100, Runtime 0.307827, Loss 1.074471, forward nfe 24822, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 087/100, Runtime 0.303516, Loss 0.973059, forward nfe 25066, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 088/100, Runtime 0.296606, Loss 0.917700, forward nfe 25310, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 089/100, Runtime 0.302825, Loss 0.991543, forward nfe 25554, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 090/100, Runtime 0.299482, Loss 1.058985, forward nfe 25798, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 091/100, Runtime 0.305367, Loss 1.049378, forward nfe 26042, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 092/100, Runtime 0.298105, Loss 0.955134, forward nfe 26286, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 093/100, Runtime 0.302184, Loss 1.041327, forward nfe 26530, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 094/100, Runtime 0.303532, Loss 0.944013, forward nfe 26774, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 095/100, Runtime 0.304440, Loss 1.010175, forward nfe 27018, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 096/100, Runtime 0.299184, Loss 0.965669, forward nfe 27262, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 097/100, Runtime 0.309332, Loss 0.994061, forward nfe 27506, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 098/100, Runtime 0.316296, Loss 1.041844, forward nfe 27750, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
Epoch: 099/100, Runtime 0.301182, Loss 0.997138, forward nfe 27988, backward nfe 0, Train: 0.8667, Val: 0.7500, Test: 0.7210, Best time: 40.0000
best val accuracy 0.750000 with test accuracy 0.720968 at epoch 63 and best time 40.000000