/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.231137, Loss 1.796066, forward nfe 56, backward nfe 0, Train: 0.2417, Val: 0.1899, Test: 0.1871, Best time: 0.0421
Epoch: 002/100, Runtime 0.200202, Loss 1.767957, forward nfe 204, backward nfe 0, Train: 0.3833, Val: 0.2254, Test: 0.2242, Best time: 0.3460
Epoch: 003/100, Runtime 0.194671, Loss 1.735024, forward nfe 358, backward nfe 0, Train: 0.6833, Val: 0.3971, Test: 0.4032, Best time: 0.0388
Epoch: 004/100, Runtime 0.212590, Loss 1.711106, forward nfe 518, backward nfe 0, Train: 0.6500, Val: 0.5420, Test: 0.5161, Best time: 16.9407
Epoch: 005/100, Runtime 0.207027, Loss 1.685947, forward nfe 684, backward nfe 0, Train: 0.8000, Val: 0.6493, Test: 0.6161, Best time: 5.0000
Epoch: 006/100, Runtime 0.210502, Loss 1.665632, forward nfe 850, backward nfe 0, Train: 0.8500, Val: 0.6884, Test: 0.6677, Best time: 16.4853
Epoch: 007/100, Runtime 0.207819, Loss 1.630651, forward nfe 1016, backward nfe 0, Train: 0.8750, Val: 0.7196, Test: 0.6968, Best time: 16.5734
Epoch: 008/100, Runtime 0.229469, Loss 1.618775, forward nfe 1182, backward nfe 0, Train: 0.8667, Val: 0.7312, Test: 0.7210, Best time: 16.8406
Epoch: 009/100, Runtime 0.220744, Loss 1.625907, forward nfe 1348, backward nfe 0, Train: 0.8667, Val: 0.7384, Test: 0.7242, Best time: 17.2906
Epoch: 010/100, Runtime 0.193828, Loss 1.579756, forward nfe 1508, backward nfe 0, Train: 0.8750, Val: 0.7507, Test: 0.7355, Best time: 15.3417
Epoch: 011/100, Runtime 0.208530, Loss 1.563589, forward nfe 1662, backward nfe 0, Train: 0.8667, Val: 0.7580, Test: 0.7274, Best time: 5.0000
Epoch: 012/100, Runtime 0.199042, Loss 1.539906, forward nfe 1816, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 12.2237
Epoch: 013/100, Runtime 0.199391, Loss 1.523170, forward nfe 1970, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 014/100, Runtime 0.188349, Loss 1.519933, forward nfe 2124, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 015/100, Runtime 0.188711, Loss 1.506289, forward nfe 2278, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 016/100, Runtime 0.189541, Loss 1.465322, forward nfe 2426, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 017/100, Runtime 0.186564, Loss 1.455221, forward nfe 2574, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 018/100, Runtime 0.191950, Loss 1.388649, forward nfe 2722, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 019/100, Runtime 0.201074, Loss 1.395044, forward nfe 2870, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 020/100, Runtime 0.180361, Loss 1.334780, forward nfe 3012, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 021/100, Runtime 0.188888, Loss 1.261240, forward nfe 3154, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 022/100, Runtime 0.181307, Loss 1.245886, forward nfe 3296, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 023/100, Runtime 0.181336, Loss 1.231295, forward nfe 3438, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 024/100, Runtime 0.187355, Loss 1.135004, forward nfe 3574, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 025/100, Runtime 0.176827, Loss 1.121856, forward nfe 3710, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 026/100, Runtime 0.170964, Loss 1.179624, forward nfe 3846, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 027/100, Runtime 0.182735, Loss 1.133797, forward nfe 3982, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 028/100, Runtime 0.164525, Loss 1.060038, forward nfe 4118, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 029/100, Runtime 0.165205, Loss 1.128015, forward nfe 4248, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 030/100, Runtime 0.173120, Loss 1.048813, forward nfe 4372, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 031/100, Runtime 0.159042, Loss 1.108263, forward nfe 4496, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 032/100, Runtime 0.162414, Loss 1.040525, forward nfe 4620, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 033/100, Runtime 0.154461, Loss 1.084958, forward nfe 4744, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 034/100, Runtime 0.153695, Loss 1.056528, forward nfe 4862, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 035/100, Runtime 0.149101, Loss 1.009522, forward nfe 4980, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 036/100, Runtime 0.157613, Loss 1.052985, forward nfe 5098, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 037/100, Runtime 0.148200, Loss 0.994274, forward nfe 5216, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 038/100, Runtime 0.152764, Loss 0.971691, forward nfe 5328, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 039/100, Runtime 0.143072, Loss 1.032794, forward nfe 5434, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 040/100, Runtime 0.151425, Loss 1.024147, forward nfe 5540, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 041/100, Runtime 0.131753, Loss 0.987503, forward nfe 5646, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 042/100, Runtime 0.132203, Loss 0.906804, forward nfe 5746, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 043/100, Runtime 0.152687, Loss 0.988360, forward nfe 5846, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 044/100, Runtime 0.139314, Loss 0.882188, forward nfe 5946, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 045/100, Runtime 0.137220, Loss 0.908005, forward nfe 6046, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 046/100, Runtime 0.134030, Loss 0.959926, forward nfe 6146, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 047/100, Runtime 0.142850, Loss 0.921440, forward nfe 6246, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 048/100, Runtime 0.136965, Loss 1.016755, forward nfe 6346, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 049/100, Runtime 0.140429, Loss 0.988731, forward nfe 6446, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 050/100, Runtime 0.147492, Loss 0.931701, forward nfe 6546, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 051/100, Runtime 0.140548, Loss 0.840079, forward nfe 6652, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 052/100, Runtime 0.143626, Loss 0.900136, forward nfe 6758, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 053/100, Runtime 0.138292, Loss 0.854267, forward nfe 6864, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 054/100, Runtime 0.148172, Loss 0.971439, forward nfe 6970, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 055/100, Runtime 0.142972, Loss 0.906437, forward nfe 7076, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 056/100, Runtime 0.140836, Loss 0.874733, forward nfe 7182, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 057/100, Runtime 0.165038, Loss 0.897090, forward nfe 7288, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 058/100, Runtime 0.141531, Loss 0.902438, forward nfe 7394, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 059/100, Runtime 0.142681, Loss 0.971677, forward nfe 7500, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 060/100, Runtime 0.159790, Loss 0.911408, forward nfe 7606, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 061/100, Runtime 0.141508, Loss 1.020839, forward nfe 7712, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 062/100, Runtime 0.140155, Loss 0.996809, forward nfe 7818, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 063/100, Runtime 0.138375, Loss 0.884862, forward nfe 7924, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 064/100, Runtime 0.145733, Loss 0.881200, forward nfe 8030, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 065/100, Runtime 0.139739, Loss 0.947811, forward nfe 8136, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 066/100, Runtime 0.138834, Loss 0.886066, forward nfe 8242, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 067/100, Runtime 0.141582, Loss 0.863955, forward nfe 8348, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 068/100, Runtime 0.148932, Loss 0.954279, forward nfe 8454, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 069/100, Runtime 0.142494, Loss 0.817946, forward nfe 8560, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 070/100, Runtime 0.140692, Loss 0.913653, forward nfe 8666, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 071/100, Runtime 0.148407, Loss 0.787695, forward nfe 8772, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 072/100, Runtime 0.140750, Loss 0.898118, forward nfe 8878, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 073/100, Runtime 0.141940, Loss 0.882473, forward nfe 8984, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 074/100, Runtime 0.144982, Loss 0.914738, forward nfe 9090, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 075/100, Runtime 0.169113, Loss 0.901284, forward nfe 9196, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 076/100, Runtime 0.140618, Loss 0.962132, forward nfe 9302, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 077/100, Runtime 0.139014, Loss 0.804295, forward nfe 9408, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 078/100, Runtime 0.154355, Loss 0.820694, forward nfe 9514, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 079/100, Runtime 0.142367, Loss 0.812415, forward nfe 9620, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 080/100, Runtime 0.140043, Loss 0.903236, forward nfe 9726, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 081/100, Runtime 0.137675, Loss 0.891337, forward nfe 9832, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 082/100, Runtime 0.143378, Loss 0.882911, forward nfe 9938, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 083/100, Runtime 0.140306, Loss 0.809926, forward nfe 10044, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 084/100, Runtime 0.143320, Loss 0.882679, forward nfe 10150, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 085/100, Runtime 0.161974, Loss 0.939375, forward nfe 10256, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 086/100, Runtime 0.140827, Loss 0.755178, forward nfe 10362, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 087/100, Runtime 0.137089, Loss 0.945605, forward nfe 10468, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 088/100, Runtime 0.138053, Loss 0.941674, forward nfe 10574, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 089/100, Runtime 0.146268, Loss 0.879346, forward nfe 10680, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 090/100, Runtime 0.138264, Loss 0.853225, forward nfe 10786, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 091/100, Runtime 0.136142, Loss 0.812546, forward nfe 10892, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 092/100, Runtime 0.150052, Loss 0.781396, forward nfe 10998, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 093/100, Runtime 0.145636, Loss 0.791609, forward nfe 11104, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 094/100, Runtime 0.143375, Loss 0.798789, forward nfe 11210, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 095/100, Runtime 0.136975, Loss 0.846460, forward nfe 11316, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 096/100, Runtime 0.146608, Loss 0.815383, forward nfe 11422, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 097/100, Runtime 0.148912, Loss 0.788327, forward nfe 11522, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 098/100, Runtime 0.140247, Loss 0.959590, forward nfe 11628, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
Epoch: 099/100, Runtime 0.150368, Loss 0.805135, forward nfe 11728, backward nfe 0, Train: 0.8667, Val: 0.7638, Test: 0.7323, Best time: 5.0000
best val accuracy 0.763768 with test accuracy 0.732258 at epoch 12 and best time 5.000000