/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 32.327600, Loss 1.100191, forward nfe 80, backward nfe 3233, Train: 0.7500, Val: 0.7104, Test: 0.7132, Best time: 44.0036
Epoch: 002/100, Runtime 28.710365, Loss 1.089118, forward nfe 504, backward nfe 6050, Train: 0.7500, Val: 0.7104, Test: 0.7132, Best time: 35.0000
Epoch: 003/100, Runtime 29.072982, Loss 1.072626, forward nfe 922, backward nfe 8900, Train: 0.7500, Val: 0.7104, Test: 0.7132, Best time: 35.0000
Epoch: 004/100, Runtime 27.337235, Loss 1.044560, forward nfe 1346, backward nfe 11597, Train: 0.7500, Val: 0.7104, Test: 0.7132, Best time: 35.0000
Epoch: 005/100, Runtime 26.839533, Loss 1.014009, forward nfe 1782, backward nfe 14248, Train: 0.7500, Val: 0.7104, Test: 0.7132, Best time: 35.0000
Epoch: 006/100, Runtime 27.929560, Loss 0.974402, forward nfe 2218, backward nfe 17008, Train: 0.7667, Val: 0.7139, Test: 0.7047, Best time: 27.2709
Epoch: 007/100, Runtime 27.285157, Loss 0.923715, forward nfe 2654, backward nfe 19682, Train: 0.7500, Val: 0.7167, Test: 0.7099, Best time: 23.2957
Epoch: 008/100, Runtime 25.645500, Loss 0.861680, forward nfe 3096, backward nfe 22219, Train: 0.7500, Val: 0.7174, Test: 0.7116, Best time: 9.2765
Epoch: 009/100, Runtime 28.570323, Loss 0.809207, forward nfe 3532, backward nfe 25069, Train: 0.7833, Val: 0.7188, Test: 0.7105, Best time: 5.3240
Epoch: 010/100, Runtime 26.448288, Loss 0.747517, forward nfe 3974, backward nfe 27700, Train: 0.7833, Val: 0.7215, Test: 0.7117, Best time: 2.2155
Epoch: 011/100, Runtime 26.493685, Loss 0.692538, forward nfe 4410, backward nfe 30353, Train: 0.7833, Val: 0.7264, Test: 0.7147, Best time: 2.1775
Epoch: 012/100, Runtime 22.657887, Loss 0.637747, forward nfe 4852, backward nfe 32593, Train: 0.7833, Val: 0.7347, Test: 0.7193, Best time: 14.2309
Epoch: 013/100, Runtime 23.396354, Loss 0.577558, forward nfe 5300, backward nfe 34878, Train: 0.8167, Val: 0.7403, Test: 0.7284, Best time: 2.1158
Epoch: 014/100, Runtime 22.539911, Loss 0.530166, forward nfe 5748, backward nfe 37115, Train: 0.8000, Val: 0.7507, Test: 0.7402, Best time: 2.0918
Epoch: 015/100, Runtime 24.173009, Loss 0.494087, forward nfe 6196, backward nfe 39527, Train: 0.8500, Val: 0.7597, Test: 0.7502, Best time: 2.0727
Epoch: 016/100, Runtime 23.469976, Loss 0.459752, forward nfe 6644, backward nfe 41843, Train: 0.8500, Val: 0.7597, Test: 0.7502, Best time: 35.0000
Epoch: 017/100, Runtime 25.825005, Loss 0.436549, forward nfe 7086, backward nfe 44418, Train: 0.8500, Val: 0.7597, Test: 0.7502, Best time: 35.0000
Epoch: 018/100, Runtime 26.377169, Loss 0.406673, forward nfe 7522, backward nfe 47061, Train: 0.8667, Val: 0.7632, Test: 0.7574, Best time: 39.5560
Epoch: 019/100, Runtime 24.212782, Loss 0.377683, forward nfe 7952, backward nfe 49455, Train: 0.9167, Val: 0.7736, Test: 0.7749, Best time: 5.3697
Epoch: 020/100, Runtime 23.185491, Loss 0.369787, forward nfe 8388, backward nfe 51763, Train: 0.9167, Val: 0.7736, Test: 0.7749, Best time: 35.0000
Epoch: 021/100, Runtime 17.521239, Loss 0.346807, forward nfe 8824, backward nfe 53462, Train: 0.9167, Val: 0.7736, Test: 0.7749, Best time: 35.0000
Epoch: 022/100, Runtime 24.186799, Loss 0.355220, forward nfe 9272, backward nfe 55838, Train: 0.9167, Val: 0.7736, Test: 0.7749, Best time: 35.0000
Epoch: 023/100, Runtime 18.134538, Loss 0.349167, forward nfe 9714, backward nfe 57544, Train: 0.9500, Val: 0.7833, Test: 0.7781, Best time: 9.7237
Epoch: 024/100, Runtime 23.152902, Loss 0.348550, forward nfe 10156, backward nfe 59807, Train: 0.9500, Val: 0.7833, Test: 0.7781, Best time: 35.0000
Epoch: 025/100, Runtime 20.198061, Loss 0.301092, forward nfe 10598, backward nfe 61784, Train: 0.9500, Val: 0.7833, Test: 0.7781, Best time: 35.0000
Epoch: 026/100, Runtime 20.967839, Loss 0.315867, forward nfe 11040, backward nfe 63850, Train: 0.9500, Val: 0.7833, Test: 0.7781, Best time: 35.0000
Epoch: 027/100, Runtime 21.140367, Loss 0.293087, forward nfe 11482, backward nfe 65906, Train: 0.9500, Val: 0.7833, Test: 0.7781, Best time: 35.0000
Epoch: 028/100, Runtime 22.833354, Loss 0.279048, forward nfe 11912, backward nfe 68166, Train: 0.9500, Val: 0.7833, Test: 0.7781, Best time: 35.0000
Epoch: 029/100, Runtime 17.262195, Loss 0.291116, forward nfe 12348, backward nfe 69811, Train: 0.9500, Val: 0.7833, Test: 0.7781, Best time: 35.0000
Epoch: 030/100, Runtime 24.858898, Loss 0.276446, forward nfe 12778, backward nfe 72288, Train: 0.9500, Val: 0.7833, Test: 0.7781, Best time: 35.0000
Epoch: 031/100, Runtime 25.465471, Loss 0.253447, forward nfe 13208, backward nfe 74811, Train: 0.9500, Val: 0.7833, Test: 0.7781, Best time: 35.0000
Epoch: 032/100, Runtime 23.230299, Loss 0.272111, forward nfe 13632, backward nfe 77124, Train: 0.9500, Val: 0.7833, Test: 0.7781, Best time: 35.0000
Epoch: 033/100, Runtime 24.412875, Loss 0.255878, forward nfe 14056, backward nfe 79528, Train: 0.9500, Val: 0.7833, Test: 0.7781, Best time: 35.0000
Epoch: 034/100, Runtime 22.729985, Loss 0.219408, forward nfe 14480, backward nfe 81794, Train: 0.9500, Val: 0.7833, Test: 0.7781, Best time: 35.0000
Epoch: 035/100, Runtime 24.001141, Loss 0.267791, forward nfe 14904, backward nfe 84161, Train: 0.9667, Val: 0.8035, Test: 0.7994, Best time: 5.9926
Epoch: 036/100, Runtime 20.357226, Loss 0.238260, forward nfe 15334, backward nfe 86157, Train: 0.9667, Val: 0.8035, Test: 0.7994, Best time: 35.0000
Epoch: 037/100, Runtime 22.070596, Loss 0.284822, forward nfe 15770, backward nfe 88354, Train: 0.9667, Val: 0.8035, Test: 0.7994, Best time: 35.0000
Epoch: 038/100, Runtime 22.355253, Loss 0.227663, forward nfe 16200, backward nfe 90588, Train: 0.9667, Val: 0.8035, Test: 0.7994, Best time: 35.0000
Epoch: 039/100, Runtime 21.644986, Loss 0.203369, forward nfe 16630, backward nfe 92709, Train: 0.9667, Val: 0.8035, Test: 0.7994, Best time: 35.0000
Epoch: 040/100, Runtime 21.489858, Loss 0.244255, forward nfe 17060, backward nfe 94844, Train: 0.9667, Val: 0.8035, Test: 0.7994, Best time: 35.0000
Epoch: 041/100, Runtime 22.557554, Loss 0.207350, forward nfe 17490, backward nfe 97088, Train: 0.9667, Val: 0.8035, Test: 0.7994, Best time: 35.0000
Epoch: 042/100, Runtime 13.350997, Loss 0.227940, forward nfe 17920, backward nfe 98311, Train: 0.9667, Val: 0.8035, Test: 0.7994, Best time: 35.0000
Epoch: 043/100, Runtime 19.477407, Loss 0.204374, forward nfe 18350, backward nfe 100195, Train: 0.9667, Val: 0.8035, Test: 0.7994, Best time: 35.0000
Epoch: 044/100, Runtime 13.269914, Loss 0.155468, forward nfe 18780, backward nfe 101437, Train: 0.9667, Val: 0.8035, Test: 0.7994, Best time: 35.0000
Epoch: 045/100, Runtime 19.032470, Loss 0.228208, forward nfe 19210, backward nfe 103296, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 6.3799
Epoch: 046/100, Runtime 15.086506, Loss 0.150632, forward nfe 19640, backward nfe 104739, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 047/100, Runtime 22.804462, Loss 0.201332, forward nfe 20070, backward nfe 106974, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 048/100, Runtime 21.968164, Loss 0.180621, forward nfe 20500, backward nfe 109126, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 049/100, Runtime 22.693078, Loss 0.155471, forward nfe 20930, backward nfe 111383, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 050/100, Runtime 23.427484, Loss 0.206263, forward nfe 21360, backward nfe 113755, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 051/100, Runtime 20.534166, Loss 0.165264, forward nfe 21784, backward nfe 115788, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 052/100, Runtime 19.612259, Loss 0.164110, forward nfe 22208, backward nfe 117685, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 053/100, Runtime 21.752955, Loss 0.140239, forward nfe 22638, backward nfe 119816, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 054/100, Runtime 18.351496, Loss 0.164873, forward nfe 23068, backward nfe 121609, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 055/100, Runtime 19.086292, Loss 0.220669, forward nfe 23498, backward nfe 123454, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 056/100, Runtime 20.693058, Loss 0.130377, forward nfe 23928, backward nfe 125445, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 057/100, Runtime 16.574205, Loss 0.167755, forward nfe 24358, backward nfe 127026, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 058/100, Runtime 20.766392, Loss 0.160786, forward nfe 24782, backward nfe 129086, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 059/100, Runtime 20.358517, Loss 0.125106, forward nfe 25206, backward nfe 131102, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 060/100, Runtime 20.311810, Loss 0.145380, forward nfe 25630, backward nfe 133058, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 061/100, Runtime 17.817376, Loss 0.121321, forward nfe 26054, backward nfe 134783, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 062/100, Runtime 15.393616, Loss 0.116619, forward nfe 26478, backward nfe 136260, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 063/100, Runtime 21.015045, Loss 0.141717, forward nfe 26902, backward nfe 138329, Train: 0.9667, Val: 0.8063, Test: 0.7966, Best time: 35.0000
Epoch: 064/100, Runtime 18.658813, Loss 0.121597, forward nfe 27326, backward nfe 140127, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 6.9022
Epoch: 065/100, Runtime 16.480881, Loss 0.154779, forward nfe 27762, backward nfe 141709, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 066/100, Runtime 16.849163, Loss 0.087220, forward nfe 28198, backward nfe 143292, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 067/100, Runtime 20.839891, Loss 0.134727, forward nfe 28634, backward nfe 145343, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 068/100, Runtime 20.726551, Loss 0.154399, forward nfe 29070, backward nfe 147402, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 069/100, Runtime 16.448661, Loss 0.127089, forward nfe 29506, backward nfe 148943, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 070/100, Runtime 14.251962, Loss 0.072536, forward nfe 29942, backward nfe 150303, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 071/100, Runtime 17.592581, Loss 0.094707, forward nfe 30378, backward nfe 152012, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 072/100, Runtime 17.735845, Loss 0.086948, forward nfe 30814, backward nfe 153689, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 073/100, Runtime 17.796097, Loss 0.092119, forward nfe 31250, backward nfe 155425, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 074/100, Runtime 18.697637, Loss 0.091089, forward nfe 31686, backward nfe 157258, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 075/100, Runtime 16.634089, Loss 0.067671, forward nfe 32122, backward nfe 158836, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 076/100, Runtime 15.440573, Loss 0.087127, forward nfe 32558, backward nfe 160337, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 077/100, Runtime 17.587330, Loss 0.083595, forward nfe 32994, backward nfe 162046, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 078/100, Runtime 15.251923, Loss 0.081778, forward nfe 33430, backward nfe 163509, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 079/100, Runtime 15.003744, Loss 0.081213, forward nfe 33866, backward nfe 164944, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 080/100, Runtime 15.190532, Loss 0.075252, forward nfe 34302, backward nfe 166365, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 081/100, Runtime 15.148166, Loss 0.053035, forward nfe 34726, backward nfe 167815, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 082/100, Runtime 20.016971, Loss 0.082133, forward nfe 35150, backward nfe 169765, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 083/100, Runtime 17.263666, Loss 0.067905, forward nfe 35574, backward nfe 171428, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 084/100, Runtime 16.126549, Loss 0.126135, forward nfe 35998, backward nfe 172988, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 085/100, Runtime 17.102496, Loss 0.062744, forward nfe 36428, backward nfe 174621, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 086/100, Runtime 16.381861, Loss 0.079010, forward nfe 36858, backward nfe 176184, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 087/100, Runtime 18.978273, Loss 0.075877, forward nfe 37288, backward nfe 178006, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 088/100, Runtime 18.229234, Loss 0.043531, forward nfe 37718, backward nfe 179750, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 089/100, Runtime 19.450103, Loss 0.056067, forward nfe 38148, backward nfe 181665, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 090/100, Runtime 17.094873, Loss 0.065748, forward nfe 38578, backward nfe 183332, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 091/100, Runtime 20.027382, Loss 0.051074, forward nfe 39008, backward nfe 185322, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 092/100, Runtime 17.701776, Loss 0.053418, forward nfe 39438, backward nfe 187000, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 093/100, Runtime 17.692894, Loss 0.044530, forward nfe 39868, backward nfe 188708, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 094/100, Runtime 11.334905, Loss 0.042816, forward nfe 40298, backward nfe 189766, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 095/100, Runtime 19.727861, Loss 0.049813, forward nfe 40728, backward nfe 191713, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 096/100, Runtime 15.475982, Loss 0.054909, forward nfe 41158, backward nfe 193182, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 097/100, Runtime 15.779989, Loss 0.033880, forward nfe 41588, backward nfe 194686, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 098/100, Runtime 18.352659, Loss 0.078988, forward nfe 42018, backward nfe 196482, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
Epoch: 099/100, Runtime 16.730118, Loss 0.035991, forward nfe 42448, backward nfe 198083, Train: 1.0000, Val: 0.8097, Test: 0.8067, Best time: 35.0000
best val accuracy 0.809722 with test accuracy 0.806719 at epoch 64 and best time 35.000000