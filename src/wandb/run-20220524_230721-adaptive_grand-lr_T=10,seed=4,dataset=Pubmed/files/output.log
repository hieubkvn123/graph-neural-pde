****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
Epoch: 001/100, Runtime 0.501078, Loss 1.099287, forward nfe 32, backward nfe 15, Train: 0.8000, Val: 0.5854, Test: 0.5783, Best time: 2.6003
Epoch: 002/100, Runtime 0.478725, Loss 1.089870, forward nfe 168, backward nfe 30, Train: 0.8000, Val: 0.5854, Test: 0.5783, Best time: 10.0000
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 003/100, Runtime 0.480946, Loss 1.075718, forward nfe 298, backward nfe 45, Train: 0.8000, Val: 0.5854, Test: 0.5783, Best time: 10.0000
Epoch: 004/100, Runtime 0.542764, Loss 1.056567, forward nfe 428, backward nfe 64, Train: 0.8333, Val: 0.6215, Test: 0.6187, Best time: 0.2282
Epoch: 005/100, Runtime 0.499187, Loss 1.033614, forward nfe 564, backward nfe 80, Train: 0.8833, Val: 0.6465, Test: 0.6463, Best time: 2.4408
Epoch: 006/100, Runtime 0.502627, Loss 1.002807, forward nfe 694, backward nfe 97, Train: 0.8833, Val: 0.6632, Test: 0.6639, Best time: 2.3839
Epoch: 007/100, Runtime 0.519094, Loss 0.959679, forward nfe 824, backward nfe 114, Train: 0.8833, Val: 0.6708, Test: 0.6718, Best time: 2.3360
Epoch: 008/100, Runtime 0.533430, Loss 0.919514, forward nfe 954, backward nfe 132, Train: 0.9000, Val: 0.6743, Test: 0.6793, Best time: 2.2931
Epoch: 009/100, Runtime 0.486513, Loss 0.882272, forward nfe 1084, backward nfe 150, Train: 0.9000, Val: 0.6806, Test: 0.6851, Best time: 2.2538
Epoch: 010/100, Runtime 0.518963, Loss 0.809029, forward nfe 1202, backward nfe 171, Train: 0.9000, Val: 0.6854, Test: 0.6880, Best time: 2.2165
Epoch: 011/100, Runtime 0.521334, Loss 0.761671, forward nfe 1320, backward nfe 192, Train: 0.9000, Val: 0.6875, Test: 0.6920, Best time: 2.1794
Epoch: 012/100, Runtime 0.549884, Loss 0.689274, forward nfe 1438, backward nfe 214, Train: 0.9167, Val: 0.6937, Test: 0.6975, Best time: 2.1420
Epoch: 013/100, Runtime 0.546715, Loss 0.626315, forward nfe 1556, backward nfe 236, Train: 0.9333, Val: 0.7021, Test: 0.7107, Best time: 2.1034
Epoch: 014/100, Runtime 0.572836, Loss 0.569715, forward nfe 1674, backward nfe 260, Train: 0.8833, Val: 0.7167, Test: 0.7220, Best time: 15.5614
Epoch: 015/100, Runtime 0.523037, Loss 0.497963, forward nfe 1792, backward nfe 281, Train: 0.8833, Val: 0.7347, Test: 0.7366, Best time: 23.4678
Epoch: 016/100, Runtime 0.520434, Loss 0.467876, forward nfe 1904, backward nfe 302, Train: 0.8667, Val: 0.7493, Test: 0.7533, Best time: 34.8661
Epoch: 017/100, Runtime 0.535237, Loss 0.423659, forward nfe 2016, backward nfe 324, Train: 0.8667, Val: 0.7493, Test: 0.7533, Best time: 10.0000
Epoch: 018/100, Runtime 0.525526, Loss 0.367723, forward nfe 2128, backward nfe 345, Train: 0.8667, Val: 0.7493, Test: 0.7533, Best time: 10.0000
Epoch: 019/100, Runtime 0.494448, Loss 0.341369, forward nfe 2240, backward nfe 363, Train: 0.8667, Val: 0.7493, Test: 0.7533, Best time: 10.0000
Epoch: 020/100, Runtime 0.476852, Loss 0.296648, forward nfe 2346, backward nfe 382, Train: 0.9167, Val: 0.7542, Test: 0.7663, Best time: 55.3354
Epoch: 021/100, Runtime 0.444885, Loss 0.264513, forward nfe 2452, backward nfe 400, Train: 0.9167, Val: 0.7674, Test: 0.7764, Best time: 50.5991
Epoch: 022/100, Runtime 0.447852, Loss 0.248511, forward nfe 2552, backward nfe 419, Train: 0.9167, Val: 0.7674, Test: 0.7764, Best time: 10.0000
Epoch: 023/100, Runtime 0.446255, Loss 0.217745, forward nfe 2652, backward nfe 435, Train: 0.9167, Val: 0.7674, Test: 0.7764, Best time: 10.0000
Epoch: 024/100, Runtime 0.437115, Loss 0.185954, forward nfe 2752, backward nfe 450, Train: 0.9167, Val: 0.7674, Test: 0.7764, Best time: 10.0000
Epoch: 025/100, Runtime 0.457360, Loss 0.173790, forward nfe 2858, backward nfe 466, Train: 0.9167, Val: 0.7674, Test: 0.7764, Best time: 10.0000
Epoch: 026/100, Runtime 0.454319, Loss 0.181268, forward nfe 2964, backward nfe 482, Train: 0.9167, Val: 0.7674, Test: 0.7764, Best time: 10.0000
Epoch: 027/100, Runtime 0.412113, Loss 0.122892, forward nfe 3070, backward nfe 498, Train: 0.9833, Val: 0.7688, Test: 0.7677, Best time: 10.0000
Epoch: 028/100, Runtime 0.396945, Loss 0.187074, forward nfe 3164, backward nfe 512, Train: 0.9833, Val: 0.7688, Test: 0.7677, Best time: 10.0000
Epoch: 029/100, Runtime 0.403676, Loss 0.173232, forward nfe 3258, backward nfe 528, Train: 0.9833, Val: 0.7688, Test: 0.7677, Best time: 10.0000
Epoch: 030/100, Runtime 0.384589, Loss 0.138034, forward nfe 3352, backward nfe 541, Train: 0.9833, Val: 0.7688, Test: 0.7677, Best time: 10.0000
Epoch: 031/100, Runtime 0.389035, Loss 0.158865, forward nfe 3446, backward nfe 554, Train: 0.9833, Val: 0.7688, Test: 0.7677, Best time: 10.0000
Epoch: 032/100, Runtime 0.373543, Loss 0.163783, forward nfe 3540, backward nfe 566, Train: 0.9833, Val: 0.7688, Test: 0.7677, Best time: 10.0000
Epoch: 033/100, Runtime 0.381838, Loss 0.142851, forward nfe 3634, backward nfe 578, Train: 0.9833, Val: 0.7688, Test: 0.7677, Best time: 10.0000
Epoch: 034/100, Runtime 0.385994, Loss 0.145922, forward nfe 3728, backward nfe 593, Train: 0.9833, Val: 0.7688, Test: 0.7677, Best time: 10.0000
Epoch: 035/100, Runtime 0.337440, Loss 0.145153, forward nfe 3816, backward nfe 604, Train: 1.0000, Val: 0.7701, Test: 0.7722, Best time: 10.0000
Epoch: 036/100, Runtime 0.366115, Loss 0.148622, forward nfe 3898, backward nfe 618, Train: 1.0000, Val: 0.7729, Test: 0.7690, Best time: 43.3282
Epoch: 037/100, Runtime 0.347327, Loss 0.101286, forward nfe 3980, backward nfe 630, Train: 1.0000, Val: 0.7729, Test: 0.7690, Best time: 10.0000
Epoch: 038/100, Runtime 0.343086, Loss 0.126640, forward nfe 4056, backward nfe 642, Train: 1.0000, Val: 0.7729, Test: 0.7690, Best time: 10.0000
Epoch: 039/100, Runtime 0.357280, Loss 0.105499, forward nfe 4138, backward nfe 655, Train: 1.0000, Val: 0.7729, Test: 0.7690, Best time: 10.0000
Epoch: 040/100, Runtime 0.321048, Loss 0.083666, forward nfe 4220, backward nfe 666, Train: 1.0000, Val: 0.7729, Test: 0.7690, Best time: 10.0000
Epoch: 041/100, Runtime 0.349309, Loss 0.125918, forward nfe 4296, backward nfe 679, Train: 1.0000, Val: 0.7729, Test: 0.7690, Best time: 10.0000
Epoch: 042/100, Runtime 0.336959, Loss 0.092876, forward nfe 4378, backward nfe 692, Train: 1.0000, Val: 0.7729, Test: 0.7690, Best time: 10.0000
Epoch: 043/100, Runtime 0.304870, Loss 0.093933, forward nfe 4454, backward nfe 703, Train: 1.0000, Val: 0.7729, Test: 0.7690, Best time: 10.0000
Epoch: 044/100, Runtime 0.311950, Loss 0.105964, forward nfe 4524, backward nfe 715, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 045/100, Runtime 0.313353, Loss 0.111118, forward nfe 4594, backward nfe 725, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 046/100, Runtime 0.356105, Loss 0.147422, forward nfe 4670, backward nfe 739, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 047/100, Runtime 0.318805, Loss 0.077117, forward nfe 4746, backward nfe 750, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 048/100, Runtime 0.329790, Loss 0.088277, forward nfe 4822, backward nfe 762, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 049/100, Runtime 0.311294, Loss 0.084030, forward nfe 4898, backward nfe 773, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 050/100, Runtime 0.327971, Loss 0.084280, forward nfe 4974, backward nfe 785, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 051/100, Runtime 0.339067, Loss 0.076424, forward nfe 5050, backward nfe 798, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 052/100, Runtime 0.307775, Loss 0.078782, forward nfe 5126, backward nfe 808, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 053/100, Runtime 0.323778, Loss 0.071861, forward nfe 5202, backward nfe 819, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 054/100, Runtime 0.310001, Loss 0.085263, forward nfe 5278, backward nfe 829, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 055/100, Runtime 0.315233, Loss 0.076322, forward nfe 5354, backward nfe 840, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 056/100, Runtime 0.320138, Loss 0.085354, forward nfe 5430, backward nfe 850, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 057/100, Runtime 0.328584, Loss 0.094529, forward nfe 5506, backward nfe 862, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 058/100, Runtime 0.310734, Loss 0.075345, forward nfe 5582, backward nfe 872, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 059/100, Runtime 0.318028, Loss 0.072319, forward nfe 5658, backward nfe 883, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 060/100, Runtime 0.291008, Loss 0.086290, forward nfe 5734, backward nfe 891, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 061/100, Runtime 0.322351, Loss 0.078086, forward nfe 5810, backward nfe 902, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 062/100, Runtime 0.318880, Loss 0.116272, forward nfe 5886, backward nfe 913, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 063/100, Runtime 0.309438, Loss 0.057585, forward nfe 5962, backward nfe 923, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 064/100, Runtime 0.318162, Loss 0.104847, forward nfe 6038, backward nfe 934, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 065/100, Runtime 0.309297, Loss 0.063757, forward nfe 6114, backward nfe 944, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 066/100, Runtime 0.300413, Loss 0.074904, forward nfe 6190, backward nfe 954, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 067/100, Runtime 0.321139, Loss 0.107640, forward nfe 6266, backward nfe 965, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 068/100, Runtime 0.298295, Loss 0.070834, forward nfe 6342, backward nfe 974, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 069/100, Runtime 0.296505, Loss 0.103835, forward nfe 6418, backward nfe 983, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 070/100, Runtime 0.317932, Loss 0.054358, forward nfe 6494, backward nfe 993, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 071/100, Runtime 0.314898, Loss 0.088439, forward nfe 6570, backward nfe 1004, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 072/100, Runtime 0.269707, Loss 0.088640, forward nfe 6646, backward nfe 1013, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 073/100, Runtime 0.273755, Loss 0.055287, forward nfe 6710, backward nfe 1023, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 074/100, Runtime 0.275309, Loss 0.077153, forward nfe 6774, backward nfe 1033, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 075/100, Runtime 0.266480, Loss 0.069782, forward nfe 6838, backward nfe 1042, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 076/100, Runtime 0.294510, Loss 0.080640, forward nfe 6902, backward nfe 1054, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 077/100, Runtime 0.286050, Loss 0.062562, forward nfe 6966, backward nfe 1064, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 078/100, Runtime 0.267056, Loss 0.061003, forward nfe 7030, backward nfe 1073, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 079/100, Runtime 0.278757, Loss 0.062296, forward nfe 7094, backward nfe 1083, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 080/100, Runtime 0.266422, Loss 0.075778, forward nfe 7158, backward nfe 1092, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 081/100, Runtime 0.277633, Loss 0.055571, forward nfe 7222, backward nfe 1102, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 082/100, Runtime 0.272229, Loss 0.072563, forward nfe 7286, backward nfe 1111, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 083/100, Runtime 0.296230, Loss 0.084888, forward nfe 7350, backward nfe 1122, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 084/100, Runtime 0.291006, Loss 0.065614, forward nfe 7414, backward nfe 1132, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 085/100, Runtime 0.272253, Loss 0.062232, forward nfe 7478, backward nfe 1141, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 086/100, Runtime 0.268773, Loss 0.046368, forward nfe 7542, backward nfe 1150, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 087/100, Runtime 0.267911, Loss 0.056571, forward nfe 7606, backward nfe 1159, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 088/100, Runtime 0.289689, Loss 0.057754, forward nfe 7670, backward nfe 1170, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 089/100, Runtime 0.281563, Loss 0.035511, forward nfe 7734, backward nfe 1181, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 090/100, Runtime 0.279422, Loss 0.029742, forward nfe 7798, backward nfe 1192, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 091/100, Runtime 0.264985, Loss 0.054338, forward nfe 7862, backward nfe 1201, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 092/100, Runtime 0.278244, Loss 0.041423, forward nfe 7926, backward nfe 1210, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 093/100, Runtime 0.270501, Loss 0.050364, forward nfe 7990, backward nfe 1220, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 094/100, Runtime 0.270213, Loss 0.051730, forward nfe 8054, backward nfe 1229, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 095/100, Runtime 0.275514, Loss 0.082034, forward nfe 8118, backward nfe 1239, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 096/100, Runtime 0.268971, Loss 0.058539, forward nfe 8182, backward nfe 1248, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 097/100, Runtime 0.296899, Loss 0.111719, forward nfe 8246, backward nfe 1259, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 098/100, Runtime 0.273052, Loss 0.048426, forward nfe 8310, backward nfe 1269, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
Epoch: 099/100, Runtime 0.279603, Loss 0.030326, forward nfe 8374, backward nfe 1279, Train: 1.0000, Val: 0.7792, Test: 0.7776, Best time: 10.0000
best val accuracy 0.779167 with test accuracy 0.777625 at epoch 44 and best time 10.000000