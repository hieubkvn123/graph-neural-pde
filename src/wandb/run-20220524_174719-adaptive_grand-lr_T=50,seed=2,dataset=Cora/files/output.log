/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 5.192812, Loss 1.946487, forward nfe 104, backward nfe 0, Train: 0.1571, Val: 0.1066, Test: 0.0944, Best time: 0.0927
Epoch: 002/100, Runtime 6.001580, Loss 1.858202, forward nfe 498, backward nfe 0, Train: 0.6286, Val: 0.5081, Test: 0.4975, Best time: 0.9917
Epoch: 003/100, Runtime 5.821542, Loss 1.650123, forward nfe 886, backward nfe 0, Train: 0.7786, Val: 0.7574, Test: 0.7431, Best time: 7.5296
Epoch: 004/100, Runtime 5.717727, Loss 1.378085, forward nfe 1262, backward nfe 0, Train: 0.8214, Val: 0.7816, Test: 0.7736, Best time: 5.5867
Epoch: 005/100, Runtime 5.581708, Loss 1.147619, forward nfe 1626, backward nfe 0, Train: 0.8643, Val: 0.7904, Test: 0.7797, Best time: 3.9200
Epoch: 006/100, Runtime 5.401290, Loss 0.904536, forward nfe 1984, backward nfe 0, Train: 0.8429, Val: 0.8096, Test: 0.7929, Best time: 8.1505
Epoch: 007/100, Runtime 5.348980, Loss 0.765285, forward nfe 2336, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 14.9608
Epoch: 008/100, Runtime 5.273572, Loss 0.631690, forward nfe 2682, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 009/100, Runtime 5.051889, Loss 0.516905, forward nfe 3016, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 010/100, Runtime 4.954017, Loss 0.522534, forward nfe 3344, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 011/100, Runtime 4.851754, Loss 0.466754, forward nfe 3666, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 012/100, Runtime 4.674387, Loss 0.423796, forward nfe 3976, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 013/100, Runtime 4.552269, Loss 0.399855, forward nfe 4268, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 014/100, Runtime 4.475735, Loss 0.373338, forward nfe 4554, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 015/100, Runtime 4.324059, Loss 0.353874, forward nfe 4834, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 016/100, Runtime 4.427691, Loss 0.303628, forward nfe 5120, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 017/100, Runtime 4.178663, Loss 0.351470, forward nfe 5400, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 018/100, Runtime 4.080119, Loss 0.330779, forward nfe 5662, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 019/100, Runtime 3.840481, Loss 0.302280, forward nfe 5918, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 020/100, Runtime 3.795269, Loss 0.319593, forward nfe 6162, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 021/100, Runtime 3.798724, Loss 0.338393, forward nfe 6406, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 022/100, Runtime 3.873010, Loss 0.254320, forward nfe 6650, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 023/100, Runtime 3.747899, Loss 0.264628, forward nfe 6888, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 024/100, Runtime 3.690748, Loss 0.322713, forward nfe 7132, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 025/100, Runtime 3.675538, Loss 0.233037, forward nfe 7364, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 026/100, Runtime 3.395653, Loss 0.231632, forward nfe 7590, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 027/100, Runtime 3.548934, Loss 0.255940, forward nfe 7810, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 028/100, Runtime 3.476155, Loss 0.192238, forward nfe 8024, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 029/100, Runtime 3.393712, Loss 0.194772, forward nfe 8238, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 030/100, Runtime 3.560480, Loss 0.204691, forward nfe 8452, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 031/100, Runtime 3.348861, Loss 0.237317, forward nfe 8666, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 032/100, Runtime 3.272264, Loss 0.238384, forward nfe 8886, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 033/100, Runtime 3.392281, Loss 0.188478, forward nfe 9100, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 034/100, Runtime 3.200459, Loss 0.258294, forward nfe 9296, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 035/100, Runtime 3.086656, Loss 0.216007, forward nfe 9492, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 036/100, Runtime 3.311582, Loss 0.188243, forward nfe 9694, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 037/100, Runtime 3.161244, Loss 0.168151, forward nfe 9896, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 038/100, Runtime 3.073858, Loss 0.156276, forward nfe 10086, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 039/100, Runtime 3.023030, Loss 0.176262, forward nfe 10276, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 040/100, Runtime 2.948584, Loss 0.154630, forward nfe 10466, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 041/100, Runtime 3.166692, Loss 0.127906, forward nfe 10656, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 042/100, Runtime 2.997566, Loss 0.160474, forward nfe 10840, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 043/100, Runtime 3.098655, Loss 0.112423, forward nfe 11024, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 044/100, Runtime 2.934479, Loss 0.101262, forward nfe 11208, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 045/100, Runtime 2.723284, Loss 0.106926, forward nfe 11392, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 046/100, Runtime 2.800371, Loss 0.137317, forward nfe 11564, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 047/100, Runtime 2.753090, Loss 0.120667, forward nfe 11730, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 048/100, Runtime 2.731952, Loss 0.108385, forward nfe 11902, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 049/100, Runtime 2.831313, Loss 0.112687, forward nfe 12074, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 050/100, Runtime 2.823154, Loss 0.114153, forward nfe 12246, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 051/100, Runtime 2.880926, Loss 0.135985, forward nfe 12418, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 052/100, Runtime 3.015494, Loss 0.120346, forward nfe 12596, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 053/100, Runtime 2.693571, Loss 0.096216, forward nfe 12774, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 054/100, Runtime 2.707551, Loss 0.090532, forward nfe 12946, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 055/100, Runtime 2.904384, Loss 0.078623, forward nfe 13118, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 056/100, Runtime 2.659955, Loss 0.103395, forward nfe 13290, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 057/100, Runtime 2.790033, Loss 0.094248, forward nfe 13462, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 058/100, Runtime 2.920850, Loss 0.078257, forward nfe 13634, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 059/100, Runtime 2.777274, Loss 0.095390, forward nfe 13806, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 060/100, Runtime 2.803765, Loss 0.078330, forward nfe 13978, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 061/100, Runtime 2.873653, Loss 0.102854, forward nfe 14150, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 062/100, Runtime 2.783215, Loss 0.100066, forward nfe 14322, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 063/100, Runtime 2.702555, Loss 0.101127, forward nfe 14494, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 064/100, Runtime 2.748939, Loss 0.072654, forward nfe 14666, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 065/100, Runtime 2.798636, Loss 0.061969, forward nfe 14838, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 066/100, Runtime 2.749243, Loss 0.075731, forward nfe 15010, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 067/100, Runtime 2.779948, Loss 0.077849, forward nfe 15182, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 068/100, Runtime 2.881138, Loss 0.081417, forward nfe 15354, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 069/100, Runtime 2.744352, Loss 0.039009, forward nfe 15526, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 070/100, Runtime 2.788649, Loss 0.081177, forward nfe 15698, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 071/100, Runtime 2.902994, Loss 0.083967, forward nfe 15870, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 072/100, Runtime 2.739134, Loss 0.043948, forward nfe 16042, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 073/100, Runtime 2.772867, Loss 0.050157, forward nfe 16214, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 074/100, Runtime 2.856701, Loss 0.088249, forward nfe 16386, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 075/100, Runtime 2.733289, Loss 0.049517, forward nfe 16558, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 076/100, Runtime 2.650457, Loss 0.044058, forward nfe 16724, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 077/100, Runtime 2.630846, Loss 0.060026, forward nfe 16890, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 078/100, Runtime 2.722046, Loss 0.032893, forward nfe 17056, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 079/100, Runtime 2.778707, Loss 0.051471, forward nfe 17222, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 080/100, Runtime 2.655198, Loss 0.058879, forward nfe 17388, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 081/100, Runtime 2.695156, Loss 0.035592, forward nfe 17554, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 082/100, Runtime 2.688279, Loss 0.049281, forward nfe 17720, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 083/100, Runtime 2.721023, Loss 0.071121, forward nfe 17886, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 084/100, Runtime 2.767583, Loss 0.054455, forward nfe 18052, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 085/100, Runtime 2.673086, Loss 0.060681, forward nfe 18218, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 086/100, Runtime 2.822030, Loss 0.051543, forward nfe 18384, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 087/100, Runtime 2.989992, Loss 0.043585, forward nfe 18556, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 088/100, Runtime 3.042037, Loss 0.043669, forward nfe 18740, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 089/100, Runtime 3.231715, Loss 0.042202, forward nfe 18930, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 090/100, Runtime 3.412495, Loss 0.041753, forward nfe 19126, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 091/100, Runtime 3.195908, Loss 0.043502, forward nfe 19328, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 092/100, Runtime 3.207148, Loss 0.042879, forward nfe 19524, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 093/100, Runtime 3.193774, Loss 0.058738, forward nfe 19720, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 094/100, Runtime 3.151059, Loss 0.061071, forward nfe 19916, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 095/100, Runtime 3.186658, Loss 0.098141, forward nfe 20106, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 096/100, Runtime 3.097678, Loss 0.093354, forward nfe 20296, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 097/100, Runtime 3.138273, Loss 0.038176, forward nfe 20486, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 098/100, Runtime 2.994596, Loss 0.103760, forward nfe 20676, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
Epoch: 099/100, Runtime 3.125493, Loss 0.032188, forward nfe 20860, backward nfe 0, Train: 0.8571, Val: 0.8360, Test: 0.8294, Best time: 50.0000
best val accuracy 0.836029 with test accuracy 0.829442 at epoch 7 and best time 50.000000