/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 4.497836, Loss 1.947705, forward nfe 146, backward nfe 0, Train: 0.1929, Val: 0.1125, Test: 0.1208, Best time: 0.0918
Epoch: 002/100, Runtime 4.275171, Loss 2.009141, forward nfe 708, backward nfe 0, Train: 0.1929, Val: 0.1125, Test: 0.1208, Best time: 75.0000
Epoch: 003/100, Runtime 4.297195, Loss 1.950921, forward nfe 1270, backward nfe 0, Train: 0.1929, Val: 0.1125, Test: 0.1208, Best time: 75.0000
Epoch: 004/100, Runtime 4.267510, Loss 1.927544, forward nfe 1826, backward nfe 0, Train: 0.2143, Val: 0.1412, Test: 0.1655, Best time: 0.0838
Epoch: 005/100, Runtime 4.176957, Loss 1.839529, forward nfe 2364, backward nfe 0, Train: 0.7857, Val: 0.7412, Test: 0.7188, Best time: 27.1201
Epoch: 006/100, Runtime 3.703010, Loss 1.699373, forward nfe 2890, backward nfe 0, Train: 0.7857, Val: 0.7412, Test: 0.7188, Best time: 75.0000
Epoch: 007/100, Runtime 3.886272, Loss 1.564531, forward nfe 3398, backward nfe 0, Train: 0.7857, Val: 0.7412, Test: 0.7188, Best time: 75.0000
Epoch: 008/100, Runtime 3.790579, Loss 1.337681, forward nfe 3894, backward nfe 0, Train: 0.7857, Val: 0.7412, Test: 0.7188, Best time: 75.0000
Epoch: 009/100, Runtime 3.880976, Loss 1.143970, forward nfe 4384, backward nfe 0, Train: 0.8357, Val: 0.7728, Test: 0.7635, Best time: 49.4054
Epoch: 010/100, Runtime 3.651843, Loss 0.977697, forward nfe 4856, backward nfe 0, Train: 0.8500, Val: 0.8118, Test: 0.7949, Best time: 129.3798
Epoch: 011/100, Runtime 3.594069, Loss 0.767317, forward nfe 5328, backward nfe 0, Train: 0.8500, Val: 0.8118, Test: 0.7949, Best time: 75.0000
Epoch: 012/100, Runtime 3.430967, Loss 0.713723, forward nfe 5788, backward nfe 0, Train: 0.8500, Val: 0.8118, Test: 0.7949, Best time: 75.0000
Epoch: 013/100, Runtime 3.459868, Loss 0.633175, forward nfe 6236, backward nfe 0, Train: 0.8500, Val: 0.8118, Test: 0.7949, Best time: 75.0000
Epoch: 014/100, Runtime 3.476200, Loss 0.540224, forward nfe 6672, backward nfe 0, Train: 0.8500, Val: 0.8118, Test: 0.7949, Best time: 75.0000
Epoch: 015/100, Runtime 3.368438, Loss 0.528339, forward nfe 7096, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 41.5383
Epoch: 016/100, Runtime 3.539287, Loss 0.503990, forward nfe 7502, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 017/100, Runtime 4.136944, Loss 0.410652, forward nfe 7896, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 018/100, Runtime 3.921263, Loss 0.407614, forward nfe 8290, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 019/100, Runtime 3.915687, Loss 0.376260, forward nfe 8678, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 020/100, Runtime 3.820574, Loss 0.418874, forward nfe 9054, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 021/100, Runtime 4.133598, Loss 0.417358, forward nfe 9418, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 022/100, Runtime 3.772541, Loss 0.396991, forward nfe 9770, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 023/100, Runtime 3.541221, Loss 0.411303, forward nfe 10116, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 024/100, Runtime 4.006660, Loss 0.474077, forward nfe 10456, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 025/100, Runtime 3.819638, Loss 0.393794, forward nfe 10802, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 026/100, Runtime 2.548630, Loss 0.337039, forward nfe 11136, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 027/100, Runtime 2.379858, Loss 0.360355, forward nfe 11464, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 028/100, Runtime 2.379740, Loss 0.278260, forward nfe 11780, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 029/100, Runtime 2.415443, Loss 0.314106, forward nfe 12084, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 030/100, Runtime 2.535894, Loss 0.305262, forward nfe 12388, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 031/100, Runtime 2.446560, Loss 0.278634, forward nfe 12698, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 032/100, Runtime 2.510324, Loss 0.336892, forward nfe 13002, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 033/100, Runtime 2.467762, Loss 0.279545, forward nfe 13306, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 034/100, Runtime 2.386241, Loss 0.224002, forward nfe 13604, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 035/100, Runtime 2.320933, Loss 0.282319, forward nfe 13890, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 036/100, Runtime 2.158587, Loss 0.266542, forward nfe 14170, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 037/100, Runtime 2.044507, Loss 0.218386, forward nfe 14450, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 038/100, Runtime 2.947589, Loss 0.252847, forward nfe 14730, backward nfe 0, Train: 0.8929, Val: 0.8257, Test: 0.8162, Best time: 75.0000
Epoch: 039/100, Runtime 3.180172, Loss 0.222827, forward nfe 15004, backward nfe 0, Train: 0.9571, Val: 0.8279, Test: 0.8274, Best time: 111.5446
Epoch: 040/100, Runtime 3.141720, Loss 0.195456, forward nfe 15278, backward nfe 0, Train: 0.9571, Val: 0.8279, Test: 0.8274, Best time: 75.0000
Epoch: 041/100, Runtime 2.765815, Loss 0.182367, forward nfe 15552, backward nfe 0, Train: 0.9571, Val: 0.8279, Test: 0.8274, Best time: 75.0000
Epoch: 042/100, Runtime 3.084528, Loss 0.275964, forward nfe 15814, backward nfe 0, Train: 0.9571, Val: 0.8279, Test: 0.8274, Best time: 75.0000
Epoch: 043/100, Runtime 2.941942, Loss 0.214916, forward nfe 16070, backward nfe 0, Train: 0.9571, Val: 0.8279, Test: 0.8274, Best time: 75.0000
Epoch: 044/100, Runtime 3.048818, Loss 0.245138, forward nfe 16326, backward nfe 0, Train: 0.9571, Val: 0.8279, Test: 0.8274, Best time: 75.0000
Epoch: 045/100, Runtime 3.017170, Loss 0.164032, forward nfe 16582, backward nfe 0, Train: 0.9571, Val: 0.8279, Test: 0.8274, Best time: 75.0000
Epoch: 046/100, Runtime 2.860559, Loss 0.195562, forward nfe 16838, backward nfe 0, Train: 0.9571, Val: 0.8279, Test: 0.8274, Best time: 75.0000
Epoch: 047/100, Runtime 2.811060, Loss 0.127747, forward nfe 17082, backward nfe 0, Train: 0.9571, Val: 0.8279, Test: 0.8274, Best time: 75.0000
Epoch: 048/100, Runtime 2.840206, Loss 0.163125, forward nfe 17326, backward nfe 0, Train: 0.9571, Val: 0.8279, Test: 0.8274, Best time: 75.0000
Epoch: 049/100, Runtime 2.772246, Loss 0.179772, forward nfe 17570, backward nfe 0, Train: 0.9571, Val: 0.8279, Test: 0.8274, Best time: 75.0000
Epoch: 050/100, Runtime 2.032964, Loss 0.124564, forward nfe 17808, backward nfe 0, Train: 0.9571, Val: 0.8279, Test: 0.8274, Best time: 75.0000
Epoch: 051/100, Runtime 1.885861, Loss 0.188072, forward nfe 18046, backward nfe 0, Train: 0.9571, Val: 0.8279, Test: 0.8274, Best time: 75.0000
Epoch: 052/100, Runtime 1.916918, Loss 0.162539, forward nfe 18290, backward nfe 0, Train: 0.9571, Val: 0.8279, Test: 0.8274, Best time: 75.0000
Epoch: 053/100, Runtime 1.959893, Loss 0.156959, forward nfe 18522, backward nfe 0, Train: 0.9571, Val: 0.8279, Test: 0.8274, Best time: 75.0000
Epoch: 054/100, Runtime 1.879158, Loss 0.145928, forward nfe 18754, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 125.1036
Epoch: 055/100, Runtime 1.967682, Loss 0.142603, forward nfe 18980, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 056/100, Runtime 1.897099, Loss 0.166141, forward nfe 19206, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 057/100, Runtime 1.866696, Loss 0.125935, forward nfe 19432, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 058/100, Runtime 1.899948, Loss 0.138499, forward nfe 19658, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 059/100, Runtime 1.852602, Loss 0.133081, forward nfe 19884, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 060/100, Runtime 1.816022, Loss 0.140656, forward nfe 20104, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 061/100, Runtime 1.834670, Loss 0.086422, forward nfe 20324, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 062/100, Runtime 1.837365, Loss 0.141493, forward nfe 20544, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 063/100, Runtime 1.826305, Loss 0.161085, forward nfe 20764, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 064/100, Runtime 1.828327, Loss 0.093235, forward nfe 20984, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 065/100, Runtime 1.851736, Loss 0.090328, forward nfe 21204, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 066/100, Runtime 1.833039, Loss 0.139753, forward nfe 21424, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 067/100, Runtime 1.836667, Loss 0.116326, forward nfe 21644, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 068/100, Runtime 1.813064, Loss 0.141529, forward nfe 21864, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 069/100, Runtime 1.898738, Loss 0.081884, forward nfe 22084, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 070/100, Runtime 1.822816, Loss 0.126473, forward nfe 22304, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 071/100, Runtime 1.800940, Loss 0.090532, forward nfe 22524, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 072/100, Runtime 1.784705, Loss 0.114835, forward nfe 22744, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 073/100, Runtime 1.874602, Loss 0.084546, forward nfe 22964, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 074/100, Runtime 1.829108, Loss 0.139634, forward nfe 23184, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 075/100, Runtime 1.831250, Loss 0.142806, forward nfe 23404, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 076/100, Runtime 1.851911, Loss 0.064796, forward nfe 23624, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 077/100, Runtime 1.886207, Loss 0.075637, forward nfe 23844, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 078/100, Runtime 1.809731, Loss 0.097992, forward nfe 24064, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 079/100, Runtime 1.821622, Loss 0.081664, forward nfe 24284, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 080/100, Runtime 1.863064, Loss 0.086309, forward nfe 24504, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 081/100, Runtime 1.775103, Loss 0.079647, forward nfe 24724, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 082/100, Runtime 1.721936, Loss 0.103277, forward nfe 24938, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 083/100, Runtime 1.683119, Loss 0.065091, forward nfe 25152, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 084/100, Runtime 1.723397, Loss 0.082728, forward nfe 25366, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 085/100, Runtime 1.755596, Loss 0.105777, forward nfe 25580, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 086/100, Runtime 1.708194, Loss 0.094023, forward nfe 25794, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 087/100, Runtime 1.722812, Loss 0.060153, forward nfe 26008, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 088/100, Runtime 1.746953, Loss 0.074155, forward nfe 26222, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 089/100, Runtime 1.801020, Loss 0.084268, forward nfe 26436, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 090/100, Runtime 1.806855, Loss 0.046377, forward nfe 26650, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 091/100, Runtime 1.783326, Loss 0.046847, forward nfe 26864, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 092/100, Runtime 1.811389, Loss 0.075578, forward nfe 27078, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 093/100, Runtime 1.860867, Loss 0.039597, forward nfe 27292, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 094/100, Runtime 1.767658, Loss 0.058381, forward nfe 27506, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 095/100, Runtime 1.738466, Loss 0.066005, forward nfe 27720, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 096/100, Runtime 1.778192, Loss 0.109200, forward nfe 27934, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 097/100, Runtime 1.827803, Loss 0.130557, forward nfe 28148, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 098/100, Runtime 1.778358, Loss 0.049394, forward nfe 28362, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
Epoch: 099/100, Runtime 1.794194, Loss 0.102468, forward nfe 28576, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8325, Best time: 75.0000
best val accuracy 0.841176 with test accuracy 0.832487 at epoch 54 and best time 75.000000