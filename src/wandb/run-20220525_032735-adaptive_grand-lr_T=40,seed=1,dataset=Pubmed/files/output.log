/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 35.077207, Loss 1.100533, forward nfe 92, backward nfe 3445, Train: 0.5667, Val: 0.5736, Test: 0.5765, Best time: 16.0560
Epoch: 002/100, Runtime 46.553073, Loss 1.097138, forward nfe 564, backward nfe 8099, Train: 0.7500, Val: 0.7042, Test: 0.7037, Best time: 52.4678
Epoch: 003/100, Runtime 58.496210, Loss 1.089969, forward nfe 1030, backward nfe 14354, Train: 0.7500, Val: 0.7042, Test: 0.7037, Best time: 40.0000
Epoch: 004/100, Runtime 46.399670, Loss 1.078189, forward nfe 1508, backward nfe 19245, Train: 0.7500, Val: 0.7042, Test: 0.7037, Best time: 40.0000
Epoch: 005/100, Runtime 32.103638, Loss 1.055952, forward nfe 1992, backward nfe 22365, Train: 0.7500, Val: 0.7042, Test: 0.7037, Best time: 40.0000
Epoch: 006/100, Runtime 41.336944, Loss 1.023756, forward nfe 2482, backward nfe 26657, Train: 0.7500, Val: 0.7042, Test: 0.7037, Best time: 40.0000
Epoch: 007/100, Runtime 65.672499, Loss 0.985959, forward nfe 2978, backward nfe 33910, Train: 0.8000, Val: 0.7125, Test: 0.7002, Best time: 0.2181
Epoch: 008/100, Runtime 54.244705, Loss 0.940909, forward nfe 3468, backward nfe 39775, Train: 0.8167, Val: 0.7271, Test: 0.7227, Best time: 2.3570
Epoch: 009/100, Runtime 53.938648, Loss 0.881873, forward nfe 3958, backward nfe 45689, Train: 0.8500, Val: 0.7333, Test: 0.7272, Best time: 2.3182
Epoch: 010/100, Runtime 50.153694, Loss 0.826352, forward nfe 4448, backward nfe 51152, Train: 0.8333, Val: 0.7403, Test: 0.7313, Best time: 5.2896
Epoch: 011/100, Runtime 59.153138, Loss 0.754379, forward nfe 4932, backward nfe 57722, Train: 0.8500, Val: 0.7444, Test: 0.7404, Best time: 2.2444
Epoch: 012/100, Runtime 59.603610, Loss 0.695718, forward nfe 5428, backward nfe 64340, Train: 0.8500, Val: 0.7479, Test: 0.7438, Best time: 2.2093
Epoch: 013/100, Runtime 66.571007, Loss 0.643092, forward nfe 5924, backward nfe 71793, Train: 0.8500, Val: 0.7479, Test: 0.7438, Best time: 40.0000
Epoch: 014/100, Runtime 62.653245, Loss 0.568526, forward nfe 6420, backward nfe 78783, Train: 0.8500, Val: 0.7479, Test: 0.7438, Best time: 40.0000
Epoch: 015/100, Runtime 67.272937, Loss 0.521914, forward nfe 6916, backward nfe 86397, Train: 0.8667, Val: 0.7611, Test: 0.7467, Best time: 5.1711
Epoch: 016/100, Runtime 63.643219, Loss 0.465821, forward nfe 7400, backward nfe 93455, Train: 0.8833, Val: 0.7667, Test: 0.7571, Best time: 8.9404
Epoch: 017/100, Runtime 45.358715, Loss 0.415214, forward nfe 7884, backward nfe 98291, Train: 0.9167, Val: 0.7826, Test: 0.7750, Best time: 5.1688
Epoch: 018/100, Runtime 81.683898, Loss 0.357671, forward nfe 8368, backward nfe 107642, Train: 0.9500, Val: 0.7924, Test: 0.7857, Best time: 5.1732
Epoch: 019/100, Runtime 36.335758, Loss 0.352903, forward nfe 8864, backward nfe 111308, Train: 0.9500, Val: 0.7924, Test: 0.7857, Best time: 40.0000
Epoch: 020/100, Runtime 58.901220, Loss 0.337688, forward nfe 9366, backward nfe 117878, Train: 0.9500, Val: 0.7924, Test: 0.7857, Best time: 40.0000
Epoch: 021/100, Runtime 59.844976, Loss 0.311754, forward nfe 9868, backward nfe 124512, Train: 0.9667, Val: 0.7931, Test: 0.7918, Best time: 9.0894
Epoch: 022/100, Runtime 81.275433, Loss 0.326806, forward nfe 10370, backward nfe 133805, Train: 0.9833, Val: 0.8000, Test: 0.7994, Best time: 14.4269
Epoch: 023/100, Runtime 83.064130, Loss 0.290456, forward nfe 10872, backward nfe 143191, Train: 0.9833, Val: 0.8000, Test: 0.7994, Best time: 40.0000
Epoch: 024/100, Runtime 102.329820, Loss 0.275719, forward nfe 11374, backward nfe 155016, Train: 0.9833, Val: 0.8000, Test: 0.7994, Best time: 40.0000
Epoch: 025/100, Runtime 64.124163, Loss 0.291103, forward nfe 11870, backward nfe 162247, Train: 0.9833, Val: 0.8000, Test: 0.7994, Best time: 40.0000
Epoch: 026/100, Runtime 84.728220, Loss 0.247018, forward nfe 12366, backward nfe 171888, Train: 0.9500, Val: 0.8042, Test: 0.8037, Best time: 9.3726
Epoch: 027/100, Runtime 96.587750, Loss 0.232546, forward nfe 12862, backward nfe 182777, Train: 0.9500, Val: 0.8042, Test: 0.8037, Best time: 40.0000
Epoch: 028/100, Runtime 91.826749, Loss 0.259834, forward nfe 13358, backward nfe 193197, Train: 0.9500, Val: 0.8042, Test: 0.8037, Best time: 40.0000
Epoch: 029/100, Runtime 201.247648, Loss 0.299214, forward nfe 13854, backward nfe 217160, Train: 0.9500, Val: 0.8042, Test: 0.8037, Best time: 40.0000
Epoch: 030/100, Runtime 154.196716, Loss 0.239400, forward nfe 14356, backward nfe 235354, Train: 0.9500, Val: 0.8042, Test: 0.8037, Best time: 40.0000
Epoch: 031/100, Runtime 137.680002, Loss 0.237549, forward nfe 14858, backward nfe 251544, Train: 0.9833, Val: 0.8215, Test: 0.8171, Best time: 5.4594
Epoch: 032/100, Runtime 186.699279, Loss 0.258012, forward nfe 15360, backward nfe 273573, Train: 0.9833, Val: 0.8215, Test: 0.8171, Best time: 40.0000
Epoch: 033/100, Runtime 118.108891, Loss 0.269873, forward nfe 15856, backward nfe 287273, Train: 0.9833, Val: 0.8215, Test: 0.8171, Best time: 40.0000
Epoch: 034/100, Runtime 91.700610, Loss 0.231709, forward nfe 16352, backward nfe 297721, Train: 0.9833, Val: 0.8215, Test: 0.8171, Best time: 40.0000
Epoch: 035/100, Runtime 101.955314, Loss 0.241817, forward nfe 16848, backward nfe 309389, Train: 0.9833, Val: 0.8215, Test: 0.8171, Best time: 40.0000
Epoch: 036/100, Runtime 113.992226, Loss 0.206688, forward nfe 17344, backward nfe 322663, Train: 1.0000, Val: 0.8306, Test: 0.8218, Best time: 9.8800
Epoch: 037/100, Runtime 180.453149, Loss 0.233589, forward nfe 17840, backward nfe 343960, Train: 1.0000, Val: 0.8306, Test: 0.8218, Best time: 40.0000
Epoch: 038/100, Runtime 110.477611, Loss 0.239546, forward nfe 18336, backward nfe 356861, Train: 1.0000, Val: 0.8306, Test: 0.8218, Best time: 40.0000
Epoch: 039/100, Runtime 80.372003, Loss 0.234274, forward nfe 18832, backward nfe 366024, Train: 1.0000, Val: 0.8306, Test: 0.8218, Best time: 40.0000
Epoch: 040/100, Runtime 57.696886, Loss 0.246232, forward nfe 19328, backward nfe 372392, Train: 1.0000, Val: 0.8306, Test: 0.8218, Best time: 40.0000
Epoch: 041/100, Runtime 61.906637, Loss 0.176869, forward nfe 19824, backward nfe 379290, Train: 1.0000, Val: 0.8306, Test: 0.8218, Best time: 40.0000
Epoch: 042/100, Runtime 78.427502, Loss 0.219332, forward nfe 20320, backward nfe 388089, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 5.7053
Epoch: 043/100, Runtime 39.162659, Loss 0.193270, forward nfe 20816, backward nfe 392215, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 044/100, Runtime 110.292131, Loss 0.209348, forward nfe 21312, backward nfe 404967, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 045/100, Runtime 64.518670, Loss 0.188073, forward nfe 21808, backward nfe 411995, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 046/100, Runtime 86.005593, Loss 0.193102, forward nfe 22304, backward nfe 421794, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 047/100, Runtime 63.803223, Loss 0.175490, forward nfe 22800, backward nfe 428908, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 048/100, Runtime 76.028713, Loss 0.156609, forward nfe 23296, backward nfe 437498, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 049/100, Runtime 36.827631, Loss 0.169407, forward nfe 23780, backward nfe 441326, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 050/100, Runtime 38.200771, Loss 0.184945, forward nfe 24276, backward nfe 445313, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 051/100, Runtime 30.185784, Loss 0.152369, forward nfe 24766, backward nfe 448308, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 052/100, Runtime 38.701416, Loss 0.130529, forward nfe 25256, backward nfe 452319, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 053/100, Runtime 110.545638, Loss 0.156428, forward nfe 25746, backward nfe 465191, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 054/100, Runtime 50.719942, Loss 0.173527, forward nfe 26236, backward nfe 470729, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 055/100, Runtime 50.121554, Loss 0.175438, forward nfe 26732, backward nfe 476217, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 056/100, Runtime 42.507140, Loss 0.146175, forward nfe 27228, backward nfe 480735, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 057/100, Runtime 47.047340, Loss 0.169823, forward nfe 27724, backward nfe 485860, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 058/100, Runtime 40.356065, Loss 0.169666, forward nfe 28220, backward nfe 490181, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 059/100, Runtime 80.887177, Loss 0.132702, forward nfe 28716, backward nfe 499400, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 060/100, Runtime 54.061305, Loss 0.132568, forward nfe 29212, backward nfe 505238, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 061/100, Runtime 63.992136, Loss 0.132202, forward nfe 29708, backward nfe 512417, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 062/100, Runtime 75.675787, Loss 0.145865, forward nfe 30204, backward nfe 520887, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 063/100, Runtime 29.902581, Loss 0.127612, forward nfe 30700, backward nfe 523871, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 064/100, Runtime 55.775631, Loss 0.146082, forward nfe 31196, backward nfe 530055, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 065/100, Runtime 31.978115, Loss 0.135985, forward nfe 31686, backward nfe 533193, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 066/100, Runtime 31.258985, Loss 0.150530, forward nfe 32176, backward nfe 536283, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 067/100, Runtime 32.438813, Loss 0.105760, forward nfe 32666, backward nfe 539555, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 068/100, Runtime 33.715994, Loss 0.108512, forward nfe 33156, backward nfe 543039, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 069/100, Runtime 30.322150, Loss 0.110453, forward nfe 33646, backward nfe 546048, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 070/100, Runtime 67.863790, Loss 0.124500, forward nfe 34136, backward nfe 553527, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 071/100, Runtime 60.434741, Loss 0.134700, forward nfe 34626, backward nfe 560152, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 072/100, Runtime 31.500245, Loss 0.099337, forward nfe 35116, backward nfe 563259, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 073/100, Runtime 87.349694, Loss 0.092462, forward nfe 35606, backward nfe 573193, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 074/100, Runtime 37.078413, Loss 0.090090, forward nfe 36096, backward nfe 577014, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 075/100, Runtime 47.829481, Loss 0.093631, forward nfe 36586, backward nfe 582128, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 076/100, Runtime 66.942518, Loss 0.109387, forward nfe 37076, backward nfe 589578, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 077/100, Runtime 71.533772, Loss 0.084284, forward nfe 37566, backward nfe 597683, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 078/100, Runtime 74.281912, Loss 0.127963, forward nfe 38056, backward nfe 606101, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 079/100, Runtime 33.144988, Loss 0.099896, forward nfe 38552, backward nfe 609566, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 080/100, Runtime 60.979760, Loss 0.092811, forward nfe 39048, backward nfe 616276, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 081/100, Runtime 47.517282, Loss 0.097399, forward nfe 39550, backward nfe 621399, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 082/100, Runtime 48.309760, Loss 0.084257, forward nfe 40046, backward nfe 626553, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 083/100, Runtime 33.855389, Loss 0.059175, forward nfe 40548, backward nfe 629985, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 084/100, Runtime 49.068646, Loss 0.089165, forward nfe 41050, backward nfe 635215, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 085/100, Runtime 102.330106, Loss 0.075587, forward nfe 41552, backward nfe 646886, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 086/100, Runtime 62.787177, Loss 0.113190, forward nfe 42054, backward nfe 653862, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 087/100, Runtime 47.789391, Loss 0.064447, forward nfe 42556, backward nfe 658905, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 088/100, Runtime 41.939770, Loss 0.063246, forward nfe 43058, backward nfe 663343, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 089/100, Runtime 66.994748, Loss 0.083716, forward nfe 43560, backward nfe 670782, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 090/100, Runtime 33.996529, Loss 0.048890, forward nfe 44056, backward nfe 674222, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 091/100, Runtime 36.026888, Loss 0.073073, forward nfe 44552, backward nfe 677845, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 092/100, Runtime 33.426848, Loss 0.073490, forward nfe 45048, backward nfe 681188, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 093/100, Runtime 33.174805, Loss 0.068216, forward nfe 45544, backward nfe 684511, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 094/100, Runtime 28.010035, Loss 0.058968, forward nfe 46040, backward nfe 687256, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 095/100, Runtime 31.513727, Loss 0.057836, forward nfe 46536, backward nfe 690424, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 096/100, Runtime 33.399555, Loss 0.078337, forward nfe 47032, backward nfe 693838, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 097/100, Runtime 38.502966, Loss 0.079031, forward nfe 47528, backward nfe 697829, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 098/100, Runtime 38.240755, Loss 0.072035, forward nfe 48024, backward nfe 701852, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
Epoch: 099/100, Runtime 57.131147, Loss 0.082393, forward nfe 48520, backward nfe 708169, Train: 0.9833, Val: 0.8326, Test: 0.8244, Best time: 40.0000
best val accuracy 0.832639 with test accuracy 0.824450 at epoch 42 and best time 40.000000