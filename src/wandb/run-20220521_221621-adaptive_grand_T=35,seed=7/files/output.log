/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 2.358374, Loss 1.947196, forward nfe 80, backward nfe 0, Train: 0.4786, Val: 0.3706, Test: 0.3797, Best time: 1.0668
Epoch: 002/100, Runtime 2.385150, Loss 1.948799, forward nfe 372, backward nfe 0, Train: 0.4786, Val: 0.3706, Test: 0.3797, Best time: 35.0000
Epoch: 003/100, Runtime 2.284100, Loss 1.882765, forward nfe 670, backward nfe 0, Train: 0.3929, Val: 0.3728, Test: 0.3655, Best time: 0.0903
Epoch: 004/100, Runtime 2.350621, Loss 1.745083, forward nfe 950, backward nfe 0, Train: 0.7000, Val: 0.5985, Test: 0.5817, Best time: 5.5208
Epoch: 005/100, Runtime 2.170966, Loss 1.548533, forward nfe 1230, backward nfe 0, Train: 0.8571, Val: 0.7125, Test: 0.7066, Best time: 5.6406
Epoch: 006/100, Runtime 2.185762, Loss 1.301265, forward nfe 1504, backward nfe 0, Train: 0.8429, Val: 0.7721, Test: 0.7431, Best time: 7.8802
Epoch: 007/100, Runtime 2.051251, Loss 1.058877, forward nfe 1766, backward nfe 0, Train: 0.9143, Val: 0.8206, Test: 0.8091, Best time: 10.6757
Epoch: 008/100, Runtime 2.180347, Loss 0.809470, forward nfe 2022, backward nfe 0, Train: 0.8929, Val: 0.8331, Test: 0.8234, Best time: 10.9030
Epoch: 009/100, Runtime 1.982692, Loss 0.648392, forward nfe 2278, backward nfe 0, Train: 0.8929, Val: 0.8360, Test: 0.8294, Best time: 11.2386
Epoch: 010/100, Runtime 2.079196, Loss 0.486329, forward nfe 2528, backward nfe 0, Train: 0.8929, Val: 0.8360, Test: 0.8294, Best time: 35.0000
Epoch: 011/100, Runtime 1.930557, Loss 0.402036, forward nfe 2778, backward nfe 0, Train: 0.8929, Val: 0.8360, Test: 0.8294, Best time: 35.0000
Epoch: 012/100, Runtime 1.899910, Loss 0.371399, forward nfe 3010, backward nfe 0, Train: 0.8929, Val: 0.8360, Test: 0.8294, Best time: 35.0000
Epoch: 013/100, Runtime 1.940659, Loss 0.339283, forward nfe 3242, backward nfe 0, Train: 0.8929, Val: 0.8360, Test: 0.8294, Best time: 35.0000
Epoch: 014/100, Runtime 1.844534, Loss 0.305626, forward nfe 3474, backward nfe 0, Train: 0.8929, Val: 0.8360, Test: 0.8294, Best time: 35.0000
Epoch: 015/100, Runtime 1.767423, Loss 0.268416, forward nfe 3700, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 26.4299
Epoch: 016/100, Runtime 1.746642, Loss 0.254997, forward nfe 3920, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 017/100, Runtime 1.645528, Loss 0.313360, forward nfe 4122, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 018/100, Runtime 1.673244, Loss 0.282379, forward nfe 4324, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 019/100, Runtime 1.588028, Loss 0.279004, forward nfe 4532, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 020/100, Runtime 1.580339, Loss 0.352854, forward nfe 4740, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 021/100, Runtime 1.567861, Loss 0.274761, forward nfe 4948, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 022/100, Runtime 1.420570, Loss 0.342689, forward nfe 5138, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 023/100, Runtime 1.420067, Loss 0.308701, forward nfe 5322, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 024/100, Runtime 1.455408, Loss 0.272170, forward nfe 5506, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 025/100, Runtime 1.558304, Loss 0.286794, forward nfe 5690, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 026/100, Runtime 1.519804, Loss 0.211168, forward nfe 5880, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 027/100, Runtime 1.573053, Loss 0.230279, forward nfe 6070, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 028/100, Runtime 1.577904, Loss 0.193131, forward nfe 6260, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 029/100, Runtime 1.480557, Loss 0.205272, forward nfe 6438, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 030/100, Runtime 1.516626, Loss 0.175098, forward nfe 6610, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 031/100, Runtime 1.486265, Loss 0.216631, forward nfe 6782, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 032/100, Runtime 1.371235, Loss 0.177879, forward nfe 6954, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 033/100, Runtime 1.332047, Loss 0.190076, forward nfe 7120, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 034/100, Runtime 1.152752, Loss 0.179319, forward nfe 7280, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 035/100, Runtime 1.835546, Loss 0.152477, forward nfe 7440, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 036/100, Runtime 1.857468, Loss 0.184348, forward nfe 7606, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 037/100, Runtime 1.907858, Loss 0.197954, forward nfe 7778, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 038/100, Runtime 1.879541, Loss 0.132576, forward nfe 7950, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 039/100, Runtime 2.048421, Loss 0.203475, forward nfe 8122, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 040/100, Runtime 2.003551, Loss 0.215759, forward nfe 8294, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 041/100, Runtime 1.638697, Loss 0.203858, forward nfe 8472, backward nfe 0, Train: 0.9429, Val: 0.8390, Test: 0.8345, Best time: 35.0000
Epoch: 042/100, Runtime 1.784467, Loss 0.241803, forward nfe 8638, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8284, Best time: 54.0708
Epoch: 043/100, Runtime 1.759632, Loss 0.219546, forward nfe 8792, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8284, Best time: 35.0000
Epoch: 044/100, Runtime 1.674168, Loss 0.219697, forward nfe 8946, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8284, Best time: 35.0000
Epoch: 045/100, Runtime 1.733025, Loss 0.110012, forward nfe 9106, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8284, Best time: 35.0000
Epoch: 046/100, Runtime 1.689979, Loss 0.088288, forward nfe 9266, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8284, Best time: 35.0000
Epoch: 047/100, Runtime 1.814424, Loss 0.156829, forward nfe 9426, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8284, Best time: 35.0000
Epoch: 048/100, Runtime 1.912098, Loss 0.135061, forward nfe 9586, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8284, Best time: 35.0000
Epoch: 049/100, Runtime 1.808574, Loss 0.095897, forward nfe 9746, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8284, Best time: 35.0000
Epoch: 050/100, Runtime 1.645662, Loss 0.126271, forward nfe 9900, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8284, Best time: 35.0000
Epoch: 051/100, Runtime 1.172173, Loss 0.134171, forward nfe 10054, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8284, Best time: 35.0000
Epoch: 052/100, Runtime 1.245337, Loss 0.077565, forward nfe 10208, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8284, Best time: 35.0000
Epoch: 053/100, Runtime 1.273399, Loss 0.116466, forward nfe 10362, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8284, Best time: 35.0000
Epoch: 054/100, Runtime 1.230725, Loss 0.085824, forward nfe 10516, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8284, Best time: 35.0000
Epoch: 055/100, Runtime 1.288077, Loss 0.079537, forward nfe 10670, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8284, Best time: 35.0000
Epoch: 056/100, Runtime 1.248613, Loss 0.113352, forward nfe 10824, backward nfe 0, Train: 0.9857, Val: 0.8412, Test: 0.8284, Best time: 35.0000
Epoch: 057/100, Runtime 1.366270, Loss 0.095024, forward nfe 10978, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 058/100, Runtime 1.294805, Loss 0.102858, forward nfe 11132, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 059/100, Runtime 1.372392, Loss 0.109800, forward nfe 11286, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 060/100, Runtime 1.310645, Loss 0.118809, forward nfe 11440, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 061/100, Runtime 1.293037, Loss 0.056607, forward nfe 11594, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 062/100, Runtime 1.332212, Loss 0.077617, forward nfe 11748, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 063/100, Runtime 1.211524, Loss 0.068088, forward nfe 11902, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 064/100, Runtime 1.292270, Loss 0.066994, forward nfe 12044, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 065/100, Runtime 1.266520, Loss 0.075846, forward nfe 12192, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 066/100, Runtime 1.273588, Loss 0.090484, forward nfe 12340, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 067/100, Runtime 1.264222, Loss 0.088620, forward nfe 12488, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 068/100, Runtime 1.253063, Loss 0.075499, forward nfe 12636, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 069/100, Runtime 1.249597, Loss 0.097758, forward nfe 12784, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 070/100, Runtime 1.236118, Loss 0.073123, forward nfe 12932, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 071/100, Runtime 1.247680, Loss 0.118745, forward nfe 13080, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 072/100, Runtime 1.311161, Loss 0.038294, forward nfe 13228, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 073/100, Runtime 1.248855, Loss 0.069607, forward nfe 13376, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 074/100, Runtime 1.288618, Loss 0.076673, forward nfe 13524, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 075/100, Runtime 1.248758, Loss 0.075317, forward nfe 13672, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 076/100, Runtime 1.224374, Loss 0.038647, forward nfe 13820, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 077/100, Runtime 1.233489, Loss 0.039093, forward nfe 13962, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 078/100, Runtime 1.239149, Loss 0.066171, forward nfe 14110, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 079/100, Runtime 1.229516, Loss 0.051369, forward nfe 14258, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 080/100, Runtime 1.282417, Loss 0.079826, forward nfe 14406, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 081/100, Runtime 1.332611, Loss 0.061765, forward nfe 14554, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 082/100, Runtime 1.424300, Loss 0.085452, forward nfe 14714, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 083/100, Runtime 1.480242, Loss 0.033035, forward nfe 14874, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 084/100, Runtime 1.388785, Loss 0.050389, forward nfe 15046, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 085/100, Runtime 1.529822, Loss 0.035184, forward nfe 15212, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 086/100, Runtime 1.535807, Loss 0.091251, forward nfe 15390, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 087/100, Runtime 1.622600, Loss 0.042492, forward nfe 15568, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 088/100, Runtime 1.578161, Loss 0.048365, forward nfe 15752, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 089/100, Runtime 1.556812, Loss 0.067969, forward nfe 15936, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 090/100, Runtime 1.578110, Loss 0.052278, forward nfe 16120, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 091/100, Runtime 1.615850, Loss 0.110294, forward nfe 16304, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 092/100, Runtime 1.639774, Loss 0.037429, forward nfe 16494, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 093/100, Runtime 1.661587, Loss 0.051683, forward nfe 16690, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 094/100, Runtime 1.652118, Loss 0.057162, forward nfe 16892, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 095/100, Runtime 1.687374, Loss 0.100629, forward nfe 17088, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 096/100, Runtime 1.530634, Loss 0.030996, forward nfe 17278, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 097/100, Runtime 1.569548, Loss 0.040768, forward nfe 17462, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 098/100, Runtime 1.574808, Loss 0.051985, forward nfe 17646, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
Epoch: 099/100, Runtime 1.579957, Loss 0.060340, forward nfe 17830, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8345, Best time: 35.0000
best val accuracy 0.845588 with test accuracy 0.834518 at epoch 57 and best time 35.000000