/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.459117, Loss 1.794534, forward nfe 122, backward nfe 0, Train: 0.1833, Val: 0.1507, Test: 0.1516, Best time: 0.0416
Epoch: 002/100, Runtime 0.373631, Loss 1.782798, forward nfe 438, backward nfe 0, Train: 0.3167, Val: 0.2348, Test: 0.2274, Best time: 0.0402
Epoch: 003/100, Runtime 0.389110, Loss 1.758892, forward nfe 748, backward nfe 0, Train: 0.5500, Val: 0.4551, Test: 0.3903, Best time: 2.1001
Epoch: 004/100, Runtime 0.406507, Loss 1.744529, forward nfe 1070, backward nfe 0, Train: 0.6667, Val: 0.6761, Test: 0.6210, Best time: 44.8871
Epoch: 005/100, Runtime 0.397130, Loss 1.723163, forward nfe 1392, backward nfe 0, Train: 0.7083, Val: 0.7065, Test: 0.6371, Best time: 45.2765
Epoch: 006/100, Runtime 0.379789, Loss 1.722689, forward nfe 1714, backward nfe 0, Train: 0.7250, Val: 0.7138, Test: 0.6403, Best time: 51.6674
Epoch: 007/100, Runtime 0.391455, Loss 1.688312, forward nfe 2024, backward nfe 0, Train: 0.7417, Val: 0.7188, Test: 0.6565, Best time: 16.6497
Epoch: 008/100, Runtime 0.389377, Loss 1.683659, forward nfe 2334, backward nfe 0, Train: 0.7500, Val: 0.7239, Test: 0.6710, Best time: 10.9789
Epoch: 009/100, Runtime 0.402334, Loss 1.686024, forward nfe 2638, backward nfe 0, Train: 0.7500, Val: 0.7239, Test: 0.6710, Best time: 25.0000
Epoch: 010/100, Runtime 0.363569, Loss 1.668987, forward nfe 2936, backward nfe 0, Train: 0.7500, Val: 0.7239, Test: 0.6710, Best time: 25.0000
Epoch: 011/100, Runtime 0.363776, Loss 1.651151, forward nfe 3234, backward nfe 0, Train: 0.6917, Val: 0.7246, Test: 0.6839, Best time: 16.6128
Epoch: 012/100, Runtime 0.366882, Loss 1.609826, forward nfe 3532, backward nfe 0, Train: 0.7000, Val: 0.7348, Test: 0.7097, Best time: 14.4275
Epoch: 013/100, Runtime 0.364217, Loss 1.628229, forward nfe 3824, backward nfe 0, Train: 0.7167, Val: 0.7413, Test: 0.7290, Best time: 12.4801
Epoch: 014/100, Runtime 0.352422, Loss 1.597264, forward nfe 4116, backward nfe 0, Train: 0.7083, Val: 0.7493, Test: 0.7258, Best time: 7.7221
Epoch: 015/100, Runtime 0.353755, Loss 1.526542, forward nfe 4402, backward nfe 0, Train: 0.7083, Val: 0.7493, Test: 0.7258, Best time: 25.0000
Epoch: 016/100, Runtime 0.359669, Loss 1.523354, forward nfe 4688, backward nfe 0, Train: 0.7083, Val: 0.7493, Test: 0.7258, Best time: 25.0000
Epoch: 017/100, Runtime 0.340483, Loss 1.460749, forward nfe 4974, backward nfe 0, Train: 0.7083, Val: 0.7493, Test: 0.7258, Best time: 25.0000
Epoch: 018/100, Runtime 0.335322, Loss 1.475205, forward nfe 5254, backward nfe 0, Train: 0.7083, Val: 0.7493, Test: 0.7258, Best time: 25.0000
Epoch: 019/100, Runtime 0.338735, Loss 1.373318, forward nfe 5534, backward nfe 0, Train: 0.7083, Val: 0.7493, Test: 0.7258, Best time: 25.0000
Epoch: 020/100, Runtime 0.343803, Loss 1.354068, forward nfe 5814, backward nfe 0, Train: 0.7833, Val: 0.7565, Test: 0.7323, Best time: 27.1562
Epoch: 021/100, Runtime 0.346953, Loss 1.311901, forward nfe 6094, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 40.9436
Epoch: 022/100, Runtime 0.326048, Loss 1.315941, forward nfe 6362, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 023/100, Runtime 0.326204, Loss 1.240653, forward nfe 6630, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 024/100, Runtime 0.313559, Loss 1.291565, forward nfe 6898, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 025/100, Runtime 0.319278, Loss 1.236897, forward nfe 7154, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 026/100, Runtime 0.303180, Loss 1.221318, forward nfe 7404, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 027/100, Runtime 0.309412, Loss 1.172474, forward nfe 7654, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 028/100, Runtime 0.303587, Loss 1.108312, forward nfe 7898, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 029/100, Runtime 0.314722, Loss 1.266630, forward nfe 8142, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 030/100, Runtime 0.288119, Loss 1.163601, forward nfe 8380, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 031/100, Runtime 0.298849, Loss 1.182364, forward nfe 8612, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 032/100, Runtime 0.310183, Loss 1.194171, forward nfe 8844, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 033/100, Runtime 0.294744, Loss 1.209894, forward nfe 9076, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 034/100, Runtime 0.293305, Loss 1.072680, forward nfe 9308, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 035/100, Runtime 0.281716, Loss 1.120457, forward nfe 9540, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 036/100, Runtime 0.281027, Loss 1.206208, forward nfe 9760, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 037/100, Runtime 0.281056, Loss 1.172928, forward nfe 9980, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 038/100, Runtime 0.271595, Loss 1.134805, forward nfe 10200, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 039/100, Runtime 0.268908, Loss 1.138173, forward nfe 10420, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 040/100, Runtime 0.267461, Loss 1.186401, forward nfe 10634, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 041/100, Runtime 0.269711, Loss 1.094937, forward nfe 10842, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 042/100, Runtime 0.268663, Loss 1.096775, forward nfe 11050, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 043/100, Runtime 0.271611, Loss 1.071914, forward nfe 11258, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 044/100, Runtime 0.259891, Loss 1.153896, forward nfe 11466, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 045/100, Runtime 0.247225, Loss 1.127632, forward nfe 11674, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 046/100, Runtime 0.249440, Loss 1.088486, forward nfe 11870, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 047/100, Runtime 0.253407, Loss 1.132751, forward nfe 12066, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 048/100, Runtime 0.241104, Loss 1.044117, forward nfe 12256, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 049/100, Runtime 0.251654, Loss 1.158819, forward nfe 12446, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 050/100, Runtime 0.234212, Loss 1.124653, forward nfe 12636, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 051/100, Runtime 0.250961, Loss 1.196526, forward nfe 12832, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 052/100, Runtime 0.241908, Loss 1.183045, forward nfe 13028, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 053/100, Runtime 0.251902, Loss 1.208900, forward nfe 13224, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 054/100, Runtime 0.243527, Loss 1.128326, forward nfe 13420, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 055/100, Runtime 0.244815, Loss 1.163630, forward nfe 13616, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 056/100, Runtime 0.252472, Loss 1.158606, forward nfe 13812, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 057/100, Runtime 0.260438, Loss 1.140929, forward nfe 14014, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 058/100, Runtime 0.250515, Loss 1.215384, forward nfe 14216, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 059/100, Runtime 0.248744, Loss 1.126625, forward nfe 14418, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 060/100, Runtime 0.256092, Loss 1.082790, forward nfe 14620, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 061/100, Runtime 0.266424, Loss 1.061086, forward nfe 14822, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 062/100, Runtime 0.254543, Loss 1.101620, forward nfe 15024, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 063/100, Runtime 0.255630, Loss 1.071475, forward nfe 15226, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 064/100, Runtime 0.255267, Loss 1.031054, forward nfe 15428, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 065/100, Runtime 0.259569, Loss 0.999204, forward nfe 15630, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 066/100, Runtime 0.257236, Loss 1.059433, forward nfe 15832, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 067/100, Runtime 0.257717, Loss 1.186931, forward nfe 16034, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 068/100, Runtime 0.253684, Loss 1.103018, forward nfe 16236, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 069/100, Runtime 0.267916, Loss 1.094149, forward nfe 16438, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 070/100, Runtime 0.261387, Loss 1.133093, forward nfe 16640, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 071/100, Runtime 0.252124, Loss 1.074107, forward nfe 16842, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 072/100, Runtime 0.251832, Loss 1.097761, forward nfe 17044, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 073/100, Runtime 0.264064, Loss 1.069851, forward nfe 17246, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 074/100, Runtime 0.257079, Loss 1.053516, forward nfe 17448, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 075/100, Runtime 0.263755, Loss 0.975030, forward nfe 17656, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 076/100, Runtime 0.270660, Loss 1.069188, forward nfe 17864, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 077/100, Runtime 0.272592, Loss 0.941523, forward nfe 18078, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 078/100, Runtime 0.396896, Loss 0.989405, forward nfe 18292, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 079/100, Runtime 0.262102, Loss 1.038819, forward nfe 18506, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 080/100, Runtime 0.260885, Loss 1.134041, forward nfe 18708, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 081/100, Runtime 0.253762, Loss 1.005867, forward nfe 18910, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 082/100, Runtime 0.265207, Loss 1.195198, forward nfe 19112, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 083/100, Runtime 0.265598, Loss 1.054361, forward nfe 19314, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 084/100, Runtime 0.258380, Loss 1.018390, forward nfe 19522, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 085/100, Runtime 0.247747, Loss 1.223382, forward nfe 19730, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 086/100, Runtime 0.265064, Loss 1.063096, forward nfe 19938, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 087/100, Runtime 0.264716, Loss 1.084165, forward nfe 20146, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 088/100, Runtime 0.255013, Loss 0.980045, forward nfe 20354, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 089/100, Runtime 0.265161, Loss 1.014127, forward nfe 20556, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 090/100, Runtime 0.258163, Loss 1.020818, forward nfe 20764, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 091/100, Runtime 0.264979, Loss 0.948625, forward nfe 20972, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 092/100, Runtime 0.259677, Loss 1.001351, forward nfe 21180, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 093/100, Runtime 0.252358, Loss 0.980747, forward nfe 21382, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 094/100, Runtime 0.251649, Loss 1.012108, forward nfe 21584, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 095/100, Runtime 0.266840, Loss 0.918037, forward nfe 21786, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 096/100, Runtime 0.253901, Loss 1.023518, forward nfe 21994, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 097/100, Runtime 0.253593, Loss 1.023060, forward nfe 22196, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 098/100, Runtime 0.255506, Loss 1.031309, forward nfe 22398, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
Epoch: 099/100, Runtime 0.257421, Loss 1.071509, forward nfe 22600, backward nfe 0, Train: 0.7417, Val: 0.7638, Test: 0.7097, Best time: 25.0000
best val accuracy 0.763768 with test accuracy 0.709677 at epoch 21 and best time 25.000000