/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.992095, Loss 1.793283, forward nfe 242, backward nfe 0, Train: 0.2250, Val: 0.1725, Test: 0.1548, Best time: 0.9198
Epoch: 002/100, Runtime 0.925084, Loss 1.793919, forward nfe 1056, backward nfe 0, Train: 0.2917, Val: 0.2594, Test: 0.2258, Best time: 0.0397
Epoch: 003/100, Runtime 0.904602, Loss 1.782890, forward nfe 1870, backward nfe 0, Train: 0.5333, Val: 0.4797, Test: 0.4210, Best time: 1.4531
Epoch: 004/100, Runtime 0.896422, Loss 1.760914, forward nfe 2690, backward nfe 0, Train: 0.5333, Val: 0.4797, Test: 0.4210, Best time: 100.0000
Epoch: 005/100, Runtime 0.903661, Loss 1.754602, forward nfe 3498, backward nfe 0, Train: 0.5667, Val: 0.4804, Test: 0.4355, Best time: 1.5299
Epoch: 006/100, Runtime 0.865148, Loss 1.698547, forward nfe 4288, backward nfe 0, Train: 0.6000, Val: 0.4899, Test: 0.4581, Best time: 1.5762
Epoch: 007/100, Runtime 0.849920, Loss 1.663607, forward nfe 5078, backward nfe 0, Train: 0.6000, Val: 0.4899, Test: 0.4581, Best time: 100.0000
Epoch: 008/100, Runtime 0.842316, Loss 1.674267, forward nfe 5844, backward nfe 0, Train: 0.6583, Val: 0.5942, Test: 0.5532, Best time: 3.2128
Epoch: 009/100, Runtime 0.832204, Loss 1.641546, forward nfe 6610, backward nfe 0, Train: 0.6583, Val: 0.5942, Test: 0.5532, Best time: 100.0000
Epoch: 010/100, Runtime 0.802035, Loss 1.618601, forward nfe 7346, backward nfe 0, Train: 0.6417, Val: 0.6543, Test: 0.6323, Best time: 25.4555
Epoch: 011/100, Runtime 0.787237, Loss 1.626896, forward nfe 8082, backward nfe 0, Train: 0.6500, Val: 0.6949, Test: 0.6726, Best time: 18.7870
Epoch: 012/100, Runtime 0.784999, Loss 1.590582, forward nfe 8800, backward nfe 0, Train: 0.7250, Val: 0.7058, Test: 0.6935, Best time: 40.5727
Epoch: 013/100, Runtime 0.790235, Loss 1.546834, forward nfe 9512, backward nfe 0, Train: 0.7250, Val: 0.7058, Test: 0.6935, Best time: 100.0000
Epoch: 014/100, Runtime 0.780471, Loss 1.508240, forward nfe 10206, backward nfe 0, Train: 0.7250, Val: 0.7058, Test: 0.6935, Best time: 100.0000
Epoch: 015/100, Runtime 0.769597, Loss 1.447009, forward nfe 10888, backward nfe 0, Train: 0.7000, Val: 0.7080, Test: 0.6887, Best time: 29.7373
Epoch: 016/100, Runtime 0.748478, Loss 1.443145, forward nfe 11564, backward nfe 0, Train: 0.7667, Val: 0.7471, Test: 0.7242, Best time: 24.8862
Epoch: 017/100, Runtime 0.752498, Loss 1.505861, forward nfe 12228, backward nfe 0, Train: 0.7667, Val: 0.7471, Test: 0.7242, Best time: 100.0000
Epoch: 018/100, Runtime 0.733161, Loss 1.358967, forward nfe 12892, backward nfe 0, Train: 0.7333, Val: 0.7551, Test: 0.7290, Best time: 18.5911
Epoch: 019/100, Runtime 0.708133, Loss 1.321759, forward nfe 13550, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 27.1847
Epoch: 020/100, Runtime 0.694755, Loss 1.268353, forward nfe 14184, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 021/100, Runtime 0.685442, Loss 1.407194, forward nfe 14806, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 022/100, Runtime 0.666386, Loss 1.261515, forward nfe 15422, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 023/100, Runtime 0.683002, Loss 1.300031, forward nfe 16032, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 024/100, Runtime 0.674799, Loss 1.397187, forward nfe 16648, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 025/100, Runtime 0.651979, Loss 1.233637, forward nfe 17240, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 026/100, Runtime 0.648435, Loss 1.308815, forward nfe 17820, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 027/100, Runtime 0.639614, Loss 1.304575, forward nfe 18400, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 028/100, Runtime 0.641327, Loss 1.306630, forward nfe 18968, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 029/100, Runtime 0.618804, Loss 1.307531, forward nfe 19524, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 030/100, Runtime 0.615518, Loss 1.307407, forward nfe 20074, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 031/100, Runtime 0.602943, Loss 1.332984, forward nfe 20606, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 032/100, Runtime 0.595380, Loss 1.294224, forward nfe 21126, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 033/100, Runtime 0.596437, Loss 1.290827, forward nfe 21646, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 034/100, Runtime 0.582511, Loss 1.331568, forward nfe 22160, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 035/100, Runtime 0.570821, Loss 1.241218, forward nfe 22668, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 036/100, Runtime 0.571574, Loss 1.272284, forward nfe 23164, backward nfe 0, Train: 0.7333, Val: 0.7580, Test: 0.7371, Best time: 100.0000
Epoch: 037/100, Runtime 0.556451, Loss 1.227568, forward nfe 23648, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 54.9355
Epoch: 038/100, Runtime 0.540585, Loss 1.190215, forward nfe 24138, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 039/100, Runtime 0.523615, Loss 1.199115, forward nfe 24610, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 040/100, Runtime 0.521730, Loss 1.310868, forward nfe 25082, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 041/100, Runtime 0.510449, Loss 1.197713, forward nfe 25542, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 042/100, Runtime 0.627823, Loss 1.265538, forward nfe 25990, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 043/100, Runtime 0.501956, Loss 1.266365, forward nfe 26438, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 044/100, Runtime 0.517596, Loss 1.270777, forward nfe 26880, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 045/100, Runtime 0.508919, Loss 1.246503, forward nfe 27322, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 046/100, Runtime 0.504155, Loss 1.211383, forward nfe 27752, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 047/100, Runtime 0.480495, Loss 1.245186, forward nfe 28182, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 048/100, Runtime 0.472787, Loss 1.270614, forward nfe 28606, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 049/100, Runtime 0.473692, Loss 1.305714, forward nfe 29024, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 050/100, Runtime 0.472906, Loss 1.319364, forward nfe 29436, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 051/100, Runtime 0.472577, Loss 1.263397, forward nfe 29848, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 052/100, Runtime 0.470977, Loss 1.204402, forward nfe 30254, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 053/100, Runtime 0.450363, Loss 1.157381, forward nfe 30654, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 054/100, Runtime 0.460980, Loss 1.270142, forward nfe 31048, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 055/100, Runtime 0.475383, Loss 1.279781, forward nfe 31448, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 056/100, Runtime 0.452242, Loss 1.176949, forward nfe 31842, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 057/100, Runtime 0.452170, Loss 1.269509, forward nfe 32230, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 058/100, Runtime 0.446048, Loss 1.316222, forward nfe 32624, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 059/100, Runtime 0.456383, Loss 1.333335, forward nfe 33012, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 060/100, Runtime 0.448200, Loss 1.207553, forward nfe 33400, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 061/100, Runtime 0.436901, Loss 1.291172, forward nfe 33782, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 062/100, Runtime 0.423184, Loss 1.343437, forward nfe 34158, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 063/100, Runtime 0.453595, Loss 1.337092, forward nfe 34540, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 064/100, Runtime 0.444232, Loss 1.275955, forward nfe 34916, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 065/100, Runtime 0.432993, Loss 1.160843, forward nfe 35292, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 066/100, Runtime 0.436874, Loss 1.335905, forward nfe 35674, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 067/100, Runtime 0.448578, Loss 1.172661, forward nfe 36050, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 068/100, Runtime 0.439192, Loss 1.384519, forward nfe 36426, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 069/100, Runtime 0.431809, Loss 1.219622, forward nfe 36790, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 070/100, Runtime 0.426199, Loss 1.234223, forward nfe 37154, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 071/100, Runtime 0.429878, Loss 1.150175, forward nfe 37518, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 072/100, Runtime 0.421678, Loss 1.121426, forward nfe 37876, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 073/100, Runtime 0.427804, Loss 1.208914, forward nfe 38234, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 074/100, Runtime 0.430714, Loss 1.198465, forward nfe 38592, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 075/100, Runtime 0.421304, Loss 1.209461, forward nfe 38950, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 076/100, Runtime 0.418328, Loss 1.139943, forward nfe 39308, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 077/100, Runtime 0.425132, Loss 1.153911, forward nfe 39672, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 078/100, Runtime 0.426854, Loss 1.192052, forward nfe 40030, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 079/100, Runtime 0.427696, Loss 1.038491, forward nfe 40388, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 080/100, Runtime 0.426708, Loss 1.139204, forward nfe 40746, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7355, Best time: 100.0000
Epoch: 081/100, Runtime 0.410381, Loss 1.159367, forward nfe 41104, backward nfe 0, Train: 0.8083, Val: 0.7623, Test: 0.7210, Best time: 46.2493
Epoch: 082/100, Runtime 0.407928, Loss 1.264703, forward nfe 41456, backward nfe 0, Train: 0.8083, Val: 0.7623, Test: 0.7210, Best time: 100.0000
Epoch: 083/100, Runtime 0.420067, Loss 1.167547, forward nfe 41802, backward nfe 0, Train: 0.8083, Val: 0.7623, Test: 0.7210, Best time: 100.0000
Epoch: 084/100, Runtime 0.399851, Loss 1.156535, forward nfe 42154, backward nfe 0, Train: 0.8083, Val: 0.7623, Test: 0.7210, Best time: 100.0000
Epoch: 085/100, Runtime 0.404961, Loss 1.250547, forward nfe 42500, backward nfe 0, Train: 0.8083, Val: 0.7623, Test: 0.7210, Best time: 100.0000
Epoch: 086/100, Runtime 0.411776, Loss 1.186027, forward nfe 42846, backward nfe 0, Train: 0.8083, Val: 0.7623, Test: 0.7210, Best time: 100.0000
Epoch: 087/100, Runtime 0.404276, Loss 1.065759, forward nfe 43198, backward nfe 0, Train: 0.8083, Val: 0.7623, Test: 0.7210, Best time: 100.0000
Epoch: 088/100, Runtime 0.435969, Loss 1.239137, forward nfe 43550, backward nfe 0, Train: 0.8083, Val: 0.7623, Test: 0.7210, Best time: 100.0000
Epoch: 089/100, Runtime 0.403310, Loss 1.120948, forward nfe 43896, backward nfe 0, Train: 0.8083, Val: 0.7623, Test: 0.7210, Best time: 100.0000
Epoch: 090/100, Runtime 0.394299, Loss 1.173706, forward nfe 44242, backward nfe 0, Train: 0.8167, Val: 0.7645, Test: 0.7242, Best time: 79.2629
Epoch: 091/100, Runtime 0.400460, Loss 1.191618, forward nfe 44588, backward nfe 0, Train: 0.8167, Val: 0.7645, Test: 0.7242, Best time: 100.0000
Epoch: 092/100, Runtime 0.409493, Loss 1.138838, forward nfe 44928, backward nfe 0, Train: 0.8167, Val: 0.7645, Test: 0.7242, Best time: 100.0000
Epoch: 093/100, Runtime 0.413277, Loss 1.124218, forward nfe 45268, backward nfe 0, Train: 0.8167, Val: 0.7645, Test: 0.7242, Best time: 100.0000
Epoch: 094/100, Runtime 0.403192, Loss 1.171730, forward nfe 45608, backward nfe 0, Train: 0.8167, Val: 0.7645, Test: 0.7242, Best time: 100.0000
Epoch: 095/100, Runtime 0.414932, Loss 1.129848, forward nfe 45942, backward nfe 0, Train: 0.8167, Val: 0.7645, Test: 0.7242, Best time: 100.0000
Epoch: 096/100, Runtime 0.398721, Loss 1.221251, forward nfe 46276, backward nfe 0, Train: 0.8167, Val: 0.7645, Test: 0.7242, Best time: 100.0000
Epoch: 097/100, Runtime 0.404474, Loss 1.210656, forward nfe 46610, backward nfe 0, Train: 0.8167, Val: 0.7645, Test: 0.7242, Best time: 100.0000
Epoch: 098/100, Runtime 0.429270, Loss 1.013984, forward nfe 46944, backward nfe 0, Train: 0.8167, Val: 0.7645, Test: 0.7242, Best time: 100.0000
Epoch: 099/100, Runtime 0.407410, Loss 1.241688, forward nfe 47278, backward nfe 0, Train: 0.8167, Val: 0.7645, Test: 0.7242, Best time: 100.0000
best val accuracy 0.764493 with test accuracy 0.724194 at epoch 90 and best time 100.000000