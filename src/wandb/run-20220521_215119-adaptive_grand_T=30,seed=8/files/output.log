/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 2.189811, Loss 1.948551, forward nfe 74, backward nfe 0, Train: 0.5857, Val: 0.5154, Test: 0.5076, Best time: 3.7917
Epoch: 002/100, Runtime 2.116967, Loss 1.937882, forward nfe 342, backward nfe 0, Train: 0.5857, Val: 0.5154, Test: 0.5076, Best time: 30.0000
Epoch: 003/100, Runtime 2.005619, Loss 1.854293, forward nfe 604, backward nfe 0, Train: 0.5857, Val: 0.5154, Test: 0.5076, Best time: 30.0000
Epoch: 004/100, Runtime 2.016916, Loss 1.708864, forward nfe 854, backward nfe 0, Train: 0.6929, Val: 0.5176, Test: 0.5218, Best time: 2.2830
Epoch: 005/100, Runtime 1.964972, Loss 1.470103, forward nfe 1104, backward nfe 0, Train: 0.8000, Val: 0.6963, Test: 0.7025, Best time: 13.2065
Epoch: 006/100, Runtime 1.971640, Loss 1.205310, forward nfe 1342, backward nfe 0, Train: 0.8857, Val: 0.7897, Test: 0.7949, Best time: 7.6926
Epoch: 007/100, Runtime 1.881845, Loss 0.921066, forward nfe 1586, backward nfe 0, Train: 0.9214, Val: 0.8287, Test: 0.8305, Best time: 10.3946
Epoch: 008/100, Runtime 1.936620, Loss 0.728451, forward nfe 1818, backward nfe 0, Train: 0.9214, Val: 0.8287, Test: 0.8305, Best time: 30.0000
Epoch: 009/100, Runtime 1.688509, Loss 0.515911, forward nfe 2038, backward nfe 0, Train: 0.9214, Val: 0.8287, Test: 0.8305, Best time: 30.0000
Epoch: 010/100, Runtime 1.757958, Loss 0.424331, forward nfe 2258, backward nfe 0, Train: 0.9214, Val: 0.8287, Test: 0.8305, Best time: 30.0000
Epoch: 011/100, Runtime 1.492423, Loss 0.344128, forward nfe 2472, backward nfe 0, Train: 0.9214, Val: 0.8287, Test: 0.8305, Best time: 30.0000
Epoch: 012/100, Runtime 1.729245, Loss 0.300728, forward nfe 2674, backward nfe 0, Train: 0.9429, Val: 0.8324, Test: 0.8274, Best time: 21.3286
Epoch: 013/100, Runtime 1.651574, Loss 0.281559, forward nfe 2882, backward nfe 0, Train: 0.9429, Val: 0.8346, Test: 0.8315, Best time: 22.3825
Epoch: 014/100, Runtime 1.618958, Loss 0.242301, forward nfe 3096, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 52.7521
Epoch: 015/100, Runtime 1.563134, Loss 0.194230, forward nfe 3298, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 016/100, Runtime 1.554067, Loss 0.207985, forward nfe 3500, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 017/100, Runtime 1.542928, Loss 0.176670, forward nfe 3690, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 018/100, Runtime 1.364200, Loss 0.192976, forward nfe 3880, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 019/100, Runtime 1.432752, Loss 0.188806, forward nfe 4058, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 020/100, Runtime 1.507160, Loss 0.190643, forward nfe 4236, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 021/100, Runtime 1.443439, Loss 0.206902, forward nfe 4414, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 022/100, Runtime 1.315795, Loss 0.207491, forward nfe 4592, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 023/100, Runtime 1.435517, Loss 0.294947, forward nfe 4764, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 024/100, Runtime 1.530330, Loss 0.254935, forward nfe 4936, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 025/100, Runtime 1.348171, Loss 0.218861, forward nfe 5108, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 026/100, Runtime 1.285540, Loss 0.262066, forward nfe 5274, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 027/100, Runtime 1.312197, Loss 0.207586, forward nfe 5428, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 028/100, Runtime 1.336988, Loss 0.154048, forward nfe 5582, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 029/100, Runtime 1.397870, Loss 0.138213, forward nfe 5742, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 030/100, Runtime 1.343155, Loss 0.237812, forward nfe 5902, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 031/100, Runtime 1.328345, Loss 0.156850, forward nfe 6062, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 032/100, Runtime 1.390292, Loss 0.139341, forward nfe 6222, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 033/100, Runtime 1.271216, Loss 0.169200, forward nfe 6382, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 034/100, Runtime 1.285586, Loss 0.148130, forward nfe 6536, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 035/100, Runtime 1.193318, Loss 0.119061, forward nfe 6684, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 036/100, Runtime 1.239523, Loss 0.102245, forward nfe 6832, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 037/100, Runtime 1.110021, Loss 0.109977, forward nfe 6980, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 038/100, Runtime 1.265655, Loss 0.089374, forward nfe 7128, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 039/100, Runtime 1.158211, Loss 0.176499, forward nfe 7270, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 040/100, Runtime 1.153556, Loss 0.103271, forward nfe 7412, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 041/100, Runtime 1.184213, Loss 0.098784, forward nfe 7554, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 042/100, Runtime 1.221790, Loss 0.126952, forward nfe 7696, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 043/100, Runtime 1.142390, Loss 0.117636, forward nfe 7832, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 044/100, Runtime 1.220431, Loss 0.107282, forward nfe 7968, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 045/100, Runtime 1.232063, Loss 0.125331, forward nfe 8116, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 046/100, Runtime 1.252208, Loss 0.109919, forward nfe 8264, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 047/100, Runtime 1.104895, Loss 0.094432, forward nfe 8412, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 048/100, Runtime 1.269197, Loss 0.105679, forward nfe 8554, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 049/100, Runtime 1.106050, Loss 0.084979, forward nfe 8696, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 050/100, Runtime 1.227748, Loss 0.149798, forward nfe 8838, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 051/100, Runtime 1.209622, Loss 0.085787, forward nfe 8980, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 052/100, Runtime 1.228147, Loss 0.077158, forward nfe 9128, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 053/100, Runtime 1.230443, Loss 0.067204, forward nfe 9276, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 054/100, Runtime 1.171883, Loss 0.050691, forward nfe 9424, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 055/100, Runtime 1.188316, Loss 0.077943, forward nfe 9566, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 056/100, Runtime 1.215519, Loss 0.084364, forward nfe 9708, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 057/100, Runtime 1.175971, Loss 0.069321, forward nfe 9850, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 058/100, Runtime 1.184865, Loss 0.072317, forward nfe 9992, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 059/100, Runtime 1.194045, Loss 0.075696, forward nfe 10134, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 060/100, Runtime 1.129225, Loss 0.096936, forward nfe 10276, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 061/100, Runtime 1.072829, Loss 0.074206, forward nfe 10412, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 062/100, Runtime 1.122854, Loss 0.072182, forward nfe 10548, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 063/100, Runtime 1.141213, Loss 0.084647, forward nfe 10684, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 064/100, Runtime 1.123410, Loss 0.068624, forward nfe 10820, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 065/100, Runtime 1.122778, Loss 0.060978, forward nfe 10956, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 066/100, Runtime 1.140758, Loss 0.091922, forward nfe 11092, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 067/100, Runtime 1.134529, Loss 0.094075, forward nfe 11228, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 068/100, Runtime 1.177716, Loss 0.077160, forward nfe 11364, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 069/100, Runtime 1.154563, Loss 0.070336, forward nfe 11500, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 070/100, Runtime 1.167654, Loss 0.109015, forward nfe 11636, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 071/100, Runtime 1.108041, Loss 0.064115, forward nfe 11772, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 072/100, Runtime 1.153554, Loss 0.065342, forward nfe 11908, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 073/100, Runtime 1.204010, Loss 0.044309, forward nfe 12044, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 074/100, Runtime 1.176977, Loss 0.050792, forward nfe 12186, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 075/100, Runtime 1.189295, Loss 0.044259, forward nfe 12328, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 076/100, Runtime 1.156495, Loss 0.088071, forward nfe 12470, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 077/100, Runtime 1.136366, Loss 0.052578, forward nfe 12606, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 078/100, Runtime 1.166772, Loss 0.064441, forward nfe 12742, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 079/100, Runtime 1.134781, Loss 0.053274, forward nfe 12878, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 080/100, Runtime 1.143433, Loss 0.040192, forward nfe 13014, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 081/100, Runtime 1.472859, Loss 0.040834, forward nfe 13150, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 082/100, Runtime 1.488189, Loss 0.041202, forward nfe 13286, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 083/100, Runtime 1.440285, Loss 0.054606, forward nfe 13422, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 084/100, Runtime 1.663794, Loss 0.042546, forward nfe 13558, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 085/100, Runtime 1.694410, Loss 0.042658, forward nfe 13700, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 086/100, Runtime 1.697596, Loss 0.066351, forward nfe 13842, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 087/100, Runtime 1.599906, Loss 0.058278, forward nfe 13984, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 088/100, Runtime 1.558616, Loss 0.043065, forward nfe 14126, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 089/100, Runtime 1.594125, Loss 0.043434, forward nfe 14268, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 090/100, Runtime 1.631984, Loss 0.043058, forward nfe 14410, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 091/100, Runtime 1.626577, Loss 0.033479, forward nfe 14546, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 092/100, Runtime 1.604910, Loss 0.043157, forward nfe 14682, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 093/100, Runtime 1.614617, Loss 0.042599, forward nfe 14818, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 094/100, Runtime 1.530431, Loss 0.064912, forward nfe 14966, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 095/100, Runtime 1.624300, Loss 0.046638, forward nfe 15114, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 096/100, Runtime 1.721910, Loss 0.034270, forward nfe 15262, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 097/100, Runtime 1.829991, Loss 0.026932, forward nfe 15416, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 098/100, Runtime 1.678270, Loss 0.026693, forward nfe 15576, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
Epoch: 099/100, Runtime 1.980778, Loss 0.042811, forward nfe 15736, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8487, Best time: 30.0000
best val accuracy 0.842647 with test accuracy 0.848731 at epoch 14 and best time 30.000000