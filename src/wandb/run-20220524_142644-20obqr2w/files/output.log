/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1, 'max_iters': 100}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1, 'max_iters': 100}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
Clipping Bound =  0.05
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
Clipping Bound =  0.05
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.odefunc.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.odefunc.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.odefunc.multihead_att_layer.V.bias
torch.Size([128])
odeblock.odefunc.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.odefunc.multihead_att_layer.K.bias
torch.Size([128])
odeblock.odefunc.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.odefunc.multihead_att_layer.Wout.bias
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.reg_odefunc.odefunc.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.reg_odefunc.odefunc.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.reg_odefunc.odefunc.multihead_att_layer.V.bias
torch.Size([128])
odeblock.reg_odefunc.odefunc.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.reg_odefunc.odefunc.multihead_att_layer.K.bias
torch.Size([128])
odeblock.reg_odefunc.odefunc.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.reg_odefunc.odefunc.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.851340, Loss 1.944351, forward nfe 14, backward nfe 0, Train: 0.9214, Val: 0.6971, Test: 0.7117, Best time: 4.3067
Epoch: 002/100, Runtime 0.600288, Loss 1.748035, forward nfe 54, backward nfe 0, Train: 0.9571, Val: 0.7235, Test: 0.7482, Best time: 3.9667
Epoch: 003/100, Runtime 0.782941, Loss 1.430135, forward nfe 94, backward nfe 0, Train: 0.9714, Val: 0.7331, Test: 0.7624, Best time: 3.7001
Epoch: 004/100, Runtime 0.878953, Loss 1.095115, forward nfe 140, backward nfe 0, Train: 0.9714, Val: 0.7493, Test: 0.7746, Best time: 4.2345
Epoch: 005/100, Runtime 0.849272, Loss 0.759517, forward nfe 192, backward nfe 0, Train: 0.9714, Val: 0.7493, Test: 0.7746, Best time: 1.0000
Epoch: 006/100, Runtime 1.005932, Loss 0.573749, forward nfe 250, backward nfe 0, Train: 0.9714, Val: 0.7493, Test: 0.7746, Best time: 1.0000
Epoch: 007/100, Runtime 0.849950, Loss 0.386955, forward nfe 302, backward nfe 0, Train: 1.0000, Val: 0.7596, Test: 0.7878, Best time: 3.5926
Epoch: 008/100, Runtime 0.964193, Loss 0.247075, forward nfe 354, backward nfe 0, Train: 1.0000, Val: 0.7632, Test: 0.7888, Best time: 4.0596
Epoch: 009/100, Runtime 0.718370, Loss 0.205761, forward nfe 406, backward nfe 0, Train: 1.0000, Val: 0.7632, Test: 0.7888, Best time: 1.0000
Epoch: 010/100, Runtime 1.051895, Loss 0.135939, forward nfe 452, backward nfe 0, Train: 1.0000, Val: 0.7632, Test: 0.7888, Best time: 1.0000
Epoch: 011/100, Runtime 0.733985, Loss 0.091334, forward nfe 504, backward nfe 0, Train: 1.0000, Val: 0.7632, Test: 0.7888, Best time: 1.0000
Epoch: 012/100, Runtime 1.122262, Loss 0.080772, forward nfe 562, backward nfe 0, Train: 1.0000, Val: 0.7632, Test: 0.7888, Best time: 1.0000
Epoch: 013/100, Runtime 0.843846, Loss 0.096843, forward nfe 614, backward nfe 0, Train: 1.0000, Val: 0.7632, Test: 0.7888, Best time: 1.0000
Epoch: 014/100, Runtime 1.045100, Loss 0.090709, forward nfe 672, backward nfe 0, Train: 1.0000, Val: 0.7632, Test: 0.7888, Best time: 1.0000
Epoch: 015/100, Runtime 0.846876, Loss 0.073312, forward nfe 730, backward nfe 0, Train: 1.0000, Val: 0.7632, Test: 0.7888, Best time: 1.0000
Epoch: 016/100, Runtime 0.890246, Loss 0.049325, forward nfe 782, backward nfe 0, Train: 1.0000, Val: 0.7632, Test: 0.7888, Best time: 1.0000
Traceback (most recent call last):
  File "run_GNN.py", line 265, in main
    tmp_train_acc, tmp_val_acc, tmp_test_acc = this_test(model, data, pos_encoding, opt)
  File "/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "run_GNN.py", line 140, in test
    logits, accs = model(feat, pos_encoding), []
  File "/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/media/data-share/hieunm60/graph-neural-pde/src/GNN_early.py", line 84, in forward
    z = self.odeblock(x)
  File "/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/media/data-share/hieunm60/graph-neural-pde/src/block_constant.py", line 56, in forward
    state_dt = integrator(
  File "/media/data-share/hieunm60/graph-neural-pde/src/early_stop_solver.py", line 301, in __call__
    t, solution = self.solver.integrate(t)
  File "/media/data-share/hieunm60/graph-neural-pde/src/early_stop_solver.py", line 65, in integrate
    new_t, y = self.advance(t[i])
  File "/media/data-share/hieunm60/graph-neural-pde/src/early_stop_solver.py", line 79, in advance
    train_acc, val_acc, test_acc = self.evaluate(self.rk_state)
  File "/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/media/data-share/hieunm60/graph-neural-pde/src/early_stop_solver.py", line 119, in evaluate
    train_acc, val_acc, test_acc = self.ode_test(z)
  File "/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/media/data-share/hieunm60/graph-neural-pde/src/early_stop_solver.py", line 93, in test
    acc = pred.eq(self.data.y[mask]).sum().item() / mask.sum().item()
KeyboardInterrupt
