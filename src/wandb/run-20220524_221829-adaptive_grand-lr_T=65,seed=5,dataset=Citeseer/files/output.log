/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.724496, Loss 1.792651, forward nfe 182, backward nfe 0, Train: 0.2833, Val: 0.2326, Test: 0.2323, Best time: 2.8111
Epoch: 002/100, Runtime 0.665007, Loss 1.790829, forward nfe 768, backward nfe 0, Train: 0.4500, Val: 0.4420, Test: 0.4355, Best time: 0.0388
Epoch: 003/100, Runtime 0.671270, Loss 1.772167, forward nfe 1366, backward nfe 0, Train: 0.5667, Val: 0.5848, Test: 0.5694, Best time: 0.8653
Epoch: 004/100, Runtime 0.647501, Loss 1.742040, forward nfe 1946, backward nfe 0, Train: 0.6250, Val: 0.6935, Test: 0.6629, Best time: 123.6257
Epoch: 005/100, Runtime 0.635909, Loss 1.709699, forward nfe 2526, backward nfe 0, Train: 0.6250, Val: 0.6935, Test: 0.6629, Best time: 65.0000
Epoch: 006/100, Runtime 0.638828, Loss 1.678195, forward nfe 3100, backward nfe 0, Train: 0.6250, Val: 0.6935, Test: 0.6629, Best time: 65.0000
Epoch: 007/100, Runtime 0.643709, Loss 1.649559, forward nfe 3656, backward nfe 0, Train: 0.6250, Val: 0.6935, Test: 0.6629, Best time: 65.0000
Epoch: 008/100, Runtime 0.624632, Loss 1.641189, forward nfe 4218, backward nfe 0, Train: 0.6250, Val: 0.6935, Test: 0.6629, Best time: 65.0000
Epoch: 009/100, Runtime 0.617305, Loss 1.617586, forward nfe 4768, backward nfe 0, Train: 0.6250, Val: 0.6935, Test: 0.6629, Best time: 65.0000
Epoch: 010/100, Runtime 0.600446, Loss 1.571588, forward nfe 5306, backward nfe 0, Train: 0.6250, Val: 0.6935, Test: 0.6629, Best time: 65.0000
Epoch: 011/100, Runtime 0.576803, Loss 1.568992, forward nfe 5838, backward nfe 0, Train: 0.6250, Val: 0.6935, Test: 0.6629, Best time: 65.0000
Epoch: 012/100, Runtime 0.576054, Loss 1.575724, forward nfe 6358, backward nfe 0, Train: 0.6250, Val: 0.6935, Test: 0.6629, Best time: 65.0000
Epoch: 013/100, Runtime 0.576661, Loss 1.527068, forward nfe 6866, backward nfe 0, Train: 0.6500, Val: 0.7065, Test: 0.6935, Best time: 76.2919
Epoch: 014/100, Runtime 0.560178, Loss 1.522397, forward nfe 7362, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7210, Best time: 71.5770
Epoch: 015/100, Runtime 0.560206, Loss 1.517204, forward nfe 7870, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 39.1685
Epoch: 016/100, Runtime 0.580643, Loss 1.456869, forward nfe 8378, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 017/100, Runtime 0.572029, Loss 1.364799, forward nfe 8874, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 018/100, Runtime 0.542733, Loss 1.395707, forward nfe 9352, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 019/100, Runtime 0.532454, Loss 1.328263, forward nfe 9818, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 020/100, Runtime 0.535041, Loss 1.344513, forward nfe 10284, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 021/100, Runtime 0.526388, Loss 1.364186, forward nfe 10744, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 022/100, Runtime 0.513606, Loss 1.285254, forward nfe 11204, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 023/100, Runtime 0.504778, Loss 1.349573, forward nfe 11658, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 024/100, Runtime 0.512132, Loss 1.285640, forward nfe 12106, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 025/100, Runtime 0.489992, Loss 1.282326, forward nfe 12536, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 026/100, Runtime 0.490962, Loss 1.338138, forward nfe 12960, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 027/100, Runtime 0.473779, Loss 1.239053, forward nfe 13384, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 028/100, Runtime 0.473719, Loss 1.237021, forward nfe 13796, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 029/100, Runtime 0.453276, Loss 1.267997, forward nfe 14202, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 030/100, Runtime 0.466580, Loss 1.317098, forward nfe 14602, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 031/100, Runtime 0.438148, Loss 1.221205, forward nfe 15002, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 032/100, Runtime 0.454494, Loss 1.237985, forward nfe 15390, backward nfe 0, Train: 0.6833, Val: 0.7565, Test: 0.7161, Best time: 65.0000
Epoch: 033/100, Runtime 0.454093, Loss 1.237527, forward nfe 15778, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 39.0666
Epoch: 034/100, Runtime 0.440762, Loss 1.221368, forward nfe 16160, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 035/100, Runtime 0.430973, Loss 1.199840, forward nfe 16536, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 036/100, Runtime 0.430628, Loss 1.259898, forward nfe 16906, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 037/100, Runtime 0.419796, Loss 1.168261, forward nfe 17276, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 038/100, Runtime 0.407945, Loss 1.239634, forward nfe 17628, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 039/100, Runtime 0.405019, Loss 1.173959, forward nfe 17980, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 040/100, Runtime 0.399067, Loss 1.337656, forward nfe 18332, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 041/100, Runtime 0.410560, Loss 1.198676, forward nfe 18678, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 042/100, Runtime 0.404741, Loss 1.178316, forward nfe 19024, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 043/100, Runtime 0.395418, Loss 1.327901, forward nfe 19370, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 044/100, Runtime 0.399257, Loss 1.219355, forward nfe 19704, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 045/100, Runtime 0.380574, Loss 1.294549, forward nfe 20032, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 046/100, Runtime 0.368418, Loss 1.375382, forward nfe 20360, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 047/100, Runtime 0.395187, Loss 1.333917, forward nfe 20682, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 048/100, Runtime 0.390348, Loss 1.436725, forward nfe 21004, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 049/100, Runtime 0.394622, Loss 1.331585, forward nfe 21326, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 050/100, Runtime 0.381718, Loss 1.346345, forward nfe 21648, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 051/100, Runtime 0.386283, Loss 1.367182, forward nfe 21964, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 052/100, Runtime 0.399927, Loss 1.253725, forward nfe 22280, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 053/100, Runtime 0.377970, Loss 1.214548, forward nfe 22596, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 054/100, Runtime 0.380196, Loss 1.203647, forward nfe 22912, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 055/100, Runtime 0.356286, Loss 1.297906, forward nfe 23216, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 056/100, Runtime 0.361349, Loss 1.287858, forward nfe 23520, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 057/100, Runtime 0.356365, Loss 1.203490, forward nfe 23818, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 058/100, Runtime 0.351582, Loss 1.312277, forward nfe 24116, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 059/100, Runtime 0.360219, Loss 1.280554, forward nfe 24414, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 060/100, Runtime 0.362423, Loss 1.267564, forward nfe 24712, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 061/100, Runtime 0.363023, Loss 1.315886, forward nfe 25010, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 062/100, Runtime 0.349597, Loss 1.218265, forward nfe 25308, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 063/100, Runtime 0.353580, Loss 1.255980, forward nfe 25606, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 064/100, Runtime 0.361273, Loss 1.229499, forward nfe 25904, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 065/100, Runtime 0.348452, Loss 1.166541, forward nfe 26202, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 066/100, Runtime 0.349574, Loss 1.204688, forward nfe 26494, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 067/100, Runtime 0.355108, Loss 1.314011, forward nfe 26786, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 068/100, Runtime 0.377993, Loss 1.171935, forward nfe 27078, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 069/100, Runtime 0.350553, Loss 1.268940, forward nfe 27376, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 070/100, Runtime 0.350403, Loss 1.269465, forward nfe 27668, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 071/100, Runtime 0.350417, Loss 1.232569, forward nfe 27960, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 072/100, Runtime 0.355429, Loss 1.212461, forward nfe 28252, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 073/100, Runtime 0.476275, Loss 1.316882, forward nfe 28544, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 074/100, Runtime 0.355648, Loss 1.428435, forward nfe 28836, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 075/100, Runtime 0.340996, Loss 1.239041, forward nfe 29128, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 076/100, Runtime 0.354296, Loss 1.237186, forward nfe 29420, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 077/100, Runtime 0.351482, Loss 1.247751, forward nfe 29712, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 078/100, Runtime 0.342873, Loss 1.394458, forward nfe 30004, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 079/100, Runtime 0.365880, Loss 1.327043, forward nfe 30296, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 080/100, Runtime 0.352306, Loss 1.249530, forward nfe 30588, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 081/100, Runtime 0.350068, Loss 1.272955, forward nfe 30880, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 082/100, Runtime 0.350936, Loss 1.203614, forward nfe 31166, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 083/100, Runtime 0.351371, Loss 1.317312, forward nfe 31458, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 084/100, Runtime 0.350268, Loss 1.243112, forward nfe 31744, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 085/100, Runtime 0.366687, Loss 1.260143, forward nfe 32030, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 086/100, Runtime 0.344609, Loss 1.258973, forward nfe 32316, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 087/100, Runtime 0.354789, Loss 1.133795, forward nfe 32602, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 088/100, Runtime 0.343773, Loss 1.094753, forward nfe 32888, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 089/100, Runtime 0.343872, Loss 1.258156, forward nfe 33174, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 090/100, Runtime 0.358903, Loss 1.176895, forward nfe 33460, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 091/100, Runtime 0.360888, Loss 1.280206, forward nfe 33746, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 092/100, Runtime 0.349647, Loss 1.072352, forward nfe 34032, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 093/100, Runtime 0.351062, Loss 1.294452, forward nfe 34312, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 094/100, Runtime 0.341813, Loss 1.204274, forward nfe 34592, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 095/100, Runtime 0.335128, Loss 1.156487, forward nfe 34866, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 096/100, Runtime 0.336841, Loss 1.270469, forward nfe 35140, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 097/100, Runtime 0.347206, Loss 1.287381, forward nfe 35414, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 098/100, Runtime 0.335611, Loss 1.372378, forward nfe 35688, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
Epoch: 099/100, Runtime 0.361825, Loss 1.320869, forward nfe 35968, backward nfe 0, Train: 0.7833, Val: 0.7717, Test: 0.7387, Best time: 65.0000
best val accuracy 0.771739 with test accuracy 0.738710 at epoch 33 and best time 65.000000