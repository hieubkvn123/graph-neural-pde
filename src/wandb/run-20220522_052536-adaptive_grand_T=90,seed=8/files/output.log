/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 5.478851, Loss 1.948177, forward nfe 170, backward nfe 0, Train: 0.1500, Val: 0.1449, Test: 0.1330, Best time: 0.0931
Epoch: 002/100, Runtime 5.348852, Loss 2.012204, forward nfe 834, backward nfe 0, Train: 0.1500, Val: 0.1449, Test: 0.1330, Best time: 90.0000
Epoch: 003/100, Runtime 5.137661, Loss 1.960179, forward nfe 1480, backward nfe 0, Train: 0.1500, Val: 0.1449, Test: 0.1330, Best time: 90.0000
Epoch: 004/100, Runtime 5.053977, Loss 1.939287, forward nfe 2126, backward nfe 0, Train: 0.1500, Val: 0.1449, Test: 0.1330, Best time: 90.0000
Epoch: 005/100, Runtime 4.949049, Loss 1.919591, forward nfe 2766, backward nfe 0, Train: 0.2286, Val: 0.2088, Test: 0.2223, Best time: 0.0828
Epoch: 006/100, Runtime 4.906862, Loss 1.886095, forward nfe 3376, backward nfe 0, Train: 0.4714, Val: 0.5338, Test: 0.5401, Best time: 5.2179
Epoch: 007/100, Runtime 4.756526, Loss 1.849949, forward nfe 3986, backward nfe 0, Train: 0.5786, Val: 0.6382, Test: 0.6497, Best time: 5.4171
Epoch: 008/100, Runtime 4.624886, Loss 1.799881, forward nfe 4566, backward nfe 0, Train: 0.5786, Val: 0.6382, Test: 0.6497, Best time: 90.0000
Epoch: 009/100, Runtime 4.588224, Loss 1.717396, forward nfe 5134, backward nfe 0, Train: 0.6071, Val: 0.6772, Test: 0.6599, Best time: 8.1035
Epoch: 010/100, Runtime 4.405772, Loss 1.627608, forward nfe 5684, backward nfe 0, Train: 0.6929, Val: 0.7301, Test: 0.7117, Best time: 6.1501
Epoch: 011/100, Runtime 4.260686, Loss 1.518596, forward nfe 6216, backward nfe 0, Train: 0.7857, Val: 0.7581, Test: 0.7513, Best time: 15.5758
Epoch: 012/100, Runtime 4.364900, Loss 1.421435, forward nfe 6742, backward nfe 0, Train: 0.7857, Val: 0.7581, Test: 0.7513, Best time: 90.0000
Epoch: 013/100, Runtime 4.278478, Loss 1.308857, forward nfe 7256, backward nfe 0, Train: 0.8071, Val: 0.7757, Test: 0.7655, Best time: 190.2253
Epoch: 014/100, Runtime 4.045814, Loss 1.132084, forward nfe 7770, backward nfe 0, Train: 0.8071, Val: 0.7757, Test: 0.7655, Best time: 90.0000
Epoch: 015/100, Runtime 4.073847, Loss 1.041152, forward nfe 8278, backward nfe 0, Train: 0.8357, Val: 0.7941, Test: 0.7980, Best time: 40.0592
Epoch: 016/100, Runtime 3.868919, Loss 0.927384, forward nfe 8768, backward nfe 0, Train: 0.8714, Val: 0.8037, Test: 0.7990, Best time: 34.3280
Epoch: 017/100, Runtime 3.717307, Loss 0.820559, forward nfe 9246, backward nfe 0, Train: 0.8714, Val: 0.8037, Test: 0.7990, Best time: 90.0000
Epoch: 018/100, Runtime 3.693650, Loss 0.763431, forward nfe 9700, backward nfe 0, Train: 0.8714, Val: 0.8037, Test: 0.7990, Best time: 90.0000
Epoch: 019/100, Runtime 3.452876, Loss 0.751111, forward nfe 10148, backward nfe 0, Train: 0.8714, Val: 0.8037, Test: 0.7990, Best time: 90.0000
Epoch: 020/100, Runtime 3.445380, Loss 0.615845, forward nfe 10566, backward nfe 0, Train: 0.8714, Val: 0.8037, Test: 0.7990, Best time: 90.0000
Epoch: 021/100, Runtime 3.400012, Loss 0.571864, forward nfe 10978, backward nfe 0, Train: 0.9000, Val: 0.8132, Test: 0.7980, Best time: 33.7530
Epoch: 022/100, Runtime 3.311260, Loss 0.573441, forward nfe 11384, backward nfe 0, Train: 0.8643, Val: 0.8324, Test: 0.8152, Best time: 163.7228
Epoch: 023/100, Runtime 3.224191, Loss 0.504497, forward nfe 11790, backward nfe 0, Train: 0.8643, Val: 0.8324, Test: 0.8152, Best time: 90.0000
Epoch: 024/100, Runtime 3.209706, Loss 0.535549, forward nfe 12190, backward nfe 0, Train: 0.9143, Val: 0.8368, Test: 0.8284, Best time: 67.1261
Epoch: 025/100, Runtime 2.941287, Loss 0.510626, forward nfe 12578, backward nfe 0, Train: 0.9143, Val: 0.8368, Test: 0.8284, Best time: 90.0000
Epoch: 026/100, Runtime 2.633801, Loss 0.482079, forward nfe 12948, backward nfe 0, Train: 0.9143, Val: 0.8368, Test: 0.8284, Best time: 90.0000
Epoch: 027/100, Runtime 2.631560, Loss 0.436089, forward nfe 13306, backward nfe 0, Train: 0.9143, Val: 0.8419, Test: 0.8386, Best time: 147.4810
Epoch: 028/100, Runtime 2.601578, Loss 0.419970, forward nfe 13652, backward nfe 0, Train: 0.9143, Val: 0.8419, Test: 0.8386, Best time: 90.0000
Epoch: 029/100, Runtime 2.667026, Loss 0.406347, forward nfe 13998, backward nfe 0, Train: 0.9143, Val: 0.8419, Test: 0.8386, Best time: 90.0000
Epoch: 030/100, Runtime 2.764442, Loss 0.390611, forward nfe 14332, backward nfe 0, Train: 0.9143, Val: 0.8419, Test: 0.8386, Best time: 90.0000
Epoch: 031/100, Runtime 2.515251, Loss 0.429819, forward nfe 14672, backward nfe 0, Train: 0.9143, Val: 0.8419, Test: 0.8386, Best time: 90.0000
Epoch: 032/100, Runtime 2.452564, Loss 0.394935, forward nfe 14988, backward nfe 0, Train: 0.9143, Val: 0.8419, Test: 0.8386, Best time: 90.0000
Epoch: 033/100, Runtime 2.478786, Loss 0.464406, forward nfe 15292, backward nfe 0, Train: 0.9143, Val: 0.8419, Test: 0.8386, Best time: 90.0000
Epoch: 034/100, Runtime 2.447640, Loss 0.394064, forward nfe 15590, backward nfe 0, Train: 0.9143, Val: 0.8419, Test: 0.8386, Best time: 90.0000
Epoch: 035/100, Runtime 2.535634, Loss 0.320622, forward nfe 15894, backward nfe 0, Train: 0.9143, Val: 0.8419, Test: 0.8386, Best time: 90.0000
Epoch: 036/100, Runtime 2.380679, Loss 0.448693, forward nfe 16180, backward nfe 0, Train: 0.9143, Val: 0.8419, Test: 0.8386, Best time: 90.0000
Epoch: 037/100, Runtime 2.269558, Loss 0.315738, forward nfe 16472, backward nfe 0, Train: 0.9143, Val: 0.8419, Test: 0.8386, Best time: 90.0000
Epoch: 038/100, Runtime 2.281179, Loss 0.331185, forward nfe 16752, backward nfe 0, Train: 0.9143, Val: 0.8419, Test: 0.8386, Best time: 90.0000
Epoch: 039/100, Runtime 2.259949, Loss 0.384621, forward nfe 17026, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 99.6206
Epoch: 040/100, Runtime 2.176932, Loss 0.265055, forward nfe 17294, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 041/100, Runtime 2.026111, Loss 0.391238, forward nfe 17568, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 042/100, Runtime 1.942201, Loss 0.226997, forward nfe 17824, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 043/100, Runtime 1.844238, Loss 0.340987, forward nfe 18086, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 044/100, Runtime 1.858702, Loss 0.249018, forward nfe 18342, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 045/100, Runtime 2.078551, Loss 0.270675, forward nfe 18604, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 046/100, Runtime 2.112450, Loss 0.336025, forward nfe 18866, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 047/100, Runtime 2.209222, Loss 0.233242, forward nfe 19128, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 048/100, Runtime 2.075211, Loss 0.250239, forward nfe 19390, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 049/100, Runtime 2.002952, Loss 0.228268, forward nfe 19634, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 050/100, Runtime 1.997357, Loss 0.213042, forward nfe 19878, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 051/100, Runtime 1.872534, Loss 0.172328, forward nfe 20122, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 052/100, Runtime 1.825362, Loss 0.223677, forward nfe 20366, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 053/100, Runtime 1.682424, Loss 0.242842, forward nfe 20610, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 054/100, Runtime 1.901243, Loss 0.158921, forward nfe 20848, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 055/100, Runtime 1.944070, Loss 0.220017, forward nfe 21092, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 056/100, Runtime 1.905431, Loss 0.226813, forward nfe 21336, backward nfe 0, Train: 0.9571, Val: 0.8471, Test: 0.8457, Best time: 90.0000
Epoch: 057/100, Runtime 1.986645, Loss 0.153809, forward nfe 21586, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 226.2688
Epoch: 058/100, Runtime 2.121830, Loss 0.163664, forward nfe 21842, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 059/100, Runtime 2.620925, Loss 0.178988, forward nfe 22098, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 060/100, Runtime 2.882992, Loss 0.141636, forward nfe 22354, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 061/100, Runtime 2.922390, Loss 0.144004, forward nfe 22610, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 062/100, Runtime 2.880254, Loss 0.133709, forward nfe 22860, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 063/100, Runtime 2.890228, Loss 0.153639, forward nfe 23110, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 064/100, Runtime 2.777403, Loss 0.144324, forward nfe 23360, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 065/100, Runtime 2.889598, Loss 0.130434, forward nfe 23604, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 066/100, Runtime 2.828092, Loss 0.145997, forward nfe 23854, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 067/100, Runtime 2.870665, Loss 0.209303, forward nfe 24104, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 068/100, Runtime 2.681848, Loss 0.141884, forward nfe 24354, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 069/100, Runtime 1.921057, Loss 0.251892, forward nfe 24604, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 070/100, Runtime 1.986636, Loss 0.176211, forward nfe 24854, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 071/100, Runtime 1.990898, Loss 0.215352, forward nfe 25104, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 072/100, Runtime 2.080836, Loss 0.126879, forward nfe 25354, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 073/100, Runtime 2.103608, Loss 0.131997, forward nfe 25604, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 074/100, Runtime 2.092506, Loss 0.152698, forward nfe 25854, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 075/100, Runtime 1.908353, Loss 0.146219, forward nfe 26104, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 076/100, Runtime 1.922212, Loss 0.089936, forward nfe 26342, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 077/100, Runtime 2.004909, Loss 0.109058, forward nfe 26580, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 078/100, Runtime 1.932237, Loss 0.177636, forward nfe 26818, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 079/100, Runtime 1.888366, Loss 0.163977, forward nfe 27056, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 080/100, Runtime 1.916188, Loss 0.209838, forward nfe 27294, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 081/100, Runtime 2.026815, Loss 0.088954, forward nfe 27532, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 082/100, Runtime 1.944642, Loss 0.219068, forward nfe 27770, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 083/100, Runtime 2.015017, Loss 0.146086, forward nfe 28008, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 084/100, Runtime 1.977660, Loss 0.080396, forward nfe 28246, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 085/100, Runtime 2.155813, Loss 0.099778, forward nfe 28490, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 086/100, Runtime 2.037551, Loss 0.164892, forward nfe 28734, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 087/100, Runtime 1.935721, Loss 0.103616, forward nfe 28978, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 088/100, Runtime 1.964386, Loss 0.096353, forward nfe 29216, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 089/100, Runtime 2.008469, Loss 0.072808, forward nfe 29454, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 090/100, Runtime 1.951072, Loss 0.123915, forward nfe 29692, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 091/100, Runtime 1.940206, Loss 0.111207, forward nfe 29930, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 092/100, Runtime 1.931193, Loss 0.061167, forward nfe 30162, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 093/100, Runtime 1.909756, Loss 0.073083, forward nfe 30394, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 094/100, Runtime 1.869993, Loss 0.062693, forward nfe 30626, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 095/100, Runtime 1.886950, Loss 0.058484, forward nfe 30858, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 096/100, Runtime 1.884854, Loss 0.065941, forward nfe 31090, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 097/100, Runtime 1.869626, Loss 0.065220, forward nfe 31322, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 098/100, Runtime 1.876432, Loss 0.040706, forward nfe 31554, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
Epoch: 099/100, Runtime 1.827636, Loss 0.045983, forward nfe 31786, backward nfe 0, Train: 0.9643, Val: 0.8485, Test: 0.8386, Best time: 90.0000
best val accuracy 0.848529 with test accuracy 0.838579 at epoch 57 and best time 90.000000