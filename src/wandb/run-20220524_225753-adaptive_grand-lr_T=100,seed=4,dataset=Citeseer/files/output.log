/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 1.016420, Loss 1.792938, forward nfe 242, backward nfe 0, Train: 0.2833, Val: 0.2913, Test: 0.2823, Best time: 10.2946
Epoch: 002/100, Runtime 0.905868, Loss 1.770597, forward nfe 1062, backward nfe 0, Train: 0.3417, Val: 0.3167, Test: 0.3048, Best time: 8.5407
Epoch: 003/100, Runtime 0.906990, Loss 1.756023, forward nfe 1864, backward nfe 0, Train: 0.4667, Val: 0.4797, Test: 0.4565, Best time: 160.8685
Epoch: 004/100, Runtime 0.889572, Loss 1.717380, forward nfe 2666, backward nfe 0, Train: 0.5583, Val: 0.5268, Test: 0.5145, Best time: 163.6118
Epoch: 005/100, Runtime 0.873589, Loss 1.670057, forward nfe 3450, backward nfe 0, Train: 0.6083, Val: 0.5659, Test: 0.5661, Best time: 44.3226
Epoch: 006/100, Runtime 0.856099, Loss 1.642721, forward nfe 4240, backward nfe 0, Train: 0.6250, Val: 0.5870, Test: 0.5710, Best time: 13.1900
Epoch: 007/100, Runtime 0.841375, Loss 1.571530, forward nfe 5006, backward nfe 0, Train: 0.6333, Val: 0.6659, Test: 0.6645, Best time: 58.7280
Epoch: 008/100, Runtime 0.833336, Loss 1.573934, forward nfe 5766, backward nfe 0, Train: 0.6917, Val: 0.7348, Test: 0.7323, Best time: 89.8531
Epoch: 009/100, Runtime 0.821836, Loss 1.548216, forward nfe 6514, backward nfe 0, Train: 0.6917, Val: 0.7348, Test: 0.7323, Best time: 100.0000
Epoch: 010/100, Runtime 0.828201, Loss 1.547607, forward nfe 7244, backward nfe 0, Train: 0.6917, Val: 0.7348, Test: 0.7323, Best time: 100.0000
Epoch: 011/100, Runtime 0.800775, Loss 1.523258, forward nfe 7956, backward nfe 0, Train: 0.6917, Val: 0.7348, Test: 0.7323, Best time: 100.0000
Epoch: 012/100, Runtime 0.853632, Loss 1.503319, forward nfe 8674, backward nfe 0, Train: 0.6917, Val: 0.7348, Test: 0.7323, Best time: 100.0000
Epoch: 013/100, Runtime 0.791453, Loss 1.545078, forward nfe 9374, backward nfe 0, Train: 0.6917, Val: 0.7348, Test: 0.7323, Best time: 100.0000
Epoch: 014/100, Runtime 0.772934, Loss 1.467022, forward nfe 10062, backward nfe 0, Train: 0.7000, Val: 0.7377, Test: 0.7387, Best time: 30.6892
Epoch: 015/100, Runtime 0.748077, Loss 1.442123, forward nfe 10750, backward nfe 0, Train: 0.7000, Val: 0.7377, Test: 0.7387, Best time: 100.0000
Epoch: 016/100, Runtime 0.730952, Loss 1.389140, forward nfe 11426, backward nfe 0, Train: 0.7000, Val: 0.7377, Test: 0.7387, Best time: 100.0000
Epoch: 017/100, Runtime 0.742159, Loss 1.352577, forward nfe 12090, backward nfe 0, Train: 0.7000, Val: 0.7377, Test: 0.7387, Best time: 100.0000
Epoch: 018/100, Runtime 0.720161, Loss 1.327562, forward nfe 12742, backward nfe 0, Train: 0.7000, Val: 0.7384, Test: 0.7306, Best time: 102.8317
Epoch: 019/100, Runtime 0.706450, Loss 1.301043, forward nfe 13382, backward nfe 0, Train: 0.7000, Val: 0.7384, Test: 0.7306, Best time: 100.0000
Epoch: 020/100, Runtime 0.700933, Loss 1.450327, forward nfe 14004, backward nfe 0, Train: 0.7000, Val: 0.7384, Test: 0.7306, Best time: 100.0000
Epoch: 021/100, Runtime 0.680228, Loss 1.340999, forward nfe 14626, backward nfe 0, Train: 0.7000, Val: 0.7384, Test: 0.7306, Best time: 100.0000
Epoch: 022/100, Runtime 0.661445, Loss 1.364386, forward nfe 15230, backward nfe 0, Train: 0.7000, Val: 0.7384, Test: 0.7306, Best time: 100.0000
Epoch: 023/100, Runtime 0.676009, Loss 1.435137, forward nfe 15828, backward nfe 0, Train: 0.7000, Val: 0.7384, Test: 0.7306, Best time: 100.0000
Epoch: 024/100, Runtime 0.667092, Loss 1.354477, forward nfe 16420, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 40.2239
Epoch: 025/100, Runtime 0.629148, Loss 1.293858, forward nfe 17006, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 026/100, Runtime 0.631507, Loss 1.285986, forward nfe 17574, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 027/100, Runtime 0.617454, Loss 1.254963, forward nfe 18136, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 028/100, Runtime 0.635953, Loss 1.281879, forward nfe 18692, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 029/100, Runtime 0.638696, Loss 1.404264, forward nfe 19242, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 030/100, Runtime 0.587223, Loss 1.296620, forward nfe 19786, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 031/100, Runtime 0.610944, Loss 1.230670, forward nfe 20312, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 032/100, Runtime 0.602167, Loss 1.327876, forward nfe 20832, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 033/100, Runtime 0.593550, Loss 1.273515, forward nfe 21352, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 034/100, Runtime 0.591637, Loss 1.358037, forward nfe 21860, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 035/100, Runtime 0.566848, Loss 1.258295, forward nfe 22356, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 036/100, Runtime 0.558358, Loss 1.246394, forward nfe 22852, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 037/100, Runtime 0.567202, Loss 1.377946, forward nfe 23336, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 038/100, Runtime 0.552291, Loss 1.320532, forward nfe 23826, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 039/100, Runtime 0.529301, Loss 1.320287, forward nfe 24298, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 040/100, Runtime 0.520068, Loss 1.319708, forward nfe 24758, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 041/100, Runtime 0.638202, Loss 1.328997, forward nfe 25212, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 042/100, Runtime 0.510420, Loss 1.279609, forward nfe 25654, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7419, Best time: 100.0000
Epoch: 043/100, Runtime 0.516252, Loss 1.262642, forward nfe 26090, backward nfe 0, Train: 0.7750, Val: 0.7471, Test: 0.7306, Best time: 58.7572
Epoch: 044/100, Runtime 0.506563, Loss 1.234245, forward nfe 26526, backward nfe 0, Train: 0.7750, Val: 0.7471, Test: 0.7306, Best time: 100.0000
Epoch: 045/100, Runtime 0.513335, Loss 1.356956, forward nfe 26956, backward nfe 0, Train: 0.7750, Val: 0.7471, Test: 0.7306, Best time: 100.0000
Epoch: 046/100, Runtime 0.472755, Loss 1.348233, forward nfe 27380, backward nfe 0, Train: 0.7750, Val: 0.7471, Test: 0.7306, Best time: 100.0000
Epoch: 047/100, Runtime 0.478957, Loss 1.213467, forward nfe 27798, backward nfe 0, Train: 0.7750, Val: 0.7471, Test: 0.7306, Best time: 100.0000
Epoch: 048/100, Runtime 0.474950, Loss 1.378109, forward nfe 28204, backward nfe 0, Train: 0.7750, Val: 0.7471, Test: 0.7306, Best time: 100.0000
Epoch: 049/100, Runtime 0.469652, Loss 1.227096, forward nfe 28616, backward nfe 0, Train: 0.7750, Val: 0.7471, Test: 0.7306, Best time: 100.0000
Epoch: 050/100, Runtime 0.472361, Loss 1.258178, forward nfe 29028, backward nfe 0, Train: 0.7750, Val: 0.7471, Test: 0.7306, Best time: 100.0000
Epoch: 051/100, Runtime 0.471610, Loss 1.148949, forward nfe 29428, backward nfe 0, Train: 0.7750, Val: 0.7471, Test: 0.7306, Best time: 100.0000
Epoch: 052/100, Runtime 0.456870, Loss 1.209956, forward nfe 29822, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 44.3463
Epoch: 053/100, Runtime 0.436641, Loss 1.359614, forward nfe 30210, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 054/100, Runtime 0.439129, Loss 1.333535, forward nfe 30592, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 055/100, Runtime 0.435574, Loss 1.312215, forward nfe 30974, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 056/100, Runtime 0.438718, Loss 1.349578, forward nfe 31356, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 057/100, Runtime 0.431847, Loss 1.300074, forward nfe 31732, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 058/100, Runtime 0.435137, Loss 1.326781, forward nfe 32108, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 059/100, Runtime 0.429561, Loss 1.183908, forward nfe 32478, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 060/100, Runtime 0.439239, Loss 1.342739, forward nfe 32848, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 061/100, Runtime 0.429449, Loss 1.232863, forward nfe 33218, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 062/100, Runtime 0.440674, Loss 1.290039, forward nfe 33588, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 063/100, Runtime 0.444722, Loss 1.240803, forward nfe 33958, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 064/100, Runtime 0.438638, Loss 1.255745, forward nfe 34322, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 065/100, Runtime 0.431788, Loss 1.261739, forward nfe 34686, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 066/100, Runtime 0.425644, Loss 1.222513, forward nfe 35050, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 067/100, Runtime 0.434145, Loss 1.331078, forward nfe 35414, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 068/100, Runtime 0.433728, Loss 1.324030, forward nfe 35778, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 069/100, Runtime 0.431553, Loss 1.260230, forward nfe 36136, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 070/100, Runtime 0.439677, Loss 1.300549, forward nfe 36494, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 071/100, Runtime 0.440142, Loss 1.259896, forward nfe 36852, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 072/100, Runtime 0.433466, Loss 1.269997, forward nfe 37216, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 073/100, Runtime 0.430466, Loss 1.334704, forward nfe 37580, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 074/100, Runtime 0.438997, Loss 1.281710, forward nfe 37944, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 075/100, Runtime 0.432592, Loss 1.294209, forward nfe 38302, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 076/100, Runtime 0.407142, Loss 1.332556, forward nfe 38654, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 077/100, Runtime 0.421642, Loss 1.201068, forward nfe 39006, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 078/100, Runtime 0.433085, Loss 1.279083, forward nfe 39358, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 079/100, Runtime 0.429428, Loss 1.151410, forward nfe 39716, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 080/100, Runtime 0.418774, Loss 1.232320, forward nfe 40068, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 081/100, Runtime 0.417867, Loss 1.279665, forward nfe 40414, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 082/100, Runtime 0.426041, Loss 1.156766, forward nfe 40760, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 083/100, Runtime 0.419570, Loss 1.409559, forward nfe 41112, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 084/100, Runtime 0.421361, Loss 1.373592, forward nfe 41458, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 085/100, Runtime 0.405455, Loss 1.245709, forward nfe 41804, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 086/100, Runtime 0.395438, Loss 1.338195, forward nfe 42150, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 087/100, Runtime 0.404327, Loss 1.234888, forward nfe 42490, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 088/100, Runtime 0.401346, Loss 1.238615, forward nfe 42830, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 089/100, Runtime 0.414989, Loss 1.145781, forward nfe 43170, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 090/100, Runtime 0.408571, Loss 1.399871, forward nfe 43510, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 091/100, Runtime 0.402162, Loss 1.347122, forward nfe 43850, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 092/100, Runtime 0.400545, Loss 1.288992, forward nfe 44190, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 093/100, Runtime 0.424595, Loss 1.273950, forward nfe 44530, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 094/100, Runtime 0.419057, Loss 1.315167, forward nfe 44870, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 095/100, Runtime 0.403493, Loss 1.125444, forward nfe 45210, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 096/100, Runtime 0.407061, Loss 1.399570, forward nfe 45544, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 097/100, Runtime 0.412838, Loss 1.210326, forward nfe 45878, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 098/100, Runtime 0.395706, Loss 1.398588, forward nfe 46212, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
Epoch: 099/100, Runtime 0.422954, Loss 1.144610, forward nfe 46540, backward nfe 0, Train: 0.8167, Val: 0.7522, Test: 0.7419, Best time: 100.0000
best val accuracy 0.752174 with test accuracy 0.741935 at epoch 52 and best time 100.000000