/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 16.048466, Loss 1.100003, forward nfe 68, backward nfe 1548, Train: 0.7000, Val: 0.5639, Test: 0.5773, Best time: 2.6121
Epoch: 002/100, Runtime 17.177474, Loss 1.094854, forward nfe 432, backward nfe 3232, Train: 0.6667, Val: 0.6028, Test: 0.5848, Best time: 2.6870
Epoch: 003/100, Runtime 16.174788, Loss 1.086343, forward nfe 790, backward nfe 4779, Train: 0.7000, Val: 0.6299, Test: 0.6125, Best time: 2.6448
Epoch: 004/100, Runtime 12.823933, Loss 1.072546, forward nfe 1142, backward nfe 6009, Train: 0.7500, Val: 0.6708, Test: 0.6752, Best time: 20.6241
Epoch: 005/100, Runtime 16.763509, Loss 1.051776, forward nfe 1494, backward nfe 7631, Train: 0.7500, Val: 0.6993, Test: 0.7074, Best time: 51.3131
Epoch: 006/100, Runtime 16.282515, Loss 1.019175, forward nfe 1834, backward nfe 9221, Train: 0.7667, Val: 0.7111, Test: 0.7105, Best time: 2.4423
Epoch: 007/100, Runtime 15.598342, Loss 0.982503, forward nfe 2174, backward nfe 10731, Train: 0.7333, Val: 0.7118, Test: 0.7160, Best time: 2.3959
Epoch: 008/100, Runtime 14.014415, Loss 0.936083, forward nfe 2502, backward nfe 12062, Train: 0.7500, Val: 0.7146, Test: 0.7192, Best time: 2.3553
Epoch: 009/100, Runtime 14.425060, Loss 0.883381, forward nfe 2824, backward nfe 13468, Train: 0.7500, Val: 0.7146, Test: 0.7192, Best time: 30.0000
Epoch: 010/100, Runtime 13.758768, Loss 0.830959, forward nfe 3140, backward nfe 14807, Train: 0.7500, Val: 0.7146, Test: 0.7192, Best time: 30.0000
Epoch: 011/100, Runtime 12.597878, Loss 0.772123, forward nfe 3456, backward nfe 16029, Train: 0.7500, Val: 0.7146, Test: 0.7192, Best time: 30.0000
Epoch: 012/100, Runtime 7.400754, Loss 0.706236, forward nfe 3760, backward nfe 16707, Train: 0.7667, Val: 0.7167, Test: 0.7217, Best time: 5.7796
Epoch: 013/100, Runtime 10.949284, Loss 0.648505, forward nfe 4064, backward nfe 17759, Train: 0.8333, Val: 0.7188, Test: 0.7316, Best time: 2.1704
Epoch: 014/100, Runtime 11.155212, Loss 0.596782, forward nfe 4362, backward nfe 18798, Train: 0.8667, Val: 0.7250, Test: 0.7422, Best time: 2.1365
Epoch: 015/100, Runtime 10.867321, Loss 0.541764, forward nfe 4660, backward nfe 19810, Train: 0.9167, Val: 0.7368, Test: 0.7508, Best time: 2.1060
Epoch: 016/100, Runtime 9.800351, Loss 0.519050, forward nfe 4952, backward nfe 20721, Train: 0.9000, Val: 0.7431, Test: 0.7553, Best time: 2.0795
Epoch: 017/100, Runtime 7.901589, Loss 0.449690, forward nfe 5244, backward nfe 21458, Train: 0.9000, Val: 0.7431, Test: 0.7553, Best time: 30.0000
Epoch: 018/100, Runtime 5.986623, Loss 0.422393, forward nfe 5530, backward nfe 21998, Train: 0.9000, Val: 0.7507, Test: 0.7585, Best time: 11.0047
Epoch: 019/100, Runtime 7.262959, Loss 0.407304, forward nfe 5816, backward nfe 22674, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 17.9074
Epoch: 020/100, Runtime 7.564077, Loss 0.384765, forward nfe 6084, backward nfe 23375, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 021/100, Runtime 6.787164, Loss 0.332054, forward nfe 6352, backward nfe 23997, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 022/100, Runtime 4.367733, Loss 0.363747, forward nfe 6614, backward nfe 24382, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 023/100, Runtime 1.902804, Loss 0.336749, forward nfe 6882, backward nfe 24508, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 024/100, Runtime 4.640381, Loss 0.287137, forward nfe 7144, backward nfe 24907, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 025/100, Runtime 4.721230, Loss 0.322076, forward nfe 7406, backward nfe 25318, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 026/100, Runtime 3.982678, Loss 0.318284, forward nfe 7662, backward nfe 25656, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 027/100, Runtime 3.205275, Loss 0.354453, forward nfe 7918, backward nfe 25918, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 028/100, Runtime 2.827426, Loss 0.253194, forward nfe 8162, backward nfe 26142, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 029/100, Runtime 3.347991, Loss 0.297198, forward nfe 8406, backward nfe 26420, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 030/100, Runtime 3.712134, Loss 0.313030, forward nfe 8632, backward nfe 26739, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 031/100, Runtime 3.729089, Loss 0.364362, forward nfe 8858, backward nfe 27061, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 032/100, Runtime 3.154833, Loss 0.218758, forward nfe 9078, backward nfe 27327, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 033/100, Runtime 2.231430, Loss 0.244407, forward nfe 9292, backward nfe 27500, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 034/100, Runtime 1.154521, Loss 0.223266, forward nfe 9506, backward nfe 27561, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 035/100, Runtime 2.055010, Loss 0.191014, forward nfe 9720, backward nfe 27717, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 036/100, Runtime 2.112399, Loss 0.198800, forward nfe 9928, backward nfe 27879, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 037/100, Runtime 2.095972, Loss 0.193978, forward nfe 10136, backward nfe 28039, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 038/100, Runtime 1.609453, Loss 0.253734, forward nfe 10344, backward nfe 28152, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 039/100, Runtime 1.594635, Loss 0.173670, forward nfe 10546, backward nfe 28264, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 040/100, Runtime 1.522521, Loss 0.217243, forward nfe 10754, backward nfe 28366, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 041/100, Runtime 1.487498, Loss 0.145352, forward nfe 10956, backward nfe 28467, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 042/100, Runtime 2.031265, Loss 0.178534, forward nfe 11152, backward nfe 28625, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 043/100, Runtime 2.259833, Loss 0.185373, forward nfe 11342, backward nfe 28807, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 044/100, Runtime 1.850329, Loss 0.175502, forward nfe 11532, backward nfe 28947, Train: 0.8833, Val: 0.7583, Test: 0.7690, Best time: 30.0000
Epoch: 045/100, Runtime 1.759108, Loss 0.157862, forward nfe 11722, backward nfe 29077, Train: 1.0000, Val: 0.7618, Test: 0.7742, Best time: 13.3053
Epoch: 046/100, Runtime 1.636778, Loss 0.187100, forward nfe 11918, backward nfe 29196, Train: 1.0000, Val: 0.7618, Test: 0.7742, Best time: 30.0000
Epoch: 047/100, Runtime 1.265545, Loss 0.161360, forward nfe 12102, backward nfe 29280, Train: 1.0000, Val: 0.7618, Test: 0.7742, Best time: 30.0000
Epoch: 048/100, Runtime 1.289434, Loss 0.149690, forward nfe 12280, backward nfe 29367, Train: 1.0000, Val: 0.7618, Test: 0.7742, Best time: 30.0000
Epoch: 049/100, Runtime 1.155772, Loss 0.111734, forward nfe 12458, backward nfe 29439, Train: 1.0000, Val: 0.7618, Test: 0.7742, Best time: 30.0000
Epoch: 050/100, Runtime 0.969069, Loss 0.155414, forward nfe 12636, backward nfe 29490, Train: 1.0000, Val: 0.7618, Test: 0.7742, Best time: 30.0000
Epoch: 051/100, Runtime 1.290336, Loss 0.132886, forward nfe 12814, backward nfe 29576, Train: 1.0000, Val: 0.7618, Test: 0.7742, Best time: 30.0000
Epoch: 052/100, Runtime 1.196090, Loss 0.130137, forward nfe 12992, backward nfe 29655, Train: 1.0000, Val: 0.7618, Test: 0.7742, Best time: 30.0000
Epoch: 053/100, Runtime 1.200102, Loss 0.195553, forward nfe 13164, backward nfe 29733, Train: 1.0000, Val: 0.7618, Test: 0.7742, Best time: 30.0000
Epoch: 054/100, Runtime 1.113715, Loss 0.160821, forward nfe 13336, backward nfe 29803, Train: 1.0000, Val: 0.7618, Test: 0.7742, Best time: 30.0000
Epoch: 055/100, Runtime 0.908300, Loss 0.116947, forward nfe 13502, backward nfe 29855, Train: 1.0000, Val: 0.7618, Test: 0.7742, Best time: 30.0000
Epoch: 056/100, Runtime 0.964466, Loss 0.213368, forward nfe 13662, backward nfe 29911, Train: 1.0000, Val: 0.7618, Test: 0.7742, Best time: 30.0000
Epoch: 057/100, Runtime 0.873113, Loss 0.127420, forward nfe 13828, backward nfe 29957, Train: 1.0000, Val: 0.7618, Test: 0.7742, Best time: 30.0000
Epoch: 058/100, Runtime 0.801024, Loss 0.102274, forward nfe 13994, backward nfe 29996, Train: 1.0000, Val: 0.7618, Test: 0.7742, Best time: 30.0000
Epoch: 059/100, Runtime 0.819320, Loss 0.179520, forward nfe 14154, backward nfe 30038, Train: 1.0000, Val: 0.7618, Test: 0.7742, Best time: 30.0000
Epoch: 060/100, Runtime 0.911723, Loss 0.161024, forward nfe 14314, backward nfe 30090, Train: 0.9000, Val: 0.7667, Test: 0.7694, Best time: 95.1515
Epoch: 061/100, Runtime 0.787574, Loss 0.125755, forward nfe 14474, backward nfe 30131, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 37.9670
Epoch: 062/100, Runtime 0.929798, Loss 0.163595, forward nfe 14628, backward nfe 30187, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 063/100, Runtime 0.903140, Loss 0.133183, forward nfe 14782, backward nfe 30240, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 064/100, Runtime 0.925830, Loss 0.085006, forward nfe 14936, backward nfe 30295, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 065/100, Runtime 0.942608, Loss 0.092378, forward nfe 15090, backward nfe 30350, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 066/100, Runtime 0.972717, Loss 0.108908, forward nfe 15250, backward nfe 30406, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 067/100, Runtime 0.927066, Loss 0.137084, forward nfe 15416, backward nfe 30458, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 068/100, Runtime 0.978967, Loss 0.066644, forward nfe 15582, backward nfe 30517, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 069/100, Runtime 0.893800, Loss 0.107110, forward nfe 15742, backward nfe 30567, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 070/100, Runtime 0.978830, Loss 0.117707, forward nfe 15902, backward nfe 30626, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 071/100, Runtime 1.104479, Loss 0.183206, forward nfe 16062, backward nfe 30700, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 072/100, Runtime 0.923269, Loss 0.049399, forward nfe 16216, backward nfe 30755, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 073/100, Runtime 1.042093, Loss 0.138142, forward nfe 16370, backward nfe 30821, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 074/100, Runtime 1.042832, Loss 0.085124, forward nfe 16524, backward nfe 30887, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 075/100, Runtime 0.903014, Loss 0.061637, forward nfe 16678, backward nfe 30939, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 076/100, Runtime 0.934574, Loss 0.082269, forward nfe 16832, backward nfe 30994, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 077/100, Runtime 0.893813, Loss 0.082311, forward nfe 16986, backward nfe 31047, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 078/100, Runtime 0.901043, Loss 0.076093, forward nfe 17140, backward nfe 31099, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 079/100, Runtime 0.871766, Loss 0.043204, forward nfe 17294, backward nfe 31150, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 080/100, Runtime 0.889208, Loss 0.083479, forward nfe 17442, backward nfe 31203, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 081/100, Runtime 0.835434, Loss 0.097980, forward nfe 17590, backward nfe 31249, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 082/100, Runtime 0.806141, Loss 0.046992, forward nfe 17738, backward nfe 31293, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 083/100, Runtime 0.792148, Loss 0.105003, forward nfe 17886, backward nfe 31335, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 084/100, Runtime 0.803936, Loss 0.146493, forward nfe 18034, backward nfe 31380, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 085/100, Runtime 0.775365, Loss 0.068051, forward nfe 18176, backward nfe 31422, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 086/100, Runtime 0.709115, Loss 0.071607, forward nfe 18318, backward nfe 31457, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 087/100, Runtime 0.705595, Loss 0.082037, forward nfe 18460, backward nfe 31492, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 088/100, Runtime 0.634605, Loss 0.069778, forward nfe 18602, backward nfe 31518, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 089/100, Runtime 0.625806, Loss 0.074405, forward nfe 18744, backward nfe 31544, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 090/100, Runtime 0.642088, Loss 0.064196, forward nfe 18886, backward nfe 31572, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 091/100, Runtime 0.612052, Loss 0.051422, forward nfe 19028, backward nfe 31596, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 092/100, Runtime 0.605874, Loss 0.065677, forward nfe 19170, backward nfe 31619, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 093/100, Runtime 0.549599, Loss 0.084687, forward nfe 19312, backward nfe 31636, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 094/100, Runtime 0.555712, Loss 0.061183, forward nfe 19454, backward nfe 31654, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 095/100, Runtime 0.551751, Loss 0.074988, forward nfe 19596, backward nfe 31671, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 096/100, Runtime 0.558907, Loss 0.082490, forward nfe 19738, backward nfe 31689, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 097/100, Runtime 0.538807, Loss 0.064008, forward nfe 19880, backward nfe 31707, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 098/100, Runtime 0.540948, Loss 0.050998, forward nfe 20016, backward nfe 31725, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
Epoch: 099/100, Runtime 0.565048, Loss 0.078995, forward nfe 20152, backward nfe 31745, Train: 0.9333, Val: 0.7681, Test: 0.7814, Best time: 30.0000
best val accuracy 0.768056 with test accuracy 0.781413 at epoch 61 and best time 30.000000