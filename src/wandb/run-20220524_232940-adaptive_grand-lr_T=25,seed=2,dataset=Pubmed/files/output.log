/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
Epoch: 001/100, Runtime 11.420697, Loss 1.099476, forward nfe 62, backward nfe 1089, Train: 0.6833, Val: 0.5917, Test: 0.6123, Best time: 5.9819
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 002/100, Runtime 9.731439, Loss 1.086006, forward nfe 360, backward nfe 2019, Train: 0.6833, Val: 0.5917, Test: 0.6123, Best time: 25.0000
Epoch: 003/100, Runtime 10.124347, Loss 1.062605, forward nfe 652, backward nfe 2985, Train: 0.8000, Val: 0.6500, Test: 0.6665, Best time: 2.6389
Epoch: 004/100, Runtime 10.522713, Loss 1.039122, forward nfe 944, backward nfe 3976, Train: 0.8000, Val: 0.7097, Test: 0.7281, Best time: 2.5541
Epoch: 005/100, Runtime 9.912822, Loss 0.999021, forward nfe 1230, backward nfe 4915, Train: 0.8500, Val: 0.7257, Test: 0.7438, Best time: 2.4781
Epoch: 006/100, Runtime 9.591233, Loss 0.951003, forward nfe 1516, backward nfe 5811, Train: 0.8500, Val: 0.7292, Test: 0.7449, Best time: 2.4126
Epoch: 007/100, Runtime 8.520519, Loss 0.899669, forward nfe 1796, backward nfe 6596, Train: 0.8500, Val: 0.7375, Test: 0.7505, Best time: 2.3543
Epoch: 008/100, Runtime 7.582988, Loss 0.835693, forward nfe 2064, backward nfe 7293, Train: 0.8500, Val: 0.7424, Test: 0.7569, Best time: 2.3006
Epoch: 009/100, Runtime 6.688113, Loss 0.761349, forward nfe 2332, backward nfe 7910, Train: 0.8500, Val: 0.7486, Test: 0.7638, Best time: 2.2496
Epoch: 010/100, Runtime 4.969849, Loss 0.683353, forward nfe 2594, backward nfe 8347, Train: 0.8667, Val: 0.7500, Test: 0.7657, Best time: 2.2007
Epoch: 011/100, Runtime 4.078330, Loss 0.634460, forward nfe 2856, backward nfe 8695, Train: 0.9000, Val: 0.7562, Test: 0.7714, Best time: 2.1542
Epoch: 012/100, Runtime 4.208607, Loss 0.568377, forward nfe 3112, backward nfe 9056, Train: 0.9000, Val: 0.7667, Test: 0.7803, Best time: 2.1120
Epoch: 013/100, Runtime 5.176420, Loss 0.496738, forward nfe 3368, backward nfe 9513, Train: 0.9167, Val: 0.7729, Test: 0.7852, Best time: 2.0751
Epoch: 014/100, Runtime 5.093193, Loss 0.465460, forward nfe 3618, backward nfe 9965, Train: 0.9167, Val: 0.7729, Test: 0.7852, Best time: 25.0000
Epoch: 015/100, Runtime 4.173629, Loss 0.403730, forward nfe 3868, backward nfe 10326, Train: 0.9167, Val: 0.7764, Test: 0.7889, Best time: 2.0176
Epoch: 016/100, Runtime 2.957299, Loss 0.377133, forward nfe 4106, backward nfe 10566, Train: 0.9167, Val: 0.7785, Test: 0.7917, Best time: 6.2168
Epoch: 017/100, Runtime 3.234287, Loss 0.336054, forward nfe 4344, backward nfe 10834, Train: 0.9167, Val: 0.7785, Test: 0.7917, Best time: 25.0000
Epoch: 018/100, Runtime 3.648605, Loss 0.345659, forward nfe 4582, backward nfe 11145, Train: 0.9333, Val: 0.7840, Test: 0.7968, Best time: 6.4996
Epoch: 019/100, Runtime 3.895903, Loss 0.304716, forward nfe 4802, backward nfe 11482, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 6.6633
Epoch: 020/100, Runtime 3.632145, Loss 0.288195, forward nfe 5022, backward nfe 11795, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 021/100, Runtime 2.902582, Loss 0.318382, forward nfe 5236, backward nfe 12034, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 022/100, Runtime 2.018091, Loss 0.273533, forward nfe 5450, backward nfe 12187, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 023/100, Runtime 1.918895, Loss 0.266104, forward nfe 5664, backward nfe 12329, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 024/100, Runtime 1.698773, Loss 0.282678, forward nfe 5878, backward nfe 12451, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 025/100, Runtime 2.018830, Loss 0.294390, forward nfe 6080, backward nfe 12607, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 026/100, Runtime 1.987530, Loss 0.216596, forward nfe 6282, backward nfe 12759, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 027/100, Runtime 1.830776, Loss 0.280228, forward nfe 6484, backward nfe 12896, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 028/100, Runtime 1.826864, Loss 0.271574, forward nfe 6680, backward nfe 13033, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 029/100, Runtime 1.264199, Loss 0.270376, forward nfe 6876, backward nfe 13115, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 030/100, Runtime 0.976546, Loss 0.223144, forward nfe 7060, backward nfe 13167, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 031/100, Runtime 1.110058, Loss 0.228185, forward nfe 7244, backward nfe 13234, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 032/100, Runtime 1.168370, Loss 0.201338, forward nfe 7416, backward nfe 13310, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 033/100, Runtime 1.119123, Loss 0.218633, forward nfe 7588, backward nfe 13382, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 034/100, Runtime 1.003147, Loss 0.187270, forward nfe 7754, backward nfe 13442, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 035/100, Runtime 0.620159, Loss 0.172455, forward nfe 7920, backward nfe 13461, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 036/100, Runtime 0.968312, Loss 0.161510, forward nfe 8080, backward nfe 13519, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 037/100, Runtime 1.008267, Loss 0.192180, forward nfe 8246, backward nfe 13580, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 038/100, Runtime 0.852527, Loss 0.130545, forward nfe 8412, backward nfe 13625, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 039/100, Runtime 0.748043, Loss 0.199221, forward nfe 8578, backward nfe 13660, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 040/100, Runtime 0.749125, Loss 0.161632, forward nfe 8738, backward nfe 13694, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 041/100, Runtime 0.713256, Loss 0.106903, forward nfe 8898, backward nfe 13728, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 042/100, Runtime 0.842832, Loss 0.168400, forward nfe 9040, backward nfe 13778, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 043/100, Runtime 0.783554, Loss 0.157614, forward nfe 9182, backward nfe 13820, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 044/100, Runtime 0.670069, Loss 0.163681, forward nfe 9324, backward nfe 13850, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 045/100, Runtime 0.686310, Loss 0.142686, forward nfe 9466, backward nfe 13880, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 046/100, Runtime 0.637673, Loss 0.159877, forward nfe 9614, backward nfe 13905, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 047/100, Runtime 0.559724, Loss 0.125783, forward nfe 9756, backward nfe 13924, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 048/100, Runtime 0.562470, Loss 0.120083, forward nfe 9892, backward nfe 13944, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 049/100, Runtime 0.557553, Loss 0.132436, forward nfe 10028, backward nfe 13961, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 050/100, Runtime 0.558530, Loss 0.144355, forward nfe 10170, backward nfe 13980, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 051/100, Runtime 0.532137, Loss 0.067611, forward nfe 10306, backward nfe 13997, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 052/100, Runtime 0.540793, Loss 0.103472, forward nfe 10442, backward nfe 14015, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 053/100, Runtime 0.565473, Loss 0.136428, forward nfe 10578, backward nfe 14034, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 054/100, Runtime 0.527952, Loss 0.089256, forward nfe 10714, backward nfe 14051, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 055/100, Runtime 0.515720, Loss 0.111894, forward nfe 10850, backward nfe 14067, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 056/100, Runtime 0.525642, Loss 0.099433, forward nfe 10980, backward nfe 14084, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 057/100, Runtime 0.516099, Loss 0.119507, forward nfe 11110, backward nfe 14101, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 058/100, Runtime 0.517346, Loss 0.084666, forward nfe 11240, backward nfe 14118, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 059/100, Runtime 0.516974, Loss 0.071724, forward nfe 11370, backward nfe 14133, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 060/100, Runtime 0.515837, Loss 0.129524, forward nfe 11506, backward nfe 14148, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 061/100, Runtime 0.553182, Loss 0.081101, forward nfe 11642, backward nfe 14167, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 062/100, Runtime 0.527135, Loss 0.090437, forward nfe 11778, backward nfe 14183, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 063/100, Runtime 0.503508, Loss 0.089612, forward nfe 11914, backward nfe 14200, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 064/100, Runtime 0.490293, Loss 0.074396, forward nfe 12038, backward nfe 14216, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 065/100, Runtime 0.493065, Loss 0.074252, forward nfe 12162, backward nfe 14232, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 066/100, Runtime 0.470632, Loss 0.079799, forward nfe 12280, backward nfe 14247, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 067/100, Runtime 0.496016, Loss 0.093777, forward nfe 12398, backward nfe 14265, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 068/100, Runtime 0.465096, Loss 0.108353, forward nfe 12516, backward nfe 14279, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 069/100, Runtime 0.464341, Loss 0.066650, forward nfe 12634, backward nfe 14293, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 070/100, Runtime 0.490055, Loss 0.093279, forward nfe 12752, backward nfe 14310, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 071/100, Runtime 0.448396, Loss 0.068624, forward nfe 12870, backward nfe 14323, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 072/100, Runtime 0.503191, Loss 0.093075, forward nfe 12988, backward nfe 14341, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 073/100, Runtime 0.488822, Loss 0.087066, forward nfe 13106, backward nfe 14358, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 074/100, Runtime 0.473924, Loss 0.063580, forward nfe 13224, backward nfe 14373, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 075/100, Runtime 0.467244, Loss 0.052161, forward nfe 13342, backward nfe 14388, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 076/100, Runtime 0.468029, Loss 0.124421, forward nfe 13460, backward nfe 14402, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 077/100, Runtime 0.433526, Loss 0.088315, forward nfe 13578, backward nfe 14416, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 078/100, Runtime 0.416739, Loss 0.068646, forward nfe 13684, backward nfe 14429, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 079/100, Runtime 0.437391, Loss 0.068608, forward nfe 13790, backward nfe 14444, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 080/100, Runtime 0.415018, Loss 0.052098, forward nfe 13896, backward nfe 14456, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 081/100, Runtime 0.425756, Loss 0.108061, forward nfe 14002, backward nfe 14469, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 082/100, Runtime 0.438815, Loss 0.086122, forward nfe 14108, backward nfe 14484, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 083/100, Runtime 0.412793, Loss 0.056132, forward nfe 14214, backward nfe 14496, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 084/100, Runtime 0.417791, Loss 0.124331, forward nfe 14320, backward nfe 14509, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 085/100, Runtime 0.417106, Loss 0.112580, forward nfe 14426, backward nfe 14522, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 086/100, Runtime 0.405547, Loss 0.047122, forward nfe 14532, backward nfe 14533, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 087/100, Runtime 0.423597, Loss 0.085510, forward nfe 14638, backward nfe 14546, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 088/100, Runtime 0.410646, Loss 0.139382, forward nfe 14744, backward nfe 14558, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 089/100, Runtime 0.445100, Loss 0.052518, forward nfe 14850, backward nfe 14572, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 090/100, Runtime 0.451780, Loss 0.082456, forward nfe 14962, backward nfe 14586, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 091/100, Runtime 0.431274, Loss 0.039293, forward nfe 15074, backward nfe 14600, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 092/100, Runtime 0.439092, Loss 0.136003, forward nfe 15180, backward nfe 14614, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 093/100, Runtime 0.418802, Loss 0.065958, forward nfe 15286, backward nfe 14627, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 094/100, Runtime 0.425790, Loss 0.035628, forward nfe 15392, backward nfe 14641, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 095/100, Runtime 0.414327, Loss 0.051010, forward nfe 15498, backward nfe 14653, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 096/100, Runtime 0.416384, Loss 0.064112, forward nfe 15604, backward nfe 14665, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 097/100, Runtime 0.426311, Loss 0.082861, forward nfe 15710, backward nfe 14678, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 098/100, Runtime 0.398595, Loss 0.098862, forward nfe 15816, backward nfe 14688, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
Epoch: 099/100, Runtime 0.399151, Loss 0.044982, forward nfe 15922, backward nfe 14699, Train: 0.9500, Val: 0.7910, Test: 0.8030, Best time: 25.0000
best val accuracy 0.790972 with test accuracy 0.803041 at epoch 19 and best time 25.000000