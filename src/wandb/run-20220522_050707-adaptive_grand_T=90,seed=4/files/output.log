/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 5.407350, Loss 1.949283, forward nfe 170, backward nfe 0, Train: 0.4143, Val: 0.3338, Test: 0.3381, Best time: 0.0960
Epoch: 002/100, Runtime 5.346424, Loss 2.025003, forward nfe 828, backward nfe 0, Train: 0.4143, Val: 0.3338, Test: 0.3381, Best time: 90.0000
Epoch: 003/100, Runtime 5.154895, Loss 1.967719, forward nfe 1474, backward nfe 0, Train: 0.4143, Val: 0.3338, Test: 0.3381, Best time: 90.0000
Epoch: 004/100, Runtime 5.075126, Loss 1.941763, forward nfe 2120, backward nfe 0, Train: 0.4143, Val: 0.3338, Test: 0.3381, Best time: 90.0000
Epoch: 005/100, Runtime 5.017858, Loss 1.932132, forward nfe 2760, backward nfe 0, Train: 0.4143, Val: 0.3338, Test: 0.3381, Best time: 90.0000
Epoch: 006/100, Runtime 4.862306, Loss 1.917510, forward nfe 3382, backward nfe 0, Train: 0.4143, Val: 0.3338, Test: 0.3381, Best time: 90.0000
Epoch: 007/100, Runtime 4.786452, Loss 1.888275, forward nfe 3986, backward nfe 0, Train: 0.4143, Val: 0.3338, Test: 0.3381, Best time: 90.0000
Epoch: 008/100, Runtime 5.340285, Loss 1.848179, forward nfe 4578, backward nfe 0, Train: 0.4143, Val: 0.3338, Test: 0.3381, Best time: 90.0000
Epoch: 009/100, Runtime 5.733460, Loss 1.806293, forward nfe 5158, backward nfe 0, Train: 0.4143, Val: 0.4147, Test: 0.4467, Best time: 42.2336
Epoch: 010/100, Runtime 5.401751, Loss 1.759202, forward nfe 5720, backward nfe 0, Train: 0.5857, Val: 0.5066, Test: 0.5289, Best time: 56.0837
Epoch: 011/100, Runtime 4.120660, Loss 1.678600, forward nfe 6264, backward nfe 0, Train: 0.6071, Val: 0.5559, Test: 0.5878, Best time: 4.3211
Epoch: 012/100, Runtime 4.144416, Loss 1.597217, forward nfe 6796, backward nfe 0, Train: 0.6500, Val: 0.5860, Test: 0.6112, Best time: 4.5144
Epoch: 013/100, Runtime 4.239559, Loss 1.504972, forward nfe 7328, backward nfe 0, Train: 0.6714, Val: 0.6257, Test: 0.6508, Best time: 6.9583
Epoch: 014/100, Runtime 3.920447, Loss 1.397235, forward nfe 7854, backward nfe 0, Train: 0.6643, Val: 0.6368, Test: 0.6640, Best time: 4.8935
Epoch: 015/100, Runtime 4.112713, Loss 1.294108, forward nfe 8368, backward nfe 0, Train: 0.6571, Val: 0.6596, Test: 0.6934, Best time: 7.5210
Epoch: 016/100, Runtime 4.108811, Loss 1.218402, forward nfe 8876, backward nfe 0, Train: 0.7143, Val: 0.6897, Test: 0.7178, Best time: 7.7802
Epoch: 017/100, Runtime 3.946449, Loss 1.130605, forward nfe 9366, backward nfe 0, Train: 0.7357, Val: 0.7110, Test: 0.7401, Best time: 8.0425
Epoch: 018/100, Runtime 3.710597, Loss 1.034161, forward nfe 9850, backward nfe 0, Train: 0.7643, Val: 0.7287, Test: 0.7584, Best time: 11.6344
Epoch: 019/100, Runtime 3.781571, Loss 0.951120, forward nfe 10304, backward nfe 0, Train: 0.8357, Val: 0.7588, Test: 0.7817, Best time: 16.3482
Epoch: 020/100, Runtime 3.556822, Loss 0.861737, forward nfe 10752, backward nfe 0, Train: 0.8429, Val: 0.7728, Test: 0.7949, Best time: 22.7401
Epoch: 021/100, Runtime 3.567050, Loss 0.814550, forward nfe 11182, backward nfe 0, Train: 0.8429, Val: 0.7868, Test: 0.8051, Best time: 31.7947
Epoch: 022/100, Runtime 3.255140, Loss 0.754103, forward nfe 11600, backward nfe 0, Train: 0.8429, Val: 0.7868, Test: 0.8051, Best time: 90.0000
Epoch: 023/100, Runtime 3.379051, Loss 0.724642, forward nfe 12012, backward nfe 0, Train: 0.8429, Val: 0.7868, Test: 0.8051, Best time: 90.0000
Epoch: 024/100, Runtime 3.159219, Loss 0.662166, forward nfe 12418, backward nfe 0, Train: 0.8429, Val: 0.7868, Test: 0.8051, Best time: 90.0000
Epoch: 025/100, Runtime 3.201229, Loss 0.641867, forward nfe 12818, backward nfe 0, Train: 0.8786, Val: 0.7904, Test: 0.8132, Best time: 38.7045
Epoch: 026/100, Runtime 3.146338, Loss 0.575507, forward nfe 13200, backward nfe 0, Train: 0.8643, Val: 0.8015, Test: 0.8305, Best time: 78.7686
Epoch: 027/100, Runtime 3.063274, Loss 0.627354, forward nfe 13576, backward nfe 0, Train: 0.8714, Val: 0.8037, Test: 0.8315, Best time: 98.9958
Epoch: 028/100, Runtime 3.103979, Loss 0.561991, forward nfe 13946, backward nfe 0, Train: 0.8714, Val: 0.8037, Test: 0.8315, Best time: 90.0000
Epoch: 029/100, Runtime 2.938952, Loss 0.519776, forward nfe 14298, backward nfe 0, Train: 0.9000, Val: 0.8118, Test: 0.8396, Best time: 79.8121
Epoch: 030/100, Runtime 2.652728, Loss 0.433513, forward nfe 14638, backward nfe 0, Train: 0.9000, Val: 0.8118, Test: 0.8396, Best time: 90.0000
Epoch: 031/100, Runtime 2.512488, Loss 0.494145, forward nfe 14960, backward nfe 0, Train: 0.9000, Val: 0.8118, Test: 0.8396, Best time: 90.0000
Epoch: 032/100, Runtime 2.542368, Loss 0.450873, forward nfe 15276, backward nfe 0, Train: 0.9000, Val: 0.8118, Test: 0.8396, Best time: 90.0000
Epoch: 033/100, Runtime 2.880686, Loss 0.453148, forward nfe 15598, backward nfe 0, Train: 0.9000, Val: 0.8118, Test: 0.8396, Best time: 90.0000
Epoch: 034/100, Runtime 2.922898, Loss 0.413575, forward nfe 15902, backward nfe 0, Train: 0.9357, Val: 0.8154, Test: 0.8437, Best time: 74.7357
Epoch: 035/100, Runtime 3.576175, Loss 0.428013, forward nfe 16206, backward nfe 0, Train: 0.9214, Val: 0.8169, Test: 0.8528, Best time: 76.9414
Epoch: 036/100, Runtime 2.815664, Loss 0.395843, forward nfe 16498, backward nfe 0, Train: 0.9214, Val: 0.8169, Test: 0.8528, Best time: 90.0000
Epoch: 037/100, Runtime 3.230754, Loss 0.403150, forward nfe 16766, backward nfe 0, Train: 0.9214, Val: 0.8169, Test: 0.8528, Best time: 90.0000
Epoch: 038/100, Runtime 3.404725, Loss 0.336007, forward nfe 17040, backward nfe 0, Train: 0.9214, Val: 0.8169, Test: 0.8528, Best time: 90.0000
Epoch: 039/100, Runtime 3.392713, Loss 0.339513, forward nfe 17314, backward nfe 0, Train: 0.9214, Val: 0.8169, Test: 0.8528, Best time: 90.0000
Epoch: 040/100, Runtime 2.928267, Loss 0.321463, forward nfe 17588, backward nfe 0, Train: 0.9214, Val: 0.8169, Test: 0.8528, Best time: 90.0000
Epoch: 041/100, Runtime 2.497535, Loss 0.320165, forward nfe 17850, backward nfe 0, Train: 0.9214, Val: 0.8169, Test: 0.8528, Best time: 90.0000
Epoch: 042/100, Runtime 3.000872, Loss 0.303306, forward nfe 18106, backward nfe 0, Train: 0.9214, Val: 0.8169, Test: 0.8528, Best time: 90.0000
Epoch: 043/100, Runtime 2.772884, Loss 0.273400, forward nfe 18362, backward nfe 0, Train: 0.9214, Val: 0.8169, Test: 0.8528, Best time: 90.0000
Epoch: 044/100, Runtime 2.523754, Loss 0.315677, forward nfe 18606, backward nfe 0, Train: 0.9214, Val: 0.8169, Test: 0.8528, Best time: 90.0000
Epoch: 045/100, Runtime 1.997753, Loss 0.254414, forward nfe 18850, backward nfe 0, Train: 0.9214, Val: 0.8169, Test: 0.8528, Best time: 90.0000
Epoch: 046/100, Runtime 1.888380, Loss 0.259582, forward nfe 19088, backward nfe 0, Train: 0.9214, Val: 0.8169, Test: 0.8528, Best time: 90.0000
Epoch: 047/100, Runtime 1.818612, Loss 0.300400, forward nfe 19308, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 195.0187
Epoch: 048/100, Runtime 1.883158, Loss 0.206329, forward nfe 19528, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 049/100, Runtime 1.708607, Loss 0.222013, forward nfe 19748, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 050/100, Runtime 1.854178, Loss 0.308546, forward nfe 19962, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 051/100, Runtime 1.827580, Loss 0.226309, forward nfe 20176, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 052/100, Runtime 1.884181, Loss 0.172703, forward nfe 20390, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 053/100, Runtime 1.843220, Loss 0.195166, forward nfe 20610, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 054/100, Runtime 1.646906, Loss 0.236478, forward nfe 20824, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 055/100, Runtime 1.830462, Loss 0.180680, forward nfe 21038, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 056/100, Runtime 1.887255, Loss 0.181365, forward nfe 21252, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 057/100, Runtime 1.708399, Loss 0.167513, forward nfe 21466, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 058/100, Runtime 1.802490, Loss 0.176373, forward nfe 21680, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 059/100, Runtime 1.824232, Loss 0.150706, forward nfe 21894, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 060/100, Runtime 1.769665, Loss 0.242541, forward nfe 22114, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 061/100, Runtime 1.848317, Loss 0.165858, forward nfe 22334, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 062/100, Runtime 1.788064, Loss 0.099104, forward nfe 22554, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 063/100, Runtime 1.913842, Loss 0.137157, forward nfe 22774, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 064/100, Runtime 1.933880, Loss 0.171043, forward nfe 22994, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 065/100, Runtime 1.899654, Loss 0.133552, forward nfe 23220, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 066/100, Runtime 1.916457, Loss 0.083902, forward nfe 23452, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 067/100, Runtime 2.019300, Loss 0.138144, forward nfe 23684, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 068/100, Runtime 1.987163, Loss 0.178329, forward nfe 23922, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 069/100, Runtime 1.994191, Loss 0.114912, forward nfe 24166, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 070/100, Runtime 2.016982, Loss 0.088284, forward nfe 24416, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 071/100, Runtime 2.048570, Loss 0.196276, forward nfe 24666, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 072/100, Runtime 2.121587, Loss 0.106971, forward nfe 24916, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 073/100, Runtime 2.145671, Loss 0.095420, forward nfe 25166, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 074/100, Runtime 2.202054, Loss 0.065478, forward nfe 25416, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 075/100, Runtime 2.021571, Loss 0.086405, forward nfe 25672, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 076/100, Runtime 2.200953, Loss 0.136881, forward nfe 25928, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 077/100, Runtime 1.998029, Loss 0.103897, forward nfe 26184, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 078/100, Runtime 2.134822, Loss 0.104734, forward nfe 26434, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 079/100, Runtime 2.153775, Loss 0.075021, forward nfe 26684, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 080/100, Runtime 2.199887, Loss 0.116056, forward nfe 26934, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 081/100, Runtime 2.066223, Loss 0.125551, forward nfe 27190, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 082/100, Runtime 2.299170, Loss 0.091445, forward nfe 27452, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 083/100, Runtime 2.080166, Loss 0.074580, forward nfe 27714, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 084/100, Runtime 2.274636, Loss 0.090819, forward nfe 27976, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 085/100, Runtime 2.192262, Loss 0.075508, forward nfe 28238, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 086/100, Runtime 2.439879, Loss 0.093691, forward nfe 28500, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 087/100, Runtime 2.142873, Loss 0.075586, forward nfe 28762, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 088/100, Runtime 2.213690, Loss 0.158098, forward nfe 29024, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 089/100, Runtime 2.142828, Loss 0.070465, forward nfe 29286, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 090/100, Runtime 2.097644, Loss 0.081428, forward nfe 29548, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 091/100, Runtime 2.091529, Loss 0.064365, forward nfe 29810, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 092/100, Runtime 2.072187, Loss 0.068305, forward nfe 30072, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 093/100, Runtime 2.218905, Loss 0.092845, forward nfe 30334, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 094/100, Runtime 2.388819, Loss 0.101152, forward nfe 30596, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 095/100, Runtime 2.490145, Loss 0.060660, forward nfe 30864, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 096/100, Runtime 2.514310, Loss 0.064254, forward nfe 31132, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 097/100, Runtime 2.043552, Loss 0.093044, forward nfe 31400, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 098/100, Runtime 2.260100, Loss 0.032995, forward nfe 31668, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
Epoch: 099/100, Runtime 2.779620, Loss 0.037047, forward nfe 31930, backward nfe 0, Train: 0.9500, Val: 0.8184, Test: 0.8325, Best time: 90.0000
best val accuracy 0.818382 with test accuracy 0.832487 at epoch 47 and best time 90.000000