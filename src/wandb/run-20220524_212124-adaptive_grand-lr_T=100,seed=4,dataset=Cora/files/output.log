/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.885371, Loss 1.945467, forward nfe 182, backward nfe 0, Train: 0.2857, Val: 0.3125, Test: 0.2792, Best time: 5.4840
Epoch: 002/100, Runtime 0.769159, Loss 1.948317, forward nfe 900, backward nfe 0, Train: 0.3714, Val: 0.4941, Test: 0.4904, Best time: 100.0000
Epoch: 003/100, Runtime 0.756313, Loss 1.860373, forward nfe 1588, backward nfe 0, Train: 0.5143, Val: 0.5324, Test: 0.5614, Best time: 100.0000
Epoch: 004/100, Runtime 0.724911, Loss 1.784797, forward nfe 2264, backward nfe 0, Train: 0.7071, Val: 0.6360, Test: 0.6396, Best time: 10.5263
Epoch: 005/100, Runtime 0.701932, Loss 1.611845, forward nfe 2928, backward nfe 0, Train: 0.7857, Val: 0.7390, Test: 0.7614, Best time: 14.3768
Epoch: 006/100, Runtime 0.679054, Loss 1.382556, forward nfe 3586, backward nfe 0, Train: 0.7857, Val: 0.7390, Test: 0.7614, Best time: 100.0000
Epoch: 007/100, Runtime 0.672777, Loss 1.216867, forward nfe 4220, backward nfe 0, Train: 0.8071, Val: 0.7625, Test: 0.7858, Best time: 15.2419
Epoch: 008/100, Runtime 0.661323, Loss 0.956335, forward nfe 4848, backward nfe 0, Train: 0.8286, Val: 0.7956, Test: 0.8112, Best time: 27.6474
Epoch: 009/100, Runtime 0.634029, Loss 0.877993, forward nfe 5446, backward nfe 0, Train: 0.8286, Val: 0.7956, Test: 0.8112, Best time: 100.0000
Epoch: 010/100, Runtime 0.647846, Loss 0.774483, forward nfe 6044, backward nfe 0, Train: 0.8357, Val: 0.8015, Test: 0.8112, Best time: 66.9741
Epoch: 011/100, Runtime 0.664589, Loss 0.648433, forward nfe 6624, backward nfe 0, Train: 0.8357, Val: 0.8015, Test: 0.8112, Best time: 100.0000
Epoch: 012/100, Runtime 0.603608, Loss 0.587732, forward nfe 7192, backward nfe 0, Train: 0.8714, Val: 0.8301, Test: 0.8325, Best time: 33.2096
Epoch: 013/100, Runtime 0.596524, Loss 0.560192, forward nfe 7742, backward nfe 0, Train: 0.8714, Val: 0.8301, Test: 0.8325, Best time: 100.0000
Epoch: 014/100, Runtime 0.570289, Loss 0.540168, forward nfe 8274, backward nfe 0, Train: 0.8714, Val: 0.8301, Test: 0.8325, Best time: 100.0000
Epoch: 015/100, Runtime 0.570214, Loss 0.501841, forward nfe 8794, backward nfe 0, Train: 0.8714, Val: 0.8301, Test: 0.8325, Best time: 100.0000
Epoch: 016/100, Runtime 0.530086, Loss 0.526920, forward nfe 9302, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8355, Best time: 120.5167
Epoch: 017/100, Runtime 0.545122, Loss 0.523006, forward nfe 9810, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8355, Best time: 100.0000
Epoch: 018/100, Runtime 0.536475, Loss 0.570612, forward nfe 10306, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8355, Best time: 100.0000
Epoch: 019/100, Runtime 0.545944, Loss 0.435177, forward nfe 10796, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8355, Best time: 100.0000
Epoch: 020/100, Runtime 0.517783, Loss 0.407180, forward nfe 11268, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8355, Best time: 100.0000
Epoch: 021/100, Runtime 0.505605, Loss 0.422340, forward nfe 11728, backward nfe 0, Train: 0.8643, Val: 0.8360, Test: 0.8355, Best time: 100.0000
Epoch: 022/100, Runtime 0.495366, Loss 0.475959, forward nfe 12182, backward nfe 0, Train: 0.8714, Val: 0.8456, Test: 0.8497, Best time: 56.1072
Epoch: 023/100, Runtime 0.476802, Loss 0.508245, forward nfe 12618, backward nfe 0, Train: 0.8714, Val: 0.8456, Test: 0.8497, Best time: 100.0000
Epoch: 024/100, Runtime 0.468076, Loss 0.455350, forward nfe 13060, backward nfe 0, Train: 0.8714, Val: 0.8456, Test: 0.8497, Best time: 100.0000
Epoch: 025/100, Runtime 0.468255, Loss 0.472814, forward nfe 13490, backward nfe 0, Train: 0.8714, Val: 0.8456, Test: 0.8497, Best time: 100.0000
Epoch: 026/100, Runtime 0.460748, Loss 0.391768, forward nfe 13914, backward nfe 0, Train: 0.8714, Val: 0.8456, Test: 0.8497, Best time: 100.0000
Epoch: 027/100, Runtime 0.493603, Loss 0.436699, forward nfe 14326, backward nfe 0, Train: 0.8714, Val: 0.8456, Test: 0.8497, Best time: 100.0000
Epoch: 028/100, Runtime 0.445414, Loss 0.424927, forward nfe 14720, backward nfe 0, Train: 0.8714, Val: 0.8456, Test: 0.8497, Best time: 100.0000
Epoch: 029/100, Runtime 0.434848, Loss 0.384195, forward nfe 15108, backward nfe 0, Train: 0.8714, Val: 0.8456, Test: 0.8497, Best time: 100.0000
Epoch: 030/100, Runtime 0.429651, Loss 0.420067, forward nfe 15490, backward nfe 0, Train: 0.8714, Val: 0.8456, Test: 0.8497, Best time: 100.0000
Epoch: 031/100, Runtime 0.427239, Loss 0.301823, forward nfe 15866, backward nfe 0, Train: 0.8714, Val: 0.8456, Test: 0.8497, Best time: 100.0000
Epoch: 032/100, Runtime 0.412893, Loss 0.414135, forward nfe 16242, backward nfe 0, Train: 0.8714, Val: 0.8456, Test: 0.8497, Best time: 100.0000
Epoch: 033/100, Runtime 0.397223, Loss 0.315965, forward nfe 16612, backward nfe 0, Train: 0.8714, Val: 0.8456, Test: 0.8497, Best time: 100.0000
Epoch: 034/100, Runtime 0.405775, Loss 0.480010, forward nfe 16976, backward nfe 0, Train: 0.8714, Val: 0.8456, Test: 0.8497, Best time: 100.0000
Epoch: 035/100, Runtime 0.398490, Loss 0.407547, forward nfe 17334, backward nfe 0, Train: 0.9286, Val: 0.8559, Test: 0.8579, Best time: 101.6988
Epoch: 036/100, Runtime 0.394062, Loss 0.352430, forward nfe 17692, backward nfe 0, Train: 0.9286, Val: 0.8559, Test: 0.8579, Best time: 100.0000
Epoch: 037/100, Runtime 0.383523, Loss 0.297472, forward nfe 18032, backward nfe 0, Train: 0.9286, Val: 0.8559, Test: 0.8579, Best time: 100.0000
Epoch: 038/100, Runtime 0.373318, Loss 0.289525, forward nfe 18372, backward nfe 0, Train: 0.9286, Val: 0.8559, Test: 0.8579, Best time: 100.0000
Epoch: 039/100, Runtime 0.385062, Loss 0.441165, forward nfe 18706, backward nfe 0, Train: 0.9286, Val: 0.8559, Test: 0.8579, Best time: 100.0000
Epoch: 040/100, Runtime 0.368210, Loss 0.384559, forward nfe 19040, backward nfe 0, Train: 0.9286, Val: 0.8559, Test: 0.8579, Best time: 100.0000
Epoch: 041/100, Runtime 0.356937, Loss 0.305347, forward nfe 19362, backward nfe 0, Train: 0.9286, Val: 0.8559, Test: 0.8579, Best time: 100.0000
Epoch: 042/100, Runtime 0.355624, Loss 0.262875, forward nfe 19678, backward nfe 0, Train: 0.9286, Val: 0.8559, Test: 0.8579, Best time: 100.0000
Epoch: 043/100, Runtime 0.354109, Loss 0.220111, forward nfe 19994, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 76.2889
Epoch: 044/100, Runtime 0.350091, Loss 0.246695, forward nfe 20298, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 045/100, Runtime 0.346533, Loss 0.292584, forward nfe 20608, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 046/100, Runtime 0.334327, Loss 0.266066, forward nfe 20906, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 047/100, Runtime 0.341320, Loss 0.246505, forward nfe 21198, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 048/100, Runtime 0.322248, Loss 0.236110, forward nfe 21490, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 049/100, Runtime 0.316860, Loss 0.283429, forward nfe 21782, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 050/100, Runtime 0.315754, Loss 0.273183, forward nfe 22062, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 051/100, Runtime 0.308209, Loss 0.200603, forward nfe 22342, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 052/100, Runtime 0.310356, Loss 0.321954, forward nfe 22616, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 053/100, Runtime 0.299202, Loss 0.152318, forward nfe 22890, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 054/100, Runtime 0.311370, Loss 0.150236, forward nfe 23152, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 055/100, Runtime 0.312470, Loss 0.207201, forward nfe 23408, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 056/100, Runtime 0.303407, Loss 0.207086, forward nfe 23670, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 057/100, Runtime 0.294257, Loss 0.127384, forward nfe 23932, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 058/100, Runtime 0.306210, Loss 0.139322, forward nfe 24188, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 059/100, Runtime 0.302631, Loss 0.126648, forward nfe 24444, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 060/100, Runtime 0.316016, Loss 0.140011, forward nfe 24700, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 061/100, Runtime 0.296274, Loss 0.194131, forward nfe 24956, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 062/100, Runtime 0.298115, Loss 0.131987, forward nfe 25206, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 063/100, Runtime 0.284872, Loss 0.091559, forward nfe 25462, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 064/100, Runtime 0.292704, Loss 0.091020, forward nfe 25712, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 065/100, Runtime 0.286264, Loss 0.191406, forward nfe 25956, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 066/100, Runtime 0.289324, Loss 0.123565, forward nfe 26200, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 067/100, Runtime 0.308038, Loss 0.156789, forward nfe 26444, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 068/100, Runtime 0.296680, Loss 0.139163, forward nfe 26688, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 069/100, Runtime 0.289293, Loss 0.103297, forward nfe 26932, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 070/100, Runtime 0.292216, Loss 0.095628, forward nfe 27176, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 071/100, Runtime 0.277134, Loss 0.100893, forward nfe 27420, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 072/100, Runtime 0.292863, Loss 0.063467, forward nfe 27664, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 073/100, Runtime 0.286229, Loss 0.114396, forward nfe 27902, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 074/100, Runtime 0.292307, Loss 0.048670, forward nfe 28146, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 075/100, Runtime 0.302803, Loss 0.107335, forward nfe 28390, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 076/100, Runtime 0.291592, Loss 0.079949, forward nfe 28634, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 077/100, Runtime 0.285148, Loss 0.035263, forward nfe 28878, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 078/100, Runtime 0.282971, Loss 0.088055, forward nfe 29122, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 079/100, Runtime 0.285944, Loss 0.068340, forward nfe 29366, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 080/100, Runtime 0.290178, Loss 0.057009, forward nfe 29610, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 081/100, Runtime 0.430368, Loss 0.047425, forward nfe 29854, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 082/100, Runtime 0.283513, Loss 0.072886, forward nfe 30098, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 083/100, Runtime 0.278363, Loss 0.093308, forward nfe 30342, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 084/100, Runtime 0.274224, Loss 0.098872, forward nfe 30586, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 085/100, Runtime 0.278327, Loss 0.060777, forward nfe 30824, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 086/100, Runtime 0.266410, Loss 0.070946, forward nfe 31056, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 087/100, Runtime 0.268037, Loss 0.092631, forward nfe 31288, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 088/100, Runtime 0.289715, Loss 0.049767, forward nfe 31526, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 089/100, Runtime 0.274984, Loss 0.124930, forward nfe 31770, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 090/100, Runtime 0.300757, Loss 0.073247, forward nfe 32014, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 091/100, Runtime 0.285337, Loss 0.068275, forward nfe 32258, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 092/100, Runtime 0.277017, Loss 0.069721, forward nfe 32502, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 093/100, Runtime 0.280106, Loss 0.071990, forward nfe 32746, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 094/100, Runtime 0.285705, Loss 0.046040, forward nfe 32990, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 095/100, Runtime 0.285596, Loss 0.029125, forward nfe 33234, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 096/100, Runtime 0.270889, Loss 0.044950, forward nfe 33466, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 097/100, Runtime 0.276449, Loss 0.072127, forward nfe 33698, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 098/100, Runtime 0.271826, Loss 0.048743, forward nfe 33936, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
Epoch: 099/100, Runtime 0.279278, Loss 0.036782, forward nfe 34174, backward nfe 0, Train: 0.9286, Val: 0.8581, Test: 0.8619, Best time: 100.0000
best val accuracy 0.858088 with test accuracy 0.861929 at epoch 43 and best time 100.000000