/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
Epoch: 001/100, Runtime 0.481301, Loss 1.099034, forward nfe 32, backward nfe 11, Train: 0.8167, Val: 0.6674, Test: 0.6663, Best time: 9.8772
Epoch: 002/100, Runtime 0.514820, Loss 1.084041, forward nfe 168, backward nfe 28, Train: 0.8167, Val: 0.6674, Test: 0.6663, Best time: 10.0000
Epoch: 003/100, Runtime 0.507626, Loss 1.065778, forward nfe 304, backward nfe 43, Train: 0.9000, Val: 0.7014, Test: 0.6846, Best time: 2.5395
Epoch: 004/100, Runtime 0.510851, Loss 1.034815, forward nfe 440, backward nfe 59, Train: 0.8833, Val: 0.7097, Test: 0.7013, Best time: 5.7471
Epoch: 005/100, Runtime 0.503282, Loss 0.993224, forward nfe 576, backward nfe 74, Train: 0.8833, Val: 0.7097, Test: 0.7013, Best time: 10.0000
Epoch: 006/100, Runtime 0.493372, Loss 0.953742, forward nfe 712, backward nfe 89, Train: 0.8833, Val: 0.7097, Test: 0.7013, Best time: 10.0000
Epoch: 007/100, Runtime 0.508695, Loss 0.899814, forward nfe 842, backward nfe 106, Train: 0.8833, Val: 0.7097, Test: 0.7013, Best time: 10.0000
Epoch: 008/100, Runtime 0.496176, Loss 0.833114, forward nfe 972, backward nfe 122, Train: 0.8833, Val: 0.7097, Test: 0.7013, Best time: 10.0000
Epoch: 009/100, Runtime 0.536982, Loss 0.768498, forward nfe 1102, backward nfe 140, Train: 0.8833, Val: 0.7097, Test: 0.7013, Best time: 10.0000
Epoch: 010/100, Runtime 0.490463, Loss 0.709703, forward nfe 1232, backward nfe 156, Train: 0.8833, Val: 0.7097, Test: 0.7013, Best time: 10.0000
Epoch: 011/100, Runtime 0.490934, Loss 0.632436, forward nfe 1350, backward nfe 172, Train: 0.9333, Val: 0.7118, Test: 0.7101, Best time: 2.0809
Epoch: 012/100, Runtime 0.508566, Loss 0.534205, forward nfe 1468, backward nfe 190, Train: 0.8833, Val: 0.7132, Test: 0.7075, Best time: 15.0421
Epoch: 013/100, Runtime 0.488397, Loss 0.489153, forward nfe 1586, backward nfe 207, Train: 0.8833, Val: 0.7208, Test: 0.7119, Best time: 15.1535
Epoch: 014/100, Runtime 0.509449, Loss 0.431637, forward nfe 1704, backward nfe 226, Train: 0.8833, Val: 0.7215, Test: 0.7136, Best time: 15.3128
Epoch: 015/100, Runtime 0.517595, Loss 0.366371, forward nfe 1822, backward nfe 245, Train: 0.9000, Val: 0.7236, Test: 0.7164, Best time: 15.5266
Epoch: 016/100, Runtime 0.483057, Loss 0.330190, forward nfe 1940, backward nfe 263, Train: 0.9333, Val: 0.7285, Test: 0.7202, Best time: 15.7924
Epoch: 017/100, Runtime 0.475523, Loss 0.253888, forward nfe 2052, backward nfe 280, Train: 0.9667, Val: 0.7333, Test: 0.7278, Best time: 5.7813
Epoch: 018/100, Runtime 0.473276, Loss 0.244778, forward nfe 2164, backward nfe 297, Train: 0.9667, Val: 0.7410, Test: 0.7311, Best time: 5.8864
Epoch: 019/100, Runtime 0.467093, Loss 0.201338, forward nfe 2276, backward nfe 314, Train: 0.9667, Val: 0.7424, Test: 0.7347, Best time: 10.5406
Epoch: 020/100, Runtime 0.475803, Loss 0.197857, forward nfe 2388, backward nfe 330, Train: 0.9833, Val: 0.7438, Test: 0.7405, Best time: 6.1389
Epoch: 021/100, Runtime 0.426590, Loss 0.147698, forward nfe 2494, backward nfe 346, Train: 0.9833, Val: 0.7507, Test: 0.7424, Best time: 17.7545
Epoch: 022/100, Runtime 0.418231, Loss 0.141169, forward nfe 2594, backward nfe 361, Train: 0.9833, Val: 0.7535, Test: 0.7458, Best time: 18.2539
Epoch: 023/100, Runtime 0.423905, Loss 0.151885, forward nfe 2694, backward nfe 376, Train: 1.0000, Val: 0.7542, Test: 0.7483, Best time: 11.7152
Epoch: 024/100, Runtime 0.433058, Loss 0.158555, forward nfe 2794, backward nfe 390, Train: 0.9833, Val: 0.7604, Test: 0.7543, Best time: 40.6181
Epoch: 025/100, Runtime 0.437186, Loss 0.117093, forward nfe 2900, backward nfe 405, Train: 0.9833, Val: 0.7625, Test: 0.7598, Best time: 10.0000
Epoch: 026/100, Runtime 0.437119, Loss 0.140068, forward nfe 3006, backward nfe 420, Train: 0.9833, Val: 0.7660, Test: 0.7626, Best time: 10.0000
Epoch: 027/100, Runtime 0.396590, Loss 0.128355, forward nfe 3112, backward nfe 434, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 028/100, Runtime 0.417505, Loss 0.086701, forward nfe 3206, backward nfe 451, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 029/100, Runtime 0.391282, Loss 0.096685, forward nfe 3300, backward nfe 464, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 030/100, Runtime 0.388947, Loss 0.101889, forward nfe 3394, backward nfe 477, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 031/100, Runtime 0.384553, Loss 0.110482, forward nfe 3488, backward nfe 490, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 032/100, Runtime 0.378654, Loss 0.126564, forward nfe 3582, backward nfe 502, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 033/100, Runtime 0.378904, Loss 0.144799, forward nfe 3676, backward nfe 515, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 034/100, Runtime 0.376853, Loss 0.141632, forward nfe 3764, backward nfe 528, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 035/100, Runtime 0.360058, Loss 0.120912, forward nfe 3852, backward nfe 540, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 036/100, Runtime 0.361349, Loss 0.106685, forward nfe 3940, backward nfe 552, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 037/100, Runtime 0.363056, Loss 0.110291, forward nfe 4028, backward nfe 566, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 038/100, Runtime 0.369856, Loss 0.126696, forward nfe 4110, backward nfe 580, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 039/100, Runtime 0.375296, Loss 0.106074, forward nfe 4192, backward nfe 594, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 040/100, Runtime 0.335934, Loss 0.090997, forward nfe 4274, backward nfe 604, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 041/100, Runtime 0.345335, Loss 0.124091, forward nfe 4356, backward nfe 616, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 042/100, Runtime 0.328399, Loss 0.074606, forward nfe 4438, backward nfe 628, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 043/100, Runtime 0.331892, Loss 0.119972, forward nfe 4514, backward nfe 640, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 044/100, Runtime 0.336428, Loss 0.104648, forward nfe 4590, backward nfe 651, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 045/100, Runtime 0.326886, Loss 0.059058, forward nfe 4672, backward nfe 661, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 046/100, Runtime 0.327053, Loss 0.089616, forward nfe 4754, backward nfe 672, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 047/100, Runtime 0.325866, Loss 0.101640, forward nfe 4830, backward nfe 683, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 048/100, Runtime 0.323641, Loss 0.090266, forward nfe 4906, backward nfe 694, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 049/100, Runtime 0.305352, Loss 0.041976, forward nfe 4982, backward nfe 705, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 050/100, Runtime 0.337200, Loss 0.091845, forward nfe 5052, backward nfe 717, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 051/100, Runtime 0.331915, Loss 0.106988, forward nfe 5128, backward nfe 729, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 052/100, Runtime 0.331450, Loss 0.088689, forward nfe 5204, backward nfe 741, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 053/100, Runtime 0.301876, Loss 0.087389, forward nfe 5280, backward nfe 750, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 054/100, Runtime 0.331524, Loss 0.070459, forward nfe 5356, backward nfe 762, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 055/100, Runtime 0.332650, Loss 0.076502, forward nfe 5432, backward nfe 774, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 056/100, Runtime 0.318358, Loss 0.092835, forward nfe 5508, backward nfe 785, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 057/100, Runtime 0.316415, Loss 0.050741, forward nfe 5584, backward nfe 795, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 058/100, Runtime 0.320810, Loss 0.046838, forward nfe 5660, backward nfe 806, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 059/100, Runtime 0.335212, Loss 0.076116, forward nfe 5736, backward nfe 818, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 060/100, Runtime 0.325828, Loss 0.054736, forward nfe 5812, backward nfe 829, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 061/100, Runtime 0.312072, Loss 0.054825, forward nfe 5888, backward nfe 839, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 062/100, Runtime 0.297263, Loss 0.039365, forward nfe 5964, backward nfe 848, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 063/100, Runtime 0.303394, Loss 0.085704, forward nfe 6040, backward nfe 858, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 064/100, Runtime 0.302861, Loss 0.069173, forward nfe 6110, backward nfe 868, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 065/100, Runtime 0.298513, Loss 0.070722, forward nfe 6180, backward nfe 879, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 066/100, Runtime 0.283652, Loss 0.068906, forward nfe 6250, backward nfe 888, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 067/100, Runtime 0.294270, Loss 0.142998, forward nfe 6320, backward nfe 898, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 068/100, Runtime 0.295530, Loss 0.058904, forward nfe 6390, backward nfe 908, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 069/100, Runtime 0.285839, Loss 0.046741, forward nfe 6460, backward nfe 917, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 070/100, Runtime 0.309483, Loss 0.061487, forward nfe 6530, backward nfe 928, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 071/100, Runtime 0.302068, Loss 0.071678, forward nfe 6600, backward nfe 938, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 072/100, Runtime 0.319497, Loss 0.088482, forward nfe 6670, backward nfe 950, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 073/100, Runtime 0.286434, Loss 0.053622, forward nfe 6740, backward nfe 959, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 074/100, Runtime 0.308789, Loss 0.082735, forward nfe 6810, backward nfe 970, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 075/100, Runtime 0.305307, Loss 0.086539, forward nfe 6880, backward nfe 981, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 076/100, Runtime 0.303728, Loss 0.070457, forward nfe 6950, backward nfe 992, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 077/100, Runtime 0.286242, Loss 0.049324, forward nfe 7020, backward nfe 1001, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 078/100, Runtime 0.306961, Loss 0.062921, forward nfe 7090, backward nfe 1012, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 079/100, Runtime 0.294365, Loss 0.055565, forward nfe 7160, backward nfe 1022, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 080/100, Runtime 0.284857, Loss 0.056002, forward nfe 7230, backward nfe 1031, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 081/100, Runtime 0.298238, Loss 0.051674, forward nfe 7300, backward nfe 1041, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 082/100, Runtime 0.284360, Loss 0.069462, forward nfe 7370, backward nfe 1050, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 083/100, Runtime 0.296370, Loss 0.075558, forward nfe 7440, backward nfe 1060, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 084/100, Runtime 0.286632, Loss 0.068257, forward nfe 7510, backward nfe 1070, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 085/100, Runtime 0.293094, Loss 0.044938, forward nfe 7580, backward nfe 1080, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 086/100, Runtime 0.285219, Loss 0.047587, forward nfe 7650, backward nfe 1089, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 087/100, Runtime 0.293540, Loss 0.050378, forward nfe 7720, backward nfe 1099, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 088/100, Runtime 0.292865, Loss 0.091567, forward nfe 7790, backward nfe 1109, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 089/100, Runtime 0.301310, Loss 0.063618, forward nfe 7860, backward nfe 1119, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 090/100, Runtime 0.298591, Loss 0.043075, forward nfe 7930, backward nfe 1129, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 091/100, Runtime 0.298333, Loss 0.062735, forward nfe 8000, backward nfe 1139, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 092/100, Runtime 0.307835, Loss 0.045632, forward nfe 8070, backward nfe 1150, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 093/100, Runtime 0.297421, Loss 0.055233, forward nfe 8140, backward nfe 1160, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 094/100, Runtime 0.289052, Loss 0.076009, forward nfe 8210, backward nfe 1169, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 095/100, Runtime 0.297192, Loss 0.035665, forward nfe 8280, backward nfe 1180, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 096/100, Runtime 0.294248, Loss 0.048339, forward nfe 8350, backward nfe 1190, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 097/100, Runtime 0.298565, Loss 0.057776, forward nfe 8420, backward nfe 1200, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 098/100, Runtime 0.301082, Loss 0.062824, forward nfe 8490, backward nfe 1210, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
Epoch: 099/100, Runtime 0.288396, Loss 0.046254, forward nfe 8560, backward nfe 1220, Train: 0.9833, Val: 0.7743, Test: 0.7648, Best time: 10.0000
best val accuracy 0.774306 with test accuracy 0.764780 at epoch 27 and best time 10.000000