/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.847311, Loss 1.946633, forward nfe 176, backward nfe 0, Train: 0.2857, Val: 0.3294, Test: 0.3147, Best time: 60.2064
Epoch: 002/100, Runtime 0.736444, Loss 1.865210, forward nfe 864, backward nfe 0, Train: 0.3929, Val: 0.3824, Test: 0.3513, Best time: 1.0196
Epoch: 003/100, Runtime 0.744912, Loss 1.802414, forward nfe 1546, backward nfe 0, Train: 0.5571, Val: 0.5875, Test: 0.5330, Best time: 3.8394
Epoch: 004/100, Runtime 0.699405, Loss 1.627544, forward nfe 2210, backward nfe 0, Train: 0.6857, Val: 0.6463, Test: 0.6162, Best time: 5.7063
Epoch: 005/100, Runtime 0.689580, Loss 1.419325, forward nfe 2856, backward nfe 0, Train: 0.7214, Val: 0.6684, Test: 0.6355, Best time: 8.0417
Epoch: 006/100, Runtime 0.693060, Loss 1.254650, forward nfe 3490, backward nfe 0, Train: 0.7714, Val: 0.7676, Test: 0.7391, Best time: 11.0909
Epoch: 007/100, Runtime 0.673478, Loss 1.040252, forward nfe 4118, backward nfe 0, Train: 0.7714, Val: 0.7993, Test: 0.7645, Best time: 38.1686
Epoch: 008/100, Runtime 0.661007, Loss 0.895419, forward nfe 4728, backward nfe 0, Train: 0.7714, Val: 0.7993, Test: 0.7645, Best time: 95.0000
Epoch: 009/100, Runtime 0.625371, Loss 0.814810, forward nfe 5326, backward nfe 0, Train: 0.7714, Val: 0.7993, Test: 0.7645, Best time: 95.0000
Epoch: 010/100, Runtime 0.620941, Loss 0.777663, forward nfe 5894, backward nfe 0, Train: 0.7857, Val: 0.8125, Test: 0.7919, Best time: 6.9375
Epoch: 011/100, Runtime 0.578797, Loss 0.779703, forward nfe 6444, backward nfe 0, Train: 0.7857, Val: 0.8125, Test: 0.7919, Best time: 95.0000
Epoch: 012/100, Runtime 0.568864, Loss 0.694281, forward nfe 6982, backward nfe 0, Train: 0.7857, Val: 0.8125, Test: 0.7919, Best time: 95.0000
Epoch: 013/100, Runtime 0.584975, Loss 0.621113, forward nfe 7508, backward nfe 0, Train: 0.8143, Val: 0.8324, Test: 0.8122, Best time: 79.9523
Epoch: 014/100, Runtime 0.556320, Loss 0.668126, forward nfe 8028, backward nfe 0, Train: 0.8143, Val: 0.8324, Test: 0.8122, Best time: 95.0000
Epoch: 015/100, Runtime 0.552041, Loss 0.604302, forward nfe 8536, backward nfe 0, Train: 0.8143, Val: 0.8324, Test: 0.8122, Best time: 95.0000
Epoch: 016/100, Runtime 0.531333, Loss 0.651593, forward nfe 9032, backward nfe 0, Train: 0.8143, Val: 0.8324, Test: 0.8122, Best time: 95.0000
Epoch: 017/100, Runtime 0.528423, Loss 0.619105, forward nfe 9516, backward nfe 0, Train: 0.8143, Val: 0.8324, Test: 0.8122, Best time: 95.0000
Epoch: 018/100, Runtime 0.496556, Loss 0.607356, forward nfe 9982, backward nfe 0, Train: 0.8143, Val: 0.8324, Test: 0.8122, Best time: 95.0000
Epoch: 019/100, Runtime 0.501395, Loss 0.623137, forward nfe 10436, backward nfe 0, Train: 0.8143, Val: 0.8324, Test: 0.8122, Best time: 95.0000
Epoch: 020/100, Runtime 0.489704, Loss 0.606537, forward nfe 10878, backward nfe 0, Train: 0.8357, Val: 0.8397, Test: 0.8173, Best time: 62.1489
Epoch: 021/100, Runtime 0.497372, Loss 0.528289, forward nfe 11308, backward nfe 0, Train: 0.8357, Val: 0.8397, Test: 0.8173, Best time: 95.0000
Epoch: 022/100, Runtime 0.480926, Loss 0.622116, forward nfe 11744, backward nfe 0, Train: 0.8357, Val: 0.8397, Test: 0.8173, Best time: 95.0000
Epoch: 023/100, Runtime 0.463398, Loss 0.638869, forward nfe 12168, backward nfe 0, Train: 0.8357, Val: 0.8397, Test: 0.8173, Best time: 95.0000
Epoch: 024/100, Runtime 0.458176, Loss 0.576007, forward nfe 12580, backward nfe 0, Train: 0.8429, Val: 0.8449, Test: 0.8132, Best time: 36.1484
Epoch: 025/100, Runtime 0.453292, Loss 0.529935, forward nfe 12992, backward nfe 0, Train: 0.8214, Val: 0.8456, Test: 0.8162, Best time: 71.0178
Epoch: 026/100, Runtime 0.459963, Loss 0.536100, forward nfe 13392, backward nfe 0, Train: 0.8214, Val: 0.8456, Test: 0.8162, Best time: 95.0000
Epoch: 027/100, Runtime 0.418767, Loss 0.472329, forward nfe 13780, backward nfe 0, Train: 0.8214, Val: 0.8456, Test: 0.8162, Best time: 95.0000
Epoch: 028/100, Runtime 0.432980, Loss 0.450163, forward nfe 14156, backward nfe 0, Train: 0.8214, Val: 0.8456, Test: 0.8162, Best time: 95.0000
Epoch: 029/100, Runtime 0.424672, Loss 0.519093, forward nfe 14532, backward nfe 0, Train: 0.8214, Val: 0.8456, Test: 0.8162, Best time: 95.0000
Epoch: 030/100, Runtime 0.402303, Loss 0.475799, forward nfe 14896, backward nfe 0, Train: 0.8857, Val: 0.8485, Test: 0.8264, Best time: 44.6965
Epoch: 031/100, Runtime 0.389759, Loss 0.425709, forward nfe 15260, backward nfe 0, Train: 0.8857, Val: 0.8485, Test: 0.8264, Best time: 95.0000
Epoch: 032/100, Runtime 0.401269, Loss 0.473290, forward nfe 15624, backward nfe 0, Train: 0.8857, Val: 0.8485, Test: 0.8264, Best time: 95.0000
Epoch: 033/100, Runtime 0.415367, Loss 0.409183, forward nfe 15988, backward nfe 0, Train: 0.8857, Val: 0.8485, Test: 0.8264, Best time: 95.0000
Epoch: 034/100, Runtime 0.404684, Loss 0.433042, forward nfe 16346, backward nfe 0, Train: 0.8857, Val: 0.8485, Test: 0.8264, Best time: 95.0000
Epoch: 035/100, Runtime 0.397856, Loss 0.369743, forward nfe 16698, backward nfe 0, Train: 0.8857, Val: 0.8485, Test: 0.8264, Best time: 95.0000
Epoch: 036/100, Runtime 0.374271, Loss 0.507579, forward nfe 17038, backward nfe 0, Train: 0.8857, Val: 0.8485, Test: 0.8264, Best time: 95.0000
Epoch: 037/100, Runtime 0.371901, Loss 0.365967, forward nfe 17372, backward nfe 0, Train: 0.8857, Val: 0.8485, Test: 0.8264, Best time: 95.0000
Epoch: 038/100, Runtime 0.386942, Loss 0.359336, forward nfe 17706, backward nfe 0, Train: 0.8857, Val: 0.8485, Test: 0.8264, Best time: 95.0000
Epoch: 039/100, Runtime 0.364625, Loss 0.385449, forward nfe 18034, backward nfe 0, Train: 0.8857, Val: 0.8485, Test: 0.8264, Best time: 95.0000
Epoch: 040/100, Runtime 0.366322, Loss 0.391726, forward nfe 18362, backward nfe 0, Train: 0.8857, Val: 0.8485, Test: 0.8264, Best time: 95.0000
Epoch: 041/100, Runtime 0.371844, Loss 0.375593, forward nfe 18690, backward nfe 0, Train: 0.8857, Val: 0.8485, Test: 0.8264, Best time: 95.0000
Epoch: 042/100, Runtime 0.352670, Loss 0.321372, forward nfe 19000, backward nfe 0, Train: 0.8857, Val: 0.8485, Test: 0.8264, Best time: 95.0000
Epoch: 043/100, Runtime 0.376953, Loss 0.290429, forward nfe 19310, backward nfe 0, Train: 0.8857, Val: 0.8485, Test: 0.8264, Best time: 95.0000
Epoch: 044/100, Runtime 0.340696, Loss 0.291823, forward nfe 19620, backward nfe 0, Train: 0.8857, Val: 0.8485, Test: 0.8264, Best time: 95.0000
Epoch: 045/100, Runtime 0.338385, Loss 0.299950, forward nfe 19924, backward nfe 0, Train: 0.8857, Val: 0.8485, Test: 0.8264, Best time: 95.0000
Epoch: 046/100, Runtime 0.342419, Loss 0.275773, forward nfe 20228, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 145.4028
Epoch: 047/100, Runtime 0.336684, Loss 0.273495, forward nfe 20532, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 048/100, Runtime 0.344414, Loss 0.293160, forward nfe 20836, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 049/100, Runtime 0.339873, Loss 0.183121, forward nfe 21134, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 050/100, Runtime 0.342286, Loss 0.221997, forward nfe 21432, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 051/100, Runtime 0.345040, Loss 0.239296, forward nfe 21730, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 052/100, Runtime 0.332757, Loss 0.224010, forward nfe 22022, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 053/100, Runtime 0.335110, Loss 0.278311, forward nfe 22308, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 054/100, Runtime 0.340621, Loss 0.216356, forward nfe 22600, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 055/100, Runtime 0.332597, Loss 0.241396, forward nfe 22892, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 056/100, Runtime 0.319532, Loss 0.200607, forward nfe 23184, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 057/100, Runtime 0.322395, Loss 0.167044, forward nfe 23458, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 058/100, Runtime 0.317341, Loss 0.112201, forward nfe 23732, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 059/100, Runtime 0.305347, Loss 0.180387, forward nfe 24000, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 060/100, Runtime 0.297212, Loss 0.143858, forward nfe 24262, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 061/100, Runtime 0.292914, Loss 0.120314, forward nfe 24518, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 062/100, Runtime 0.303993, Loss 0.114924, forward nfe 24774, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 063/100, Runtime 0.304096, Loss 0.161729, forward nfe 25030, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 064/100, Runtime 0.303223, Loss 0.103767, forward nfe 25286, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 065/100, Runtime 0.301137, Loss 0.119315, forward nfe 25548, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 066/100, Runtime 0.288074, Loss 0.107344, forward nfe 25810, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 067/100, Runtime 0.308249, Loss 0.125334, forward nfe 26072, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 068/100, Runtime 0.320563, Loss 0.083482, forward nfe 26334, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 069/100, Runtime 0.321779, Loss 0.089016, forward nfe 26596, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 070/100, Runtime 0.426439, Loss 0.089563, forward nfe 26858, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 071/100, Runtime 0.295053, Loss 0.123519, forward nfe 27120, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 072/100, Runtime 0.288165, Loss 0.099682, forward nfe 27382, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 073/100, Runtime 0.288019, Loss 0.162146, forward nfe 27644, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 074/100, Runtime 0.301725, Loss 0.087636, forward nfe 27900, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 075/100, Runtime 0.295526, Loss 0.096486, forward nfe 28156, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 076/100, Runtime 0.283112, Loss 0.068504, forward nfe 28412, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 077/100, Runtime 0.286427, Loss 0.134091, forward nfe 28662, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 078/100, Runtime 0.292643, Loss 0.076819, forward nfe 28912, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 079/100, Runtime 0.277575, Loss 0.037544, forward nfe 29162, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 080/100, Runtime 0.287687, Loss 0.068279, forward nfe 29412, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 081/100, Runtime 0.302019, Loss 0.049645, forward nfe 29662, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 082/100, Runtime 0.290399, Loss 0.068313, forward nfe 29912, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 083/100, Runtime 0.281278, Loss 0.057031, forward nfe 30162, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 084/100, Runtime 0.287587, Loss 0.085437, forward nfe 30412, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 085/100, Runtime 0.284466, Loss 0.052541, forward nfe 30662, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 086/100, Runtime 0.288013, Loss 0.068207, forward nfe 30906, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 087/100, Runtime 0.295552, Loss 0.083272, forward nfe 31150, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 088/100, Runtime 0.291240, Loss 0.057638, forward nfe 31400, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 089/100, Runtime 0.274000, Loss 0.086965, forward nfe 31650, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 090/100, Runtime 0.272700, Loss 0.045460, forward nfe 31888, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 091/100, Runtime 0.288827, Loss 0.059868, forward nfe 32126, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 092/100, Runtime 0.282222, Loss 0.079361, forward nfe 32364, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 093/100, Runtime 0.282010, Loss 0.052939, forward nfe 32602, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 094/100, Runtime 0.277238, Loss 0.072929, forward nfe 32846, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 095/100, Runtime 0.283343, Loss 0.033928, forward nfe 33096, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 096/100, Runtime 0.303351, Loss 0.089204, forward nfe 33340, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 097/100, Runtime 0.283124, Loss 0.064213, forward nfe 33584, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 098/100, Runtime 0.287117, Loss 0.045837, forward nfe 33834, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
Epoch: 099/100, Runtime 0.274531, Loss 0.064881, forward nfe 34072, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8305, Best time: 95.0000
best val accuracy 0.851471 with test accuracy 0.830457 at epoch 46 and best time 95.000000