/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.462868, Loss 1.792037, forward nfe 128, backward nfe 0, Train: 0.3833, Val: 0.3891, Test: 0.3774, Best time: 1.5906
Epoch: 002/100, Runtime 0.402101, Loss 1.763896, forward nfe 468, backward nfe 0, Train: 0.5583, Val: 0.4797, Test: 0.4339, Best time: 4.4157
Epoch: 003/100, Runtime 0.411188, Loss 1.727844, forward nfe 814, backward nfe 0, Train: 0.7833, Val: 0.6232, Test: 0.6000, Best time: 13.1344
Epoch: 004/100, Runtime 0.443298, Loss 1.682256, forward nfe 1172, backward nfe 0, Train: 0.7917, Val: 0.6587, Test: 0.5952, Best time: 1.4684
Epoch: 005/100, Runtime 0.438199, Loss 1.615369, forward nfe 1530, backward nfe 0, Train: 0.7917, Val: 0.6587, Test: 0.5952, Best time: 30.0000
Epoch: 006/100, Runtime 0.412384, Loss 1.585299, forward nfe 1882, backward nfe 0, Train: 0.7917, Val: 0.6587, Test: 0.5952, Best time: 30.0000
Epoch: 007/100, Runtime 0.410058, Loss 1.541723, forward nfe 2228, backward nfe 0, Train: 0.7917, Val: 0.6587, Test: 0.5952, Best time: 30.0000
Epoch: 008/100, Runtime 0.410373, Loss 1.485339, forward nfe 2568, backward nfe 0, Train: 0.7917, Val: 0.6587, Test: 0.5952, Best time: 30.0000
Epoch: 009/100, Runtime 0.413751, Loss 1.500031, forward nfe 2914, backward nfe 0, Train: 0.7917, Val: 0.6587, Test: 0.5952, Best time: 30.0000
Epoch: 010/100, Runtime 0.382680, Loss 1.472473, forward nfe 3242, backward nfe 0, Train: 0.7917, Val: 0.6587, Test: 0.5952, Best time: 30.0000
Epoch: 011/100, Runtime 0.387529, Loss 1.422402, forward nfe 3570, backward nfe 0, Train: 0.7917, Val: 0.6587, Test: 0.5952, Best time: 30.0000
Epoch: 012/100, Runtime 0.384922, Loss 1.396573, forward nfe 3898, backward nfe 0, Train: 0.7250, Val: 0.6652, Test: 0.6452, Best time: 2.5449
Epoch: 013/100, Runtime 0.388959, Loss 1.391568, forward nfe 4220, backward nfe 0, Train: 0.7750, Val: 0.6920, Test: 0.6581, Best time: 7.8214
Epoch: 014/100, Runtime 0.372189, Loss 1.346388, forward nfe 4536, backward nfe 0, Train: 0.7500, Val: 0.7145, Test: 0.6742, Best time: 3.5083
Epoch: 015/100, Runtime 0.364715, Loss 1.388862, forward nfe 4846, backward nfe 0, Train: 0.7500, Val: 0.7145, Test: 0.6742, Best time: 30.0000
Epoch: 016/100, Runtime 0.372861, Loss 1.293896, forward nfe 5156, backward nfe 0, Train: 0.7500, Val: 0.7145, Test: 0.6742, Best time: 30.0000
Epoch: 017/100, Runtime 0.368074, Loss 1.308328, forward nfe 5472, backward nfe 0, Train: 0.7500, Val: 0.7145, Test: 0.6742, Best time: 30.0000
Epoch: 018/100, Runtime 0.356149, Loss 1.198822, forward nfe 5776, backward nfe 0, Train: 0.7500, Val: 0.7145, Test: 0.6742, Best time: 30.0000
Epoch: 019/100, Runtime 0.356313, Loss 1.213912, forward nfe 6080, backward nfe 0, Train: 0.8167, Val: 0.7152, Test: 0.6919, Best time: 8.7743
Epoch: 020/100, Runtime 0.352982, Loss 1.198136, forward nfe 6378, backward nfe 0, Train: 0.8167, Val: 0.7217, Test: 0.6984, Best time: 20.8426
Epoch: 021/100, Runtime 0.336385, Loss 1.140283, forward nfe 6664, backward nfe 0, Train: 0.8333, Val: 0.7341, Test: 0.7000, Best time: 15.3830
Epoch: 022/100, Runtime 0.339780, Loss 1.138018, forward nfe 6950, backward nfe 0, Train: 0.8083, Val: 0.7377, Test: 0.7016, Best time: 32.3956
Epoch: 023/100, Runtime 0.345375, Loss 1.072267, forward nfe 7236, backward nfe 0, Train: 0.8083, Val: 0.7399, Test: 0.7000, Best time: 27.8198
Epoch: 024/100, Runtime 0.337474, Loss 1.055518, forward nfe 7522, backward nfe 0, Train: 0.8083, Val: 0.7493, Test: 0.7194, Best time: 19.7789
Epoch: 025/100, Runtime 0.339776, Loss 1.146756, forward nfe 7796, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 29.1586
Epoch: 026/100, Runtime 0.351927, Loss 1.043786, forward nfe 8070, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 027/100, Runtime 0.334233, Loss 1.040330, forward nfe 8344, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 028/100, Runtime 0.321816, Loss 1.055805, forward nfe 8618, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 029/100, Runtime 0.325154, Loss 1.052199, forward nfe 8886, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 030/100, Runtime 0.318890, Loss 1.012331, forward nfe 9148, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 031/100, Runtime 0.308467, Loss 0.978900, forward nfe 9410, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 032/100, Runtime 0.312182, Loss 1.064654, forward nfe 9666, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 033/100, Runtime 0.311897, Loss 0.919413, forward nfe 9916, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 034/100, Runtime 0.321600, Loss 1.076720, forward nfe 10166, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 035/100, Runtime 0.298557, Loss 0.990182, forward nfe 10410, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 036/100, Runtime 0.292632, Loss 1.013967, forward nfe 10648, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 037/100, Runtime 0.287462, Loss 1.074718, forward nfe 10886, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 038/100, Runtime 0.288657, Loss 0.962270, forward nfe 11124, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 039/100, Runtime 0.309332, Loss 0.993160, forward nfe 11362, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 040/100, Runtime 0.287157, Loss 0.954278, forward nfe 11600, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 041/100, Runtime 0.286793, Loss 0.918751, forward nfe 11832, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 042/100, Runtime 0.281964, Loss 0.944672, forward nfe 12058, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 043/100, Runtime 0.281197, Loss 0.905484, forward nfe 12284, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 044/100, Runtime 0.273869, Loss 1.028791, forward nfe 12510, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 045/100, Runtime 0.272512, Loss 0.996498, forward nfe 12730, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 046/100, Runtime 0.287049, Loss 1.064851, forward nfe 12950, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 047/100, Runtime 0.270657, Loss 0.972466, forward nfe 13170, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 048/100, Runtime 0.276577, Loss 0.955331, forward nfe 13390, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 049/100, Runtime 0.260790, Loss 1.021994, forward nfe 13604, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 050/100, Runtime 0.254524, Loss 0.962124, forward nfe 13818, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 051/100, Runtime 0.265256, Loss 0.948528, forward nfe 14026, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 052/100, Runtime 0.267836, Loss 1.055322, forward nfe 14234, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 053/100, Runtime 0.272813, Loss 0.870530, forward nfe 14448, backward nfe 0, Train: 0.8250, Val: 0.7522, Test: 0.7306, Best time: 30.0000
Epoch: 054/100, Runtime 0.261551, Loss 0.989337, forward nfe 14668, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 34.0980
Epoch: 055/100, Runtime 0.267467, Loss 0.876500, forward nfe 14888, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 056/100, Runtime 0.274809, Loss 0.945810, forward nfe 15108, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 057/100, Runtime 0.274031, Loss 0.956954, forward nfe 15328, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 058/100, Runtime 0.272073, Loss 1.014030, forward nfe 15548, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 059/100, Runtime 0.273944, Loss 1.000627, forward nfe 15762, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 060/100, Runtime 0.279545, Loss 0.939735, forward nfe 15976, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 061/100, Runtime 0.271959, Loss 0.939065, forward nfe 16190, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 062/100, Runtime 0.268662, Loss 1.011223, forward nfe 16404, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 063/100, Runtime 0.263967, Loss 0.978226, forward nfe 16618, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 064/100, Runtime 0.272953, Loss 0.975961, forward nfe 16832, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 065/100, Runtime 0.263747, Loss 1.046768, forward nfe 17046, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 066/100, Runtime 0.280720, Loss 0.955165, forward nfe 17260, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 067/100, Runtime 0.273918, Loss 0.903335, forward nfe 17474, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 068/100, Runtime 0.267936, Loss 0.986370, forward nfe 17688, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 069/100, Runtime 0.268444, Loss 0.987441, forward nfe 17902, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 070/100, Runtime 0.275270, Loss 0.949148, forward nfe 18116, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 071/100, Runtime 0.277291, Loss 0.937842, forward nfe 18336, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 072/100, Runtime 0.281256, Loss 1.028243, forward nfe 18562, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 073/100, Runtime 0.282382, Loss 1.045822, forward nfe 18788, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 074/100, Runtime 0.283175, Loss 0.963685, forward nfe 19014, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 075/100, Runtime 0.295145, Loss 1.058418, forward nfe 19240, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 076/100, Runtime 0.281434, Loss 0.984012, forward nfe 19466, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 077/100, Runtime 0.287368, Loss 0.875219, forward nfe 19692, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 078/100, Runtime 0.283164, Loss 0.928090, forward nfe 19918, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 079/100, Runtime 0.274856, Loss 0.842536, forward nfe 20144, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 080/100, Runtime 0.286546, Loss 1.030813, forward nfe 20364, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 081/100, Runtime 0.401101, Loss 1.053496, forward nfe 20578, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 082/100, Runtime 0.281005, Loss 0.938872, forward nfe 20792, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 083/100, Runtime 0.270169, Loss 0.982011, forward nfe 21006, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 084/100, Runtime 0.278503, Loss 0.933396, forward nfe 21220, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 085/100, Runtime 0.277266, Loss 0.958361, forward nfe 21440, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 086/100, Runtime 0.282516, Loss 0.936038, forward nfe 21660, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 087/100, Runtime 0.275551, Loss 0.990663, forward nfe 21880, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 088/100, Runtime 0.276865, Loss 0.955118, forward nfe 22100, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 089/100, Runtime 0.284329, Loss 0.906454, forward nfe 22320, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 090/100, Runtime 0.281457, Loss 0.998464, forward nfe 22540, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 091/100, Runtime 0.273332, Loss 0.815938, forward nfe 22760, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 092/100, Runtime 0.279480, Loss 1.093378, forward nfe 22980, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 093/100, Runtime 0.268292, Loss 0.999204, forward nfe 23200, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 094/100, Runtime 0.271135, Loss 1.031031, forward nfe 23420, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 095/100, Runtime 0.275203, Loss 0.964521, forward nfe 23640, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 096/100, Runtime 0.264412, Loss 0.888969, forward nfe 23860, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 097/100, Runtime 0.276645, Loss 0.924009, forward nfe 24080, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 098/100, Runtime 0.265380, Loss 0.971303, forward nfe 24294, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
Epoch: 099/100, Runtime 0.264389, Loss 0.881843, forward nfe 24508, backward nfe 0, Train: 0.8583, Val: 0.7594, Test: 0.7194, Best time: 30.0000
best val accuracy 0.759420 with test accuracy 0.719355 at epoch 54 and best time 30.000000