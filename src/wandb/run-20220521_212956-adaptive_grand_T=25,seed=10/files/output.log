/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 1.882591, Loss 1.947450, forward nfe 56, backward nfe 0, Train: 0.2929, Val: 0.2110, Test: 0.2345, Best time: 0.0917
Epoch: 002/100, Runtime 1.939797, Loss 1.841351, forward nfe 288, backward nfe 0, Train: 0.5357, Val: 0.3382, Test: 0.3269, Best time: 0.0887
Epoch: 003/100, Runtime 1.865769, Loss 1.749824, forward nfe 514, backward nfe 0, Train: 0.8286, Val: 0.7088, Test: 0.7025, Best time: 12.9233
Epoch: 004/100, Runtime 1.770998, Loss 1.368572, forward nfe 734, backward nfe 0, Train: 0.8286, Val: 0.7162, Test: 0.7117, Best time: 5.4722
Epoch: 005/100, Runtime 1.762391, Loss 1.142995, forward nfe 948, backward nfe 0, Train: 0.8429, Val: 0.7941, Test: 0.7827, Best time: 10.2362
Epoch: 006/100, Runtime 1.741258, Loss 0.914462, forward nfe 1156, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 77.7488
Epoch: 007/100, Runtime 1.754042, Loss 0.711509, forward nfe 1364, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 25.0000
Epoch: 008/100, Runtime 1.706615, Loss 0.579204, forward nfe 1572, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 25.0000
Epoch: 009/100, Runtime 1.729295, Loss 0.463948, forward nfe 1768, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 25.0000
Epoch: 010/100, Runtime 1.607304, Loss 0.396092, forward nfe 1964, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 25.0000
Epoch: 011/100, Runtime 1.611131, Loss 0.378276, forward nfe 2154, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 25.0000
Epoch: 012/100, Runtime 1.565525, Loss 0.324986, forward nfe 2344, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 25.0000
Epoch: 013/100, Runtime 1.365331, Loss 0.295542, forward nfe 2528, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 25.0000
Epoch: 014/100, Runtime 1.946885, Loss 0.251191, forward nfe 2712, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 25.0000
Epoch: 015/100, Runtime 1.764168, Loss 0.244429, forward nfe 2884, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 25.0000
Epoch: 016/100, Runtime 1.859861, Loss 0.216108, forward nfe 3050, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 25.0000
Epoch: 017/100, Runtime 1.893312, Loss 0.266613, forward nfe 3216, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 25.0000
Epoch: 018/100, Runtime 1.655871, Loss 0.228478, forward nfe 3388, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 25.0000
Epoch: 019/100, Runtime 1.649850, Loss 0.278283, forward nfe 3554, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 25.0000
Epoch: 020/100, Runtime 1.746193, Loss 0.250830, forward nfe 3720, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 25.0000
Epoch: 021/100, Runtime 1.658960, Loss 0.225356, forward nfe 3874, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 25.0000
Epoch: 022/100, Runtime 1.757595, Loss 0.209210, forward nfe 4022, backward nfe 0, Train: 0.8714, Val: 0.8419, Test: 0.8274, Best time: 25.0000
Epoch: 023/100, Runtime 1.735816, Loss 0.204675, forward nfe 4170, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 64.5913
Epoch: 024/100, Runtime 1.803391, Loss 0.254673, forward nfe 4318, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 025/100, Runtime 1.640162, Loss 0.166926, forward nfe 4472, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 026/100, Runtime 1.767286, Loss 0.168785, forward nfe 4620, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 027/100, Runtime 1.635548, Loss 0.182265, forward nfe 4768, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 028/100, Runtime 1.594879, Loss 0.226499, forward nfe 4904, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 029/100, Runtime 1.614797, Loss 0.140234, forward nfe 5040, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 030/100, Runtime 1.631637, Loss 0.154989, forward nfe 5176, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 031/100, Runtime 1.612880, Loss 0.143411, forward nfe 5312, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 032/100, Runtime 1.097594, Loss 0.158330, forward nfe 5448, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 033/100, Runtime 1.089702, Loss 0.144188, forward nfe 5578, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 034/100, Runtime 1.147314, Loss 0.167061, forward nfe 5708, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 035/100, Runtime 1.063783, Loss 0.108737, forward nfe 5844, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 036/100, Runtime 1.166879, Loss 0.138463, forward nfe 5980, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 037/100, Runtime 1.186260, Loss 0.150412, forward nfe 6116, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 038/100, Runtime 1.185714, Loss 0.162236, forward nfe 6252, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 039/100, Runtime 1.102020, Loss 0.124672, forward nfe 6388, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 040/100, Runtime 1.279773, Loss 0.106380, forward nfe 6524, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 041/100, Runtime 1.085257, Loss 0.154738, forward nfe 6654, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 042/100, Runtime 1.182297, Loss 0.119806, forward nfe 6784, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 043/100, Runtime 0.974965, Loss 0.107114, forward nfe 6914, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 044/100, Runtime 0.999763, Loss 0.136181, forward nfe 7026, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 045/100, Runtime 0.969196, Loss 0.150856, forward nfe 7138, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 046/100, Runtime 0.978818, Loss 0.148128, forward nfe 7250, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 047/100, Runtime 0.945611, Loss 0.101305, forward nfe 7362, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 048/100, Runtime 0.966303, Loss 0.158869, forward nfe 7474, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 049/100, Runtime 0.935369, Loss 0.096537, forward nfe 7586, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 050/100, Runtime 0.972944, Loss 0.116754, forward nfe 7698, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 051/100, Runtime 0.978306, Loss 0.117595, forward nfe 7816, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 052/100, Runtime 1.073023, Loss 0.111530, forward nfe 7934, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 053/100, Runtime 1.006663, Loss 0.088861, forward nfe 8052, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 054/100, Runtime 1.008248, Loss 0.064233, forward nfe 8170, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 055/100, Runtime 0.855107, Loss 0.075635, forward nfe 8288, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 056/100, Runtime 0.926247, Loss 0.113115, forward nfe 8406, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 057/100, Runtime 1.027565, Loss 0.084591, forward nfe 8524, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 058/100, Runtime 1.020979, Loss 0.091480, forward nfe 8642, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 059/100, Runtime 1.023516, Loss 0.097375, forward nfe 8760, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 060/100, Runtime 0.961247, Loss 0.088440, forward nfe 8878, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 061/100, Runtime 0.905584, Loss 0.077809, forward nfe 8990, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 062/100, Runtime 0.931105, Loss 0.074864, forward nfe 9102, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 063/100, Runtime 0.876271, Loss 0.084311, forward nfe 9214, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 064/100, Runtime 0.980667, Loss 0.083130, forward nfe 9326, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 065/100, Runtime 0.991738, Loss 0.075346, forward nfe 9438, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 066/100, Runtime 0.987370, Loss 0.066782, forward nfe 9550, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 067/100, Runtime 1.002954, Loss 0.064084, forward nfe 9662, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 068/100, Runtime 0.995173, Loss 0.051680, forward nfe 9774, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 069/100, Runtime 1.006129, Loss 0.095004, forward nfe 9886, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 070/100, Runtime 1.003252, Loss 0.068684, forward nfe 9998, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 071/100, Runtime 1.002885, Loss 0.051188, forward nfe 10110, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 072/100, Runtime 0.982892, Loss 0.041588, forward nfe 10222, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 073/100, Runtime 0.985734, Loss 0.074887, forward nfe 10334, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 074/100, Runtime 0.949554, Loss 0.039858, forward nfe 10446, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 075/100, Runtime 0.953933, Loss 0.043738, forward nfe 10552, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 076/100, Runtime 0.944864, Loss 0.054017, forward nfe 10658, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 077/100, Runtime 0.934504, Loss 0.070226, forward nfe 10764, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 078/100, Runtime 0.974807, Loss 0.061815, forward nfe 10870, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 079/100, Runtime 0.957144, Loss 0.089569, forward nfe 10976, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 080/100, Runtime 0.950141, Loss 0.058675, forward nfe 11082, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 081/100, Runtime 0.948445, Loss 0.051551, forward nfe 11188, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 082/100, Runtime 0.951023, Loss 0.060235, forward nfe 11294, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 083/100, Runtime 0.957571, Loss 0.055391, forward nfe 11400, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 084/100, Runtime 0.939553, Loss 0.041782, forward nfe 11506, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 085/100, Runtime 0.954265, Loss 0.071848, forward nfe 11612, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 086/100, Runtime 0.953340, Loss 0.028666, forward nfe 11718, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 087/100, Runtime 0.947937, Loss 0.052051, forward nfe 11824, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 088/100, Runtime 0.955005, Loss 0.073472, forward nfe 11930, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 089/100, Runtime 0.954570, Loss 0.088321, forward nfe 12036, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 090/100, Runtime 1.050368, Loss 0.040544, forward nfe 12148, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 091/100, Runtime 1.097688, Loss 0.067813, forward nfe 12266, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 092/100, Runtime 1.033828, Loss 0.055027, forward nfe 12384, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 093/100, Runtime 1.036325, Loss 0.065665, forward nfe 12502, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 094/100, Runtime 1.090610, Loss 0.061163, forward nfe 12620, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 095/100, Runtime 0.998250, Loss 0.038945, forward nfe 12738, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 096/100, Runtime 1.096514, Loss 0.045345, forward nfe 12856, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 097/100, Runtime 1.088322, Loss 0.035172, forward nfe 12980, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 098/100, Runtime 1.133887, Loss 0.025649, forward nfe 13104, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
Epoch: 099/100, Runtime 1.255100, Loss 0.038709, forward nfe 13234, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8274, Best time: 25.0000
best val accuracy 0.850000 with test accuracy 0.827411 at epoch 23 and best time 25.000000