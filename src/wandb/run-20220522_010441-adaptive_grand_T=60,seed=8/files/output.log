/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 3.605648, Loss 1.949001, forward nfe 116, backward nfe 0, Train: 0.3786, Val: 0.3059, Test: 0.3046, Best time: 0.0943
Epoch: 002/100, Runtime 3.582423, Loss 1.986425, forward nfe 570, backward nfe 0, Train: 0.3786, Val: 0.3059, Test: 0.3046, Best time: 60.0000
Epoch: 003/100, Runtime 3.523847, Loss 1.940141, forward nfe 1012, backward nfe 0, Train: 0.3786, Val: 0.3059, Test: 0.3046, Best time: 60.0000
Epoch: 004/100, Runtime 3.458596, Loss 1.910533, forward nfe 1454, backward nfe 0, Train: 0.3786, Val: 0.3059, Test: 0.3046, Best time: 60.0000
Epoch: 005/100, Runtime 3.487849, Loss 1.854433, forward nfe 1884, backward nfe 0, Train: 0.5857, Val: 0.4963, Test: 0.5228, Best time: 3.7530
Epoch: 006/100, Runtime 3.233786, Loss 1.749607, forward nfe 2302, backward nfe 0, Train: 0.7643, Val: 0.7618, Test: 0.7462, Best time: 3.8991
Epoch: 007/100, Runtime 3.251971, Loss 1.596584, forward nfe 2708, backward nfe 0, Train: 0.8429, Val: 0.7904, Test: 0.7706, Best time: 10.8421
Epoch: 008/100, Runtime 3.187206, Loss 1.435801, forward nfe 3102, backward nfe 0, Train: 0.8429, Val: 0.7904, Test: 0.7706, Best time: 60.0000
Epoch: 009/100, Runtime 3.107213, Loss 1.241834, forward nfe 3490, backward nfe 0, Train: 0.8571, Val: 0.8059, Test: 0.7939, Best time: 26.5926
Epoch: 010/100, Runtime 3.064716, Loss 1.010134, forward nfe 3872, backward nfe 0, Train: 0.8714, Val: 0.8162, Test: 0.7990, Best time: 69.8078
Epoch: 011/100, Runtime 3.093656, Loss 0.797851, forward nfe 4248, backward nfe 0, Train: 0.8714, Val: 0.8162, Test: 0.7990, Best time: 60.0000
Epoch: 012/100, Runtime 2.931826, Loss 0.658954, forward nfe 4624, backward nfe 0, Train: 0.8857, Val: 0.8199, Test: 0.8081, Best time: 29.8838
Epoch: 013/100, Runtime 2.940506, Loss 0.537629, forward nfe 4994, backward nfe 0, Train: 0.8857, Val: 0.8199, Test: 0.8081, Best time: 60.0000
Epoch: 014/100, Runtime 2.815140, Loss 0.450000, forward nfe 5352, backward nfe 0, Train: 0.8714, Val: 0.8221, Test: 0.7970, Best time: 106.1449
Epoch: 015/100, Runtime 2.593179, Loss 0.441854, forward nfe 5692, backward nfe 0, Train: 0.9143, Val: 0.8287, Test: 0.8081, Best time: 62.7820
Epoch: 016/100, Runtime 2.664877, Loss 0.398366, forward nfe 6020, backward nfe 0, Train: 0.9214, Val: 0.8316, Test: 0.8183, Best time: 20.7952
Epoch: 017/100, Runtime 2.564376, Loss 0.366704, forward nfe 6342, backward nfe 0, Train: 0.9214, Val: 0.8316, Test: 0.8183, Best time: 60.0000
Epoch: 018/100, Runtime 2.499012, Loss 0.378651, forward nfe 6640, backward nfe 0, Train: 0.9214, Val: 0.8316, Test: 0.8183, Best time: 60.0000
Epoch: 019/100, Runtime 2.372882, Loss 0.318689, forward nfe 6938, backward nfe 0, Train: 0.9214, Val: 0.8316, Test: 0.8183, Best time: 60.0000
Epoch: 020/100, Runtime 2.488570, Loss 0.381017, forward nfe 7242, backward nfe 0, Train: 0.9143, Val: 0.8426, Test: 0.8315, Best time: 53.2457
Epoch: 021/100, Runtime 2.317119, Loss 0.374688, forward nfe 7534, backward nfe 0, Train: 0.9143, Val: 0.8426, Test: 0.8315, Best time: 60.0000
Epoch: 022/100, Runtime 2.287925, Loss 0.416491, forward nfe 7814, backward nfe 0, Train: 0.9143, Val: 0.8426, Test: 0.8315, Best time: 60.0000
Epoch: 023/100, Runtime 2.264319, Loss 0.330835, forward nfe 8094, backward nfe 0, Train: 0.9143, Val: 0.8426, Test: 0.8315, Best time: 60.0000
Epoch: 024/100, Runtime 2.206674, Loss 0.292351, forward nfe 8362, backward nfe 0, Train: 0.9143, Val: 0.8426, Test: 0.8315, Best time: 60.0000
Epoch: 025/100, Runtime 2.198291, Loss 0.278762, forward nfe 8630, backward nfe 0, Train: 0.9143, Val: 0.8426, Test: 0.8315, Best time: 60.0000
Epoch: 026/100, Runtime 2.139326, Loss 0.304302, forward nfe 8898, backward nfe 0, Train: 0.9143, Val: 0.8426, Test: 0.8315, Best time: 60.0000
Epoch: 027/100, Runtime 2.129555, Loss 0.243106, forward nfe 9166, backward nfe 0, Train: 0.9143, Val: 0.8426, Test: 0.8315, Best time: 60.0000
Epoch: 028/100, Runtime 2.032096, Loss 0.253110, forward nfe 9422, backward nfe 0, Train: 0.9143, Val: 0.8426, Test: 0.8315, Best time: 60.0000
Epoch: 029/100, Runtime 1.995844, Loss 0.285680, forward nfe 9666, backward nfe 0, Train: 0.9143, Val: 0.8426, Test: 0.8315, Best time: 60.0000
Epoch: 030/100, Runtime 1.967613, Loss 0.302079, forward nfe 9898, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 93.7871
Epoch: 031/100, Runtime 2.064011, Loss 0.303176, forward nfe 10130, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 032/100, Runtime 2.007673, Loss 0.215712, forward nfe 10368, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 033/100, Runtime 1.948940, Loss 0.202328, forward nfe 10600, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 034/100, Runtime 1.982128, Loss 0.240362, forward nfe 10832, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 035/100, Runtime 1.983901, Loss 0.235808, forward nfe 11058, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 036/100, Runtime 1.886914, Loss 0.244791, forward nfe 11284, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 037/100, Runtime 1.743380, Loss 0.245988, forward nfe 11504, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 038/100, Runtime 1.795940, Loss 0.209233, forward nfe 11724, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 039/100, Runtime 1.756032, Loss 0.211578, forward nfe 11944, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 040/100, Runtime 1.738466, Loss 0.194558, forward nfe 12164, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 041/100, Runtime 1.686114, Loss 0.197141, forward nfe 12378, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 042/100, Runtime 1.687349, Loss 0.244474, forward nfe 12580, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 043/100, Runtime 1.724028, Loss 0.182028, forward nfe 12788, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 044/100, Runtime 1.783605, Loss 0.164691, forward nfe 12990, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 045/100, Runtime 1.853163, Loss 0.180403, forward nfe 13198, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 046/100, Runtime 1.855034, Loss 0.187993, forward nfe 13412, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 047/100, Runtime 1.623359, Loss 0.230877, forward nfe 13626, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 048/100, Runtime 1.638296, Loss 0.166918, forward nfe 13840, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 049/100, Runtime 1.528441, Loss 0.179031, forward nfe 14054, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 050/100, Runtime 1.626583, Loss 0.125751, forward nfe 14268, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 051/100, Runtime 1.545423, Loss 0.165807, forward nfe 14482, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 052/100, Runtime 1.455557, Loss 0.181079, forward nfe 14684, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 053/100, Runtime 1.589705, Loss 0.121501, forward nfe 14886, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 054/100, Runtime 1.507970, Loss 0.116265, forward nfe 15088, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 055/100, Runtime 1.568540, Loss 0.136658, forward nfe 15290, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 056/100, Runtime 1.569704, Loss 0.176815, forward nfe 15492, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 057/100, Runtime 1.741821, Loss 0.139731, forward nfe 15694, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 058/100, Runtime 1.752652, Loss 0.113581, forward nfe 15896, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 059/100, Runtime 1.754108, Loss 0.154870, forward nfe 16098, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 060/100, Runtime 1.741600, Loss 0.146291, forward nfe 16300, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 061/100, Runtime 1.755867, Loss 0.156551, forward nfe 16502, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 062/100, Runtime 1.773245, Loss 0.144055, forward nfe 16704, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 063/100, Runtime 1.840406, Loss 0.102226, forward nfe 16906, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 064/100, Runtime 1.851176, Loss 0.089393, forward nfe 17120, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 065/100, Runtime 1.874707, Loss 0.128453, forward nfe 17334, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 066/100, Runtime 1.845024, Loss 0.086558, forward nfe 17548, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 067/100, Runtime 1.768151, Loss 0.133327, forward nfe 17762, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 068/100, Runtime 1.765238, Loss 0.132201, forward nfe 17970, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 069/100, Runtime 1.753546, Loss 0.111702, forward nfe 18178, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 070/100, Runtime 1.764667, Loss 0.101120, forward nfe 18386, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 071/100, Runtime 1.780779, Loss 0.088600, forward nfe 18594, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 072/100, Runtime 1.706960, Loss 0.092574, forward nfe 18802, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 073/100, Runtime 2.109493, Loss 0.113750, forward nfe 19010, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 074/100, Runtime 2.180115, Loss 0.095460, forward nfe 19218, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 075/100, Runtime 2.129795, Loss 0.089946, forward nfe 19426, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 076/100, Runtime 2.177401, Loss 0.066934, forward nfe 19634, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 077/100, Runtime 2.282555, Loss 0.113540, forward nfe 19842, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 078/100, Runtime 2.362904, Loss 0.089982, forward nfe 20050, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 079/100, Runtime 2.374945, Loss 0.070431, forward nfe 20258, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 080/100, Runtime 2.399393, Loss 0.041860, forward nfe 20466, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 081/100, Runtime 2.403668, Loss 0.075428, forward nfe 20674, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 082/100, Runtime 2.386928, Loss 0.084456, forward nfe 20882, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 083/100, Runtime 2.348001, Loss 0.075455, forward nfe 21090, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 084/100, Runtime 1.666387, Loss 0.071899, forward nfe 21298, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 085/100, Runtime 1.608521, Loss 0.084009, forward nfe 21506, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 086/100, Runtime 1.607327, Loss 0.074732, forward nfe 21714, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 087/100, Runtime 1.517542, Loss 0.077728, forward nfe 21922, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 088/100, Runtime 1.786341, Loss 0.040646, forward nfe 22130, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 089/100, Runtime 1.804639, Loss 0.080141, forward nfe 22344, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 090/100, Runtime 1.813110, Loss 0.041126, forward nfe 22558, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 091/100, Runtime 1.847520, Loss 0.087356, forward nfe 22772, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 092/100, Runtime 1.915782, Loss 0.054668, forward nfe 22986, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 093/100, Runtime 1.658181, Loss 0.115757, forward nfe 23200, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 094/100, Runtime 1.671929, Loss 0.060957, forward nfe 23408, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 095/100, Runtime 1.724762, Loss 0.059774, forward nfe 23616, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 096/100, Runtime 1.716747, Loss 0.052618, forward nfe 23824, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 097/100, Runtime 1.715017, Loss 0.071851, forward nfe 24032, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 098/100, Runtime 1.693208, Loss 0.076743, forward nfe 24240, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
Epoch: 099/100, Runtime 1.729957, Loss 0.057243, forward nfe 24448, backward nfe 0, Train: 0.9571, Val: 0.8449, Test: 0.8234, Best time: 60.0000
best val accuracy 0.844853 with test accuracy 0.823350 at epoch 30 and best time 60.000000