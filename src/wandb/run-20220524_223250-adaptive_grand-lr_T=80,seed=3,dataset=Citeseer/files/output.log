/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.870866, Loss 1.792653, forward nfe 212, backward nfe 0, Train: 0.2750, Val: 0.3254, Test: 0.3048, Best time: 0.0407
Epoch: 002/100, Runtime 0.823758, Loss 1.774930, forward nfe 906, backward nfe 0, Train: 0.4667, Val: 0.4848, Test: 0.4806, Best time: 0.8877
Epoch: 003/100, Runtime 0.752470, Loss 1.747925, forward nfe 1588, backward nfe 0, Train: 0.6083, Val: 0.6420, Test: 0.6129, Best time: 40.3157
Epoch: 004/100, Runtime 0.774015, Loss 1.695091, forward nfe 2264, backward nfe 0, Train: 0.7000, Val: 0.7203, Test: 0.7129, Best time: 5.2605
Epoch: 005/100, Runtime 0.748218, Loss 1.662704, forward nfe 2940, backward nfe 0, Train: 0.7333, Val: 0.7507, Test: 0.7387, Best time: 6.4386
Epoch: 006/100, Runtime 0.735756, Loss 1.631008, forward nfe 3604, backward nfe 0, Train: 0.7333, Val: 0.7507, Test: 0.7387, Best time: 80.0000
Epoch: 007/100, Runtime 0.725412, Loss 1.529343, forward nfe 4268, backward nfe 0, Train: 0.7333, Val: 0.7507, Test: 0.7387, Best time: 80.0000
Epoch: 008/100, Runtime 0.698448, Loss 1.518302, forward nfe 4896, backward nfe 0, Train: 0.7333, Val: 0.7507, Test: 0.7387, Best time: 80.0000
Epoch: 009/100, Runtime 0.689160, Loss 1.534096, forward nfe 5536, backward nfe 0, Train: 0.7333, Val: 0.7507, Test: 0.7387, Best time: 80.0000
Epoch: 010/100, Runtime 0.679222, Loss 1.476139, forward nfe 6158, backward nfe 0, Train: 0.7333, Val: 0.7507, Test: 0.7387, Best time: 80.0000
Epoch: 011/100, Runtime 0.677399, Loss 1.497939, forward nfe 6774, backward nfe 0, Train: 0.7333, Val: 0.7507, Test: 0.7387, Best time: 80.0000
Epoch: 012/100, Runtime 0.655214, Loss 1.395596, forward nfe 7378, backward nfe 0, Train: 0.7333, Val: 0.7507, Test: 0.7387, Best time: 80.0000
Epoch: 013/100, Runtime 0.652649, Loss 1.391088, forward nfe 7970, backward nfe 0, Train: 0.7333, Val: 0.7507, Test: 0.7387, Best time: 80.0000
Epoch: 014/100, Runtime 0.666795, Loss 1.390777, forward nfe 8556, backward nfe 0, Train: 0.7333, Val: 0.7507, Test: 0.7387, Best time: 80.0000
Epoch: 015/100, Runtime 0.672806, Loss 1.325357, forward nfe 9136, backward nfe 0, Train: 0.7417, Val: 0.7587, Test: 0.7548, Best time: 23.6575
Epoch: 016/100, Runtime 0.643715, Loss 1.356224, forward nfe 9704, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 24.6387
Epoch: 017/100, Runtime 0.621246, Loss 1.240404, forward nfe 10266, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 018/100, Runtime 0.624055, Loss 1.305308, forward nfe 10828, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 019/100, Runtime 0.602689, Loss 1.139150, forward nfe 11384, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 020/100, Runtime 0.591277, Loss 1.212412, forward nfe 11922, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 021/100, Runtime 0.569331, Loss 1.160521, forward nfe 12448, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 022/100, Runtime 0.569547, Loss 1.122536, forward nfe 12956, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 023/100, Runtime 0.602476, Loss 1.176884, forward nfe 13470, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 024/100, Runtime 0.578978, Loss 1.212800, forward nfe 13972, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 025/100, Runtime 0.576090, Loss 1.162391, forward nfe 14468, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 026/100, Runtime 0.551505, Loss 1.208079, forward nfe 14958, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 027/100, Runtime 0.540265, Loss 1.180524, forward nfe 15442, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 028/100, Runtime 0.534566, Loss 1.048152, forward nfe 15920, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 029/100, Runtime 0.515824, Loss 1.116738, forward nfe 16386, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 030/100, Runtime 0.514597, Loss 1.093943, forward nfe 16840, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 031/100, Runtime 0.531442, Loss 1.353528, forward nfe 17294, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 032/100, Runtime 0.522115, Loss 1.178474, forward nfe 17742, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 033/100, Runtime 0.522361, Loss 1.229673, forward nfe 18184, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 034/100, Runtime 0.532761, Loss 1.045700, forward nfe 18620, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 035/100, Runtime 0.506972, Loss 1.173818, forward nfe 19050, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 036/100, Runtime 0.493006, Loss 1.163032, forward nfe 19474, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 037/100, Runtime 0.496755, Loss 1.049278, forward nfe 19904, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 038/100, Runtime 0.485417, Loss 1.046209, forward nfe 20322, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 039/100, Runtime 0.472529, Loss 1.099540, forward nfe 20734, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 040/100, Runtime 0.469593, Loss 1.103930, forward nfe 21140, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 041/100, Runtime 0.481462, Loss 1.029696, forward nfe 21540, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 042/100, Runtime 0.473400, Loss 1.067461, forward nfe 21940, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 043/100, Runtime 0.452079, Loss 1.117189, forward nfe 22334, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 044/100, Runtime 0.467277, Loss 1.137860, forward nfe 22722, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 045/100, Runtime 0.437723, Loss 1.145017, forward nfe 23110, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 046/100, Runtime 0.464968, Loss 1.136624, forward nfe 23492, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 047/100, Runtime 0.457728, Loss 1.069087, forward nfe 23874, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 048/100, Runtime 0.447502, Loss 1.019128, forward nfe 24250, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 049/100, Runtime 0.433704, Loss 1.057767, forward nfe 24626, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 050/100, Runtime 0.434140, Loss 1.075956, forward nfe 24984, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 051/100, Runtime 0.429828, Loss 1.070657, forward nfe 25342, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 052/100, Runtime 0.436321, Loss 1.079153, forward nfe 25700, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 053/100, Runtime 0.422760, Loss 1.073697, forward nfe 26064, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 054/100, Runtime 0.415180, Loss 1.027433, forward nfe 26416, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 055/100, Runtime 0.410530, Loss 1.107170, forward nfe 26768, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 056/100, Runtime 0.411599, Loss 1.067071, forward nfe 27114, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 057/100, Runtime 0.418074, Loss 0.984996, forward nfe 27460, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 058/100, Runtime 0.399452, Loss 1.090599, forward nfe 27806, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 059/100, Runtime 0.399371, Loss 1.009444, forward nfe 28152, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 060/100, Runtime 0.405107, Loss 1.103032, forward nfe 28492, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 061/100, Runtime 0.416818, Loss 1.048245, forward nfe 28832, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 062/100, Runtime 0.413588, Loss 0.994831, forward nfe 29172, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 063/100, Runtime 0.537965, Loss 1.142948, forward nfe 29512, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 064/100, Runtime 0.414238, Loss 1.074459, forward nfe 29852, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 065/100, Runtime 0.413588, Loss 1.126446, forward nfe 30192, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 066/100, Runtime 0.411594, Loss 1.116688, forward nfe 30538, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 067/100, Runtime 0.407335, Loss 1.072696, forward nfe 30884, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 068/100, Runtime 0.418223, Loss 1.087890, forward nfe 31230, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 069/100, Runtime 0.413172, Loss 0.942979, forward nfe 31576, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 070/100, Runtime 0.413538, Loss 1.117376, forward nfe 31916, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 071/100, Runtime 0.403216, Loss 1.080076, forward nfe 32256, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 072/100, Runtime 0.394057, Loss 1.036167, forward nfe 32596, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 073/100, Runtime 0.407436, Loss 1.019391, forward nfe 32936, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 074/100, Runtime 0.410955, Loss 0.969780, forward nfe 33276, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 075/100, Runtime 0.400523, Loss 1.075049, forward nfe 33610, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 076/100, Runtime 0.404616, Loss 1.123813, forward nfe 33944, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 077/100, Runtime 0.398429, Loss 1.154256, forward nfe 34272, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 078/100, Runtime 0.399341, Loss 1.160792, forward nfe 34606, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 079/100, Runtime 0.411918, Loss 1.100199, forward nfe 34940, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 080/100, Runtime 0.398892, Loss 1.069921, forward nfe 35274, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 081/100, Runtime 0.398239, Loss 1.109782, forward nfe 35602, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 082/100, Runtime 0.400564, Loss 1.069435, forward nfe 35930, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 083/100, Runtime 0.392892, Loss 0.995874, forward nfe 36258, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 084/100, Runtime 0.386515, Loss 1.103753, forward nfe 36586, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 085/100, Runtime 0.389201, Loss 1.084662, forward nfe 36908, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 086/100, Runtime 0.396641, Loss 1.099269, forward nfe 37230, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 087/100, Runtime 0.384542, Loss 1.044682, forward nfe 37552, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 088/100, Runtime 0.379306, Loss 1.044022, forward nfe 37874, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 089/100, Runtime 0.391510, Loss 0.999922, forward nfe 38196, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 090/100, Runtime 0.386941, Loss 1.083384, forward nfe 38518, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 091/100, Runtime 0.387119, Loss 0.918225, forward nfe 38840, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 092/100, Runtime 0.390369, Loss 1.041235, forward nfe 39162, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 093/100, Runtime 0.390270, Loss 1.017364, forward nfe 39478, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 094/100, Runtime 0.383589, Loss 1.152167, forward nfe 39794, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 095/100, Runtime 0.369150, Loss 1.144264, forward nfe 40110, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 096/100, Runtime 0.401745, Loss 1.234760, forward nfe 40426, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 097/100, Runtime 0.382423, Loss 1.027751, forward nfe 40742, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 098/100, Runtime 0.376448, Loss 1.140226, forward nfe 41058, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
Epoch: 099/100, Runtime 0.384348, Loss 1.061738, forward nfe 41374, backward nfe 0, Train: 0.7667, Val: 0.7594, Test: 0.7581, Best time: 80.0000
best val accuracy 0.759420 with test accuracy 0.758065 at epoch 16 and best time 80.000000