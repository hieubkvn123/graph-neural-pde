/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 2.726808, Loss 1.948239, forward nfe 92, backward nfe 0, Train: 0.5643, Val: 0.4110, Test: 0.4081, Best time: 5.5488
Epoch: 002/100, Runtime 2.556818, Loss 1.959326, forward nfe 420, backward nfe 0, Train: 0.5643, Val: 0.4110, Test: 0.4081, Best time: 40.0000
Epoch: 003/100, Runtime 2.457854, Loss 1.905552, forward nfe 736, backward nfe 0, Train: 0.5643, Val: 0.4110, Test: 0.4081, Best time: 40.0000
Epoch: 004/100, Runtime 2.431324, Loss 1.806504, forward nfe 1046, backward nfe 0, Train: 0.5643, Val: 0.4110, Test: 0.4081, Best time: 40.0000
Epoch: 005/100, Runtime 2.334175, Loss 1.638375, forward nfe 1350, backward nfe 0, Train: 0.7571, Val: 0.6574, Test: 0.6193, Best time: 5.5681
Epoch: 006/100, Runtime 2.450441, Loss 1.404433, forward nfe 1648, backward nfe 0, Train: 0.8143, Val: 0.7324, Test: 0.7076, Best time: 7.8552
Epoch: 007/100, Runtime 2.345230, Loss 1.188419, forward nfe 1940, backward nfe 0, Train: 0.8643, Val: 0.7662, Test: 0.7503, Best time: 5.8581
Epoch: 008/100, Runtime 2.344850, Loss 0.979134, forward nfe 2226, backward nfe 0, Train: 0.8857, Val: 0.8081, Test: 0.8000, Best time: 11.0698
Epoch: 009/100, Runtime 2.244765, Loss 0.765443, forward nfe 2512, backward nfe 0, Train: 0.8929, Val: 0.8184, Test: 0.7949, Best time: 8.5313
Epoch: 010/100, Runtime 2.193484, Loss 0.620580, forward nfe 2792, backward nfe 0, Train: 0.8857, Val: 0.8191, Test: 0.7970, Best time: 11.8314
Epoch: 011/100, Runtime 2.149914, Loss 0.564474, forward nfe 3060, backward nfe 0, Train: 0.8857, Val: 0.8191, Test: 0.7970, Best time: 40.0000
Epoch: 012/100, Runtime 2.164471, Loss 0.445855, forward nfe 3334, backward nfe 0, Train: 0.9071, Val: 0.8324, Test: 0.8102, Best time: 9.5479
Epoch: 013/100, Runtime 1.970753, Loss 0.400162, forward nfe 3602, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 17.9426
Epoch: 014/100, Runtime 2.091038, Loss 0.353581, forward nfe 3858, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 40.0000
Epoch: 015/100, Runtime 1.875020, Loss 0.364851, forward nfe 4102, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 40.0000
Epoch: 016/100, Runtime 1.680814, Loss 0.324686, forward nfe 4340, backward nfe 0, Train: 0.9214, Val: 0.8397, Test: 0.8376, Best time: 38.2103
Epoch: 017/100, Runtime 1.828702, Loss 0.327932, forward nfe 4566, backward nfe 0, Train: 0.9214, Val: 0.8397, Test: 0.8376, Best time: 40.0000
Epoch: 018/100, Runtime 1.793050, Loss 0.285510, forward nfe 4804, backward nfe 0, Train: 0.9214, Val: 0.8397, Test: 0.8376, Best time: 40.0000
Epoch: 019/100, Runtime 1.722343, Loss 0.286925, forward nfe 5036, backward nfe 0, Train: 0.9214, Val: 0.8397, Test: 0.8376, Best time: 40.0000
Epoch: 020/100, Runtime 1.695602, Loss 0.277022, forward nfe 5262, backward nfe 0, Train: 0.9214, Val: 0.8397, Test: 0.8376, Best time: 40.0000
Epoch: 021/100, Runtime 1.622635, Loss 0.273287, forward nfe 5482, backward nfe 0, Train: 0.9214, Val: 0.8397, Test: 0.8376, Best time: 40.0000
Epoch: 022/100, Runtime 1.635526, Loss 0.272444, forward nfe 5690, backward nfe 0, Train: 0.9214, Val: 0.8397, Test: 0.8376, Best time: 40.0000
Epoch: 023/100, Runtime 1.723511, Loss 0.222276, forward nfe 5898, backward nfe 0, Train: 0.9500, Val: 0.8522, Test: 0.8406, Best time: 41.1795
Epoch: 024/100, Runtime 1.675123, Loss 0.184807, forward nfe 6100, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 50.0359
Epoch: 025/100, Runtime 1.725107, Loss 0.289063, forward nfe 6308, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 026/100, Runtime 1.655350, Loss 0.244739, forward nfe 6510, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 027/100, Runtime 1.575574, Loss 0.216411, forward nfe 6712, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 028/100, Runtime 1.625024, Loss 0.216518, forward nfe 6908, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 029/100, Runtime 1.536850, Loss 0.181151, forward nfe 7104, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 030/100, Runtime 1.547662, Loss 0.179347, forward nfe 7294, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 031/100, Runtime 1.542458, Loss 0.143409, forward nfe 7484, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 032/100, Runtime 1.547488, Loss 0.197454, forward nfe 7662, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 033/100, Runtime 1.545406, Loss 0.212179, forward nfe 7846, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 034/100, Runtime 1.454383, Loss 0.132520, forward nfe 8030, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 035/100, Runtime 1.324046, Loss 0.182198, forward nfe 8214, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 036/100, Runtime 1.382408, Loss 0.213651, forward nfe 8398, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 037/100, Runtime 1.262101, Loss 0.143476, forward nfe 8576, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 038/100, Runtime 1.428639, Loss 0.149021, forward nfe 8754, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 039/100, Runtime 1.237949, Loss 0.154356, forward nfe 8932, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 040/100, Runtime 1.453731, Loss 0.137724, forward nfe 9110, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 041/100, Runtime 1.364428, Loss 0.153067, forward nfe 9288, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 042/100, Runtime 1.419638, Loss 0.133404, forward nfe 9466, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 043/100, Runtime 1.522157, Loss 0.206859, forward nfe 9644, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 044/100, Runtime 1.508236, Loss 0.127859, forward nfe 9822, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 045/100, Runtime 1.532908, Loss 0.129406, forward nfe 10000, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 046/100, Runtime 1.465436, Loss 0.134333, forward nfe 10178, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 047/100, Runtime 1.405286, Loss 0.095173, forward nfe 10344, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 048/100, Runtime 1.406727, Loss 0.121004, forward nfe 10510, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 049/100, Runtime 1.415343, Loss 0.093380, forward nfe 10676, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 050/100, Runtime 1.394891, Loss 0.066456, forward nfe 10842, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 051/100, Runtime 1.488418, Loss 0.121721, forward nfe 11008, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 052/100, Runtime 1.413207, Loss 0.075790, forward nfe 11180, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 053/100, Runtime 1.489306, Loss 0.070197, forward nfe 11352, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 054/100, Runtime 1.431315, Loss 0.105356, forward nfe 11524, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 055/100, Runtime 1.453077, Loss 0.075644, forward nfe 11696, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 056/100, Runtime 1.418658, Loss 0.076149, forward nfe 11868, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 057/100, Runtime 1.431345, Loss 0.067620, forward nfe 12040, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 058/100, Runtime 1.476129, Loss 0.074631, forward nfe 12212, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 059/100, Runtime 1.408587, Loss 0.063562, forward nfe 12384, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 060/100, Runtime 1.501515, Loss 0.081296, forward nfe 12556, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 061/100, Runtime 1.486788, Loss 0.077086, forward nfe 12728, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 062/100, Runtime 1.373606, Loss 0.095722, forward nfe 12900, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 063/100, Runtime 1.508692, Loss 0.130413, forward nfe 13072, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 064/100, Runtime 1.448273, Loss 0.102952, forward nfe 13244, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 065/100, Runtime 1.429877, Loss 0.091309, forward nfe 13416, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 066/100, Runtime 1.503160, Loss 0.064575, forward nfe 13588, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 067/100, Runtime 1.382387, Loss 0.071256, forward nfe 13760, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 068/100, Runtime 1.437786, Loss 0.066447, forward nfe 13932, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 069/100, Runtime 1.338139, Loss 0.057817, forward nfe 14098, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 070/100, Runtime 1.286958, Loss 0.048558, forward nfe 14258, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 071/100, Runtime 1.269670, Loss 0.069811, forward nfe 14412, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 072/100, Runtime 1.194373, Loss 0.041806, forward nfe 14566, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 073/100, Runtime 1.224065, Loss 0.044389, forward nfe 14720, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 074/100, Runtime 1.234429, Loss 0.039360, forward nfe 14880, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 075/100, Runtime 1.219128, Loss 0.103898, forward nfe 15040, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 076/100, Runtime 1.314343, Loss 0.095415, forward nfe 15200, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 077/100, Runtime 1.246008, Loss 0.049420, forward nfe 15360, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 078/100, Runtime 1.220077, Loss 0.075308, forward nfe 15520, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 079/100, Runtime 1.587824, Loss 0.051007, forward nfe 15680, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 080/100, Runtime 1.694215, Loss 0.110035, forward nfe 15840, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 081/100, Runtime 1.667137, Loss 0.070745, forward nfe 16000, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 082/100, Runtime 1.874471, Loss 0.076818, forward nfe 16160, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 083/100, Runtime 1.837580, Loss 0.097536, forward nfe 16320, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 084/100, Runtime 1.885760, Loss 0.068928, forward nfe 16480, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 085/100, Runtime 1.852564, Loss 0.105373, forward nfe 16640, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 086/100, Runtime 1.912088, Loss 0.076571, forward nfe 16800, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 087/100, Runtime 1.830114, Loss 0.065564, forward nfe 16960, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 088/100, Runtime 1.814511, Loss 0.038755, forward nfe 17120, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 089/100, Runtime 1.758533, Loss 0.053197, forward nfe 17274, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 090/100, Runtime 1.736659, Loss 0.059976, forward nfe 17428, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 091/100, Runtime 1.863567, Loss 0.067301, forward nfe 17582, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 092/100, Runtime 1.660841, Loss 0.042193, forward nfe 17736, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 093/100, Runtime 1.558257, Loss 0.028314, forward nfe 17896, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 094/100, Runtime 1.350014, Loss 0.031105, forward nfe 18056, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 095/100, Runtime 1.294842, Loss 0.063179, forward nfe 18228, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 096/100, Runtime 1.371979, Loss 0.035837, forward nfe 18400, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 097/100, Runtime 1.419868, Loss 0.029564, forward nfe 18578, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 098/100, Runtime 1.497093, Loss 0.037463, forward nfe 18756, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
Epoch: 099/100, Runtime 1.484486, Loss 0.039988, forward nfe 18934, backward nfe 0, Train: 0.9143, Val: 0.8574, Test: 0.8426, Best time: 40.0000
best val accuracy 0.857353 with test accuracy 0.842640 at epoch 24 and best time 40.000000