/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 1999.022473, Loss 1.098658, forward nfe 128, backward nfe 234213, Train: 0.7167, Val: 0.7056, Test: 0.6871, Best time: 10.2235
Epoch: 002/100, Runtime 2039.697064, Loss 1.085259, forward nfe 846, backward nfe 472112, Train: 0.7333, Val: 0.7174, Test: 0.6964, Best time: 19.9026
Epoch: 003/100, Runtime 1536.615390, Loss 1.060796, forward nfe 1552, backward nfe 649940, Train: 0.7333, Val: 0.7306, Test: 0.7165, Best time: 51.2969
Epoch: 004/100, Runtime 2960.497889, Loss 1.025231, forward nfe 2270, backward nfe 1001060, Train: 0.7333, Val: 0.7361, Test: 0.7165, Best time: 39.1971
Epoch: 005/100, Runtime 2410.855110, Loss 0.978485, forward nfe 3000, backward nfe 1283857, Train: 0.7333, Val: 0.7361, Test: 0.7165, Best time: 60.0000
Epoch: 006/100, Runtime 3104.216305, Loss 0.911290, forward nfe 3730, backward nfe 1651949, Train: 0.7333, Val: 0.7361, Test: 0.7165, Best time: 60.0000
Epoch: 007/100, Runtime 2303.397691, Loss 0.852060, forward nfe 4454, backward nfe 1924619, Train: 0.7333, Val: 0.7361, Test: 0.7165, Best time: 60.0000
Epoch: 008/100, Runtime 2758.872886, Loss 0.793630, forward nfe 5184, backward nfe 2250485, Train: 0.7500, Val: 0.7403, Test: 0.7191, Best time: 9.2399
Epoch: 009/100, Runtime 2852.824378, Loss 0.723584, forward nfe 5914, backward nfe 2589626, Train: 0.7500, Val: 0.7521, Test: 0.7328, Best time: 9.1604
Epoch: 010/100, Runtime 2919.675353, Loss 0.667859, forward nfe 6644, backward nfe 2937233, Train: 0.7667, Val: 0.7653, Test: 0.7420, Best time: 9.1405
Epoch: 011/100, Runtime 4241.653951, Loss 0.621941, forward nfe 7374, backward nfe 3448363, Train: 0.7833, Val: 0.7701, Test: 0.7500, Best time: 9.1530
Epoch: 012/100, Runtime 2966.555943, Loss 0.592275, forward nfe 8104, backward nfe 3801232, Train: 0.7833, Val: 0.7833, Test: 0.7640, Best time: 9.1852
Epoch: 013/100, Runtime 3514.486686, Loss 0.564360, forward nfe 8834, backward nfe 4225046, Train: 0.7667, Val: 0.8007, Test: 0.7911, Best time: 2.1790
Epoch: 014/100, Runtime 2719.757578, Loss 0.538940, forward nfe 9564, backward nfe 4552255, Train: 0.7667, Val: 0.8007, Test: 0.7911, Best time: 60.0000
Epoch: 015/100, Runtime 2854.884681, Loss 0.504849, forward nfe 10294, backward nfe 4897965, Train: 0.7667, Val: 0.8007, Test: 0.7911, Best time: 60.0000
Epoch: 016/100, Runtime 2030.330873, Loss 0.509895, forward nfe 11030, backward nfe 5141500, Train: 0.8667, Val: 0.8229, Test: 0.8120, Best time: 5.4131
Epoch: 017/100, Runtime 2196.720856, Loss 0.497360, forward nfe 11766, backward nfe 5406469, Train: 0.8667, Val: 0.8229, Test: 0.8120, Best time: 60.0000
Epoch: 018/100, Runtime 1883.800633, Loss 0.513670, forward nfe 12502, backward nfe 5630813, Train: 0.8667, Val: 0.8229, Test: 0.8120, Best time: 60.0000
Epoch: 019/100, Runtime 2504.009297, Loss 0.459067, forward nfe 13238, backward nfe 5929907, Train: 0.8667, Val: 0.8229, Test: 0.8120, Best time: 60.0000
Epoch: 020/100, Runtime 2629.066706, Loss 0.452526, forward nfe 13974, backward nfe 6248790, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 5.5397
Epoch: 021/100, Runtime 2697.336152, Loss 0.513648, forward nfe 14710, backward nfe 6576171, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 022/100, Runtime 1764.838168, Loss 0.471314, forward nfe 15446, backward nfe 6789750, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 023/100, Runtime 2157.820964, Loss 0.455229, forward nfe 16182, backward nfe 7051513, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 024/100, Runtime 1771.700810, Loss 0.490713, forward nfe 16918, backward nfe 7263012, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 025/100, Runtime 2198.098831, Loss 0.431042, forward nfe 17654, backward nfe 7525799, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 026/100, Runtime 1850.259635, Loss 0.453088, forward nfe 18390, backward nfe 7746280, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 027/100, Runtime 1843.702356, Loss 0.413137, forward nfe 19126, backward nfe 7966342, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 028/100, Runtime 2084.791096, Loss 0.459701, forward nfe 19862, backward nfe 8216280, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 029/100, Runtime 2018.844728, Loss 0.394416, forward nfe 20598, backward nfe 8456446, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 030/100, Runtime 2816.293582, Loss 0.441426, forward nfe 21328, backward nfe 8796479, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 031/100, Runtime 3510.301419, Loss 0.407796, forward nfe 22058, backward nfe 9225127, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 032/100, Runtime 2249.368201, Loss 0.404303, forward nfe 22788, backward nfe 9499901, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 033/100, Runtime 2259.408741, Loss 0.415262, forward nfe 23518, backward nfe 9772536, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 034/100, Runtime 1995.833935, Loss 0.448057, forward nfe 24248, backward nfe 10009241, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 035/100, Runtime 2416.782680, Loss 0.472663, forward nfe 24978, backward nfe 10298837, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 036/100, Runtime 2438.977965, Loss 0.452363, forward nfe 25708, backward nfe 10598113, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 037/100, Runtime 1735.709380, Loss 0.374547, forward nfe 26438, backward nfe 10801459, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 038/100, Runtime 2013.972199, Loss 0.387332, forward nfe 27168, backward nfe 11044106, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 039/100, Runtime 1308.848462, Loss 0.392089, forward nfe 27898, backward nfe 11198451, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 040/100, Runtime 2234.304404, Loss 0.365884, forward nfe 28628, backward nfe 11465148, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 041/100, Runtime 1462.338630, Loss 0.375601, forward nfe 29358, backward nfe 11639477, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 042/100, Runtime 2323.584809, Loss 0.368919, forward nfe 30088, backward nfe 11917627, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 043/100, Runtime 2479.415169, Loss 0.395074, forward nfe 30818, backward nfe 12216290, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 044/100, Runtime 2101.897968, Loss 0.333876, forward nfe 31548, backward nfe 12465488, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 045/100, Runtime 1699.725528, Loss 0.400263, forward nfe 32278, backward nfe 12665777, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 046/100, Runtime 1867.347109, Loss 0.386040, forward nfe 33008, backward nfe 12884265, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 047/100, Runtime 2645.614304, Loss 0.425817, forward nfe 33738, backward nfe 13199867, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 048/100, Runtime 2026.745623, Loss 0.397891, forward nfe 34468, backward nfe 13443129, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 049/100, Runtime 1940.403899, Loss 0.452137, forward nfe 35198, backward nfe 13676934, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 050/100, Runtime 2080.506634, Loss 0.405419, forward nfe 35928, backward nfe 13926569, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 051/100, Runtime 1496.213861, Loss 0.487157, forward nfe 36658, backward nfe 14102748, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 052/100, Runtime 1890.997460, Loss 0.372788, forward nfe 37388, backward nfe 14332610, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 053/100, Runtime 1361.690920, Loss 0.354032, forward nfe 38118, backward nfe 14496543, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 054/100, Runtime 1885.541454, Loss 0.403239, forward nfe 38848, backward nfe 14724243, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 055/100, Runtime 2335.553684, Loss 0.348716, forward nfe 39578, backward nfe 15007260, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 056/100, Runtime 4507.136350, Loss 0.425651, forward nfe 40308, backward nfe 15559619, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 057/100, Runtime 2008.190453, Loss 0.387241, forward nfe 41038, backward nfe 15800190, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 058/100, Runtime 2620.377365, Loss 0.379322, forward nfe 41768, backward nfe 16120612, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 059/100, Runtime 1709.039942, Loss 0.376057, forward nfe 42498, backward nfe 16325679, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 060/100, Runtime 1842.607570, Loss 0.376906, forward nfe 43228, backward nfe 16546006, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 061/100, Runtime 1894.985241, Loss 0.447037, forward nfe 43958, backward nfe 16773197, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 062/100, Runtime 1421.188710, Loss 0.362270, forward nfe 44688, backward nfe 16944335, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 063/100, Runtime 1517.808558, Loss 0.391906, forward nfe 45418, backward nfe 17125383, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 064/100, Runtime 1315.577586, Loss 0.487876, forward nfe 46148, backward nfe 17282159, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 065/100, Runtime 2106.942763, Loss 0.384345, forward nfe 46878, backward nfe 17537506, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 066/100, Runtime 2150.346077, Loss 0.409643, forward nfe 47608, backward nfe 17795596, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 067/100, Runtime 2396.761659, Loss 0.425093, forward nfe 48338, backward nfe 18090109, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 068/100, Runtime 1714.976176, Loss 0.363429, forward nfe 49068, backward nfe 18296153, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 069/100, Runtime 1395.953555, Loss 0.429432, forward nfe 49798, backward nfe 18462090, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 070/100, Runtime 1836.476329, Loss 0.342869, forward nfe 50528, backward nfe 18685420, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 071/100, Runtime 1982.199542, Loss 0.379400, forward nfe 51258, backward nfe 18926785, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 072/100, Runtime 1726.330458, Loss 0.415354, forward nfe 51988, backward nfe 19135379, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 073/100, Runtime 1722.548182, Loss 0.408965, forward nfe 52718, backward nfe 19340629, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 074/100, Runtime 1664.713375, Loss 0.328249, forward nfe 53448, backward nfe 19539501, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 075/100, Runtime 1451.986510, Loss 0.389289, forward nfe 54178, backward nfe 19712745, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 076/100, Runtime 1707.575047, Loss 0.307741, forward nfe 54908, backward nfe 19917906, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 077/100, Runtime 2556.789868, Loss 0.348785, forward nfe 55638, backward nfe 20227831, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 078/100, Runtime 2506.947416, Loss 0.361561, forward nfe 56368, backward nfe 20531731, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 079/100, Runtime 1872.942182, Loss 0.329962, forward nfe 57104, backward nfe 20758248, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 080/100, Runtime 2112.005333, Loss 0.342270, forward nfe 57834, backward nfe 21013513, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 081/100, Runtime 2279.870342, Loss 0.344408, forward nfe 58564, backward nfe 21290446, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 082/100, Runtime 1730.741583, Loss 0.375513, forward nfe 59294, backward nfe 21495668, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 083/100, Runtime 1481.841552, Loss 0.290415, forward nfe 60024, backward nfe 21673705, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 084/100, Runtime 1102.729071, Loss 0.353108, forward nfe 60760, backward nfe 21805037, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 085/100, Runtime 1687.743912, Loss 0.314368, forward nfe 61490, backward nfe 22008840, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 086/100, Runtime 3062.586630, Loss 0.338028, forward nfe 62220, backward nfe 22379928, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 087/100, Runtime 2856.259463, Loss 0.317914, forward nfe 62950, backward nfe 22725987, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 088/100, Runtime 1474.645812, Loss 0.349852, forward nfe 63686, backward nfe 22900575, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 089/100, Runtime 1910.407833, Loss 0.366127, forward nfe 64422, backward nfe 23128731, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 090/100, Runtime 1766.550231, Loss 0.317773, forward nfe 65158, backward nfe 23338956, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 091/100, Runtime 2664.967782, Loss 0.359455, forward nfe 65894, backward nfe 23664891, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 092/100, Runtime 1217.893249, Loss 0.367607, forward nfe 66630, backward nfe 23809605, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 093/100, Runtime 4010.433918, Loss 0.327875, forward nfe 67366, backward nfe 24297963, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 094/100, Runtime 1902.997188, Loss 0.311990, forward nfe 68102, backward nfe 24528004, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 095/100, Runtime 1343.219648, Loss 0.346536, forward nfe 68838, backward nfe 24686234, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 096/100, Runtime 2513.365046, Loss 0.393756, forward nfe 69574, backward nfe 24988593, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 097/100, Runtime 1653.670791, Loss 0.337982, forward nfe 70310, backward nfe 25187649, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 098/100, Runtime 1614.485173, Loss 0.336571, forward nfe 71046, backward nfe 25382278, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
Epoch: 099/100, Runtime 1773.306913, Loss 0.365715, forward nfe 71782, backward nfe 25597294, Train: 0.8500, Val: 0.8319, Test: 0.8097, Best time: 60.0000
best val accuracy 0.831944 with test accuracy 0.809738 at epoch 20 and best time 60.000000