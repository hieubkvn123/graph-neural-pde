/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
Epoch: 001/100, Runtime 37.406422, Loss 1.098942, forward nfe 92, backward nfe 3712, Train: 0.5667, Val: 0.5993, Test: 0.6118, Best time: 40.0950
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 002/100, Runtime 46.257753, Loss 1.097028, forward nfe 570, backward nfe 8466, Train: 0.5667, Val: 0.5993, Test: 0.6118, Best time: 40.0000
Epoch: 003/100, Runtime 56.882628, Loss 1.090690, forward nfe 1048, backward nfe 14510, Train: 0.5667, Val: 0.5993, Test: 0.6118, Best time: 40.0000
Epoch: 004/100, Runtime 53.274910, Loss 1.076836, forward nfe 1532, backward nfe 20273, Train: 0.7333, Val: 0.7167, Test: 0.7182, Best time: 2.5715
Epoch: 005/100, Runtime 103.391255, Loss 1.059082, forward nfe 2016, backward nfe 32166, Train: 0.7167, Val: 0.7486, Test: 0.7380, Best time: 2.5005
Epoch: 006/100, Runtime 130.367887, Loss 1.032092, forward nfe 2500, backward nfe 47315, Train: 0.7167, Val: 0.7486, Test: 0.7380, Best time: 40.0000
Epoch: 007/100, Runtime 88.473097, Loss 0.996356, forward nfe 2990, backward nfe 57433, Train: 0.7167, Val: 0.7486, Test: 0.7380, Best time: 40.0000
Epoch: 008/100, Runtime 101.890521, Loss 0.956247, forward nfe 3480, backward nfe 69206, Train: 0.7167, Val: 0.7486, Test: 0.7380, Best time: 40.0000
Epoch: 009/100, Runtime 112.735572, Loss 0.907675, forward nfe 3970, backward nfe 82213, Train: 0.7167, Val: 0.7486, Test: 0.7380, Best time: 40.0000
Epoch: 010/100, Runtime 101.360331, Loss 0.855124, forward nfe 4460, backward nfe 93924, Train: 0.7167, Val: 0.7486, Test: 0.7380, Best time: 40.0000
Epoch: 011/100, Runtime 87.695920, Loss 0.793519, forward nfe 4950, backward nfe 103842, Train: 0.7167, Val: 0.7486, Test: 0.7380, Best time: 40.0000
Epoch: 012/100, Runtime 102.729406, Loss 0.753358, forward nfe 5440, backward nfe 115730, Train: 0.7167, Val: 0.7486, Test: 0.7380, Best time: 40.0000
Epoch: 013/100, Runtime 59.820196, Loss 0.688821, forward nfe 5924, backward nfe 122356, Train: 0.7500, Val: 0.7514, Test: 0.7402, Best time: 81.8157
Epoch: 014/100, Runtime 89.078585, Loss 0.653485, forward nfe 6408, backward nfe 132566, Train: 0.7833, Val: 0.7576, Test: 0.7490, Best time: 105.3686
Epoch: 015/100, Runtime 38.260215, Loss 0.602526, forward nfe 6892, backward nfe 136499, Train: 0.7833, Val: 0.7701, Test: 0.7609, Best time: 101.6749
Epoch: 016/100, Runtime 63.923834, Loss 0.565107, forward nfe 7382, backward nfe 143530, Train: 0.7833, Val: 0.7736, Test: 0.7669, Best time: 35.0064
Epoch: 017/100, Runtime 59.144519, Loss 0.510224, forward nfe 7872, backward nfe 150079, Train: 0.8000, Val: 0.7785, Test: 0.7736, Best time: 39.2161
Epoch: 018/100, Runtime 45.605694, Loss 0.499844, forward nfe 8362, backward nfe 154965, Train: 0.8167, Val: 0.7875, Test: 0.7823, Best time: 47.2481
Epoch: 019/100, Runtime 31.577154, Loss 0.472968, forward nfe 8852, backward nfe 158153, Train: 0.8333, Val: 0.7958, Test: 0.7893, Best time: 47.3511
Epoch: 020/100, Runtime 31.375290, Loss 0.473389, forward nfe 9348, backward nfe 161277, Train: 0.8333, Val: 0.8007, Test: 0.7904, Best time: 63.1387
Epoch: 021/100, Runtime 41.146536, Loss 0.448864, forward nfe 9844, backward nfe 165633, Train: 0.8333, Val: 0.8007, Test: 0.7904, Best time: 40.0000
Epoch: 022/100, Runtime 76.696607, Loss 0.445747, forward nfe 10340, backward nfe 174234, Train: 0.8667, Val: 0.8014, Test: 0.7906, Best time: 55.3074
Epoch: 023/100, Runtime 83.670966, Loss 0.411504, forward nfe 10836, backward nfe 183539, Train: 0.8667, Val: 0.8014, Test: 0.7906, Best time: 40.0000
Epoch: 024/100, Runtime 73.535149, Loss 0.446333, forward nfe 11326, backward nfe 191785, Train: 0.8667, Val: 0.8014, Test: 0.7906, Best time: 40.0000
Epoch: 025/100, Runtime 58.525063, Loss 0.401160, forward nfe 11816, backward nfe 198226, Train: 0.8667, Val: 0.8014, Test: 0.7906, Best time: 40.0000
Epoch: 026/100, Runtime 59.999096, Loss 0.387626, forward nfe 12306, backward nfe 204798, Train: 0.8667, Val: 0.8014, Test: 0.7906, Best time: 40.0000
Epoch: 027/100, Runtime 63.002009, Loss 0.382877, forward nfe 12796, backward nfe 211717, Train: 0.8667, Val: 0.8014, Test: 0.7906, Best time: 40.0000
Epoch: 028/100, Runtime 49.916662, Loss 0.402193, forward nfe 13274, backward nfe 217104, Train: 0.8667, Val: 0.8014, Test: 0.7906, Best time: 40.0000
Epoch: 029/100, Runtime 66.101845, Loss 0.406026, forward nfe 13752, backward nfe 224504, Train: 0.8667, Val: 0.8014, Test: 0.7906, Best time: 40.0000
Epoch: 030/100, Runtime 91.757042, Loss 0.377326, forward nfe 14224, backward nfe 235014, Train: 0.8667, Val: 0.8014, Test: 0.7906, Best time: 40.0000
Epoch: 031/100, Runtime 81.212658, Loss 0.422225, forward nfe 14696, backward nfe 244195, Train: 0.8667, Val: 0.8014, Test: 0.7906, Best time: 40.0000
Epoch: 032/100, Runtime 55.302896, Loss 0.389504, forward nfe 15174, backward nfe 250200, Train: 0.8667, Val: 0.8014, Test: 0.7906, Best time: 40.0000
Epoch: 033/100, Runtime 96.540782, Loss 0.378714, forward nfe 15646, backward nfe 261265, Train: 0.8667, Val: 0.8014, Test: 0.7906, Best time: 40.0000
Epoch: 034/100, Runtime 112.975861, Loss 0.401399, forward nfe 16124, backward nfe 274268, Train: 0.8667, Val: 0.8014, Test: 0.7906, Best time: 40.0000
Epoch: 035/100, Runtime 77.876826, Loss 0.387942, forward nfe 16602, backward nfe 282993, Train: 0.8667, Val: 0.8014, Test: 0.7906, Best time: 40.0000
Epoch: 036/100, Runtime 189.644706, Loss 0.385905, forward nfe 17080, backward nfe 305471, Train: 0.8667, Val: 0.8014, Test: 0.7906, Best time: 40.0000
Epoch: 037/100, Runtime 118.175841, Loss 0.351452, forward nfe 17546, backward nfe 319183, Train: 0.9167, Val: 0.8021, Test: 0.7943, Best time: 39.7135
Epoch: 038/100, Runtime 197.048741, Loss 0.329898, forward nfe 18024, backward nfe 342398, Train: 0.9167, Val: 0.8021, Test: 0.7943, Best time: 40.0000
Epoch: 039/100, Runtime 178.826993, Loss 0.357478, forward nfe 18490, backward nfe 363501, Train: 0.9167, Val: 0.8021, Test: 0.7943, Best time: 40.0000
Epoch: 040/100, Runtime 101.836701, Loss 0.310503, forward nfe 18968, backward nfe 375248, Train: 0.9167, Val: 0.8021, Test: 0.7943, Best time: 40.0000
Epoch: 041/100, Runtime 120.520296, Loss 0.329387, forward nfe 19446, backward nfe 389235, Train: 0.9167, Val: 0.8021, Test: 0.7943, Best time: 40.0000
Epoch: 042/100, Runtime 111.974691, Loss 0.327846, forward nfe 19912, backward nfe 401954, Train: 0.9167, Val: 0.8021, Test: 0.7943, Best time: 40.0000
Epoch: 043/100, Runtime 110.953385, Loss 0.344048, forward nfe 20390, backward nfe 414790, Train: 0.9167, Val: 0.8028, Test: 0.7965, Best time: 51.1847
Epoch: 044/100, Runtime 87.598285, Loss 0.339664, forward nfe 20862, backward nfe 424748, Train: 0.9000, Val: 0.8035, Test: 0.7970, Best time: 55.1408
Epoch: 045/100, Runtime 69.629805, Loss 0.359408, forward nfe 21346, backward nfe 432487, Train: 0.9000, Val: 0.8035, Test: 0.7970, Best time: 40.0000
Epoch: 046/100, Runtime 32.091203, Loss 0.265901, forward nfe 21830, backward nfe 435722, Train: 0.9000, Val: 0.8035, Test: 0.7970, Best time: 40.0000
Epoch: 047/100, Runtime 26.563739, Loss 0.332233, forward nfe 22320, backward nfe 438346, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 78.4392
Epoch: 048/100, Runtime 36.211707, Loss 0.291830, forward nfe 22810, backward nfe 442095, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 049/100, Runtime 28.575390, Loss 0.335197, forward nfe 23300, backward nfe 444892, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 050/100, Runtime 34.409977, Loss 0.314223, forward nfe 23790, backward nfe 448357, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 051/100, Runtime 46.700704, Loss 0.242042, forward nfe 24280, backward nfe 453404, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 052/100, Runtime 33.416193, Loss 0.285402, forward nfe 24770, backward nfe 456776, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 053/100, Runtime 41.307497, Loss 0.272689, forward nfe 25260, backward nfe 461057, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 054/100, Runtime 65.623687, Loss 0.289964, forward nfe 25750, backward nfe 468297, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 055/100, Runtime 82.245179, Loss 0.302967, forward nfe 26240, backward nfe 477529, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 056/100, Runtime 108.837939, Loss 0.329836, forward nfe 26730, backward nfe 490187, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 057/100, Runtime 78.738575, Loss 0.253434, forward nfe 27214, backward nfe 499155, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 058/100, Runtime 109.754510, Loss 0.229980, forward nfe 27704, backward nfe 511801, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 059/100, Runtime 44.776458, Loss 0.204200, forward nfe 28194, backward nfe 516660, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 060/100, Runtime 136.861171, Loss 0.246886, forward nfe 28684, backward nfe 532721, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 061/100, Runtime 90.477841, Loss 0.183650, forward nfe 29162, backward nfe 543002, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 062/100, Runtime 127.849178, Loss 0.215329, forward nfe 29640, backward nfe 557799, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 063/100, Runtime 70.193471, Loss 0.242226, forward nfe 30124, backward nfe 565741, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 064/100, Runtime 143.493522, Loss 0.228054, forward nfe 30608, backward nfe 582384, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 065/100, Runtime 214.715070, Loss 0.225522, forward nfe 31092, backward nfe 607357, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 066/100, Runtime 102.008910, Loss 0.239294, forward nfe 31576, backward nfe 618856, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 067/100, Runtime 192.604398, Loss 0.255634, forward nfe 32054, backward nfe 641254, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 068/100, Runtime 153.736427, Loss 0.246199, forward nfe 32538, backward nfe 659101, Train: 0.9167, Val: 0.8049, Test: 0.7988, Best time: 40.0000
Epoch: 069/100, Runtime 210.111132, Loss 0.251429, forward nfe 33016, backward nfe 683615, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 43.1790
Epoch: 070/100, Runtime 142.757103, Loss 0.212827, forward nfe 33500, backward nfe 700123, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 071/100, Runtime 39.950063, Loss 0.271695, forward nfe 33996, backward nfe 704326, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 072/100, Runtime 68.968242, Loss 0.190739, forward nfe 34492, backward nfe 712029, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 073/100, Runtime 39.946967, Loss 0.238217, forward nfe 34988, backward nfe 716230, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 074/100, Runtime 42.022901, Loss 0.229742, forward nfe 35484, backward nfe 720696, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 075/100, Runtime 50.017356, Loss 0.172280, forward nfe 35980, backward nfe 726106, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 076/100, Runtime 59.460373, Loss 0.191438, forward nfe 36476, backward nfe 732659, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 077/100, Runtime 91.479827, Loss 0.200136, forward nfe 36978, backward nfe 742886, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 078/100, Runtime 26.579324, Loss 0.163246, forward nfe 37480, backward nfe 745512, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 079/100, Runtime 64.140939, Loss 0.223130, forward nfe 37976, backward nfe 752582, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 080/100, Runtime 160.633082, Loss 0.197418, forward nfe 38478, backward nfe 771126, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 081/100, Runtime 125.524475, Loss 0.135226, forward nfe 38980, backward nfe 785439, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 082/100, Runtime 26.905662, Loss 0.134823, forward nfe 39482, backward nfe 788035, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 083/100, Runtime 121.878095, Loss 0.168331, forward nfe 39978, backward nfe 801843, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 084/100, Runtime 39.809243, Loss 0.133566, forward nfe 40486, backward nfe 806029, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 085/100, Runtime 28.721617, Loss 0.109408, forward nfe 40994, backward nfe 808850, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 086/100, Runtime 145.327116, Loss 0.202564, forward nfe 41502, backward nfe 825765, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 087/100, Runtime 59.371448, Loss 0.112753, forward nfe 42010, backward nfe 832196, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 088/100, Runtime 33.917563, Loss 0.162825, forward nfe 42512, backward nfe 835707, Train: 0.9833, Val: 0.8069, Test: 0.8007, Best time: 40.0000
Epoch: 089/100, Runtime 78.332273, Loss 0.132132, forward nfe 43014, backward nfe 844509, Train: 1.0000, Val: 0.8118, Test: 0.8082, Best time: 42.5458
Epoch: 090/100, Runtime 78.200092, Loss 0.133556, forward nfe 43516, backward nfe 853287, Train: 1.0000, Val: 0.8118, Test: 0.8082, Best time: 40.0000
Epoch: 091/100, Runtime 71.170802, Loss 0.132893, forward nfe 44018, backward nfe 861289, Train: 1.0000, Val: 0.8118, Test: 0.8082, Best time: 40.0000
Epoch: 092/100, Runtime 38.825665, Loss 0.121515, forward nfe 44520, backward nfe 865348, Train: 1.0000, Val: 0.8118, Test: 0.8082, Best time: 40.0000
Epoch: 093/100, Runtime 27.937265, Loss 0.095279, forward nfe 45022, backward nfe 868032, Train: 1.0000, Val: 0.8118, Test: 0.8082, Best time: 40.0000
Epoch: 094/100, Runtime 43.189947, Loss 0.098711, forward nfe 45524, backward nfe 872586, Train: 1.0000, Val: 0.8118, Test: 0.8082, Best time: 40.0000
Epoch: 095/100, Runtime 27.690902, Loss 0.109404, forward nfe 46026, backward nfe 875249, Train: 1.0000, Val: 0.8118, Test: 0.8082, Best time: 40.0000
Epoch: 096/100, Runtime 33.360656, Loss 0.110224, forward nfe 46528, backward nfe 878624, Train: 1.0000, Val: 0.8118, Test: 0.8082, Best time: 40.0000
Epoch: 097/100, Runtime 79.721576, Loss 0.135586, forward nfe 47036, backward nfe 887569, Train: 1.0000, Val: 0.8118, Test: 0.8082, Best time: 40.0000
Epoch: 098/100, Runtime 32.348250, Loss 0.112359, forward nfe 47544, backward nfe 890863, Train: 1.0000, Val: 0.8118, Test: 0.8082, Best time: 40.0000
Epoch: 099/100, Runtime 100.341356, Loss 0.147716, forward nfe 48052, backward nfe 902378, Train: 1.0000, Val: 0.8118, Test: 0.8082, Best time: 40.0000
best val accuracy 0.811806 with test accuracy 0.808201 at epoch 89 and best time 40.000000