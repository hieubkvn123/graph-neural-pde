/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
Epoch: 001/100, Runtime 1.348761, Loss 1.100258, forward nfe 44, backward nfe 89, Train: 0.7833, Val: 0.6389, Test: 0.6451, Best time: 0.2363
Epoch: 002/100, Runtime 0.901953, Loss 1.091601, forward nfe 234, backward nfe 131, Train: 0.7833, Val: 0.6389, Test: 0.6451, Best time: 15.0000
Epoch: 003/100, Runtime 1.197680, Loss 1.078868, forward nfe 412, backward nfe 209, Train: 0.7833, Val: 0.6389, Test: 0.6451, Best time: 15.0000
Epoch: 004/100, Runtime 1.185788, Loss 1.059590, forward nfe 584, backward nfe 286, Train: 0.8333, Val: 0.6403, Test: 0.6336, Best time: 0.2326
Epoch: 005/100, Runtime 1.059480, Loss 1.038311, forward nfe 768, backward nfe 346, Train: 0.8833, Val: 0.6937, Test: 0.6961, Best time: 0.2266
Epoch: 006/100, Runtime 0.907316, Loss 1.009072, forward nfe 958, backward nfe 388, Train: 0.9333, Val: 0.7403, Test: 0.7467, Best time: 2.4361
Epoch: 007/100, Runtime 0.949922, Loss 0.970746, forward nfe 1142, backward nfe 439, Train: 0.9333, Val: 0.7660, Test: 0.7662, Best time: 5.7377
Epoch: 008/100, Runtime 0.958478, Loss 0.929979, forward nfe 1320, backward nfe 490, Train: 0.9333, Val: 0.7701, Test: 0.7722, Best time: 5.7124
Epoch: 009/100, Runtime 0.932893, Loss 0.872967, forward nfe 1498, backward nfe 539, Train: 0.9333, Val: 0.7729, Test: 0.7722, Best time: 9.8262
Epoch: 010/100, Runtime 0.929938, Loss 0.815109, forward nfe 1676, backward nfe 586, Train: 0.9333, Val: 0.7729, Test: 0.7722, Best time: 15.0000
Epoch: 011/100, Runtime 0.840310, Loss 0.748541, forward nfe 1854, backward nfe 627, Train: 0.9333, Val: 0.7729, Test: 0.7722, Best time: 15.0000
Epoch: 012/100, Runtime 0.744128, Loss 0.694931, forward nfe 2020, backward nfe 659, Train: 0.9167, Val: 0.7757, Test: 0.7782, Best time: 32.0444
Epoch: 013/100, Runtime 0.716702, Loss 0.627771, forward nfe 2180, backward nfe 687, Train: 0.9333, Val: 0.7812, Test: 0.7859, Best time: 5.7453
Epoch: 014/100, Runtime 0.707826, Loss 0.558274, forward nfe 2340, backward nfe 715, Train: 0.9333, Val: 0.7826, Test: 0.7870, Best time: 5.7905
Epoch: 015/100, Runtime 0.736555, Loss 0.483662, forward nfe 2500, backward nfe 748, Train: 0.9333, Val: 0.7826, Test: 0.7870, Best time: 15.0000
Epoch: 016/100, Runtime 0.745960, Loss 0.424685, forward nfe 2654, backward nfe 781, Train: 0.9333, Val: 0.7826, Test: 0.7870, Best time: 15.0000
Epoch: 017/100, Runtime 0.694535, Loss 0.376310, forward nfe 2802, backward nfe 811, Train: 0.9333, Val: 0.7826, Test: 0.7870, Best time: 15.0000
Epoch: 018/100, Runtime 0.659026, Loss 0.328144, forward nfe 2950, backward nfe 839, Train: 0.9667, Val: 0.7868, Test: 0.7923, Best time: 10.7041
Epoch: 019/100, Runtime 0.664335, Loss 0.274593, forward nfe 3092, backward nfe 867, Train: 0.9667, Val: 0.7937, Test: 0.7993, Best time: 6.2453
Epoch: 020/100, Runtime 0.613494, Loss 0.260560, forward nfe 3234, backward nfe 890, Train: 1.0000, Val: 0.8000, Test: 0.8033, Best time: 11.2213
Epoch: 021/100, Runtime 0.627955, Loss 0.224916, forward nfe 3376, backward nfe 914, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 11.5249
Epoch: 022/100, Runtime 0.568649, Loss 0.180072, forward nfe 3518, backward nfe 932, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 023/100, Runtime 0.588545, Loss 0.201489, forward nfe 3660, backward nfe 952, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 024/100, Runtime 0.576204, Loss 0.176414, forward nfe 3802, backward nfe 971, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 025/100, Runtime 0.563053, Loss 0.127841, forward nfe 3944, backward nfe 991, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 026/100, Runtime 0.536247, Loss 0.164174, forward nfe 4074, backward nfe 1009, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 027/100, Runtime 0.540824, Loss 0.153450, forward nfe 4204, backward nfe 1028, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 028/100, Runtime 0.502456, Loss 0.131253, forward nfe 4334, backward nfe 1043, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 029/100, Runtime 0.482002, Loss 0.164340, forward nfe 4464, backward nfe 1057, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 030/100, Runtime 0.486333, Loss 0.175325, forward nfe 4588, backward nfe 1072, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 031/100, Runtime 0.502093, Loss 0.147351, forward nfe 4712, backward nfe 1089, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 032/100, Runtime 0.460368, Loss 0.116673, forward nfe 4830, backward nfe 1104, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 033/100, Runtime 0.480782, Loss 0.122094, forward nfe 4948, backward nfe 1121, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 034/100, Runtime 0.432444, Loss 0.175440, forward nfe 5060, backward nfe 1135, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 035/100, Runtime 0.436272, Loss 0.135242, forward nfe 5166, backward nfe 1149, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 036/100, Runtime 0.422470, Loss 0.098756, forward nfe 5272, backward nfe 1163, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 037/100, Runtime 0.454863, Loss 0.144522, forward nfe 5378, backward nfe 1179, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 038/100, Runtime 0.435723, Loss 0.112800, forward nfe 5484, backward nfe 1195, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 039/100, Runtime 0.429523, Loss 0.100713, forward nfe 5584, backward nfe 1212, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 040/100, Runtime 0.424277, Loss 0.103247, forward nfe 5684, backward nfe 1226, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 041/100, Runtime 0.456393, Loss 0.104779, forward nfe 5790, backward nfe 1244, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 042/100, Runtime 0.428417, Loss 0.110960, forward nfe 5890, backward nfe 1258, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 043/100, Runtime 0.402618, Loss 0.098893, forward nfe 5996, backward nfe 1271, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 044/100, Runtime 0.405569, Loss 0.072330, forward nfe 6096, backward nfe 1284, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 045/100, Runtime 0.392714, Loss 0.122817, forward nfe 6196, backward nfe 1296, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 046/100, Runtime 0.389173, Loss 0.098729, forward nfe 6296, backward nfe 1308, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 047/100, Runtime 0.397525, Loss 0.115007, forward nfe 6396, backward nfe 1320, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 048/100, Runtime 0.404614, Loss 0.114075, forward nfe 6496, backward nfe 1333, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 049/100, Runtime 0.384007, Loss 0.070029, forward nfe 6590, backward nfe 1344, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 050/100, Runtime 0.388324, Loss 0.096146, forward nfe 6690, backward nfe 1358, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 051/100, Runtime 0.358144, Loss 0.089268, forward nfe 6784, backward nfe 1368, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 052/100, Runtime 0.364426, Loss 0.057509, forward nfe 6878, backward nfe 1379, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 053/100, Runtime 0.364825, Loss 0.099989, forward nfe 6972, backward nfe 1389, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 054/100, Runtime 0.385299, Loss 0.078712, forward nfe 7066, backward nfe 1402, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 055/100, Runtime 0.379136, Loss 0.092795, forward nfe 7160, backward nfe 1414, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 056/100, Runtime 0.347967, Loss 0.104239, forward nfe 7254, backward nfe 1425, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 057/100, Runtime 0.338858, Loss 0.063987, forward nfe 7342, backward nfe 1435, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 058/100, Runtime 0.359267, Loss 0.073296, forward nfe 7430, backward nfe 1447, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 059/100, Runtime 0.366304, Loss 0.068028, forward nfe 7518, backward nfe 1459, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 060/100, Runtime 0.358066, Loss 0.069598, forward nfe 7606, backward nfe 1471, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 061/100, Runtime 0.354616, Loss 0.062347, forward nfe 7694, backward nfe 1483, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 062/100, Runtime 0.342206, Loss 0.043606, forward nfe 7782, backward nfe 1493, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 063/100, Runtime 0.349019, Loss 0.061921, forward nfe 7870, backward nfe 1504, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 064/100, Runtime 0.356630, Loss 0.085235, forward nfe 7958, backward nfe 1515, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 065/100, Runtime 0.380661, Loss 0.101596, forward nfe 8046, backward nfe 1529, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 066/100, Runtime 0.347268, Loss 0.046980, forward nfe 8134, backward nfe 1539, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 067/100, Runtime 0.362273, Loss 0.060355, forward nfe 8222, backward nfe 1551, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 068/100, Runtime 0.353297, Loss 0.075348, forward nfe 8310, backward nfe 1563, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 069/100, Runtime 0.354446, Loss 0.086192, forward nfe 8398, backward nfe 1575, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 070/100, Runtime 0.357345, Loss 0.045591, forward nfe 8486, backward nfe 1586, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 071/100, Runtime 0.359990, Loss 0.060808, forward nfe 8574, backward nfe 1598, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 072/100, Runtime 0.340267, Loss 0.053815, forward nfe 8662, backward nfe 1608, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 073/100, Runtime 0.349540, Loss 0.097482, forward nfe 8750, backward nfe 1619, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 074/100, Runtime 0.348356, Loss 0.079682, forward nfe 8838, backward nfe 1630, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 075/100, Runtime 0.353545, Loss 0.055853, forward nfe 8926, backward nfe 1641, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 076/100, Runtime 0.347378, Loss 0.105059, forward nfe 9014, backward nfe 1653, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 077/100, Runtime 0.321596, Loss 0.065217, forward nfe 9096, backward nfe 1663, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 078/100, Runtime 0.334332, Loss 0.044357, forward nfe 9178, backward nfe 1674, Train: 1.0000, Val: 0.8063, Test: 0.8068, Best time: 15.0000
Epoch: 079/100, Runtime 0.334977, Loss 0.048399, forward nfe 9260, backward nfe 1685, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 45.0286
Epoch: 080/100, Runtime 0.328002, Loss 0.062875, forward nfe 9342, backward nfe 1695, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 081/100, Runtime 0.338341, Loss 0.057090, forward nfe 9424, backward nfe 1706, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 082/100, Runtime 0.333304, Loss 0.061015, forward nfe 9506, backward nfe 1716, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 083/100, Runtime 0.336043, Loss 0.053532, forward nfe 9588, backward nfe 1727, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 084/100, Runtime 0.323736, Loss 0.047780, forward nfe 9670, backward nfe 1737, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 085/100, Runtime 0.328818, Loss 0.083368, forward nfe 9752, backward nfe 1747, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 086/100, Runtime 0.312450, Loss 0.073655, forward nfe 9834, backward nfe 1757, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 087/100, Runtime 0.324419, Loss 0.060861, forward nfe 9910, backward nfe 1769, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 088/100, Runtime 0.326382, Loss 0.055554, forward nfe 9986, backward nfe 1780, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 089/100, Runtime 0.317214, Loss 0.107815, forward nfe 10062, backward nfe 1790, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 090/100, Runtime 0.332557, Loss 0.098285, forward nfe 10138, backward nfe 1802, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 091/100, Runtime 0.298179, Loss 0.031581, forward nfe 10214, backward nfe 1811, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 092/100, Runtime 0.290367, Loss 0.041510, forward nfe 10284, backward nfe 1821, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 093/100, Runtime 0.294353, Loss 0.078489, forward nfe 10354, backward nfe 1831, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 094/100, Runtime 0.301821, Loss 0.062713, forward nfe 10424, backward nfe 1841, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 095/100, Runtime 0.290080, Loss 0.042376, forward nfe 10494, backward nfe 1851, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 096/100, Runtime 0.289241, Loss 0.062098, forward nfe 10564, backward nfe 1861, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 097/100, Runtime 0.288338, Loss 0.041004, forward nfe 10634, backward nfe 1871, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 098/100, Runtime 0.293896, Loss 0.052107, forward nfe 10704, backward nfe 1881, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
Epoch: 099/100, Runtime 0.290625, Loss 0.117878, forward nfe 10774, backward nfe 1890, Train: 1.0000, Val: 0.8069, Test: 0.8060, Best time: 15.0000
best val accuracy 0.806944 with test accuracy 0.805950 at epoch 79 and best time 15.000000