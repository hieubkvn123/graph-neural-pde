/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 13.250023, Loss 1.099783, forward nfe 68, backward nfe 1246, Train: 0.5167, Val: 0.4847, Test: 0.4917, Best time: 0.2390
Epoch: 002/100, Runtime 16.026636, Loss 1.095561, forward nfe 432, backward nfe 2791, Train: 0.6333, Val: 0.5083, Test: 0.5304, Best time: 52.8023
Epoch: 003/100, Runtime 16.261606, Loss 1.088118, forward nfe 796, backward nfe 4326, Train: 0.6333, Val: 0.5083, Test: 0.5304, Best time: 30.0000
Epoch: 004/100, Runtime 13.368179, Loss 1.073941, forward nfe 1160, backward nfe 5581, Train: 0.6833, Val: 0.5681, Test: 0.5706, Best time: 0.2344
Epoch: 005/100, Runtime 14.908839, Loss 1.049933, forward nfe 1524, backward nfe 7009, Train: 0.7500, Val: 0.6493, Test: 0.6464, Best time: 0.2278
Epoch: 006/100, Runtime 12.000112, Loss 1.024651, forward nfe 1894, backward nfe 8119, Train: 0.8167, Val: 0.7146, Test: 0.7083, Best time: 2.4486
Epoch: 007/100, Runtime 11.159541, Loss 0.986358, forward nfe 2258, backward nfe 9148, Train: 0.7833, Val: 0.7451, Test: 0.7372, Best time: 29.6300
Epoch: 008/100, Runtime 11.156579, Loss 0.945132, forward nfe 2616, backward nfe 10201, Train: 0.7667, Val: 0.7493, Test: 0.7423, Best time: 33.6884
Epoch: 009/100, Runtime 9.254912, Loss 0.886348, forward nfe 2974, backward nfe 11054, Train: 0.7667, Val: 0.7493, Test: 0.7423, Best time: 30.0000
Epoch: 010/100, Runtime 9.288917, Loss 0.834808, forward nfe 3314, backward nfe 11917, Train: 0.7667, Val: 0.7493, Test: 0.7423, Best time: 30.0000
Epoch: 011/100, Runtime 8.541959, Loss 0.778663, forward nfe 3654, backward nfe 12692, Train: 0.7667, Val: 0.7493, Test: 0.7423, Best time: 30.0000
Epoch: 012/100, Runtime 10.305931, Loss 0.706887, forward nfe 3994, backward nfe 13650, Train: 0.7667, Val: 0.7507, Test: 0.7468, Best time: 116.4693
Epoch: 013/100, Runtime 9.826997, Loss 0.656124, forward nfe 4322, backward nfe 14556, Train: 0.8333, Val: 0.7639, Test: 0.7597, Best time: 48.5898
Epoch: 014/100, Runtime 9.231603, Loss 0.596569, forward nfe 4650, backward nfe 15408, Train: 0.8667, Val: 0.7681, Test: 0.7666, Best time: 5.8963
Epoch: 015/100, Runtime 8.448095, Loss 0.528705, forward nfe 4978, backward nfe 16174, Train: 0.8500, Val: 0.7708, Test: 0.7699, Best time: 49.7024
Epoch: 016/100, Runtime 7.509338, Loss 0.487127, forward nfe 5300, backward nfe 16843, Train: 0.8500, Val: 0.7729, Test: 0.7726, Best time: 77.0269
Epoch: 017/100, Runtime 5.981013, Loss 0.438306, forward nfe 5622, backward nfe 17363, Train: 0.8500, Val: 0.7729, Test: 0.7726, Best time: 30.0000
Epoch: 018/100, Runtime 6.921771, Loss 0.426806, forward nfe 5944, backward nfe 17975, Train: 0.8500, Val: 0.7729, Test: 0.7726, Best time: 30.0000
Epoch: 019/100, Runtime 7.364949, Loss 0.379983, forward nfe 6266, backward nfe 18630, Train: 0.8500, Val: 0.7729, Test: 0.7726, Best time: 30.0000
Epoch: 020/100, Runtime 7.192680, Loss 0.352213, forward nfe 6582, backward nfe 19272, Train: 0.8833, Val: 0.7743, Test: 0.7802, Best time: 106.4863
Epoch: 021/100, Runtime 6.581296, Loss 0.324947, forward nfe 6892, backward nfe 19859, Train: 0.8833, Val: 0.7743, Test: 0.7802, Best time: 30.0000
Epoch: 022/100, Runtime 5.371233, Loss 0.316697, forward nfe 7196, backward nfe 20328, Train: 0.8833, Val: 0.7743, Test: 0.7802, Best time: 30.0000
Epoch: 023/100, Runtime 5.850211, Loss 0.306954, forward nfe 7500, backward nfe 20841, Train: 0.8833, Val: 0.7743, Test: 0.7802, Best time: 30.0000
Epoch: 024/100, Runtime 6.034509, Loss 0.276892, forward nfe 7792, backward nfe 21370, Train: 0.9000, Val: 0.7826, Test: 0.7909, Best time: 113.6225
Epoch: 025/100, Runtime 5.985220, Loss 0.292214, forward nfe 8078, backward nfe 21902, Train: 0.9000, Val: 0.7826, Test: 0.7909, Best time: 30.0000
Epoch: 026/100, Runtime 5.837667, Loss 0.237430, forward nfe 8358, backward nfe 22423, Train: 0.9000, Val: 0.7826, Test: 0.7909, Best time: 30.0000
Epoch: 027/100, Runtime 4.546454, Loss 0.290909, forward nfe 8632, backward nfe 22812, Train: 0.9000, Val: 0.7826, Test: 0.7909, Best time: 30.0000
Epoch: 028/100, Runtime 4.152431, Loss 0.236074, forward nfe 8894, backward nfe 23162, Train: 0.9667, Val: 0.7875, Test: 0.7883, Best time: 88.3378
Epoch: 029/100, Runtime 4.385933, Loss 0.232920, forward nfe 9156, backward nfe 23534, Train: 0.9667, Val: 0.7875, Test: 0.7883, Best time: 30.0000
Epoch: 030/100, Runtime 4.178670, Loss 0.189848, forward nfe 9418, backward nfe 23889, Train: 0.9667, Val: 0.7875, Test: 0.7883, Best time: 30.0000
Epoch: 031/100, Runtime 4.577514, Loss 0.195953, forward nfe 9674, backward nfe 24281, Train: 0.9667, Val: 0.7875, Test: 0.7883, Best time: 30.0000
Epoch: 032/100, Runtime 4.187678, Loss 0.221568, forward nfe 9936, backward nfe 24639, Train: 0.9667, Val: 0.7875, Test: 0.7883, Best time: 30.0000
Epoch: 033/100, Runtime 3.890834, Loss 0.171288, forward nfe 10186, backward nfe 24968, Train: 0.9667, Val: 0.7875, Test: 0.7883, Best time: 30.0000
Epoch: 034/100, Runtime 2.703851, Loss 0.168333, forward nfe 10436, backward nfe 25176, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 155.2480
Epoch: 035/100, Runtime 2.319971, Loss 0.190103, forward nfe 10686, backward nfe 25349, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 036/100, Runtime 3.420281, Loss 0.135711, forward nfe 10930, backward nfe 25629, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 037/100, Runtime 3.602340, Loss 0.134044, forward nfe 11180, backward nfe 25932, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 038/100, Runtime 3.771928, Loss 0.124544, forward nfe 11412, backward nfe 26254, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 039/100, Runtime 3.331083, Loss 0.123399, forward nfe 11644, backward nfe 26531, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 040/100, Runtime 2.705409, Loss 0.109314, forward nfe 11876, backward nfe 26746, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 041/100, Runtime 2.542056, Loss 0.104361, forward nfe 12114, backward nfe 26947, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 042/100, Runtime 2.923637, Loss 0.120100, forward nfe 12340, backward nfe 27185, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 043/100, Runtime 2.517214, Loss 0.112281, forward nfe 12572, backward nfe 27381, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 044/100, Runtime 2.795061, Loss 0.123055, forward nfe 12798, backward nfe 27608, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 045/100, Runtime 2.989335, Loss 0.153925, forward nfe 13018, backward nfe 27854, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 046/100, Runtime 2.569709, Loss 0.178089, forward nfe 13244, backward nfe 28056, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 047/100, Runtime 2.147556, Loss 0.183541, forward nfe 13470, backward nfe 28220, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 048/100, Runtime 1.819601, Loss 0.141389, forward nfe 13684, backward nfe 28350, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 049/100, Runtime 2.411860, Loss 0.151353, forward nfe 13904, backward nfe 28539, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 050/100, Runtime 1.950697, Loss 0.113104, forward nfe 14124, backward nfe 28683, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 051/100, Runtime 1.291562, Loss 0.099273, forward nfe 14344, backward nfe 28761, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 052/100, Runtime 1.805061, Loss 0.101415, forward nfe 14546, backward nfe 28892, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 053/100, Runtime 1.915004, Loss 0.121149, forward nfe 14754, backward nfe 29035, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 054/100, Runtime 1.785135, Loss 0.085473, forward nfe 14956, backward nfe 29166, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 055/100, Runtime 2.025647, Loss 0.102574, forward nfe 15158, backward nfe 29323, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 056/100, Runtime 1.746065, Loss 0.097473, forward nfe 15354, backward nfe 29451, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 057/100, Runtime 1.782341, Loss 0.107521, forward nfe 15550, backward nfe 29586, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 058/100, Runtime 1.537194, Loss 0.093970, forward nfe 15734, backward nfe 29696, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 059/100, Runtime 1.390974, Loss 0.088296, forward nfe 15918, backward nfe 29790, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 060/100, Runtime 1.244589, Loss 0.070911, forward nfe 16108, backward nfe 29872, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 061/100, Runtime 0.808314, Loss 0.111319, forward nfe 16286, backward nfe 29907, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 062/100, Runtime 1.187400, Loss 0.107663, forward nfe 16464, backward nfe 29983, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 063/100, Runtime 1.641268, Loss 0.096032, forward nfe 16636, backward nfe 30105, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 064/100, Runtime 1.522220, Loss 0.132545, forward nfe 16814, backward nfe 30214, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 065/100, Runtime 1.481936, Loss 0.116284, forward nfe 16992, backward nfe 30320, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 066/100, Runtime 1.262156, Loss 0.095480, forward nfe 17170, backward nfe 30404, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 067/100, Runtime 1.177603, Loss 0.102784, forward nfe 17342, backward nfe 30482, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 068/100, Runtime 1.140788, Loss 0.087803, forward nfe 17508, backward nfe 30556, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 069/100, Runtime 1.239825, Loss 0.073637, forward nfe 17674, backward nfe 30640, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 070/100, Runtime 1.221477, Loss 0.082855, forward nfe 17840, backward nfe 30723, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 071/100, Runtime 1.184878, Loss 0.091601, forward nfe 18006, backward nfe 30802, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 072/100, Runtime 1.118890, Loss 0.090435, forward nfe 18172, backward nfe 30873, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 073/100, Runtime 1.186510, Loss 0.083339, forward nfe 18338, backward nfe 30952, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 074/100, Runtime 1.215151, Loss 0.095113, forward nfe 18504, backward nfe 31034, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 075/100, Runtime 1.213378, Loss 0.121118, forward nfe 18670, backward nfe 31114, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 076/100, Runtime 1.178434, Loss 0.105219, forward nfe 18836, backward nfe 31192, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 077/100, Runtime 1.240154, Loss 0.105819, forward nfe 19002, backward nfe 31276, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 078/100, Runtime 1.216046, Loss 0.086046, forward nfe 19168, backward nfe 31357, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 079/100, Runtime 1.101545, Loss 0.057887, forward nfe 19334, backward nfe 31427, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 080/100, Runtime 1.235061, Loss 0.064480, forward nfe 19500, backward nfe 31511, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 081/100, Runtime 1.229831, Loss 0.079330, forward nfe 19666, backward nfe 31594, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 082/100, Runtime 1.233027, Loss 0.085153, forward nfe 19832, backward nfe 31677, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 083/100, Runtime 1.157809, Loss 0.062053, forward nfe 19998, backward nfe 31753, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 084/100, Runtime 1.154334, Loss 0.087998, forward nfe 20164, backward nfe 31832, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 085/100, Runtime 1.143394, Loss 0.054146, forward nfe 20330, backward nfe 31909, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 086/100, Runtime 1.040908, Loss 0.052092, forward nfe 20496, backward nfe 31978, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 087/100, Runtime 1.131044, Loss 0.071139, forward nfe 20656, backward nfe 32055, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 088/100, Runtime 1.140082, Loss 0.067384, forward nfe 20816, backward nfe 32134, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 089/100, Runtime 1.218256, Loss 0.088949, forward nfe 20976, backward nfe 32218, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 090/100, Runtime 1.082183, Loss 0.052129, forward nfe 21136, backward nfe 32288, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 091/100, Runtime 1.034055, Loss 0.072126, forward nfe 21296, backward nfe 32352, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 092/100, Runtime 1.025746, Loss 0.040513, forward nfe 21456, backward nfe 32416, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 093/100, Runtime 1.107076, Loss 0.062268, forward nfe 21616, backward nfe 32488, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 094/100, Runtime 1.080499, Loss 0.044298, forward nfe 21776, backward nfe 32557, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 095/100, Runtime 1.136259, Loss 0.129224, forward nfe 21936, backward nfe 32632, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 096/100, Runtime 1.079309, Loss 0.050062, forward nfe 22096, backward nfe 32702, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 097/100, Runtime 1.141306, Loss 0.204909, forward nfe 22256, backward nfe 32778, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 098/100, Runtime 1.045143, Loss 0.070105, forward nfe 22416, backward nfe 32845, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
Epoch: 099/100, Runtime 1.144815, Loss 0.133028, forward nfe 22576, backward nfe 32920, Train: 0.8667, Val: 0.8021, Test: 0.7984, Best time: 30.0000
best val accuracy 0.802083 with test accuracy 0.798375 at epoch 34 and best time 30.000000