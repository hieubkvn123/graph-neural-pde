/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.522100, Loss 1.791843, forward nfe 134, backward nfe 0, Train: 0.4667, Val: 0.3797, Test: 0.3839, Best time: 0.3416
Epoch: 002/100, Runtime 0.453454, Loss 1.780064, forward nfe 516, backward nfe 0, Train: 0.6000, Val: 0.6326, Test: 0.6452, Best time: 1.4425
Epoch: 003/100, Runtime 0.461611, Loss 1.764542, forward nfe 910, backward nfe 0, Train: 0.5917, Val: 0.6464, Test: 0.6387, Best time: 4.1614
Epoch: 004/100, Runtime 0.471314, Loss 1.747995, forward nfe 1298, backward nfe 0, Train: 0.5917, Val: 0.6464, Test: 0.6387, Best time: 35.0000
Epoch: 005/100, Runtime 0.454542, Loss 1.716765, forward nfe 1686, backward nfe 0, Train: 0.5917, Val: 0.6464, Test: 0.6387, Best time: 35.0000
Epoch: 006/100, Runtime 0.454814, Loss 1.702798, forward nfe 2074, backward nfe 0, Train: 0.5917, Val: 0.6464, Test: 0.6387, Best time: 35.0000
Epoch: 007/100, Runtime 0.441266, Loss 1.700439, forward nfe 2450, backward nfe 0, Train: 0.5917, Val: 0.6464, Test: 0.6387, Best time: 35.0000
Epoch: 008/100, Runtime 0.440645, Loss 1.673611, forward nfe 2826, backward nfe 0, Train: 0.5750, Val: 0.6710, Test: 0.6677, Best time: 14.7594
Epoch: 009/100, Runtime 0.440620, Loss 1.657005, forward nfe 3202, backward nfe 0, Train: 0.5833, Val: 0.6746, Test: 0.6726, Best time: 9.5558
Epoch: 010/100, Runtime 0.421741, Loss 1.683103, forward nfe 3560, backward nfe 0, Train: 0.5583, Val: 0.6812, Test: 0.6597, Best time: 21.7963
Epoch: 011/100, Runtime 0.432890, Loss 1.646508, forward nfe 3918, backward nfe 0, Train: 0.5833, Val: 0.7167, Test: 0.7016, Best time: 13.9289
Epoch: 012/100, Runtime 0.419770, Loss 1.610939, forward nfe 4270, backward nfe 0, Train: 0.6333, Val: 0.7326, Test: 0.7226, Best time: 16.8810
Epoch: 013/100, Runtime 0.418852, Loss 1.592210, forward nfe 4622, backward nfe 0, Train: 0.6333, Val: 0.7326, Test: 0.7226, Best time: 35.0000
Epoch: 014/100, Runtime 0.394253, Loss 1.559271, forward nfe 4968, backward nfe 0, Train: 0.6333, Val: 0.7326, Test: 0.7226, Best time: 35.0000
Epoch: 015/100, Runtime 0.400175, Loss 1.531978, forward nfe 5302, backward nfe 0, Train: 0.6333, Val: 0.7326, Test: 0.7226, Best time: 35.0000
Epoch: 016/100, Runtime 0.402322, Loss 1.489740, forward nfe 5636, backward nfe 0, Train: 0.6333, Val: 0.7326, Test: 0.7226, Best time: 35.0000
Epoch: 017/100, Runtime 0.403558, Loss 1.560387, forward nfe 5970, backward nfe 0, Train: 0.6667, Val: 0.7449, Test: 0.7242, Best time: 9.7824
Epoch: 018/100, Runtime 0.395071, Loss 1.428527, forward nfe 6304, backward nfe 0, Train: 0.6500, Val: 0.7522, Test: 0.7242, Best time: 16.3273
Epoch: 019/100, Runtime 0.381712, Loss 1.443901, forward nfe 6626, backward nfe 0, Train: 0.6500, Val: 0.7522, Test: 0.7242, Best time: 35.0000
Epoch: 020/100, Runtime 0.375317, Loss 1.418670, forward nfe 6954, backward nfe 0, Train: 0.6500, Val: 0.7522, Test: 0.7242, Best time: 35.0000
Epoch: 021/100, Runtime 0.377945, Loss 1.393708, forward nfe 7270, backward nfe 0, Train: 0.6500, Val: 0.7522, Test: 0.7242, Best time: 35.0000
Epoch: 022/100, Runtime 0.385571, Loss 1.389648, forward nfe 7586, backward nfe 0, Train: 0.6500, Val: 0.7522, Test: 0.7242, Best time: 35.0000
Epoch: 023/100, Runtime 0.379157, Loss 1.375432, forward nfe 7908, backward nfe 0, Train: 0.6500, Val: 0.7522, Test: 0.7242, Best time: 35.0000
Epoch: 024/100, Runtime 0.369001, Loss 1.360028, forward nfe 8218, backward nfe 0, Train: 0.7167, Val: 0.7536, Test: 0.7435, Best time: 16.2046
Epoch: 025/100, Runtime 0.365117, Loss 1.367401, forward nfe 8522, backward nfe 0, Train: 0.7083, Val: 0.7594, Test: 0.7371, Best time: 28.6578
Epoch: 026/100, Runtime 0.368441, Loss 1.341519, forward nfe 8826, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 50.5426
Epoch: 027/100, Runtime 0.349532, Loss 1.327748, forward nfe 9124, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 028/100, Runtime 0.373989, Loss 1.385139, forward nfe 9422, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 029/100, Runtime 0.363214, Loss 1.271547, forward nfe 9720, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 030/100, Runtime 0.332746, Loss 1.323204, forward nfe 10000, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 031/100, Runtime 0.347791, Loss 1.329410, forward nfe 10280, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 032/100, Runtime 0.334235, Loss 1.284392, forward nfe 10566, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 033/100, Runtime 0.332730, Loss 1.266041, forward nfe 10840, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 034/100, Runtime 0.322116, Loss 1.298740, forward nfe 11114, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 035/100, Runtime 0.322417, Loss 1.233692, forward nfe 11382, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 036/100, Runtime 0.306653, Loss 1.237451, forward nfe 11644, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 037/100, Runtime 0.322182, Loss 1.291126, forward nfe 11900, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 038/100, Runtime 0.328196, Loss 1.157702, forward nfe 12156, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 039/100, Runtime 0.306003, Loss 1.257917, forward nfe 12418, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 040/100, Runtime 0.312586, Loss 1.238160, forward nfe 12668, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 041/100, Runtime 0.292473, Loss 1.195736, forward nfe 12912, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 042/100, Runtime 0.317109, Loss 1.232554, forward nfe 13150, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 043/100, Runtime 0.307113, Loss 1.299966, forward nfe 13388, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 044/100, Runtime 0.292347, Loss 1.174139, forward nfe 13626, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 045/100, Runtime 0.288670, Loss 1.223227, forward nfe 13858, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 046/100, Runtime 0.275327, Loss 1.153739, forward nfe 14090, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 047/100, Runtime 0.284900, Loss 1.260215, forward nfe 14316, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 048/100, Runtime 0.295699, Loss 1.147601, forward nfe 14542, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 049/100, Runtime 0.274854, Loss 1.103981, forward nfe 14768, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 050/100, Runtime 0.276711, Loss 1.240652, forward nfe 14994, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 051/100, Runtime 0.274550, Loss 1.216325, forward nfe 15220, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 052/100, Runtime 0.278680, Loss 1.080293, forward nfe 15446, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 053/100, Runtime 0.272284, Loss 1.177647, forward nfe 15672, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 054/100, Runtime 0.282054, Loss 1.173019, forward nfe 15898, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 055/100, Runtime 0.274189, Loss 1.293939, forward nfe 16124, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 056/100, Runtime 0.306891, Loss 1.192763, forward nfe 16356, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 057/100, Runtime 0.299944, Loss 1.207542, forward nfe 16588, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 058/100, Runtime 0.289976, Loss 1.256516, forward nfe 16820, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 059/100, Runtime 0.308373, Loss 1.197174, forward nfe 17052, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 060/100, Runtime 0.288022, Loss 1.263725, forward nfe 17284, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 061/100, Runtime 0.285544, Loss 1.305553, forward nfe 17510, backward nfe 0, Train: 0.6833, Val: 0.7681, Test: 0.7516, Best time: 35.0000
Epoch: 062/100, Runtime 0.300575, Loss 1.235026, forward nfe 17736, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 36.6628
Epoch: 063/100, Runtime 0.296069, Loss 1.187840, forward nfe 17962, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 064/100, Runtime 0.282497, Loss 1.286181, forward nfe 18188, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 065/100, Runtime 0.293778, Loss 1.214004, forward nfe 18414, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 066/100, Runtime 0.289071, Loss 1.185552, forward nfe 18640, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 067/100, Runtime 0.289695, Loss 1.141179, forward nfe 18866, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 068/100, Runtime 0.286068, Loss 1.186755, forward nfe 19092, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 069/100, Runtime 0.307074, Loss 1.248780, forward nfe 19324, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 070/100, Runtime 0.292130, Loss 1.234885, forward nfe 19556, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 071/100, Runtime 0.287477, Loss 1.246058, forward nfe 19788, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 072/100, Runtime 0.287979, Loss 1.253552, forward nfe 20014, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 073/100, Runtime 0.292144, Loss 1.167636, forward nfe 20240, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 074/100, Runtime 0.287115, Loss 1.172897, forward nfe 20466, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 075/100, Runtime 0.297610, Loss 1.176924, forward nfe 20692, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 076/100, Runtime 0.306010, Loss 1.103239, forward nfe 20918, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 077/100, Runtime 0.290120, Loss 1.156653, forward nfe 21150, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 078/100, Runtime 0.295230, Loss 1.090058, forward nfe 21382, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 079/100, Runtime 0.285940, Loss 1.203121, forward nfe 21614, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 080/100, Runtime 0.291446, Loss 1.215656, forward nfe 21846, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 081/100, Runtime 0.288551, Loss 1.122330, forward nfe 22072, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 082/100, Runtime 0.288811, Loss 1.143890, forward nfe 22298, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 083/100, Runtime 0.300434, Loss 1.222073, forward nfe 22530, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 084/100, Runtime 0.434439, Loss 1.143567, forward nfe 22762, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 085/100, Runtime 0.289968, Loss 1.162355, forward nfe 22994, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 086/100, Runtime 0.290752, Loss 1.041168, forward nfe 23226, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 087/100, Runtime 0.283444, Loss 1.064762, forward nfe 23458, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 088/100, Runtime 0.290528, Loss 1.105951, forward nfe 23690, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 089/100, Runtime 0.289243, Loss 1.172002, forward nfe 23922, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 090/100, Runtime 0.281316, Loss 1.115361, forward nfe 24148, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 091/100, Runtime 0.286914, Loss 1.114846, forward nfe 24374, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 092/100, Runtime 0.290183, Loss 1.095396, forward nfe 24600, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 093/100, Runtime 0.290839, Loss 1.193596, forward nfe 24826, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 094/100, Runtime 0.281395, Loss 1.116963, forward nfe 25052, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 095/100, Runtime 0.285623, Loss 1.093809, forward nfe 25278, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 096/100, Runtime 0.291536, Loss 1.216774, forward nfe 25504, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 097/100, Runtime 0.279710, Loss 1.068135, forward nfe 25730, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 098/100, Runtime 0.288523, Loss 1.283562, forward nfe 25956, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
Epoch: 099/100, Runtime 0.277577, Loss 1.102423, forward nfe 26182, backward nfe 0, Train: 0.7917, Val: 0.7688, Test: 0.7532, Best time: 35.0000
best val accuracy 0.768841 with test accuracy 0.753226 at epoch 62 and best time 35.000000