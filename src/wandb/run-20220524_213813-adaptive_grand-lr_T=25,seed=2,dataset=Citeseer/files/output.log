/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.456819, Loss 1.793759, forward nfe 122, backward nfe 0, Train: 0.3000, Val: 0.3036, Test: 0.3177, Best time: 0.0405
Epoch: 002/100, Runtime 0.379711, Loss 1.772238, forward nfe 444, backward nfe 0, Train: 0.4333, Val: 0.4254, Test: 0.4435, Best time: 2.0483
Epoch: 003/100, Runtime 0.396805, Loss 1.742218, forward nfe 766, backward nfe 0, Train: 0.4833, Val: 0.4964, Test: 0.4952, Best time: 5.7991
Epoch: 004/100, Runtime 0.412947, Loss 1.704987, forward nfe 1100, backward nfe 0, Train: 0.5667, Val: 0.5790, Test: 0.5629, Best time: 79.0906
Epoch: 005/100, Runtime 0.409621, Loss 1.668164, forward nfe 1434, backward nfe 0, Train: 0.6667, Val: 0.6775, Test: 0.6581, Best time: 25.0000
Epoch: 006/100, Runtime 0.390569, Loss 1.651795, forward nfe 1762, backward nfe 0, Train: 0.7000, Val: 0.7174, Test: 0.6919, Best time: 76.9545
Epoch: 007/100, Runtime 0.384932, Loss 1.593143, forward nfe 2084, backward nfe 0, Train: 0.7000, Val: 0.7225, Test: 0.6984, Best time: 78.8489
Epoch: 008/100, Runtime 0.386873, Loss 1.585580, forward nfe 2406, backward nfe 0, Train: 0.7000, Val: 0.7428, Test: 0.7177, Best time: 25.0000
Epoch: 009/100, Runtime 0.378567, Loss 1.562792, forward nfe 2722, backward nfe 0, Train: 0.7000, Val: 0.7529, Test: 0.7113, Best time: 36.6524
Epoch: 010/100, Runtime 0.388362, Loss 1.548384, forward nfe 3032, backward nfe 0, Train: 0.7083, Val: 0.7587, Test: 0.7226, Best time: 39.0862
Epoch: 011/100, Runtime 0.360582, Loss 1.471302, forward nfe 3336, backward nfe 0, Train: 0.7167, Val: 0.7645, Test: 0.7323, Best time: 29.2510
Epoch: 012/100, Runtime 0.373106, Loss 1.505468, forward nfe 3640, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 48.1632
Epoch: 013/100, Runtime 0.367045, Loss 1.503464, forward nfe 3938, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 014/100, Runtime 0.354351, Loss 1.419220, forward nfe 4230, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 015/100, Runtime 0.373560, Loss 1.403416, forward nfe 4528, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 016/100, Runtime 0.349277, Loss 1.364085, forward nfe 4820, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 017/100, Runtime 0.353901, Loss 1.341595, forward nfe 5106, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 018/100, Runtime 0.335494, Loss 1.345134, forward nfe 5398, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 019/100, Runtime 0.341725, Loss 1.287383, forward nfe 5678, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 020/100, Runtime 0.345491, Loss 1.303116, forward nfe 5958, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 021/100, Runtime 0.329516, Loss 1.201557, forward nfe 6238, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 022/100, Runtime 0.320864, Loss 1.111227, forward nfe 6506, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 023/100, Runtime 0.325472, Loss 1.139379, forward nfe 6774, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 024/100, Runtime 0.326982, Loss 1.120040, forward nfe 7042, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 025/100, Runtime 0.321665, Loss 1.129361, forward nfe 7310, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 026/100, Runtime 0.335461, Loss 1.049538, forward nfe 7572, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 027/100, Runtime 0.334611, Loss 1.098300, forward nfe 7834, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 028/100, Runtime 0.305990, Loss 1.040899, forward nfe 8084, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 029/100, Runtime 0.312401, Loss 1.119421, forward nfe 8328, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 030/100, Runtime 0.310933, Loss 1.163510, forward nfe 8572, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 031/100, Runtime 0.310155, Loss 1.093346, forward nfe 8816, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 032/100, Runtime 0.302558, Loss 1.007770, forward nfe 9060, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 033/100, Runtime 0.285556, Loss 1.033594, forward nfe 9298, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 034/100, Runtime 0.299958, Loss 1.092125, forward nfe 9530, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 035/100, Runtime 0.290183, Loss 1.001186, forward nfe 9762, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 036/100, Runtime 0.282511, Loss 1.021153, forward nfe 9994, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 037/100, Runtime 0.289861, Loss 0.970915, forward nfe 10226, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 038/100, Runtime 0.286196, Loss 1.039446, forward nfe 10446, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 039/100, Runtime 0.279401, Loss 1.085145, forward nfe 10666, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 040/100, Runtime 0.274399, Loss 1.026705, forward nfe 10886, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 041/100, Runtime 0.281959, Loss 1.035343, forward nfe 11106, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 042/100, Runtime 0.269284, Loss 1.020581, forward nfe 11320, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 043/100, Runtime 0.271927, Loss 1.082730, forward nfe 11534, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 044/100, Runtime 0.262130, Loss 0.963993, forward nfe 11742, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 045/100, Runtime 0.257216, Loss 1.087554, forward nfe 11950, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 046/100, Runtime 0.247683, Loss 0.950457, forward nfe 12152, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 047/100, Runtime 0.250476, Loss 0.976890, forward nfe 12354, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 048/100, Runtime 0.249068, Loss 1.020791, forward nfe 12550, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 049/100, Runtime 0.271689, Loss 0.904036, forward nfe 12746, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 050/100, Runtime 0.237210, Loss 0.899536, forward nfe 12936, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 051/100, Runtime 0.236581, Loss 1.023162, forward nfe 13126, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 052/100, Runtime 0.233615, Loss 0.966398, forward nfe 13316, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 053/100, Runtime 0.235938, Loss 0.918497, forward nfe 13506, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 054/100, Runtime 0.238680, Loss 1.053064, forward nfe 13696, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 055/100, Runtime 0.239698, Loss 1.019464, forward nfe 13886, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 056/100, Runtime 0.246630, Loss 0.978545, forward nfe 14082, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 057/100, Runtime 0.254914, Loss 1.026400, forward nfe 14278, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 058/100, Runtime 0.252415, Loss 0.975892, forward nfe 14474, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 059/100, Runtime 0.250033, Loss 1.111530, forward nfe 14670, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 060/100, Runtime 0.249360, Loss 0.977711, forward nfe 14866, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 061/100, Runtime 0.250317, Loss 0.964721, forward nfe 15062, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 062/100, Runtime 0.249948, Loss 0.919637, forward nfe 15264, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 063/100, Runtime 0.257409, Loss 0.932238, forward nfe 15466, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 064/100, Runtime 0.254513, Loss 0.976914, forward nfe 15668, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 065/100, Runtime 0.264572, Loss 1.045328, forward nfe 15870, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 066/100, Runtime 0.254135, Loss 1.017093, forward nfe 16072, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 067/100, Runtime 0.255103, Loss 1.013826, forward nfe 16274, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 068/100, Runtime 0.252858, Loss 0.991948, forward nfe 16476, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 069/100, Runtime 0.261322, Loss 0.934649, forward nfe 16678, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 070/100, Runtime 0.252321, Loss 0.969781, forward nfe 16880, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 071/100, Runtime 0.263400, Loss 0.979004, forward nfe 17082, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 072/100, Runtime 0.255263, Loss 0.984152, forward nfe 17284, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 073/100, Runtime 0.264000, Loss 1.058965, forward nfe 17486, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 074/100, Runtime 0.260359, Loss 0.965130, forward nfe 17688, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 075/100, Runtime 0.259981, Loss 0.968105, forward nfe 17890, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 076/100, Runtime 0.257787, Loss 0.960883, forward nfe 18092, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 077/100, Runtime 0.255606, Loss 0.972634, forward nfe 18294, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 078/100, Runtime 0.258945, Loss 0.964276, forward nfe 18496, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 079/100, Runtime 0.260679, Loss 0.865023, forward nfe 18698, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 080/100, Runtime 0.254316, Loss 0.918185, forward nfe 18900, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 081/100, Runtime 0.274155, Loss 0.917475, forward nfe 19102, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 082/100, Runtime 0.264698, Loss 0.964747, forward nfe 19304, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 083/100, Runtime 0.267020, Loss 1.029651, forward nfe 19506, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 084/100, Runtime 0.276266, Loss 0.988496, forward nfe 19708, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 085/100, Runtime 0.257413, Loss 1.079247, forward nfe 19916, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 086/100, Runtime 0.265457, Loss 0.995123, forward nfe 20124, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 087/100, Runtime 0.274653, Loss 0.964837, forward nfe 20338, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 088/100, Runtime 0.270874, Loss 0.908443, forward nfe 20546, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 089/100, Runtime 0.268855, Loss 0.960820, forward nfe 20754, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 090/100, Runtime 0.396674, Loss 0.974047, forward nfe 20962, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 091/100, Runtime 0.260859, Loss 0.958847, forward nfe 21164, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 092/100, Runtime 0.273715, Loss 0.955257, forward nfe 21366, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 093/100, Runtime 0.262802, Loss 0.949070, forward nfe 21568, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 094/100, Runtime 0.260726, Loss 0.911345, forward nfe 21770, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 095/100, Runtime 0.282911, Loss 1.132273, forward nfe 21972, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 096/100, Runtime 0.256081, Loss 0.935687, forward nfe 22174, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 097/100, Runtime 0.258639, Loss 0.960646, forward nfe 22376, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 098/100, Runtime 0.251482, Loss 0.908526, forward nfe 22578, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
Epoch: 099/100, Runtime 0.257338, Loss 0.942587, forward nfe 22780, backward nfe 0, Train: 0.7250, Val: 0.7703, Test: 0.7355, Best time: 25.0000
best val accuracy 0.770290 with test accuracy 0.735484 at epoch 12 and best time 25.000000