/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.318073, Loss 1.795718, forward nfe 86, backward nfe 0, Train: 0.3917, Val: 0.2732, Test: 0.2565, Best time: 0.0409
Epoch: 002/100, Runtime 0.271726, Loss 1.768933, forward nfe 294, backward nfe 0, Train: 0.6500, Val: 0.4768, Test: 0.4532, Best time: 0.3175
Epoch: 003/100, Runtime 0.270544, Loss 1.735649, forward nfe 508, backward nfe 0, Train: 0.7333, Val: 0.6080, Test: 0.5710, Best time: 0.8519
Epoch: 004/100, Runtime 0.280358, Loss 1.707889, forward nfe 722, backward nfe 0, Train: 0.6250, Val: 0.6790, Test: 0.6113, Best time: 29.8814
Epoch: 005/100, Runtime 0.277174, Loss 1.669301, forward nfe 942, backward nfe 0, Train: 0.7083, Val: 0.7225, Test: 0.6613, Best time: 18.7106
Epoch: 006/100, Runtime 0.293401, Loss 1.623959, forward nfe 1162, backward nfe 0, Train: 0.7083, Val: 0.7225, Test: 0.6613, Best time: 10.0000
Epoch: 007/100, Runtime 0.272853, Loss 1.621037, forward nfe 1382, backward nfe 0, Train: 0.7083, Val: 0.7225, Test: 0.6613, Best time: 10.0000
Epoch: 008/100, Runtime 0.272287, Loss 1.607784, forward nfe 1596, backward nfe 0, Train: 0.7083, Val: 0.7225, Test: 0.6613, Best time: 10.0000
Epoch: 009/100, Runtime 0.267294, Loss 1.561735, forward nfe 1810, backward nfe 0, Train: 0.7583, Val: 0.7348, Test: 0.6758, Best time: 13.0436
Epoch: 010/100, Runtime 0.283255, Loss 1.560817, forward nfe 2024, backward nfe 0, Train: 0.8250, Val: 0.7362, Test: 0.6887, Best time: 7.4571
Epoch: 011/100, Runtime 0.259792, Loss 1.560516, forward nfe 2238, backward nfe 0, Train: 0.8250, Val: 0.7362, Test: 0.6887, Best time: 10.0000
Epoch: 012/100, Runtime 0.263094, Loss 1.516577, forward nfe 2446, backward nfe 0, Train: 0.8250, Val: 0.7362, Test: 0.6887, Best time: 10.0000
Epoch: 013/100, Runtime 0.250803, Loss 1.489525, forward nfe 2648, backward nfe 0, Train: 0.8250, Val: 0.7362, Test: 0.6887, Best time: 10.0000
Epoch: 014/100, Runtime 0.262892, Loss 1.494359, forward nfe 2850, backward nfe 0, Train: 0.8250, Val: 0.7362, Test: 0.6887, Best time: 10.0000
Epoch: 015/100, Runtime 0.255325, Loss 1.463882, forward nfe 3052, backward nfe 0, Train: 0.8083, Val: 0.7406, Test: 0.6871, Best time: 11.3137
Epoch: 016/100, Runtime 0.256807, Loss 1.434092, forward nfe 3254, backward nfe 0, Train: 0.8250, Val: 0.7457, Test: 0.6935, Best time: 9.8599
Epoch: 017/100, Runtime 0.249573, Loss 1.343851, forward nfe 3456, backward nfe 0, Train: 0.8250, Val: 0.7500, Test: 0.7032, Best time: 8.5760
Epoch: 018/100, Runtime 0.256938, Loss 1.337553, forward nfe 3652, backward nfe 0, Train: 0.8333, Val: 0.7543, Test: 0.7048, Best time: 10.2546
Epoch: 019/100, Runtime 0.244283, Loss 1.303854, forward nfe 3848, backward nfe 0, Train: 0.7833, Val: 0.7623, Test: 0.7194, Best time: 32.1403
Epoch: 020/100, Runtime 0.258367, Loss 1.323765, forward nfe 4038, backward nfe 0, Train: 0.8083, Val: 0.7645, Test: 0.7097, Best time: 23.6088
Epoch: 021/100, Runtime 0.245911, Loss 1.255814, forward nfe 4228, backward nfe 0, Train: 0.8083, Val: 0.7645, Test: 0.7097, Best time: 10.0000
Epoch: 022/100, Runtime 0.243659, Loss 1.168243, forward nfe 4418, backward nfe 0, Train: 0.8250, Val: 0.7652, Test: 0.7210, Best time: 10.0000
Epoch: 023/100, Runtime 0.241982, Loss 1.217422, forward nfe 4602, backward nfe 0, Train: 0.8417, Val: 0.7696, Test: 0.7242, Best time: 10.0000
Epoch: 024/100, Runtime 0.237680, Loss 1.175934, forward nfe 4786, backward nfe 0, Train: 0.8417, Val: 0.7696, Test: 0.7242, Best time: 10.0000
Epoch: 025/100, Runtime 0.262472, Loss 1.096481, forward nfe 4970, backward nfe 0, Train: 0.8417, Val: 0.7696, Test: 0.7242, Best time: 10.0000
Epoch: 026/100, Runtime 0.227783, Loss 1.132789, forward nfe 5148, backward nfe 0, Train: 0.8417, Val: 0.7696, Test: 0.7242, Best time: 10.0000
Epoch: 027/100, Runtime 0.225447, Loss 1.067535, forward nfe 5326, backward nfe 0, Train: 0.8417, Val: 0.7696, Test: 0.7242, Best time: 10.0000
Epoch: 028/100, Runtime 0.223031, Loss 1.060115, forward nfe 5498, backward nfe 0, Train: 0.8417, Val: 0.7696, Test: 0.7242, Best time: 10.0000
Epoch: 029/100, Runtime 0.224734, Loss 1.053507, forward nfe 5670, backward nfe 0, Train: 0.8417, Val: 0.7696, Test: 0.7242, Best time: 10.0000
Epoch: 030/100, Runtime 0.246793, Loss 1.012277, forward nfe 5842, backward nfe 0, Train: 0.8417, Val: 0.7696, Test: 0.7242, Best time: 10.0000
Epoch: 031/100, Runtime 0.227489, Loss 1.019038, forward nfe 6014, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 24.6953
Epoch: 032/100, Runtime 0.230175, Loss 1.004403, forward nfe 6186, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 033/100, Runtime 0.212169, Loss 1.014317, forward nfe 6346, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 034/100, Runtime 0.205188, Loss 0.960174, forward nfe 6506, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 035/100, Runtime 0.215352, Loss 1.050649, forward nfe 6666, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 036/100, Runtime 0.203683, Loss 0.883067, forward nfe 6826, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 037/100, Runtime 0.211135, Loss 0.965967, forward nfe 6980, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 038/100, Runtime 0.206177, Loss 0.913638, forward nfe 7128, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 039/100, Runtime 0.186615, Loss 0.992021, forward nfe 7276, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 040/100, Runtime 0.201716, Loss 0.990557, forward nfe 7424, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 041/100, Runtime 0.186064, Loss 0.925828, forward nfe 7572, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 042/100, Runtime 0.188673, Loss 0.946441, forward nfe 7714, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 043/100, Runtime 0.188984, Loss 0.955296, forward nfe 7856, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 044/100, Runtime 0.183311, Loss 0.944257, forward nfe 7992, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 045/100, Runtime 0.181407, Loss 0.862160, forward nfe 8128, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 046/100, Runtime 0.176392, Loss 0.979258, forward nfe 8264, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 047/100, Runtime 0.167752, Loss 0.942486, forward nfe 8400, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 048/100, Runtime 0.177574, Loss 0.966832, forward nfe 8530, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 049/100, Runtime 0.184989, Loss 0.950709, forward nfe 8666, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 050/100, Runtime 0.179014, Loss 0.990862, forward nfe 8802, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 051/100, Runtime 0.200824, Loss 0.825526, forward nfe 8938, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 052/100, Runtime 0.176937, Loss 0.855462, forward nfe 9074, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 053/100, Runtime 0.176778, Loss 0.905262, forward nfe 9210, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 054/100, Runtime 0.184875, Loss 0.889692, forward nfe 9352, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 055/100, Runtime 0.189621, Loss 0.877490, forward nfe 9494, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 056/100, Runtime 0.191675, Loss 0.872200, forward nfe 9642, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 057/100, Runtime 0.194117, Loss 0.818866, forward nfe 9790, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 058/100, Runtime 0.192920, Loss 0.819710, forward nfe 9938, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 059/100, Runtime 0.197014, Loss 0.951231, forward nfe 10086, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 060/100, Runtime 0.186083, Loss 0.956996, forward nfe 10234, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 061/100, Runtime 0.198841, Loss 0.859610, forward nfe 10382, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 062/100, Runtime 0.183040, Loss 0.883612, forward nfe 10530, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 063/100, Runtime 0.191465, Loss 0.857693, forward nfe 10678, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 064/100, Runtime 0.194428, Loss 0.982994, forward nfe 10826, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 065/100, Runtime 0.194803, Loss 0.880526, forward nfe 10974, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 066/100, Runtime 0.187878, Loss 0.864840, forward nfe 11122, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 067/100, Runtime 0.191589, Loss 0.893886, forward nfe 11270, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 068/100, Runtime 0.193171, Loss 0.819954, forward nfe 11418, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 069/100, Runtime 0.199774, Loss 0.845726, forward nfe 11566, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 070/100, Runtime 0.191677, Loss 0.897069, forward nfe 11714, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 071/100, Runtime 0.194608, Loss 0.880621, forward nfe 11862, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 072/100, Runtime 0.206461, Loss 0.859577, forward nfe 12010, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 073/100, Runtime 0.201187, Loss 0.854368, forward nfe 12158, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 074/100, Runtime 0.196992, Loss 0.889127, forward nfe 12306, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 075/100, Runtime 0.190507, Loss 0.935659, forward nfe 12454, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 076/100, Runtime 0.191133, Loss 0.949818, forward nfe 12602, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 077/100, Runtime 0.191809, Loss 0.864610, forward nfe 12750, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 078/100, Runtime 0.189889, Loss 0.884894, forward nfe 12898, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 079/100, Runtime 0.192620, Loss 0.860069, forward nfe 13046, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 080/100, Runtime 0.193073, Loss 0.783654, forward nfe 13194, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 081/100, Runtime 0.196089, Loss 0.855923, forward nfe 13342, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 082/100, Runtime 0.202829, Loss 0.870183, forward nfe 13490, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 083/100, Runtime 0.191594, Loss 0.861096, forward nfe 13638, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 084/100, Runtime 0.200135, Loss 0.842201, forward nfe 13786, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 085/100, Runtime 0.197603, Loss 0.892857, forward nfe 13934, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 086/100, Runtime 0.191219, Loss 0.755477, forward nfe 14082, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 087/100, Runtime 0.195825, Loss 0.879763, forward nfe 14230, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 088/100, Runtime 0.193207, Loss 0.838249, forward nfe 14378, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 089/100, Runtime 0.195593, Loss 0.869009, forward nfe 14526, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 090/100, Runtime 0.186553, Loss 0.868225, forward nfe 14668, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 091/100, Runtime 0.186443, Loss 0.838390, forward nfe 14810, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 092/100, Runtime 0.194549, Loss 0.832583, forward nfe 14952, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 093/100, Runtime 0.184642, Loss 0.851980, forward nfe 15094, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 094/100, Runtime 0.184374, Loss 0.886656, forward nfe 15236, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 095/100, Runtime 0.183390, Loss 0.903926, forward nfe 15378, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 096/100, Runtime 0.189403, Loss 0.909319, forward nfe 15520, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 097/100, Runtime 0.183787, Loss 0.896480, forward nfe 15662, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 098/100, Runtime 0.187293, Loss 0.838010, forward nfe 15804, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
Epoch: 099/100, Runtime 0.180839, Loss 0.855609, forward nfe 15946, backward nfe 0, Train: 0.9250, Val: 0.7775, Test: 0.7355, Best time: 10.0000
best val accuracy 0.777536 with test accuracy 0.735484 at epoch 31 and best time 10.000000