/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 3.667607, Loss 1.948691, forward nfe 116, backward nfe 0, Train: 0.1429, Val: 0.0868, Test: 0.0995, Best time: 0.0928
Epoch: 002/100, Runtime 3.579076, Loss 1.972565, forward nfe 588, backward nfe 0, Train: 0.6429, Val: 0.5904, Test: 0.6061, Best time: 1.0137
Epoch: 003/100, Runtime 3.182366, Loss 1.845108, forward nfe 1042, backward nfe 0, Train: 0.6429, Val: 0.5904, Test: 0.6061, Best time: 60.0000
Epoch: 004/100, Runtime 3.066326, Loss 1.804176, forward nfe 1484, backward nfe 0, Train: 0.5857, Val: 0.6316, Test: 0.6365, Best time: 10.4019
Epoch: 005/100, Runtime 3.087816, Loss 1.676165, forward nfe 1920, backward nfe 0, Train: 0.8143, Val: 0.7654, Test: 0.7817, Best time: 18.4823
Epoch: 006/100, Runtime 3.180381, Loss 1.486695, forward nfe 2344, backward nfe 0, Train: 0.8500, Val: 0.7831, Test: 0.8081, Best time: 4.0306
Epoch: 007/100, Runtime 3.097298, Loss 1.270492, forward nfe 2762, backward nfe 0, Train: 0.8571, Val: 0.8000, Test: 0.8183, Best time: 8.2883
Epoch: 008/100, Runtime 3.083505, Loss 1.040976, forward nfe 3162, backward nfe 0, Train: 0.8571, Val: 0.8000, Test: 0.8183, Best time: 60.0000
Epoch: 009/100, Runtime 3.127145, Loss 0.854408, forward nfe 3550, backward nfe 0, Train: 0.8571, Val: 0.8000, Test: 0.8183, Best time: 60.0000
Epoch: 010/100, Runtime 3.040681, Loss 0.728433, forward nfe 3938, backward nfe 0, Train: 0.8786, Val: 0.8081, Test: 0.8284, Best time: 40.9236
Epoch: 011/100, Runtime 3.079116, Loss 0.636867, forward nfe 4326, backward nfe 0, Train: 0.8786, Val: 0.8147, Test: 0.8244, Best time: 22.1593
Epoch: 012/100, Runtime 2.918550, Loss 0.570774, forward nfe 4702, backward nfe 0, Train: 0.8786, Val: 0.8147, Test: 0.8244, Best time: 60.0000
Epoch: 013/100, Runtime 2.826747, Loss 0.557713, forward nfe 5072, backward nfe 0, Train: 0.8786, Val: 0.8147, Test: 0.8244, Best time: 60.0000
Epoch: 014/100, Runtime 2.616706, Loss 0.490972, forward nfe 5430, backward nfe 0, Train: 0.8786, Val: 0.8147, Test: 0.8244, Best time: 60.0000
Epoch: 015/100, Runtime 2.621252, Loss 0.485751, forward nfe 5764, backward nfe 0, Train: 0.8786, Val: 0.8147, Test: 0.8244, Best time: 60.0000
Epoch: 016/100, Runtime 2.552753, Loss 0.446197, forward nfe 6092, backward nfe 0, Train: 0.8786, Val: 0.8147, Test: 0.8244, Best time: 60.0000
Epoch: 017/100, Runtime 2.656238, Loss 0.436713, forward nfe 6420, backward nfe 0, Train: 0.8786, Val: 0.8147, Test: 0.8244, Best time: 60.0000
Epoch: 018/100, Runtime 2.489106, Loss 0.418549, forward nfe 6736, backward nfe 0, Train: 0.8786, Val: 0.8147, Test: 0.8244, Best time: 60.0000
Epoch: 019/100, Runtime 2.304979, Loss 0.380837, forward nfe 7052, backward nfe 0, Train: 0.9071, Val: 0.8184, Test: 0.8386, Best time: 107.5405
Epoch: 020/100, Runtime 2.364985, Loss 0.362267, forward nfe 7368, backward nfe 0, Train: 0.9071, Val: 0.8184, Test: 0.8386, Best time: 60.0000
Epoch: 021/100, Runtime 2.286581, Loss 0.373203, forward nfe 7678, backward nfe 0, Train: 0.9071, Val: 0.8184, Test: 0.8386, Best time: 60.0000
Epoch: 022/100, Runtime 2.265921, Loss 0.367088, forward nfe 7964, backward nfe 0, Train: 0.9071, Val: 0.8184, Test: 0.8386, Best time: 60.0000
Epoch: 023/100, Runtime 2.142768, Loss 0.341525, forward nfe 8244, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 56.7006
Epoch: 024/100, Runtime 2.180491, Loss 0.336525, forward nfe 8530, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 025/100, Runtime 2.025535, Loss 0.316085, forward nfe 8810, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 026/100, Runtime 2.158723, Loss 0.322766, forward nfe 9090, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 027/100, Runtime 1.996369, Loss 0.274856, forward nfe 9364, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 028/100, Runtime 2.183817, Loss 0.319869, forward nfe 9632, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 029/100, Runtime 2.099498, Loss 0.311983, forward nfe 9900, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 030/100, Runtime 2.085781, Loss 0.297850, forward nfe 10168, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 031/100, Runtime 2.070977, Loss 0.312734, forward nfe 10418, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 032/100, Runtime 2.070077, Loss 0.233696, forward nfe 10674, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 033/100, Runtime 2.189817, Loss 0.237129, forward nfe 10936, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 034/100, Runtime 2.150117, Loss 0.175252, forward nfe 11198, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 035/100, Runtime 2.019101, Loss 0.221074, forward nfe 11466, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 036/100, Runtime 1.863059, Loss 0.205748, forward nfe 11728, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 037/100, Runtime 1.997997, Loss 0.180603, forward nfe 11990, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 038/100, Runtime 1.873838, Loss 0.187598, forward nfe 12252, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 039/100, Runtime 1.993176, Loss 0.207933, forward nfe 12502, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 040/100, Runtime 1.802704, Loss 0.158474, forward nfe 12752, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 041/100, Runtime 1.958369, Loss 0.227477, forward nfe 13002, backward nfe 0, Train: 0.9357, Val: 0.8346, Test: 0.8406, Best time: 60.0000
Epoch: 042/100, Runtime 1.996593, Loss 0.262499, forward nfe 13252, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 71.6896
Epoch: 043/100, Runtime 1.993274, Loss 0.214900, forward nfe 13502, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 044/100, Runtime 2.028672, Loss 0.164052, forward nfe 13752, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 045/100, Runtime 2.015412, Loss 0.112170, forward nfe 14002, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 046/100, Runtime 2.089130, Loss 0.153305, forward nfe 14252, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 047/100, Runtime 1.964911, Loss 0.155203, forward nfe 14502, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 048/100, Runtime 1.919683, Loss 0.154078, forward nfe 14740, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 049/100, Runtime 1.993519, Loss 0.120533, forward nfe 14978, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 050/100, Runtime 1.932782, Loss 0.087996, forward nfe 15210, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 051/100, Runtime 1.927726, Loss 0.134997, forward nfe 15442, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 052/100, Runtime 1.915630, Loss 0.119638, forward nfe 15674, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 053/100, Runtime 1.909631, Loss 0.091268, forward nfe 15906, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 054/100, Runtime 1.918098, Loss 0.115579, forward nfe 16138, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 055/100, Runtime 1.910252, Loss 0.098036, forward nfe 16370, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 056/100, Runtime 1.922621, Loss 0.094099, forward nfe 16602, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 057/100, Runtime 1.919795, Loss 0.115783, forward nfe 16834, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 058/100, Runtime 1.910009, Loss 0.057821, forward nfe 17060, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 059/100, Runtime 1.922224, Loss 0.140773, forward nfe 17286, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 060/100, Runtime 1.923946, Loss 0.087528, forward nfe 17512, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 061/100, Runtime 1.879302, Loss 0.064322, forward nfe 17738, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 062/100, Runtime 1.839166, Loss 0.088850, forward nfe 17964, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 063/100, Runtime 1.779967, Loss 0.091982, forward nfe 18184, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 064/100, Runtime 1.715327, Loss 0.074828, forward nfe 18404, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 065/100, Runtime 1.697547, Loss 0.080662, forward nfe 18624, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 066/100, Runtime 1.664443, Loss 0.060275, forward nfe 18844, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 067/100, Runtime 1.684417, Loss 0.092733, forward nfe 19058, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 068/100, Runtime 1.693001, Loss 0.130997, forward nfe 19272, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 069/100, Runtime 1.669549, Loss 0.077578, forward nfe 19486, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 070/100, Runtime 1.786840, Loss 0.082623, forward nfe 19700, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 071/100, Runtime 1.742423, Loss 0.111284, forward nfe 19914, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 072/100, Runtime 1.846671, Loss 0.107570, forward nfe 20128, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 073/100, Runtime 1.775664, Loss 0.092094, forward nfe 20342, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 074/100, Runtime 1.782053, Loss 0.131289, forward nfe 20556, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 075/100, Runtime 1.717456, Loss 0.065070, forward nfe 20770, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 076/100, Runtime 1.799687, Loss 0.066400, forward nfe 20990, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 077/100, Runtime 1.815504, Loss 0.033341, forward nfe 21210, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 078/100, Runtime 1.849388, Loss 0.091370, forward nfe 21430, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 079/100, Runtime 1.765744, Loss 0.062132, forward nfe 21650, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 080/100, Runtime 1.795792, Loss 0.065896, forward nfe 21870, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 081/100, Runtime 1.758994, Loss 0.043719, forward nfe 22084, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 082/100, Runtime 1.796354, Loss 0.052862, forward nfe 22298, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 083/100, Runtime 1.819651, Loss 0.058952, forward nfe 22518, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 084/100, Runtime 1.689639, Loss 0.064989, forward nfe 22738, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 085/100, Runtime 1.610642, Loss 0.085992, forward nfe 22958, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 086/100, Runtime 1.629034, Loss 0.050974, forward nfe 23166, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 087/100, Runtime 1.596828, Loss 0.052777, forward nfe 23368, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 088/100, Runtime 1.702976, Loss 0.054297, forward nfe 23570, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 089/100, Runtime 1.600312, Loss 0.056785, forward nfe 23766, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 090/100, Runtime 1.597246, Loss 0.054835, forward nfe 23962, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 091/100, Runtime 1.571161, Loss 0.046388, forward nfe 24158, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 092/100, Runtime 1.506377, Loss 0.100671, forward nfe 24354, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 093/100, Runtime 1.586848, Loss 0.025335, forward nfe 24544, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 094/100, Runtime 1.596730, Loss 0.059401, forward nfe 24734, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 095/100, Runtime 1.726465, Loss 0.034275, forward nfe 24924, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 096/100, Runtime 1.712378, Loss 0.053299, forward nfe 25120, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 097/100, Runtime 1.711124, Loss 0.091556, forward nfe 25322, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 098/100, Runtime 1.734861, Loss 0.051743, forward nfe 25524, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
Epoch: 099/100, Runtime 1.753199, Loss 0.087512, forward nfe 25726, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8538, Best time: 60.0000
best val accuracy 0.851471 with test accuracy 0.853807 at epoch 42 and best time 60.000000