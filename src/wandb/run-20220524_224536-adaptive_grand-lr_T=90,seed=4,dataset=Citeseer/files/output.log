/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.946876, Loss 1.792645, forward nfe 224, backward nfe 0, Train: 0.1917, Val: 0.1710, Test: 0.1629, Best time: 8.8761
Epoch: 002/100, Runtime 0.831198, Loss 1.791491, forward nfe 978, backward nfe 0, Train: 0.3833, Val: 0.3630, Test: 0.4016, Best time: 0.0391
Epoch: 003/100, Runtime 0.832003, Loss 1.763590, forward nfe 1738, backward nfe 0, Train: 0.5083, Val: 0.5609, Test: 0.5613, Best time: 0.0376
Epoch: 004/100, Runtime 0.840223, Loss 1.744565, forward nfe 2492, backward nfe 0, Train: 0.4833, Val: 0.6188, Test: 0.6081, Best time: 3.3411
Epoch: 005/100, Runtime 0.802531, Loss 1.679489, forward nfe 3234, backward nfe 0, Train: 0.5417, Val: 0.6246, Test: 0.6145, Best time: 2.0426
Epoch: 006/100, Runtime 0.813373, Loss 1.696713, forward nfe 3958, backward nfe 0, Train: 0.6000, Val: 0.6659, Test: 0.6726, Best time: 2.8149
Epoch: 007/100, Runtime 0.805638, Loss 1.648128, forward nfe 4676, backward nfe 0, Train: 0.6500, Val: 0.7261, Test: 0.7210, Best time: 10.5688
Epoch: 008/100, Runtime 0.778332, Loss 1.653817, forward nfe 5394, backward nfe 0, Train: 0.6750, Val: 0.7536, Test: 0.7484, Best time: 29.9251
Epoch: 009/100, Runtime 0.754659, Loss 1.595713, forward nfe 6088, backward nfe 0, Train: 0.6750, Val: 0.7536, Test: 0.7484, Best time: 90.0000
Epoch: 010/100, Runtime 0.753473, Loss 1.601601, forward nfe 6770, backward nfe 0, Train: 0.6750, Val: 0.7536, Test: 0.7484, Best time: 90.0000
Epoch: 011/100, Runtime 0.713814, Loss 1.556448, forward nfe 7452, backward nfe 0, Train: 0.6750, Val: 0.7536, Test: 0.7484, Best time: 90.0000
Epoch: 012/100, Runtime 0.725381, Loss 1.604128, forward nfe 8110, backward nfe 0, Train: 0.6750, Val: 0.7536, Test: 0.7484, Best time: 90.0000
Epoch: 013/100, Runtime 0.730490, Loss 1.539963, forward nfe 8768, backward nfe 0, Train: 0.6750, Val: 0.7536, Test: 0.7484, Best time: 90.0000
Epoch: 014/100, Runtime 0.704026, Loss 1.544990, forward nfe 9426, backward nfe 0, Train: 0.6750, Val: 0.7536, Test: 0.7484, Best time: 90.0000
Epoch: 015/100, Runtime 0.699556, Loss 1.424510, forward nfe 10066, backward nfe 0, Train: 0.6583, Val: 0.7543, Test: 0.7484, Best time: 45.8926
Epoch: 016/100, Runtime 0.699212, Loss 1.409922, forward nfe 10694, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 68.5588
Epoch: 017/100, Runtime 0.695744, Loss 1.429102, forward nfe 11316, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 018/100, Runtime 0.691052, Loss 1.408587, forward nfe 11914, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 019/100, Runtime 0.670947, Loss 1.382281, forward nfe 12524, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 020/100, Runtime 0.671366, Loss 1.388762, forward nfe 13128, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 021/100, Runtime 0.645763, Loss 1.326733, forward nfe 13714, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 022/100, Runtime 0.641462, Loss 1.355475, forward nfe 14288, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 023/100, Runtime 0.618107, Loss 1.371881, forward nfe 14850, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 024/100, Runtime 0.630520, Loss 1.327619, forward nfe 15400, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 025/100, Runtime 0.603560, Loss 1.283208, forward nfe 15944, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 026/100, Runtime 0.611060, Loss 1.298963, forward nfe 16488, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 027/100, Runtime 0.608799, Loss 1.378759, forward nfe 17020, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 028/100, Runtime 0.597126, Loss 1.375968, forward nfe 17540, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 029/100, Runtime 0.570525, Loss 1.477645, forward nfe 18060, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 030/100, Runtime 0.558712, Loss 1.427101, forward nfe 18568, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 031/100, Runtime 0.583993, Loss 1.314525, forward nfe 19070, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 032/100, Runtime 0.547537, Loss 1.318316, forward nfe 19560, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 033/100, Runtime 0.548313, Loss 1.247291, forward nfe 20044, backward nfe 0, Train: 0.6667, Val: 0.7565, Test: 0.7452, Best time: 90.0000
Epoch: 034/100, Runtime 0.531018, Loss 1.248581, forward nfe 20522, backward nfe 0, Train: 0.7000, Val: 0.7601, Test: 0.7403, Best time: 77.4209
Epoch: 035/100, Runtime 0.541212, Loss 1.213004, forward nfe 20994, backward nfe 0, Train: 0.7000, Val: 0.7601, Test: 0.7403, Best time: 90.0000
Epoch: 036/100, Runtime 0.523729, Loss 1.304434, forward nfe 21454, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 82.8033
Epoch: 037/100, Runtime 0.545051, Loss 1.312483, forward nfe 21920, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 038/100, Runtime 0.518746, Loss 1.233464, forward nfe 22386, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 039/100, Runtime 0.504290, Loss 1.327755, forward nfe 22828, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 040/100, Runtime 0.503363, Loss 1.259342, forward nfe 23276, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 041/100, Runtime 0.482724, Loss 1.291322, forward nfe 23718, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 042/100, Runtime 0.478547, Loss 1.375810, forward nfe 24142, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 043/100, Runtime 0.504808, Loss 1.405828, forward nfe 24572, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 044/100, Runtime 0.479305, Loss 1.298911, forward nfe 24996, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 045/100, Runtime 0.487091, Loss 1.366741, forward nfe 25408, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 046/100, Runtime 0.506277, Loss 1.318818, forward nfe 25826, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 047/100, Runtime 0.468702, Loss 1.368615, forward nfe 26238, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 048/100, Runtime 0.451401, Loss 1.308794, forward nfe 26632, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 049/100, Runtime 0.459735, Loss 1.213223, forward nfe 27026, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 050/100, Runtime 0.438875, Loss 1.395162, forward nfe 27414, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 051/100, Runtime 0.458590, Loss 1.237170, forward nfe 27796, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 052/100, Runtime 0.443085, Loss 1.453571, forward nfe 28184, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 053/100, Runtime 0.436606, Loss 1.154931, forward nfe 28560, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 054/100, Runtime 0.421444, Loss 1.249168, forward nfe 28936, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 055/100, Runtime 0.438687, Loss 1.253121, forward nfe 29306, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 056/100, Runtime 0.432794, Loss 1.325539, forward nfe 29676, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 057/100, Runtime 0.543012, Loss 1.297982, forward nfe 30040, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 058/100, Runtime 0.416419, Loss 1.356109, forward nfe 30398, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 059/100, Runtime 0.414966, Loss 1.360891, forward nfe 30756, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 060/100, Runtime 0.415253, Loss 1.304632, forward nfe 31114, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 061/100, Runtime 0.411426, Loss 1.306219, forward nfe 31466, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 062/100, Runtime 0.415930, Loss 1.317242, forward nfe 31818, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 063/100, Runtime 0.404181, Loss 1.272987, forward nfe 32164, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 064/100, Runtime 0.404883, Loss 1.320078, forward nfe 32510, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 065/100, Runtime 0.401508, Loss 1.258844, forward nfe 32856, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 066/100, Runtime 0.401649, Loss 1.344456, forward nfe 33202, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 067/100, Runtime 0.413793, Loss 1.264423, forward nfe 33548, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 068/100, Runtime 0.404958, Loss 1.251300, forward nfe 33894, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 069/100, Runtime 0.412690, Loss 1.246405, forward nfe 34240, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 070/100, Runtime 0.411709, Loss 1.202208, forward nfe 34586, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 071/100, Runtime 0.401270, Loss 1.121073, forward nfe 34926, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 072/100, Runtime 0.402836, Loss 1.246628, forward nfe 35266, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 073/100, Runtime 0.399289, Loss 1.347650, forward nfe 35606, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 074/100, Runtime 0.409877, Loss 1.263821, forward nfe 35946, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 075/100, Runtime 0.418226, Loss 1.285360, forward nfe 36292, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 076/100, Runtime 0.408616, Loss 1.369853, forward nfe 36638, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 077/100, Runtime 0.403896, Loss 1.247086, forward nfe 36972, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 078/100, Runtime 0.406702, Loss 1.225080, forward nfe 37312, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 079/100, Runtime 0.405637, Loss 1.184011, forward nfe 37652, backward nfe 0, Train: 0.7083, Val: 0.7638, Test: 0.7468, Best time: 90.0000
Epoch: 080/100, Runtime 0.403465, Loss 1.288027, forward nfe 37986, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 120.1068
Epoch: 081/100, Runtime 0.396917, Loss 1.115475, forward nfe 38320, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 082/100, Runtime 0.392596, Loss 1.159510, forward nfe 38654, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 083/100, Runtime 0.404086, Loss 1.299783, forward nfe 38988, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 084/100, Runtime 0.389424, Loss 1.247212, forward nfe 39316, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 085/100, Runtime 0.402444, Loss 1.285925, forward nfe 39644, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 086/100, Runtime 0.400050, Loss 1.259447, forward nfe 39972, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 087/100, Runtime 0.406872, Loss 1.308007, forward nfe 40300, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 088/100, Runtime 0.399232, Loss 1.155151, forward nfe 40628, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 089/100, Runtime 0.387244, Loss 1.320315, forward nfe 40950, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 090/100, Runtime 0.404133, Loss 1.257267, forward nfe 41272, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 091/100, Runtime 0.384815, Loss 1.250821, forward nfe 41594, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 092/100, Runtime 0.394532, Loss 1.391115, forward nfe 41916, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 093/100, Runtime 0.391571, Loss 1.278902, forward nfe 42238, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 094/100, Runtime 0.383479, Loss 1.224855, forward nfe 42554, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 095/100, Runtime 0.382271, Loss 1.289931, forward nfe 42870, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 096/100, Runtime 0.397867, Loss 1.262101, forward nfe 43186, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 097/100, Runtime 0.396005, Loss 1.164514, forward nfe 43502, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 098/100, Runtime 0.391475, Loss 1.320615, forward nfe 43818, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
Epoch: 099/100, Runtime 0.378426, Loss 1.348578, forward nfe 44134, backward nfe 0, Train: 0.7750, Val: 0.7652, Test: 0.7516, Best time: 90.0000
best val accuracy 0.765217 with test accuracy 0.751613 at epoch 80 and best time 90.000000