/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 1.987541, Loss 1.950621, forward nfe 44, backward nfe 0, Train: 0.3500, Val: 0.1610, Test: 0.1716, Best time: 0.0938
Epoch: 002/100, Runtime 1.844656, Loss 1.870062, forward nfe 180, backward nfe 0, Train: 0.6786, Val: 0.3647, Test: 0.3898, Best time: 0.0898
Epoch: 003/100, Runtime 1.867101, Loss 1.731825, forward nfe 310, backward nfe 0, Train: 0.8000, Val: 0.5787, Test: 0.6203, Best time: 5.2570
Epoch: 004/100, Runtime 1.910915, Loss 1.525429, forward nfe 440, backward nfe 0, Train: 0.8714, Val: 0.7397, Test: 0.7462, Best time: 9.5592
Epoch: 005/100, Runtime 1.898043, Loss 1.310054, forward nfe 570, backward nfe 0, Train: 0.8929, Val: 0.7824, Test: 0.7939, Best time: 12.5666
Epoch: 006/100, Runtime 1.756060, Loss 1.052025, forward nfe 700, backward nfe 0, Train: 0.8786, Val: 0.7941, Test: 0.8112, Best time: 21.4725
Epoch: 007/100, Runtime 1.856151, Loss 0.814884, forward nfe 830, backward nfe 0, Train: 0.9429, Val: 0.8037, Test: 0.8213, Best time: 7.4872
Epoch: 008/100, Runtime 1.856632, Loss 0.618083, forward nfe 960, backward nfe 0, Train: 0.9500, Val: 0.8081, Test: 0.8244, Best time: 7.6647
Epoch: 009/100, Runtime 1.603511, Loss 0.454726, forward nfe 1084, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 010/100, Runtime 1.558472, Loss 0.325994, forward nfe 1196, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 011/100, Runtime 1.588928, Loss 0.253037, forward nfe 1308, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 012/100, Runtime 1.617699, Loss 0.230258, forward nfe 1420, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 013/100, Runtime 1.620070, Loss 0.146864, forward nfe 1532, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 014/100, Runtime 1.541446, Loss 0.153860, forward nfe 1644, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 015/100, Runtime 1.510909, Loss 0.111696, forward nfe 1756, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 016/100, Runtime 1.515864, Loss 0.114802, forward nfe 1862, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 017/100, Runtime 1.435897, Loss 0.113511, forward nfe 1962, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 018/100, Runtime 1.546861, Loss 0.107385, forward nfe 2062, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 019/100, Runtime 1.407209, Loss 0.137831, forward nfe 2162, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 020/100, Runtime 1.377015, Loss 0.119060, forward nfe 2262, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 021/100, Runtime 1.417097, Loss 0.139855, forward nfe 2356, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 022/100, Runtime 1.282604, Loss 0.136008, forward nfe 2450, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 023/100, Runtime 1.354737, Loss 0.186311, forward nfe 2544, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 024/100, Runtime 1.460269, Loss 0.164375, forward nfe 2638, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 025/100, Runtime 1.370958, Loss 0.135987, forward nfe 2726, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 026/100, Runtime 1.263311, Loss 0.091946, forward nfe 2814, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 027/100, Runtime 1.208253, Loss 0.142012, forward nfe 2902, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 028/100, Runtime 1.210924, Loss 0.096622, forward nfe 2984, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 029/100, Runtime 1.312585, Loss 0.097158, forward nfe 3066, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 030/100, Runtime 1.200523, Loss 0.116883, forward nfe 3148, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 031/100, Runtime 1.198443, Loss 0.131909, forward nfe 3230, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 032/100, Runtime 1.259472, Loss 0.107784, forward nfe 3312, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 033/100, Runtime 1.226257, Loss 0.107132, forward nfe 3394, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 034/100, Runtime 1.302789, Loss 0.115412, forward nfe 3476, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 035/100, Runtime 1.365894, Loss 0.106522, forward nfe 3558, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 036/100, Runtime 1.137277, Loss 0.086749, forward nfe 3640, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 037/100, Runtime 1.150808, Loss 0.116171, forward nfe 3716, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 038/100, Runtime 1.141704, Loss 0.116072, forward nfe 3792, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 039/100, Runtime 1.149185, Loss 0.097059, forward nfe 3868, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 040/100, Runtime 1.132494, Loss 0.096331, forward nfe 3944, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 041/100, Runtime 1.141640, Loss 0.100466, forward nfe 4020, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 042/100, Runtime 1.098441, Loss 0.077345, forward nfe 4090, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 043/100, Runtime 1.103774, Loss 0.087012, forward nfe 4160, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 044/100, Runtime 1.103456, Loss 0.089615, forward nfe 4230, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 045/100, Runtime 1.101982, Loss 0.092944, forward nfe 4300, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 046/100, Runtime 1.101198, Loss 0.084503, forward nfe 4370, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 047/100, Runtime 1.104151, Loss 0.055040, forward nfe 4440, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 048/100, Runtime 1.100779, Loss 0.093736, forward nfe 4510, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 049/100, Runtime 1.101142, Loss 0.120557, forward nfe 4580, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 050/100, Runtime 1.104959, Loss 0.068915, forward nfe 4650, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 051/100, Runtime 1.101143, Loss 0.106290, forward nfe 4720, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 052/100, Runtime 1.101827, Loss 0.075932, forward nfe 4790, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 053/100, Runtime 1.104232, Loss 0.110168, forward nfe 4860, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 054/100, Runtime 1.123563, Loss 0.073739, forward nfe 4930, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 055/100, Runtime 1.085316, Loss 0.093783, forward nfe 5000, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 056/100, Runtime 1.070732, Loss 0.070733, forward nfe 5070, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 057/100, Runtime 1.092176, Loss 0.082447, forward nfe 5140, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 058/100, Runtime 1.080194, Loss 0.077141, forward nfe 5210, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 059/100, Runtime 1.049300, Loss 0.070947, forward nfe 5280, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 060/100, Runtime 1.051524, Loss 0.064264, forward nfe 5350, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 061/100, Runtime 1.074327, Loss 0.093918, forward nfe 5420, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 062/100, Runtime 1.078142, Loss 0.045363, forward nfe 5490, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 063/100, Runtime 1.059895, Loss 0.080856, forward nfe 5560, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 064/100, Runtime 1.049232, Loss 0.068498, forward nfe 5630, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 065/100, Runtime 1.066018, Loss 0.059875, forward nfe 5700, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 066/100, Runtime 1.077524, Loss 0.104032, forward nfe 5770, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 067/100, Runtime 1.092574, Loss 0.060544, forward nfe 5840, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 068/100, Runtime 1.107035, Loss 0.076371, forward nfe 5910, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 069/100, Runtime 1.064006, Loss 0.087354, forward nfe 5980, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 070/100, Runtime 1.075838, Loss 0.083166, forward nfe 6050, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 071/100, Runtime 1.106807, Loss 0.084355, forward nfe 6120, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 072/100, Runtime 1.123422, Loss 0.057607, forward nfe 6190, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 073/100, Runtime 1.059517, Loss 0.071405, forward nfe 6260, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 074/100, Runtime 1.039879, Loss 0.070176, forward nfe 6330, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 075/100, Runtime 1.079824, Loss 0.090375, forward nfe 6400, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 076/100, Runtime 1.096000, Loss 0.081867, forward nfe 6470, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 077/100, Runtime 1.057460, Loss 0.081686, forward nfe 6540, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 078/100, Runtime 1.099153, Loss 0.078549, forward nfe 6610, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 079/100, Runtime 1.086659, Loss 0.080608, forward nfe 6680, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 080/100, Runtime 1.052885, Loss 0.073889, forward nfe 6750, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 081/100, Runtime 1.054715, Loss 0.057517, forward nfe 6820, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 082/100, Runtime 1.100790, Loss 0.103944, forward nfe 6890, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 083/100, Runtime 1.123065, Loss 0.052708, forward nfe 6960, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 084/100, Runtime 1.081931, Loss 0.101324, forward nfe 7030, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 085/100, Runtime 1.102667, Loss 0.071408, forward nfe 7100, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 086/100, Runtime 1.099931, Loss 0.059757, forward nfe 7170, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 087/100, Runtime 1.104665, Loss 0.087362, forward nfe 7240, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 088/100, Runtime 1.108874, Loss 0.076514, forward nfe 7310, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 089/100, Runtime 1.108878, Loss 0.061478, forward nfe 7380, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 090/100, Runtime 1.106841, Loss 0.118410, forward nfe 7450, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 091/100, Runtime 1.104272, Loss 0.058024, forward nfe 7520, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 092/100, Runtime 1.106055, Loss 0.051099, forward nfe 7590, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 093/100, Runtime 1.092048, Loss 0.050058, forward nfe 7660, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 094/100, Runtime 1.111466, Loss 0.108840, forward nfe 7730, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 095/100, Runtime 1.101655, Loss 0.076534, forward nfe 7800, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 096/100, Runtime 1.103775, Loss 0.063533, forward nfe 7870, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 097/100, Runtime 1.101855, Loss 0.054463, forward nfe 7940, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 098/100, Runtime 1.142861, Loss 0.057028, forward nfe 8010, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
Epoch: 099/100, Runtime 1.195072, Loss 0.049364, forward nfe 8086, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8254, Best time: 10.0000
best val accuracy 0.813235 with test accuracy 0.825381 at epoch 9 and best time 10.000000