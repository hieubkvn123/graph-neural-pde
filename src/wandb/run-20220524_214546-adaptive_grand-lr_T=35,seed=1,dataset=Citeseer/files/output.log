/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.522464, Loss 1.794026, forward nfe 134, backward nfe 0, Train: 0.4167, Val: 0.4297, Test: 0.4226, Best time: 106.6436
Epoch: 002/100, Runtime 0.450480, Loss 1.761214, forward nfe 516, backward nfe 0, Train: 0.6833, Val: 0.5870, Test: 0.6016, Best time: 94.9551
Epoch: 003/100, Runtime 0.461046, Loss 1.718246, forward nfe 904, backward nfe 0, Train: 0.6833, Val: 0.5870, Test: 0.6016, Best time: 35.0000
Epoch: 004/100, Runtime 0.466497, Loss 1.654039, forward nfe 1292, backward nfe 0, Train: 0.6833, Val: 0.5870, Test: 0.6016, Best time: 35.0000
Epoch: 005/100, Runtime 0.448540, Loss 1.619266, forward nfe 1680, backward nfe 0, Train: 0.6833, Val: 0.5870, Test: 0.6016, Best time: 35.0000
Epoch: 006/100, Runtime 0.449111, Loss 1.571427, forward nfe 2068, backward nfe 0, Train: 0.8083, Val: 0.6203, Test: 0.6323, Best time: 2.7840
Epoch: 007/100, Runtime 0.437447, Loss 1.530295, forward nfe 2444, backward nfe 0, Train: 0.8667, Val: 0.6739, Test: 0.6952, Best time: 4.4819
Epoch: 008/100, Runtime 0.447049, Loss 1.515722, forward nfe 2814, backward nfe 0, Train: 0.8500, Val: 0.7138, Test: 0.7210, Best time: 3.7659
Epoch: 009/100, Runtime 0.435539, Loss 1.483225, forward nfe 3190, backward nfe 0, Train: 0.8500, Val: 0.7246, Test: 0.7355, Best time: 9.4948
Epoch: 010/100, Runtime 0.428429, Loss 1.454185, forward nfe 3554, backward nfe 0, Train: 0.8500, Val: 0.7246, Test: 0.7355, Best time: 35.0000
Epoch: 011/100, Runtime 0.419677, Loss 1.426177, forward nfe 3906, backward nfe 0, Train: 0.8500, Val: 0.7246, Test: 0.7355, Best time: 35.0000
Epoch: 012/100, Runtime 0.420204, Loss 1.427364, forward nfe 4258, backward nfe 0, Train: 0.8500, Val: 0.7246, Test: 0.7355, Best time: 35.0000
Epoch: 013/100, Runtime 0.431410, Loss 1.383760, forward nfe 4610, backward nfe 0, Train: 0.8500, Val: 0.7246, Test: 0.7355, Best time: 35.0000
Epoch: 014/100, Runtime 0.396165, Loss 1.371045, forward nfe 4962, backward nfe 0, Train: 0.8500, Val: 0.7246, Test: 0.7355, Best time: 35.0000
Epoch: 015/100, Runtime 0.402249, Loss 1.398540, forward nfe 5296, backward nfe 0, Train: 0.8500, Val: 0.7246, Test: 0.7355, Best time: 35.0000
Epoch: 016/100, Runtime 0.408907, Loss 1.273525, forward nfe 5630, backward nfe 0, Train: 0.8500, Val: 0.7246, Test: 0.7355, Best time: 35.0000
Epoch: 017/100, Runtime 0.401803, Loss 1.195080, forward nfe 5970, backward nfe 0, Train: 0.8500, Val: 0.7246, Test: 0.7355, Best time: 35.0000
Epoch: 018/100, Runtime 0.391048, Loss 1.223462, forward nfe 6304, backward nfe 0, Train: 0.8500, Val: 0.7246, Test: 0.7355, Best time: 35.0000
Epoch: 019/100, Runtime 0.388906, Loss 1.129442, forward nfe 6632, backward nfe 0, Train: 0.8500, Val: 0.7246, Test: 0.7355, Best time: 35.0000
Epoch: 020/100, Runtime 0.374627, Loss 1.191635, forward nfe 6954, backward nfe 0, Train: 0.8667, Val: 0.7348, Test: 0.7290, Best time: 14.4524
Epoch: 021/100, Runtime 0.376851, Loss 1.168550, forward nfe 7270, backward nfe 0, Train: 0.8583, Val: 0.7442, Test: 0.7242, Best time: 12.7228
Epoch: 022/100, Runtime 0.375856, Loss 1.138056, forward nfe 7586, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 13.2975
Epoch: 023/100, Runtime 0.374012, Loss 1.071240, forward nfe 7896, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 024/100, Runtime 0.371433, Loss 1.166520, forward nfe 8194, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 025/100, Runtime 0.345378, Loss 1.105514, forward nfe 8492, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 026/100, Runtime 0.350211, Loss 1.155726, forward nfe 8784, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 027/100, Runtime 0.356281, Loss 1.138774, forward nfe 9082, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 028/100, Runtime 0.354880, Loss 1.003780, forward nfe 9368, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 029/100, Runtime 0.343951, Loss 1.019041, forward nfe 9654, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 030/100, Runtime 0.338267, Loss 1.112155, forward nfe 9934, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 031/100, Runtime 0.334426, Loss 1.044167, forward nfe 10214, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 032/100, Runtime 0.341823, Loss 1.009720, forward nfe 10482, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 033/100, Runtime 0.334536, Loss 0.968647, forward nfe 10756, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 034/100, Runtime 0.326839, Loss 0.910103, forward nfe 11030, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 035/100, Runtime 0.322745, Loss 1.053329, forward nfe 11292, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 036/100, Runtime 0.308371, Loss 0.924195, forward nfe 11554, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 037/100, Runtime 0.317523, Loss 1.034283, forward nfe 11816, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 038/100, Runtime 0.316726, Loss 1.048058, forward nfe 12072, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 039/100, Runtime 0.307905, Loss 0.959673, forward nfe 12328, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 040/100, Runtime 0.312846, Loss 0.993342, forward nfe 12572, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 041/100, Runtime 0.296823, Loss 1.089025, forward nfe 12816, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 042/100, Runtime 0.315104, Loss 1.034493, forward nfe 13054, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 043/100, Runtime 0.291659, Loss 1.002486, forward nfe 13292, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 044/100, Runtime 0.294570, Loss 1.011542, forward nfe 13530, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 045/100, Runtime 0.284168, Loss 1.106354, forward nfe 13762, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 046/100, Runtime 0.268776, Loss 1.041360, forward nfe 13994, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 047/100, Runtime 0.273356, Loss 0.974717, forward nfe 14220, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 048/100, Runtime 0.275714, Loss 0.981039, forward nfe 14446, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 049/100, Runtime 0.292211, Loss 1.001539, forward nfe 14672, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 050/100, Runtime 0.291950, Loss 0.926335, forward nfe 14898, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 051/100, Runtime 0.266913, Loss 0.902185, forward nfe 15124, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 052/100, Runtime 0.274251, Loss 1.043289, forward nfe 15350, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 053/100, Runtime 0.272027, Loss 0.977302, forward nfe 15576, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 054/100, Runtime 0.270814, Loss 1.077270, forward nfe 15802, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 055/100, Runtime 0.271439, Loss 1.087409, forward nfe 16028, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 056/100, Runtime 0.289935, Loss 1.023022, forward nfe 16254, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 057/100, Runtime 0.283443, Loss 1.126063, forward nfe 16486, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 058/100, Runtime 0.283346, Loss 0.996676, forward nfe 16718, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 059/100, Runtime 0.278999, Loss 0.984999, forward nfe 16950, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 060/100, Runtime 0.292513, Loss 0.908025, forward nfe 17176, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 061/100, Runtime 0.290849, Loss 1.057011, forward nfe 17402, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 062/100, Runtime 0.284086, Loss 0.983479, forward nfe 17628, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 063/100, Runtime 0.294290, Loss 0.982435, forward nfe 17854, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 064/100, Runtime 0.287995, Loss 1.014244, forward nfe 18080, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 065/100, Runtime 0.300934, Loss 0.955346, forward nfe 18312, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 066/100, Runtime 0.294900, Loss 0.995514, forward nfe 18544, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 067/100, Runtime 0.287276, Loss 1.061918, forward nfe 18776, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 068/100, Runtime 0.278661, Loss 1.105120, forward nfe 19008, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 069/100, Runtime 0.279975, Loss 1.033211, forward nfe 19240, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 070/100, Runtime 0.294421, Loss 1.017609, forward nfe 19472, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 071/100, Runtime 0.284762, Loss 0.991991, forward nfe 19704, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 072/100, Runtime 0.288279, Loss 1.148368, forward nfe 19936, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 073/100, Runtime 0.287938, Loss 1.081684, forward nfe 20168, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 074/100, Runtime 0.285964, Loss 1.035176, forward nfe 20400, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 075/100, Runtime 0.281361, Loss 1.013358, forward nfe 20632, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 076/100, Runtime 0.415541, Loss 1.081433, forward nfe 20864, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 077/100, Runtime 0.281430, Loss 0.943739, forward nfe 21096, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 078/100, Runtime 0.279934, Loss 0.971238, forward nfe 21328, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 079/100, Runtime 0.275714, Loss 0.948004, forward nfe 21560, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 080/100, Runtime 0.282155, Loss 1.020864, forward nfe 21792, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 081/100, Runtime 0.289688, Loss 1.051578, forward nfe 22024, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 082/100, Runtime 0.274017, Loss 0.962146, forward nfe 22250, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 083/100, Runtime 0.287922, Loss 0.990305, forward nfe 22476, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 084/100, Runtime 0.299058, Loss 1.031357, forward nfe 22708, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 085/100, Runtime 0.282568, Loss 1.014436, forward nfe 22940, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 086/100, Runtime 0.288923, Loss 1.005642, forward nfe 23172, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 087/100, Runtime 0.286159, Loss 0.917437, forward nfe 23404, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 088/100, Runtime 0.286251, Loss 0.874677, forward nfe 23636, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 089/100, Runtime 0.284706, Loss 1.077673, forward nfe 23868, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 090/100, Runtime 0.288751, Loss 0.972177, forward nfe 24100, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 091/100, Runtime 0.313711, Loss 0.944952, forward nfe 24332, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 092/100, Runtime 0.288399, Loss 0.951557, forward nfe 24564, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 093/100, Runtime 0.284534, Loss 0.953551, forward nfe 24796, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 094/100, Runtime 0.282763, Loss 0.901546, forward nfe 25022, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 095/100, Runtime 0.283775, Loss 0.875722, forward nfe 25248, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 096/100, Runtime 0.282674, Loss 0.891656, forward nfe 25474, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 097/100, Runtime 0.280180, Loss 0.952313, forward nfe 25700, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 098/100, Runtime 0.296282, Loss 1.033513, forward nfe 25926, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
Epoch: 099/100, Runtime 0.290090, Loss 1.014057, forward nfe 26152, backward nfe 0, Train: 0.8500, Val: 0.7500, Test: 0.7371, Best time: 35.0000
best val accuracy 0.750000 with test accuracy 0.737097 at epoch 22 and best time 35.000000