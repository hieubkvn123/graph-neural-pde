/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 2.805435, Loss 1.949300, forward nfe 98, backward nfe 0, Train: 0.5571, Val: 0.5735, Test: 0.5614, Best time: 5.5683
Epoch: 002/100, Runtime 2.817818, Loss 1.807201, forward nfe 456, backward nfe 0, Train: 0.5571, Val: 0.5735, Test: 0.5614, Best time: 45.0000
Epoch: 003/100, Runtime 2.683872, Loss 1.580635, forward nfe 808, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8152, Best time: 5.5087
Epoch: 004/100, Runtime 2.589266, Loss 1.241368, forward nfe 1154, backward nfe 0, Train: 0.8571, Val: 0.8199, Test: 0.8203, Best time: 10.3018
Epoch: 005/100, Runtime 2.602385, Loss 1.011159, forward nfe 1488, backward nfe 0, Train: 0.8571, Val: 0.8199, Test: 0.8203, Best time: 45.0000
Epoch: 006/100, Runtime 2.442908, Loss 0.783118, forward nfe 1816, backward nfe 0, Train: 0.8571, Val: 0.8199, Test: 0.8203, Best time: 45.0000
Epoch: 007/100, Runtime 2.415045, Loss 0.626832, forward nfe 2132, backward nfe 0, Train: 0.8571, Val: 0.8199, Test: 0.8203, Best time: 45.0000
Epoch: 008/100, Runtime 2.639964, Loss 0.513016, forward nfe 2448, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8416, Best time: 15.7556
Epoch: 009/100, Runtime 3.369733, Loss 0.420213, forward nfe 2752, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8416, Best time: 45.0000
Epoch: 010/100, Runtime 3.226648, Loss 0.416285, forward nfe 3056, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8416, Best time: 45.0000
Epoch: 011/100, Runtime 3.109247, Loss 0.337243, forward nfe 3348, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8416, Best time: 45.0000
Epoch: 012/100, Runtime 2.901267, Loss 0.349221, forward nfe 3622, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8416, Best time: 45.0000
Epoch: 013/100, Runtime 2.995741, Loss 0.321070, forward nfe 3884, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 42.7163
Epoch: 014/100, Runtime 2.949368, Loss 0.287026, forward nfe 4152, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 015/100, Runtime 2.825871, Loss 0.299888, forward nfe 4414, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 016/100, Runtime 2.810211, Loss 0.281078, forward nfe 4670, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 017/100, Runtime 2.674009, Loss 0.286404, forward nfe 4926, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 018/100, Runtime 2.749162, Loss 0.262405, forward nfe 5170, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 019/100, Runtime 2.564935, Loss 0.269666, forward nfe 5408, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 020/100, Runtime 2.551618, Loss 0.219750, forward nfe 5634, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 021/100, Runtime 2.549390, Loss 0.309238, forward nfe 5860, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 022/100, Runtime 2.553545, Loss 0.197643, forward nfe 6086, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 023/100, Runtime 2.426113, Loss 0.236251, forward nfe 6318, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 024/100, Runtime 2.366085, Loss 0.218895, forward nfe 6526, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 025/100, Runtime 2.230012, Loss 0.206021, forward nfe 6734, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 026/100, Runtime 2.157560, Loss 0.164615, forward nfe 6930, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 027/100, Runtime 2.291488, Loss 0.177561, forward nfe 7126, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 028/100, Runtime 2.288175, Loss 0.158687, forward nfe 7322, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 029/100, Runtime 2.262778, Loss 0.160899, forward nfe 7506, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 030/100, Runtime 2.187423, Loss 0.166568, forward nfe 7690, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 031/100, Runtime 2.194562, Loss 0.164638, forward nfe 7874, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 032/100, Runtime 0.616987, Loss 0.101219, forward nfe 8052, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 033/100, Runtime 0.673291, Loss 0.133011, forward nfe 8236, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 034/100, Runtime 0.697313, Loss 0.161419, forward nfe 8420, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 035/100, Runtime 0.726543, Loss 0.122188, forward nfe 8592, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 036/100, Runtime 0.665554, Loss 0.122590, forward nfe 8758, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 037/100, Runtime 0.767692, Loss 0.131709, forward nfe 8924, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 038/100, Runtime 0.616229, Loss 0.110969, forward nfe 9090, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 039/100, Runtime 0.703682, Loss 0.092960, forward nfe 9244, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 040/100, Runtime 0.634069, Loss 0.109331, forward nfe 9398, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 041/100, Runtime 0.653241, Loss 0.121411, forward nfe 9558, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 042/100, Runtime 0.660105, Loss 0.092008, forward nfe 9718, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 043/100, Runtime 0.594807, Loss 0.122544, forward nfe 9878, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 044/100, Runtime 0.579974, Loss 0.097528, forward nfe 10038, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 045/100, Runtime 0.663445, Loss 0.142418, forward nfe 10192, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 046/100, Runtime 0.596790, Loss 0.076870, forward nfe 10346, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 047/100, Runtime 0.594363, Loss 0.082813, forward nfe 10500, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 048/100, Runtime 0.680785, Loss 0.130606, forward nfe 10654, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 049/100, Runtime 0.591561, Loss 0.033821, forward nfe 10808, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 050/100, Runtime 0.585589, Loss 0.084570, forward nfe 10962, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 051/100, Runtime 0.671182, Loss 0.084771, forward nfe 11116, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 052/100, Runtime 0.593865, Loss 0.129753, forward nfe 11270, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 053/100, Runtime 0.575050, Loss 0.134611, forward nfe 11424, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 054/100, Runtime 0.565947, Loss 0.078313, forward nfe 11578, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 055/100, Runtime 0.614223, Loss 0.051802, forward nfe 11732, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 056/100, Runtime 0.637742, Loss 0.110033, forward nfe 11886, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 057/100, Runtime 0.589414, Loss 0.142863, forward nfe 12040, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 058/100, Runtime 0.570793, Loss 0.054356, forward nfe 12194, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 059/100, Runtime 0.562512, Loss 0.124143, forward nfe 12348, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 060/100, Runtime 0.623345, Loss 0.077878, forward nfe 12502, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 061/100, Runtime 0.617239, Loss 0.079669, forward nfe 12656, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 062/100, Runtime 0.584228, Loss 0.072336, forward nfe 12810, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 063/100, Runtime 0.570886, Loss 0.078807, forward nfe 12964, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 064/100, Runtime 0.576115, Loss 0.084004, forward nfe 13118, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 065/100, Runtime 0.666222, Loss 0.091011, forward nfe 13272, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 066/100, Runtime 0.594471, Loss 0.067450, forward nfe 13426, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 067/100, Runtime 0.563637, Loss 0.047497, forward nfe 13580, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 068/100, Runtime 0.559283, Loss 0.071160, forward nfe 13728, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 069/100, Runtime 0.577047, Loss 0.051177, forward nfe 13882, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 070/100, Runtime 0.674674, Loss 0.053129, forward nfe 14036, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 071/100, Runtime 0.584530, Loss 0.095266, forward nfe 14184, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 072/100, Runtime 0.559097, Loss 0.050037, forward nfe 14332, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 073/100, Runtime 0.565890, Loss 0.082378, forward nfe 14480, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 074/100, Runtime 0.596251, Loss 0.103553, forward nfe 14628, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 075/100, Runtime 0.631449, Loss 0.043780, forward nfe 14776, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 076/100, Runtime 0.576408, Loss 0.068116, forward nfe 14924, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 077/100, Runtime 0.553192, Loss 0.089523, forward nfe 15072, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 078/100, Runtime 0.570305, Loss 0.049146, forward nfe 15220, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 079/100, Runtime 0.558196, Loss 0.077777, forward nfe 15368, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 080/100, Runtime 0.663413, Loss 0.032232, forward nfe 15516, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 081/100, Runtime 0.582410, Loss 0.057014, forward nfe 15664, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 082/100, Runtime 0.565275, Loss 0.079710, forward nfe 15818, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 083/100, Runtime 0.583729, Loss 0.056989, forward nfe 15972, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 084/100, Runtime 0.604369, Loss 0.063629, forward nfe 16120, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 085/100, Runtime 0.625051, Loss 0.027725, forward nfe 16274, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 086/100, Runtime 0.582065, Loss 0.037721, forward nfe 16428, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 087/100, Runtime 0.581814, Loss 0.074077, forward nfe 16582, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 088/100, Runtime 0.660695, Loss 0.113046, forward nfe 16730, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 089/100, Runtime 0.581804, Loss 0.036874, forward nfe 16878, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 090/100, Runtime 0.550436, Loss 0.074145, forward nfe 17020, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 091/100, Runtime 0.571569, Loss 0.061112, forward nfe 17162, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 092/100, Runtime 0.529229, Loss 0.068194, forward nfe 17304, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 093/100, Runtime 0.544897, Loss 0.027036, forward nfe 17446, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 094/100, Runtime 0.542082, Loss 0.032146, forward nfe 17588, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 095/100, Runtime 0.541274, Loss 0.047988, forward nfe 17730, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 096/100, Runtime 0.548895, Loss 0.070130, forward nfe 17872, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 097/100, Runtime 0.598839, Loss 0.065775, forward nfe 18014, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 098/100, Runtime 0.598878, Loss 0.059670, forward nfe 18156, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
Epoch: 099/100, Runtime 0.571628, Loss 0.125109, forward nfe 18298, backward nfe 0, Train: 0.9643, Val: 0.8463, Test: 0.8487, Best time: 45.0000
best val accuracy 0.846324 with test accuracy 0.848731 at epoch 13 and best time 45.000000