/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 3.740592, Loss 1.947756, forward nfe 80, backward nfe 0, Train: 0.4857, Val: 0.3588, Test: 0.3817, Best time: 3.7630
Epoch: 002/100, Runtime 3.734201, Loss 1.945823, forward nfe 372, backward nfe 0, Train: 0.4857, Val: 0.3588, Test: 0.3817, Best time: 35.0000
Epoch: 003/100, Runtime 3.664479, Loss 1.876860, forward nfe 658, backward nfe 0, Train: 0.4214, Val: 0.3956, Test: 0.4041, Best time: 2.2702
Epoch: 004/100, Runtime 3.724718, Loss 1.736153, forward nfe 932, backward nfe 0, Train: 0.6357, Val: 0.5309, Test: 0.5492, Best time: 5.5166
Epoch: 005/100, Runtime 3.401217, Loss 1.509589, forward nfe 1212, backward nfe 0, Train: 0.6357, Val: 0.5309, Test: 0.5492, Best time: 35.0000
Epoch: 006/100, Runtime 3.602602, Loss 1.282508, forward nfe 1480, backward nfe 0, Train: 0.6929, Val: 0.5684, Test: 0.5746, Best time: 5.7639
Epoch: 007/100, Runtime 3.318268, Loss 1.080947, forward nfe 1742, backward nfe 0, Train: 0.8214, Val: 0.7096, Test: 0.7005, Best time: 5.9116
Epoch: 008/100, Runtime 3.347278, Loss 0.893499, forward nfe 1998, backward nfe 0, Train: 0.9143, Val: 0.8015, Test: 0.8000, Best time: 11.2121
Epoch: 009/100, Runtime 3.303379, Loss 0.708329, forward nfe 2254, backward nfe 0, Train: 0.9000, Val: 0.8287, Test: 0.8132, Best time: 34.6602
Epoch: 010/100, Runtime 3.198900, Loss 0.589079, forward nfe 2504, backward nfe 0, Train: 0.9000, Val: 0.8287, Test: 0.8132, Best time: 35.0000
Epoch: 011/100, Runtime 3.084125, Loss 0.490687, forward nfe 2736, backward nfe 0, Train: 0.9000, Val: 0.8287, Test: 0.8132, Best time: 35.0000
Epoch: 012/100, Runtime 3.097333, Loss 0.439727, forward nfe 2968, backward nfe 0, Train: 0.9000, Val: 0.8287, Test: 0.8132, Best time: 35.0000
Epoch: 013/100, Runtime 2.938054, Loss 0.382011, forward nfe 3200, backward nfe 0, Train: 0.9357, Val: 0.8397, Test: 0.8173, Best time: 18.2967
Epoch: 014/100, Runtime 3.059985, Loss 0.364659, forward nfe 3432, backward nfe 0, Train: 0.9357, Val: 0.8397, Test: 0.8173, Best time: 35.0000
Epoch: 015/100, Runtime 2.858090, Loss 0.332453, forward nfe 3658, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 20.2251
Epoch: 016/100, Runtime 2.642460, Loss 0.306621, forward nfe 3866, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 017/100, Runtime 2.781230, Loss 0.313371, forward nfe 4068, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 018/100, Runtime 2.771700, Loss 0.339186, forward nfe 4270, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 019/100, Runtime 2.610368, Loss 0.266019, forward nfe 4472, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 020/100, Runtime 2.546218, Loss 0.250158, forward nfe 4680, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 021/100, Runtime 2.524981, Loss 0.307325, forward nfe 4870, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 022/100, Runtime 2.474360, Loss 0.180214, forward nfe 5054, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 023/100, Runtime 2.467203, Loss 0.262060, forward nfe 5238, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 024/100, Runtime 2.309950, Loss 0.214620, forward nfe 5416, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 025/100, Runtime 2.404819, Loss 0.227060, forward nfe 5588, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 026/100, Runtime 2.428952, Loss 0.179919, forward nfe 5772, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 027/100, Runtime 2.474349, Loss 0.228991, forward nfe 5962, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 028/100, Runtime 2.326951, Loss 0.187457, forward nfe 6140, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 029/100, Runtime 2.370382, Loss 0.205087, forward nfe 6312, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 030/100, Runtime 2.166803, Loss 0.196269, forward nfe 6484, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 031/100, Runtime 2.156534, Loss 0.207934, forward nfe 6644, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 032/100, Runtime 2.266671, Loss 0.190522, forward nfe 6804, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 033/100, Runtime 2.273761, Loss 0.173557, forward nfe 6970, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 034/100, Runtime 2.247637, Loss 0.177595, forward nfe 7136, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 035/100, Runtime 2.275682, Loss 0.143402, forward nfe 7302, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 036/100, Runtime 2.381038, Loss 0.177670, forward nfe 7480, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 037/100, Runtime 2.296751, Loss 0.175841, forward nfe 7658, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 038/100, Runtime 2.321698, Loss 0.162350, forward nfe 7836, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 039/100, Runtime 2.479321, Loss 0.174534, forward nfe 8014, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 040/100, Runtime 2.311027, Loss 0.157331, forward nfe 8192, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 041/100, Runtime 2.316729, Loss 0.179635, forward nfe 8364, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 042/100, Runtime 2.334185, Loss 0.113467, forward nfe 8536, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 043/100, Runtime 2.357684, Loss 0.152411, forward nfe 8708, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 044/100, Runtime 2.296300, Loss 0.128160, forward nfe 8880, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 045/100, Runtime 2.276253, Loss 0.152622, forward nfe 9052, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 046/100, Runtime 2.249738, Loss 0.151043, forward nfe 9224, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 047/100, Runtime 2.428024, Loss 0.135851, forward nfe 9396, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 048/100, Runtime 2.276577, Loss 0.150030, forward nfe 9574, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 049/100, Runtime 2.439201, Loss 0.138037, forward nfe 9752, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 050/100, Runtime 2.372497, Loss 0.092040, forward nfe 9930, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 051/100, Runtime 2.388842, Loss 0.119825, forward nfe 10108, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 052/100, Runtime 2.484937, Loss 0.072136, forward nfe 10286, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 053/100, Runtime 2.335932, Loss 0.122082, forward nfe 10464, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 054/100, Runtime 2.361761, Loss 0.097696, forward nfe 10642, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 055/100, Runtime 2.371737, Loss 0.086629, forward nfe 10820, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 056/100, Runtime 2.352102, Loss 0.084377, forward nfe 10998, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 057/100, Runtime 2.381922, Loss 0.100074, forward nfe 11176, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 058/100, Runtime 2.408352, Loss 0.113751, forward nfe 11354, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 059/100, Runtime 2.426773, Loss 0.083152, forward nfe 11532, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 060/100, Runtime 2.392731, Loss 0.106378, forward nfe 11710, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 061/100, Runtime 2.535107, Loss 0.077800, forward nfe 11888, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 062/100, Runtime 2.291519, Loss 0.141026, forward nfe 12066, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 063/100, Runtime 2.423184, Loss 0.066490, forward nfe 12244, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 064/100, Runtime 2.359142, Loss 0.120574, forward nfe 12422, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 065/100, Runtime 2.330150, Loss 0.100487, forward nfe 12600, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 066/100, Runtime 2.424833, Loss 0.081662, forward nfe 12778, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 067/100, Runtime 2.293798, Loss 0.119308, forward nfe 12944, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 068/100, Runtime 2.464822, Loss 0.094128, forward nfe 13122, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 069/100, Runtime 2.384449, Loss 0.102103, forward nfe 13300, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 070/100, Runtime 2.486640, Loss 0.085055, forward nfe 13478, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 071/100, Runtime 2.256417, Loss 0.082888, forward nfe 13644, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 072/100, Runtime 2.239117, Loss 0.075885, forward nfe 13810, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 073/100, Runtime 2.275513, Loss 0.050546, forward nfe 13976, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 074/100, Runtime 2.309125, Loss 0.058996, forward nfe 14142, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 075/100, Runtime 2.235673, Loss 0.071421, forward nfe 14308, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 076/100, Runtime 2.217880, Loss 0.050486, forward nfe 14468, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 077/100, Runtime 2.187694, Loss 0.075802, forward nfe 14628, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 078/100, Runtime 2.172083, Loss 0.062948, forward nfe 14788, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 079/100, Runtime 2.175042, Loss 0.041817, forward nfe 14948, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 080/100, Runtime 2.186943, Loss 0.045058, forward nfe 15108, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 081/100, Runtime 2.147285, Loss 0.059352, forward nfe 15268, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 082/100, Runtime 2.238543, Loss 0.060497, forward nfe 15428, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 083/100, Runtime 2.231967, Loss 0.039954, forward nfe 15588, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 084/100, Runtime 2.200863, Loss 0.082002, forward nfe 15748, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 085/100, Runtime 2.214999, Loss 0.051881, forward nfe 15908, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 086/100, Runtime 2.220266, Loss 0.057762, forward nfe 16068, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 087/100, Runtime 2.266800, Loss 0.041496, forward nfe 16228, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 088/100, Runtime 2.097559, Loss 0.051569, forward nfe 16388, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 089/100, Runtime 2.120288, Loss 0.041488, forward nfe 16542, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 090/100, Runtime 2.191632, Loss 0.047223, forward nfe 16696, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 091/100, Runtime 2.167990, Loss 0.051447, forward nfe 16856, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 092/100, Runtime 2.083896, Loss 0.050958, forward nfe 17016, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 093/100, Runtime 2.113827, Loss 0.049672, forward nfe 17170, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 094/100, Runtime 2.097861, Loss 0.044904, forward nfe 17324, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 095/100, Runtime 2.078972, Loss 0.057810, forward nfe 17478, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 096/100, Runtime 2.188941, Loss 0.054309, forward nfe 17632, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 097/100, Runtime 2.369275, Loss 0.070843, forward nfe 17792, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 098/100, Runtime 2.459860, Loss 0.033536, forward nfe 17964, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
Epoch: 099/100, Runtime 2.335368, Loss 0.043042, forward nfe 18136, backward nfe 0, Train: 0.9214, Val: 0.8471, Test: 0.8142, Best time: 35.0000
best val accuracy 0.847059 with test accuracy 0.814213 at epoch 15 and best time 35.000000