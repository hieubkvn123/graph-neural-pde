/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.635215, Loss 1.796250, forward nfe 158, backward nfe 0, Train: 0.1667, Val: 0.2275, Test: 0.2081, Best time: 111.9295
Epoch: 002/100, Runtime 0.560571, Loss 1.784933, forward nfe 642, backward nfe 0, Train: 0.1667, Val: 0.2275, Test: 0.2081, Best time: 50.0000
Epoch: 003/100, Runtime 0.562335, Loss 1.764418, forward nfe 1132, backward nfe 0, Train: 0.1667, Val: 0.2275, Test: 0.2081, Best time: 50.0000
Epoch: 004/100, Runtime 0.550119, Loss 1.741928, forward nfe 1616, backward nfe 0, Train: 0.1667, Val: 0.2275, Test: 0.2081, Best time: 50.0000
Epoch: 005/100, Runtime 0.555871, Loss 1.727800, forward nfe 2094, backward nfe 0, Train: 0.1667, Val: 0.2275, Test: 0.2081, Best time: 50.0000
Epoch: 006/100, Runtime 0.540148, Loss 1.713779, forward nfe 2566, backward nfe 0, Train: 0.4750, Val: 0.3065, Test: 0.3145, Best time: 0.3191
Epoch: 007/100, Runtime 0.532185, Loss 1.691868, forward nfe 3032, backward nfe 0, Train: 0.6083, Val: 0.4986, Test: 0.4774, Best time: 10.7581
Epoch: 008/100, Runtime 0.524684, Loss 1.672838, forward nfe 3498, backward nfe 0, Train: 0.7167, Val: 0.5754, Test: 0.5274, Best time: 30.3424
Epoch: 009/100, Runtime 0.530592, Loss 1.635048, forward nfe 3946, backward nfe 0, Train: 0.7167, Val: 0.5754, Test: 0.5274, Best time: 50.0000
Epoch: 010/100, Runtime 0.505320, Loss 1.643664, forward nfe 4394, backward nfe 0, Train: 0.7167, Val: 0.5754, Test: 0.5274, Best time: 50.0000
Epoch: 011/100, Runtime 0.520517, Loss 1.615410, forward nfe 4836, backward nfe 0, Train: 0.7167, Val: 0.5754, Test: 0.5274, Best time: 50.0000
Epoch: 012/100, Runtime 0.515162, Loss 1.571705, forward nfe 5272, backward nfe 0, Train: 0.7167, Val: 0.5754, Test: 0.5274, Best time: 50.0000
Epoch: 013/100, Runtime 0.490451, Loss 1.559308, forward nfe 5696, backward nfe 0, Train: 0.7167, Val: 0.5754, Test: 0.5274, Best time: 50.0000
Epoch: 014/100, Runtime 0.468036, Loss 1.482504, forward nfe 6108, backward nfe 0, Train: 0.7333, Val: 0.5797, Test: 0.5371, Best time: 7.9910
Epoch: 015/100, Runtime 0.471755, Loss 1.442465, forward nfe 6526, backward nfe 0, Train: 0.7167, Val: 0.6101, Test: 0.5645, Best time: 6.7631
Epoch: 016/100, Runtime 0.468063, Loss 1.420493, forward nfe 6944, backward nfe 0, Train: 0.7500, Val: 0.6399, Test: 0.6081, Best time: 11.5391
Epoch: 017/100, Runtime 0.476010, Loss 1.332917, forward nfe 7368, backward nfe 0, Train: 0.8083, Val: 0.6732, Test: 0.6565, Best time: 27.4203
Epoch: 018/100, Runtime 0.464408, Loss 1.297655, forward nfe 7780, backward nfe 0, Train: 0.8333, Val: 0.7196, Test: 0.6790, Best time: 14.1661
Epoch: 019/100, Runtime 0.470402, Loss 1.252899, forward nfe 8186, backward nfe 0, Train: 0.8250, Val: 0.7493, Test: 0.6935, Best time: 10.4415
Epoch: 020/100, Runtime 0.453764, Loss 1.282759, forward nfe 8574, backward nfe 0, Train: 0.8417, Val: 0.7507, Test: 0.6935, Best time: 10.7744
Epoch: 021/100, Runtime 0.440607, Loss 1.253838, forward nfe 8962, backward nfe 0, Train: 0.8417, Val: 0.7507, Test: 0.6935, Best time: 50.0000
Epoch: 022/100, Runtime 0.447239, Loss 1.123101, forward nfe 9350, backward nfe 0, Train: 0.8417, Val: 0.7507, Test: 0.6935, Best time: 50.0000
Epoch: 023/100, Runtime 0.432505, Loss 1.197788, forward nfe 9732, backward nfe 0, Train: 0.8417, Val: 0.7507, Test: 0.6935, Best time: 50.0000
Epoch: 024/100, Runtime 0.441966, Loss 1.185639, forward nfe 10102, backward nfe 0, Train: 0.8417, Val: 0.7507, Test: 0.6935, Best time: 50.0000
Epoch: 025/100, Runtime 0.427892, Loss 1.114216, forward nfe 10472, backward nfe 0, Train: 0.8417, Val: 0.7522, Test: 0.7226, Best time: 17.5908
Epoch: 026/100, Runtime 0.418591, Loss 1.201685, forward nfe 10830, backward nfe 0, Train: 0.8333, Val: 0.7551, Test: 0.7258, Best time: 21.9402
Epoch: 027/100, Runtime 0.411784, Loss 1.119597, forward nfe 11194, backward nfe 0, Train: 0.8333, Val: 0.7551, Test: 0.7258, Best time: 50.0000
Epoch: 028/100, Runtime 0.401346, Loss 1.130524, forward nfe 11534, backward nfe 0, Train: 0.8333, Val: 0.7551, Test: 0.7258, Best time: 50.0000
Epoch: 029/100, Runtime 0.396326, Loss 1.087963, forward nfe 11874, backward nfe 0, Train: 0.8333, Val: 0.7551, Test: 0.7258, Best time: 50.0000
Epoch: 030/100, Runtime 0.388162, Loss 1.149332, forward nfe 12208, backward nfe 0, Train: 0.8333, Val: 0.7551, Test: 0.7258, Best time: 50.0000
Epoch: 031/100, Runtime 0.386341, Loss 1.126590, forward nfe 12542, backward nfe 0, Train: 0.8333, Val: 0.7551, Test: 0.7258, Best time: 50.0000
Epoch: 032/100, Runtime 0.379118, Loss 1.086105, forward nfe 12870, backward nfe 0, Train: 0.7917, Val: 0.7565, Test: 0.7048, Best time: 3.9061
Epoch: 033/100, Runtime 0.380226, Loss 1.087052, forward nfe 13192, backward nfe 0, Train: 0.7833, Val: 0.7609, Test: 0.7065, Best time: 5.3821
Epoch: 034/100, Runtime 0.381769, Loss 1.035844, forward nfe 13514, backward nfe 0, Train: 0.7833, Val: 0.7609, Test: 0.7065, Best time: 50.0000
Epoch: 035/100, Runtime 0.370678, Loss 1.098950, forward nfe 13836, backward nfe 0, Train: 0.7833, Val: 0.7609, Test: 0.7065, Best time: 50.0000
Epoch: 036/100, Runtime 0.374771, Loss 1.041099, forward nfe 14146, backward nfe 0, Train: 0.7833, Val: 0.7609, Test: 0.7065, Best time: 50.0000
Epoch: 037/100, Runtime 0.367014, Loss 1.152433, forward nfe 14456, backward nfe 0, Train: 0.7833, Val: 0.7609, Test: 0.7065, Best time: 50.0000
Epoch: 038/100, Runtime 0.376257, Loss 1.032678, forward nfe 14766, backward nfe 0, Train: 0.7833, Val: 0.7609, Test: 0.7065, Best time: 50.0000
Epoch: 039/100, Runtime 0.383191, Loss 0.998753, forward nfe 15076, backward nfe 0, Train: 0.7833, Val: 0.7609, Test: 0.7065, Best time: 50.0000
Epoch: 040/100, Runtime 0.366604, Loss 1.057898, forward nfe 15380, backward nfe 0, Train: 0.7833, Val: 0.7609, Test: 0.7065, Best time: 50.0000
Epoch: 041/100, Runtime 0.373091, Loss 1.097543, forward nfe 15684, backward nfe 0, Train: 0.7833, Val: 0.7609, Test: 0.7065, Best time: 50.0000
Epoch: 042/100, Runtime 0.366210, Loss 1.098451, forward nfe 15982, backward nfe 0, Train: 0.8417, Val: 0.7703, Test: 0.7161, Best time: 13.8180
Epoch: 043/100, Runtime 0.363161, Loss 1.147313, forward nfe 16274, backward nfe 0, Train: 0.8417, Val: 0.7703, Test: 0.7161, Best time: 50.0000
Epoch: 044/100, Runtime 0.339144, Loss 1.041978, forward nfe 16566, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 11.7559
Epoch: 045/100, Runtime 0.346999, Loss 1.116366, forward nfe 16852, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 046/100, Runtime 0.345283, Loss 1.102932, forward nfe 17132, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 047/100, Runtime 0.347908, Loss 1.043003, forward nfe 17418, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 048/100, Runtime 0.326161, Loss 1.080369, forward nfe 17692, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 049/100, Runtime 0.329566, Loss 1.118773, forward nfe 17960, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 050/100, Runtime 0.339697, Loss 1.237592, forward nfe 18228, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 051/100, Runtime 0.348395, Loss 1.181777, forward nfe 18502, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 052/100, Runtime 0.334848, Loss 1.210837, forward nfe 18770, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 053/100, Runtime 0.336305, Loss 1.178277, forward nfe 19038, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 054/100, Runtime 0.326346, Loss 1.100990, forward nfe 19300, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 055/100, Runtime 0.321940, Loss 1.207987, forward nfe 19562, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 056/100, Runtime 0.323526, Loss 1.006897, forward nfe 19824, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 057/100, Runtime 0.324016, Loss 1.098119, forward nfe 20098, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 058/100, Runtime 0.331685, Loss 1.095643, forward nfe 20372, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 059/100, Runtime 0.333707, Loss 1.052758, forward nfe 20646, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 060/100, Runtime 0.328269, Loss 1.074194, forward nfe 20920, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 061/100, Runtime 0.326216, Loss 1.005572, forward nfe 21194, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 062/100, Runtime 0.323023, Loss 1.104255, forward nfe 21468, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 063/100, Runtime 0.470218, Loss 1.122176, forward nfe 21742, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 064/100, Runtime 0.331304, Loss 1.042358, forward nfe 22016, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 065/100, Runtime 0.318142, Loss 1.018566, forward nfe 22284, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 066/100, Runtime 0.318733, Loss 1.088436, forward nfe 22552, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 067/100, Runtime 0.331407, Loss 1.187429, forward nfe 22820, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 068/100, Runtime 0.329167, Loss 0.942341, forward nfe 23088, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 069/100, Runtime 0.323635, Loss 1.189369, forward nfe 23362, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 070/100, Runtime 0.325242, Loss 1.158592, forward nfe 23630, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 071/100, Runtime 0.321459, Loss 1.146322, forward nfe 23898, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 072/100, Runtime 0.319171, Loss 1.208910, forward nfe 24166, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 073/100, Runtime 0.353010, Loss 1.122758, forward nfe 24434, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 074/100, Runtime 0.327770, Loss 1.185052, forward nfe 24702, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 075/100, Runtime 0.327083, Loss 1.188508, forward nfe 24970, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 076/100, Runtime 0.321076, Loss 1.215100, forward nfe 25238, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 077/100, Runtime 0.327484, Loss 1.060551, forward nfe 25506, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 078/100, Runtime 0.325526, Loss 1.145616, forward nfe 25774, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 079/100, Runtime 0.325280, Loss 0.990837, forward nfe 26042, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 080/100, Runtime 0.325664, Loss 1.022076, forward nfe 26310, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 081/100, Runtime 0.326106, Loss 1.129741, forward nfe 26578, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 082/100, Runtime 0.320989, Loss 1.108354, forward nfe 26846, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 083/100, Runtime 0.308718, Loss 1.076933, forward nfe 27114, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 084/100, Runtime 0.322495, Loss 1.041754, forward nfe 27370, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 085/100, Runtime 0.331895, Loss 1.163579, forward nfe 27638, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 086/100, Runtime 0.329322, Loss 1.074527, forward nfe 27906, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 087/100, Runtime 0.340458, Loss 1.072464, forward nfe 28168, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 088/100, Runtime 0.324692, Loss 1.015396, forward nfe 28430, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 089/100, Runtime 0.319834, Loss 1.114547, forward nfe 28686, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 090/100, Runtime 0.327860, Loss 1.093004, forward nfe 28942, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 091/100, Runtime 0.328249, Loss 1.069569, forward nfe 29198, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 092/100, Runtime 0.317403, Loss 1.161563, forward nfe 29460, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 093/100, Runtime 0.340860, Loss 1.133397, forward nfe 29722, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 094/100, Runtime 0.328609, Loss 1.091186, forward nfe 29990, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 095/100, Runtime 0.337590, Loss 1.080396, forward nfe 30258, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 096/100, Runtime 0.313646, Loss 1.066414, forward nfe 30514, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 097/100, Runtime 0.314417, Loss 0.980589, forward nfe 30770, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 098/100, Runtime 0.309149, Loss 0.962642, forward nfe 31026, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
Epoch: 099/100, Runtime 0.325098, Loss 0.984262, forward nfe 31282, backward nfe 0, Train: 0.8083, Val: 0.7790, Test: 0.7323, Best time: 50.0000
best val accuracy 0.778986 with test accuracy 0.732258 at epoch 44 and best time 50.000000