/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 3.695412, Loss 1.946143, forward nfe 74, backward nfe 0, Train: 0.2071, Val: 0.1309, Test: 0.1289, Best time: 0.0903
Epoch: 002/100, Runtime 3.749943, Loss 1.878992, forward nfe 342, backward nfe 0, Train: 0.6071, Val: 0.4390, Test: 0.4264, Best time: 0.0885
Epoch: 003/100, Runtime 3.590167, Loss 1.727467, forward nfe 598, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7015, Best time: 12.5616
Epoch: 004/100, Runtime 3.528232, Loss 1.553330, forward nfe 848, backward nfe 0, Train: 0.8500, Val: 0.7618, Test: 0.7462, Best time: 16.6625
Epoch: 005/100, Runtime 3.429811, Loss 1.349712, forward nfe 1098, backward nfe 0, Train: 0.8643, Val: 0.7824, Test: 0.7675, Best time: 13.0209
Epoch: 006/100, Runtime 3.444000, Loss 1.113112, forward nfe 1342, backward nfe 0, Train: 0.8643, Val: 0.8074, Test: 0.8071, Best time: 13.3667
Epoch: 007/100, Runtime 3.353581, Loss 0.834136, forward nfe 1586, backward nfe 0, Train: 0.8857, Val: 0.8125, Test: 0.8122, Best time: 7.8877
Epoch: 008/100, Runtime 3.141177, Loss 0.640402, forward nfe 1812, backward nfe 0, Train: 0.8857, Val: 0.8206, Test: 0.8173, Best time: 10.8564
Epoch: 009/100, Runtime 3.151587, Loss 0.462877, forward nfe 2032, backward nfe 0, Train: 0.9071, Val: 0.8324, Test: 0.8223, Best time: 14.8118
Epoch: 010/100, Runtime 3.093095, Loss 0.378001, forward nfe 2252, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 20.2973
Epoch: 011/100, Runtime 3.114959, Loss 0.324997, forward nfe 2466, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 012/100, Runtime 3.062639, Loss 0.279969, forward nfe 2680, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 013/100, Runtime 3.026557, Loss 0.257889, forward nfe 2900, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 014/100, Runtime 2.799414, Loss 0.244886, forward nfe 3102, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 015/100, Runtime 2.871268, Loss 0.223826, forward nfe 3298, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 016/100, Runtime 2.643101, Loss 0.231434, forward nfe 3494, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 017/100, Runtime 2.667866, Loss 0.202749, forward nfe 3684, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 018/100, Runtime 2.602058, Loss 0.193296, forward nfe 3868, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 019/100, Runtime 2.542099, Loss 0.180281, forward nfe 4046, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 020/100, Runtime 2.566880, Loss 0.210543, forward nfe 4224, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 021/100, Runtime 2.628405, Loss 0.185703, forward nfe 4402, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 022/100, Runtime 2.236708, Loss 0.156866, forward nfe 4586, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 023/100, Runtime 1.201637, Loss 0.194306, forward nfe 4758, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 024/100, Runtime 1.255170, Loss 0.168081, forward nfe 4924, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 025/100, Runtime 1.225670, Loss 0.159377, forward nfe 5090, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 026/100, Runtime 1.206568, Loss 0.195203, forward nfe 5250, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 027/100, Runtime 1.263778, Loss 0.154369, forward nfe 5416, backward nfe 0, Train: 0.9214, Val: 0.8426, Test: 0.8305, Best time: 30.0000
Epoch: 028/100, Runtime 1.279645, Loss 0.141844, forward nfe 5576, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 44.2108
Epoch: 029/100, Runtime 1.288363, Loss 0.218603, forward nfe 5736, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 030/100, Runtime 1.261195, Loss 0.158060, forward nfe 5896, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 031/100, Runtime 1.263262, Loss 0.141928, forward nfe 6056, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 032/100, Runtime 1.113266, Loss 0.129364, forward nfe 6216, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 033/100, Runtime 1.243683, Loss 0.152070, forward nfe 6370, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 034/100, Runtime 1.212547, Loss 0.164358, forward nfe 6524, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 035/100, Runtime 1.220877, Loss 0.133013, forward nfe 6678, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 036/100, Runtime 1.235525, Loss 0.114577, forward nfe 6832, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 037/100, Runtime 1.242886, Loss 0.140280, forward nfe 6992, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 038/100, Runtime 1.273642, Loss 0.143869, forward nfe 7152, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 039/100, Runtime 1.278391, Loss 0.119599, forward nfe 7312, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 040/100, Runtime 1.266291, Loss 0.125843, forward nfe 7466, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 041/100, Runtime 1.269368, Loss 0.113509, forward nfe 7620, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 042/100, Runtime 1.579983, Loss 0.119209, forward nfe 7774, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 043/100, Runtime 1.611772, Loss 0.123222, forward nfe 7928, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 044/100, Runtime 1.574695, Loss 0.087972, forward nfe 8076, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 045/100, Runtime 1.566417, Loss 0.103601, forward nfe 8224, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 046/100, Runtime 1.584981, Loss 0.120451, forward nfe 8372, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 047/100, Runtime 1.579676, Loss 0.140086, forward nfe 8520, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 048/100, Runtime 1.584591, Loss 0.089553, forward nfe 8668, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 049/100, Runtime 1.631017, Loss 0.081496, forward nfe 8816, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 050/100, Runtime 1.590621, Loss 0.106912, forward nfe 8964, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 051/100, Runtime 1.586231, Loss 0.089924, forward nfe 9112, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 052/100, Runtime 1.573464, Loss 0.118169, forward nfe 9260, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 053/100, Runtime 1.558038, Loss 0.071467, forward nfe 9408, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 054/100, Runtime 1.590362, Loss 0.058274, forward nfe 9556, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 055/100, Runtime 1.549641, Loss 0.089172, forward nfe 9704, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 056/100, Runtime 1.610178, Loss 0.092933, forward nfe 9852, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 057/100, Runtime 1.586031, Loss 0.052212, forward nfe 10000, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 058/100, Runtime 1.581345, Loss 0.084618, forward nfe 10148, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 059/100, Runtime 1.563355, Loss 0.079780, forward nfe 10296, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 060/100, Runtime 1.461260, Loss 0.075813, forward nfe 10438, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 061/100, Runtime 1.504327, Loss 0.081521, forward nfe 10580, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 062/100, Runtime 1.553333, Loss 0.063764, forward nfe 10722, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 063/100, Runtime 1.497949, Loss 0.095958, forward nfe 10864, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 064/100, Runtime 1.420655, Loss 0.090586, forward nfe 11006, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 065/100, Runtime 1.521325, Loss 0.060951, forward nfe 11142, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 066/100, Runtime 1.397670, Loss 0.067259, forward nfe 11278, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 067/100, Runtime 1.486526, Loss 0.045622, forward nfe 11414, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 068/100, Runtime 1.472193, Loss 0.046344, forward nfe 11550, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 069/100, Runtime 1.442871, Loss 0.064348, forward nfe 11686, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 070/100, Runtime 1.513625, Loss 0.066014, forward nfe 11822, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 071/100, Runtime 1.345539, Loss 0.077320, forward nfe 11958, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 072/100, Runtime 1.492658, Loss 0.063566, forward nfe 12094, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 073/100, Runtime 1.408851, Loss 0.062806, forward nfe 12230, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 074/100, Runtime 1.449231, Loss 0.063071, forward nfe 12366, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 075/100, Runtime 1.425342, Loss 0.057936, forward nfe 12502, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 076/100, Runtime 1.527302, Loss 0.049263, forward nfe 12638, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 077/100, Runtime 1.454300, Loss 0.049167, forward nfe 12774, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 078/100, Runtime 1.443053, Loss 0.088966, forward nfe 12910, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 079/100, Runtime 1.459915, Loss 0.049746, forward nfe 13046, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 080/100, Runtime 1.439831, Loss 0.059859, forward nfe 13182, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 081/100, Runtime 1.507864, Loss 0.033489, forward nfe 13318, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 082/100, Runtime 1.368266, Loss 0.074512, forward nfe 13454, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 083/100, Runtime 1.436198, Loss 0.060372, forward nfe 13590, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 084/100, Runtime 1.426424, Loss 0.060767, forward nfe 13720, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 085/100, Runtime 1.457903, Loss 0.056278, forward nfe 13850, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 086/100, Runtime 1.387670, Loss 0.055921, forward nfe 13980, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 087/100, Runtime 1.459448, Loss 0.023919, forward nfe 14110, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 088/100, Runtime 1.370459, Loss 0.051569, forward nfe 14240, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 089/100, Runtime 1.395576, Loss 0.034067, forward nfe 14370, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 090/100, Runtime 1.401420, Loss 0.059985, forward nfe 14500, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 091/100, Runtime 1.481134, Loss 0.026684, forward nfe 14636, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 092/100, Runtime 1.383542, Loss 0.037895, forward nfe 14766, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 093/100, Runtime 1.427589, Loss 0.058884, forward nfe 14896, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 094/100, Runtime 1.325367, Loss 0.024297, forward nfe 15026, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 095/100, Runtime 1.321158, Loss 0.033448, forward nfe 15150, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 096/100, Runtime 1.345800, Loss 0.035001, forward nfe 15274, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 097/100, Runtime 1.328519, Loss 0.036434, forward nfe 15398, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 098/100, Runtime 1.374438, Loss 0.045169, forward nfe 15528, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
Epoch: 099/100, Runtime 1.381116, Loss 0.040607, forward nfe 15658, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 30.0000
best val accuracy 0.845588 with test accuracy 0.850761 at epoch 28 and best time 30.000000