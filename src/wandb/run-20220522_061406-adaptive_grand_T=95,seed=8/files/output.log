/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 5.394212, Loss 1.946996, forward nfe 176, backward nfe 0, Train: 0.3357, Val: 0.2934, Test: 0.3015, Best time: 0.0938
Epoch: 002/100, Runtime 5.400913, Loss 2.000972, forward nfe 858, backward nfe 0, Train: 0.3357, Val: 0.2934, Test: 0.3015, Best time: 95.0000
Epoch: 003/100, Runtime 5.268536, Loss 1.958844, forward nfe 1522, backward nfe 0, Train: 0.3357, Val: 0.2934, Test: 0.3015, Best time: 95.0000
Epoch: 004/100, Runtime 4.938495, Loss 1.925927, forward nfe 2192, backward nfe 0, Train: 0.3357, Val: 0.2934, Test: 0.3015, Best time: 95.0000
Epoch: 005/100, Runtime 4.850476, Loss 1.890419, forward nfe 2844, backward nfe 0, Train: 0.4000, Val: 0.3890, Test: 0.3970, Best time: 32.3967
Epoch: 006/100, Runtime 4.729413, Loss 1.811888, forward nfe 3484, backward nfe 0, Train: 0.4286, Val: 0.4096, Test: 0.3990, Best time: 2.2411
Epoch: 007/100, Runtime 4.630432, Loss 1.729786, forward nfe 4112, backward nfe 0, Train: 0.5000, Val: 0.4743, Test: 0.4772, Best time: 7.6197
Epoch: 008/100, Runtime 4.498540, Loss 1.597855, forward nfe 4722, backward nfe 0, Train: 0.6357, Val: 0.5551, Test: 0.5503, Best time: 7.9596
Epoch: 009/100, Runtime 4.265262, Loss 1.466514, forward nfe 5320, backward nfe 0, Train: 0.7429, Val: 0.6566, Test: 0.6477, Best time: 8.3261
Epoch: 010/100, Runtime 4.160357, Loss 1.332033, forward nfe 5900, backward nfe 0, Train: 0.8071, Val: 0.7324, Test: 0.7015, Best time: 11.6523
Epoch: 011/100, Runtime 4.244819, Loss 1.195921, forward nfe 6462, backward nfe 0, Train: 0.8500, Val: 0.7537, Test: 0.7289, Best time: 16.1286
Epoch: 012/100, Runtime 4.393174, Loss 1.071109, forward nfe 7024, backward nfe 0, Train: 0.8571, Val: 0.8074, Test: 0.7827, Best time: 29.6883
Epoch: 013/100, Runtime 4.306204, Loss 0.944485, forward nfe 7574, backward nfe 0, Train: 0.8286, Val: 0.8235, Test: 0.7868, Best time: 165.1796
Epoch: 014/100, Runtime 4.193709, Loss 0.838605, forward nfe 8118, backward nfe 0, Train: 0.8286, Val: 0.8235, Test: 0.7868, Best time: 95.0000
Epoch: 015/100, Runtime 4.015403, Loss 0.776144, forward nfe 8638, backward nfe 0, Train: 0.8286, Val: 0.8235, Test: 0.7868, Best time: 95.0000
Epoch: 016/100, Runtime 3.981522, Loss 0.691367, forward nfe 9146, backward nfe 0, Train: 0.8286, Val: 0.8235, Test: 0.7868, Best time: 95.0000
Epoch: 017/100, Runtime 3.800793, Loss 0.621635, forward nfe 9636, backward nfe 0, Train: 0.8571, Val: 0.8279, Test: 0.8102, Best time: 60.0016
Epoch: 018/100, Runtime 3.763988, Loss 0.615113, forward nfe 10120, backward nfe 0, Train: 0.8571, Val: 0.8279, Test: 0.8102, Best time: 95.0000
Epoch: 019/100, Runtime 3.597569, Loss 0.597795, forward nfe 10586, backward nfe 0, Train: 0.8571, Val: 0.8279, Test: 0.8102, Best time: 95.0000
Epoch: 020/100, Runtime 3.627320, Loss 0.564867, forward nfe 11052, backward nfe 0, Train: 0.8571, Val: 0.8279, Test: 0.8102, Best time: 95.0000
Epoch: 021/100, Runtime 3.588110, Loss 0.576670, forward nfe 11500, backward nfe 0, Train: 0.8286, Val: 0.8500, Test: 0.8213, Best time: 91.8902
Epoch: 022/100, Runtime 3.487199, Loss 0.538661, forward nfe 11948, backward nfe 0, Train: 0.8286, Val: 0.8500, Test: 0.8213, Best time: 95.0000
Epoch: 023/100, Runtime 3.506159, Loss 0.513591, forward nfe 12384, backward nfe 0, Train: 0.8286, Val: 0.8500, Test: 0.8213, Best time: 95.0000
Epoch: 024/100, Runtime 3.223617, Loss 0.500313, forward nfe 12796, backward nfe 0, Train: 0.8286, Val: 0.8500, Test: 0.8213, Best time: 95.0000
Epoch: 025/100, Runtime 3.187048, Loss 0.453557, forward nfe 13196, backward nfe 0, Train: 0.8286, Val: 0.8500, Test: 0.8213, Best time: 95.0000
Epoch: 026/100, Runtime 3.121801, Loss 0.469263, forward nfe 13596, backward nfe 0, Train: 0.8286, Val: 0.8500, Test: 0.8213, Best time: 95.0000
Epoch: 027/100, Runtime 2.835869, Loss 0.467339, forward nfe 13990, backward nfe 0, Train: 0.8286, Val: 0.8500, Test: 0.8213, Best time: 95.0000
Epoch: 028/100, Runtime 2.888711, Loss 0.457228, forward nfe 14378, backward nfe 0, Train: 0.8286, Val: 0.8500, Test: 0.8213, Best time: 95.0000
Epoch: 029/100, Runtime 2.733959, Loss 0.443086, forward nfe 14748, backward nfe 0, Train: 0.8857, Val: 0.8581, Test: 0.8294, Best time: 176.2232
Epoch: 030/100, Runtime 2.765668, Loss 0.410927, forward nfe 15112, backward nfe 0, Train: 0.8857, Val: 0.8581, Test: 0.8294, Best time: 95.0000
Epoch: 031/100, Runtime 2.779243, Loss 0.379334, forward nfe 15476, backward nfe 0, Train: 0.8857, Val: 0.8581, Test: 0.8294, Best time: 95.0000
Epoch: 032/100, Runtime 2.741537, Loss 0.337907, forward nfe 15840, backward nfe 0, Train: 0.8857, Val: 0.8581, Test: 0.8294, Best time: 95.0000
Epoch: 033/100, Runtime 2.633732, Loss 0.423460, forward nfe 16186, backward nfe 0, Train: 0.8857, Val: 0.8581, Test: 0.8294, Best time: 95.0000
Epoch: 034/100, Runtime 2.639247, Loss 0.364103, forward nfe 16526, backward nfe 0, Train: 0.8857, Val: 0.8581, Test: 0.8294, Best time: 95.0000
Epoch: 035/100, Runtime 2.619989, Loss 0.391331, forward nfe 16866, backward nfe 0, Train: 0.8857, Val: 0.8581, Test: 0.8294, Best time: 95.0000
Epoch: 036/100, Runtime 2.664461, Loss 0.471147, forward nfe 17200, backward nfe 0, Train: 0.8857, Val: 0.8581, Test: 0.8294, Best time: 95.0000
Epoch: 037/100, Runtime 2.744549, Loss 0.291107, forward nfe 17540, backward nfe 0, Train: 0.8857, Val: 0.8581, Test: 0.8294, Best time: 95.0000
Epoch: 038/100, Runtime 2.780752, Loss 0.338857, forward nfe 17874, backward nfe 0, Train: 0.8857, Val: 0.8581, Test: 0.8294, Best time: 95.0000
Epoch: 039/100, Runtime 2.677089, Loss 0.334110, forward nfe 18214, backward nfe 0, Train: 0.8857, Val: 0.8581, Test: 0.8294, Best time: 95.0000
Epoch: 040/100, Runtime 2.492773, Loss 0.313328, forward nfe 18548, backward nfe 0, Train: 0.8857, Val: 0.8581, Test: 0.8294, Best time: 95.0000
Epoch: 041/100, Runtime 2.463547, Loss 0.313875, forward nfe 18870, backward nfe 0, Train: 0.8857, Val: 0.8581, Test: 0.8294, Best time: 95.0000
Epoch: 042/100, Runtime 2.496139, Loss 0.299399, forward nfe 19192, backward nfe 0, Train: 0.8857, Val: 0.8581, Test: 0.8294, Best time: 95.0000
Epoch: 043/100, Runtime 2.622713, Loss 0.222524, forward nfe 19508, backward nfe 0, Train: 0.8857, Val: 0.8581, Test: 0.8294, Best time: 95.0000
Epoch: 044/100, Runtime 2.588166, Loss 0.250863, forward nfe 19830, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 91.2167
Epoch: 045/100, Runtime 2.570711, Loss 0.279840, forward nfe 20146, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 046/100, Runtime 2.953360, Loss 0.193550, forward nfe 20456, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 047/100, Runtime 3.163163, Loss 0.285527, forward nfe 20766, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 048/100, Runtime 2.867656, Loss 0.235140, forward nfe 21052, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 049/100, Runtime 3.180731, Loss 0.204944, forward nfe 21338, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 050/100, Runtime 3.391258, Loss 0.258222, forward nfe 21624, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 051/100, Runtime 3.162266, Loss 0.192071, forward nfe 21910, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 052/100, Runtime 2.856692, Loss 0.203652, forward nfe 22190, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 053/100, Runtime 3.016235, Loss 0.214654, forward nfe 22476, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 054/100, Runtime 2.899327, Loss 0.138672, forward nfe 22762, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 055/100, Runtime 3.053068, Loss 0.330313, forward nfe 23042, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 056/100, Runtime 3.125825, Loss 0.235696, forward nfe 23316, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 057/100, Runtime 2.269189, Loss 0.160122, forward nfe 23590, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 058/100, Runtime 2.162225, Loss 0.215390, forward nfe 23864, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 059/100, Runtime 2.250932, Loss 0.214638, forward nfe 24138, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 060/100, Runtime 2.268223, Loss 0.178185, forward nfe 24412, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 061/100, Runtime 2.273709, Loss 0.131879, forward nfe 24686, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 062/100, Runtime 2.222085, Loss 0.223955, forward nfe 24960, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 063/100, Runtime 2.218763, Loss 0.143229, forward nfe 25234, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 064/100, Runtime 2.334628, Loss 0.161996, forward nfe 25508, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 065/100, Runtime 2.249161, Loss 0.124968, forward nfe 25782, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 066/100, Runtime 2.219563, Loss 0.147182, forward nfe 26050, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 067/100, Runtime 2.259469, Loss 0.137096, forward nfe 26324, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 068/100, Runtime 2.238714, Loss 0.084022, forward nfe 26598, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 069/100, Runtime 2.244824, Loss 0.123833, forward nfe 26872, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 070/100, Runtime 2.269587, Loss 0.098853, forward nfe 27146, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 071/100, Runtime 2.204337, Loss 0.090078, forward nfe 27420, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 072/100, Runtime 2.212814, Loss 0.112353, forward nfe 27688, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 073/100, Runtime 2.180390, Loss 0.083268, forward nfe 27956, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 074/100, Runtime 2.125988, Loss 0.094121, forward nfe 28218, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 075/100, Runtime 2.150984, Loss 0.078209, forward nfe 28486, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 076/100, Runtime 2.114808, Loss 0.061230, forward nfe 28742, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 077/100, Runtime 2.117870, Loss 0.098266, forward nfe 28998, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 078/100, Runtime 2.101919, Loss 0.052390, forward nfe 29254, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 079/100, Runtime 2.120623, Loss 0.058475, forward nfe 29510, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 080/100, Runtime 2.149851, Loss 0.096259, forward nfe 29766, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 081/100, Runtime 2.137084, Loss 0.091197, forward nfe 30022, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 082/100, Runtime 2.119705, Loss 0.083033, forward nfe 30278, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 083/100, Runtime 2.103254, Loss 0.084562, forward nfe 30534, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 084/100, Runtime 2.292168, Loss 0.079381, forward nfe 30796, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 085/100, Runtime 2.143090, Loss 0.108426, forward nfe 31052, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 086/100, Runtime 2.177293, Loss 0.102000, forward nfe 31314, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 087/100, Runtime 2.133443, Loss 0.057186, forward nfe 31576, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 088/100, Runtime 2.139052, Loss 0.077611, forward nfe 31832, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 089/100, Runtime 2.130580, Loss 0.104138, forward nfe 32094, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 090/100, Runtime 2.144408, Loss 0.115152, forward nfe 32356, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 091/100, Runtime 2.125424, Loss 0.054004, forward nfe 32612, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 092/100, Runtime 2.126984, Loss 0.120563, forward nfe 32868, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 093/100, Runtime 2.120473, Loss 0.053106, forward nfe 33130, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 094/100, Runtime 2.132771, Loss 0.080812, forward nfe 33392, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 095/100, Runtime 2.113851, Loss 0.068563, forward nfe 33648, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 096/100, Runtime 2.109982, Loss 0.074786, forward nfe 33904, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 097/100, Runtime 2.104078, Loss 0.040032, forward nfe 34160, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 098/100, Runtime 2.128615, Loss 0.036851, forward nfe 34416, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
Epoch: 099/100, Runtime 2.130159, Loss 0.049916, forward nfe 34672, backward nfe 0, Train: 0.9429, Val: 0.8662, Test: 0.8457, Best time: 95.0000
best val accuracy 0.866176 with test accuracy 0.845685 at epoch 44 and best time 95.000000