/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 4.173931, Loss 1.947332, forward nfe 122, backward nfe 0, Train: 0.3000, Val: 0.2949, Test: 0.3025, Best time: 0.0936
Epoch: 002/100, Runtime 4.292393, Loss 1.880926, forward nfe 618, backward nfe 0, Train: 0.4500, Val: 0.6088, Test: 0.5746, Best time: 2.3262
Epoch: 003/100, Runtime 4.074988, Loss 1.801171, forward nfe 1102, backward nfe 0, Train: 0.6929, Val: 0.7397, Test: 0.7563, Best time: 7.7391
Epoch: 004/100, Runtime 4.004809, Loss 1.636354, forward nfe 1574, backward nfe 0, Train: 0.8643, Val: 0.7610, Test: 0.7777, Best time: 7.8561
Epoch: 005/100, Runtime 3.824169, Loss 1.396081, forward nfe 2040, backward nfe 0, Train: 0.8643, Val: 0.7610, Test: 0.7777, Best time: 65.0000
Epoch: 006/100, Runtime 3.847882, Loss 1.197717, forward nfe 2494, backward nfe 0, Train: 0.8714, Val: 0.7765, Test: 0.7959, Best time: 8.0781
Epoch: 007/100, Runtime 3.733730, Loss 0.941536, forward nfe 2936, backward nfe 0, Train: 0.8500, Val: 0.7772, Test: 0.8041, Best time: 32.0123
Epoch: 008/100, Runtime 3.708006, Loss 0.778024, forward nfe 3372, backward nfe 0, Train: 0.8714, Val: 0.7926, Test: 0.8061, Best time: 15.1562
Epoch: 009/100, Runtime 3.674376, Loss 0.652746, forward nfe 3796, backward nfe 0, Train: 0.8714, Val: 0.7926, Test: 0.8061, Best time: 65.0000
Epoch: 010/100, Runtime 3.570906, Loss 0.621394, forward nfe 4214, backward nfe 0, Train: 0.8714, Val: 0.7926, Test: 0.8061, Best time: 65.0000
Epoch: 011/100, Runtime 3.474311, Loss 0.522474, forward nfe 4626, backward nfe 0, Train: 0.8714, Val: 0.7926, Test: 0.8061, Best time: 65.0000
Epoch: 012/100, Runtime 3.352765, Loss 0.537389, forward nfe 5020, backward nfe 0, Train: 0.8929, Val: 0.8066, Test: 0.8254, Best time: 18.1842
Epoch: 013/100, Runtime 3.246941, Loss 0.512551, forward nfe 5396, backward nfe 0, Train: 0.8929, Val: 0.8074, Test: 0.8264, Best time: 19.1563
Epoch: 014/100, Runtime 3.156165, Loss 0.482386, forward nfe 5766, backward nfe 0, Train: 0.8929, Val: 0.8074, Test: 0.8264, Best time: 65.0000
Epoch: 015/100, Runtime 3.130834, Loss 0.459284, forward nfe 6130, backward nfe 0, Train: 0.8929, Val: 0.8074, Test: 0.8264, Best time: 65.0000
Epoch: 016/100, Runtime 3.147389, Loss 0.425028, forward nfe 6494, backward nfe 0, Train: 0.9143, Val: 0.8103, Test: 0.8051, Best time: 38.8407
Epoch: 017/100, Runtime 3.111674, Loss 0.395199, forward nfe 6852, backward nfe 0, Train: 0.9143, Val: 0.8103, Test: 0.8051, Best time: 65.0000
Epoch: 018/100, Runtime 2.973905, Loss 0.431935, forward nfe 7210, backward nfe 0, Train: 0.8929, Val: 0.8147, Test: 0.8193, Best time: 49.1359
Epoch: 019/100, Runtime 2.996290, Loss 0.465703, forward nfe 7562, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 151.9359
Epoch: 020/100, Runtime 2.905700, Loss 0.367897, forward nfe 7908, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 021/100, Runtime 3.721652, Loss 0.344196, forward nfe 8236, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 022/100, Runtime 3.747496, Loss 0.397686, forward nfe 8558, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 023/100, Runtime 3.949375, Loss 0.367949, forward nfe 8874, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 024/100, Runtime 3.883283, Loss 0.378268, forward nfe 9196, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 025/100, Runtime 3.856898, Loss 0.292307, forward nfe 9524, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 026/100, Runtime 3.753678, Loss 0.376883, forward nfe 9834, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 027/100, Runtime 3.635949, Loss 0.320001, forward nfe 10144, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 028/100, Runtime 3.661290, Loss 0.313430, forward nfe 10448, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 029/100, Runtime 3.602549, Loss 0.286941, forward nfe 10746, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 030/100, Runtime 3.451496, Loss 0.304385, forward nfe 11044, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 031/100, Runtime 3.446454, Loss 0.253372, forward nfe 11318, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 032/100, Runtime 3.520313, Loss 0.173838, forward nfe 11604, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 033/100, Runtime 3.447139, Loss 0.271395, forward nfe 11896, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 034/100, Runtime 3.371864, Loss 0.249057, forward nfe 12176, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 035/100, Runtime 3.403943, Loss 0.217166, forward nfe 12456, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 036/100, Runtime 2.316450, Loss 0.223172, forward nfe 12736, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 037/100, Runtime 2.265668, Loss 0.243664, forward nfe 13010, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 038/100, Runtime 2.275000, Loss 0.177744, forward nfe 13278, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 039/100, Runtime 2.131840, Loss 0.192809, forward nfe 13534, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 040/100, Runtime 2.243435, Loss 0.200266, forward nfe 13784, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 041/100, Runtime 2.189154, Loss 0.169816, forward nfe 14034, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 042/100, Runtime 2.201255, Loss 0.170555, forward nfe 14284, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 043/100, Runtime 2.431511, Loss 0.150258, forward nfe 14528, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 044/100, Runtime 2.188691, Loss 0.184843, forward nfe 14772, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 045/100, Runtime 2.180638, Loss 0.160617, forward nfe 15016, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 046/100, Runtime 2.036449, Loss 0.205114, forward nfe 15266, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 047/100, Runtime 2.104574, Loss 0.146508, forward nfe 15504, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 048/100, Runtime 2.301297, Loss 0.163099, forward nfe 15730, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 049/100, Runtime 2.431995, Loss 0.250788, forward nfe 15956, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 050/100, Runtime 2.308021, Loss 0.112882, forward nfe 16182, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 051/100, Runtime 2.429747, Loss 0.142546, forward nfe 16408, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 052/100, Runtime 2.503124, Loss 0.168156, forward nfe 16634, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 053/100, Runtime 2.518164, Loss 0.147963, forward nfe 16866, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 054/100, Runtime 2.423243, Loss 0.153082, forward nfe 17098, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 055/100, Runtime 2.497914, Loss 0.117340, forward nfe 17330, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 056/100, Runtime 2.357397, Loss 0.120236, forward nfe 17562, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 057/100, Runtime 2.447130, Loss 0.089932, forward nfe 17788, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 058/100, Runtime 2.213192, Loss 0.139613, forward nfe 18014, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 059/100, Runtime 1.940592, Loss 0.129735, forward nfe 18234, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 060/100, Runtime 2.014271, Loss 0.179717, forward nfe 18454, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 061/100, Runtime 1.877282, Loss 0.139124, forward nfe 18674, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 062/100, Runtime 2.016227, Loss 0.090762, forward nfe 18894, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 063/100, Runtime 1.884394, Loss 0.076318, forward nfe 19108, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 064/100, Runtime 1.908818, Loss 0.122793, forward nfe 19322, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 065/100, Runtime 1.856883, Loss 0.105759, forward nfe 19530, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 066/100, Runtime 1.792181, Loss 0.074255, forward nfe 19738, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 067/100, Runtime 1.855742, Loss 0.095860, forward nfe 19946, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 068/100, Runtime 1.866874, Loss 0.074963, forward nfe 20148, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 069/100, Runtime 1.927422, Loss 0.087807, forward nfe 20356, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 070/100, Runtime 1.917374, Loss 0.059101, forward nfe 20570, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 071/100, Runtime 1.902519, Loss 0.059630, forward nfe 20784, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 072/100, Runtime 1.864455, Loss 0.134970, forward nfe 20998, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 073/100, Runtime 1.674885, Loss 0.057157, forward nfe 21200, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 074/100, Runtime 1.778882, Loss 0.081096, forward nfe 21402, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 075/100, Runtime 1.778005, Loss 0.110325, forward nfe 21604, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 076/100, Runtime 1.837717, Loss 0.078207, forward nfe 21806, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 077/100, Runtime 1.824872, Loss 0.070502, forward nfe 22008, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 078/100, Runtime 1.758231, Loss 0.056174, forward nfe 22210, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 079/100, Runtime 1.758658, Loss 0.058648, forward nfe 22412, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 080/100, Runtime 1.865734, Loss 0.053144, forward nfe 22608, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 081/100, Runtime 1.874858, Loss 0.073669, forward nfe 22816, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 082/100, Runtime 1.827801, Loss 0.072019, forward nfe 23024, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 083/100, Runtime 1.709639, Loss 0.101550, forward nfe 23232, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 084/100, Runtime 1.942958, Loss 0.059397, forward nfe 23440, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 085/100, Runtime 1.855464, Loss 0.059014, forward nfe 23654, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 086/100, Runtime 2.017644, Loss 0.054364, forward nfe 23868, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 087/100, Runtime 1.873165, Loss 0.067736, forward nfe 24082, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 088/100, Runtime 1.940605, Loss 0.047867, forward nfe 24296, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 089/100, Runtime 1.847328, Loss 0.039805, forward nfe 24510, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 090/100, Runtime 1.909814, Loss 0.072308, forward nfe 24724, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 091/100, Runtime 1.927151, Loss 0.042985, forward nfe 24938, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 092/100, Runtime 1.820863, Loss 0.050140, forward nfe 25152, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 093/100, Runtime 1.916319, Loss 0.062354, forward nfe 25366, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 094/100, Runtime 1.804495, Loss 0.034995, forward nfe 25574, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 095/100, Runtime 1.807971, Loss 0.059885, forward nfe 25782, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 096/100, Runtime 1.940625, Loss 0.038301, forward nfe 25990, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 097/100, Runtime 1.792157, Loss 0.061952, forward nfe 26198, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 098/100, Runtime 1.782213, Loss 0.055246, forward nfe 26406, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
Epoch: 099/100, Runtime 1.936333, Loss 0.076251, forward nfe 26614, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8376, Best time: 65.0000
best val accuracy 0.839706 with test accuracy 0.837563 at epoch 19 and best time 65.000000