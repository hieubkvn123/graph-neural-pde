****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.346588, Loss 1.796209, forward nfe 128, backward nfe 0, Train: 0.2250, Val: 0.2652, Test: 0.2565, Best time: 30.0000
Epoch: 002/100, Runtime 0.345522, Loss 1.749420, forward nfe 480, backward nfe 0, Train: 0.3667, Val: 0.4558, Test: 0.4500, Best time: 30.0000
Epoch: 003/100, Runtime 0.337753, Loss 1.726314, forward nfe 844, backward nfe 0, Train: 0.6333, Val: 0.5862, Test: 0.5984, Best time: 0.0370
Epoch: 004/100, Runtime 0.339793, Loss 1.691520, forward nfe 1202, backward nfe 0, Train: 0.6917, Val: 0.6746, Test: 0.6645, Best time: 10.7124
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 005/100, Runtime 0.337198, Loss 1.617162, forward nfe 1560, backward nfe 0, Train: 0.7167, Val: 0.7326, Test: 0.7048, Best time: 20.1310
Epoch: 006/100, Runtime 0.345253, Loss 1.625208, forward nfe 1918, backward nfe 0, Train: 0.7083, Val: 0.7529, Test: 0.7419, Best time: 51.1655
Epoch: 007/100, Runtime 0.327986, Loss 1.595324, forward nfe 2264, backward nfe 0, Train: 0.6917, Val: 0.7536, Test: 0.7516, Best time: 48.2742
Epoch: 008/100, Runtime 0.324486, Loss 1.528947, forward nfe 2610, backward nfe 0, Train: 0.6917, Val: 0.7536, Test: 0.7516, Best time: 30.0000
Epoch: 009/100, Runtime 0.361311, Loss 1.512411, forward nfe 2956, backward nfe 0, Train: 0.6917, Val: 0.7536, Test: 0.7516, Best time: 30.0000
Epoch: 010/100, Runtime 0.357139, Loss 1.519235, forward nfe 3290, backward nfe 0, Train: 0.6917, Val: 0.7536, Test: 0.7516, Best time: 30.0000
Epoch: 011/100, Runtime 0.352968, Loss 1.469036, forward nfe 3618, backward nfe 0, Train: 0.6917, Val: 0.7616, Test: 0.7452, Best time: 30.7384
Epoch: 012/100, Runtime 0.333616, Loss 1.477810, forward nfe 3946, backward nfe 0, Train: 0.7333, Val: 0.7645, Test: 0.7532, Best time: 22.7702
Epoch: 013/100, Runtime 0.301859, Loss 1.447064, forward nfe 4274, backward nfe 0, Train: 0.7333, Val: 0.7645, Test: 0.7532, Best time: 30.0000
Epoch: 014/100, Runtime 0.360197, Loss 1.425878, forward nfe 4596, backward nfe 0, Train: 0.7333, Val: 0.7645, Test: 0.7532, Best time: 30.0000
Epoch: 015/100, Runtime 0.378726, Loss 1.423213, forward nfe 4906, backward nfe 0, Train: 0.7333, Val: 0.7645, Test: 0.7532, Best time: 30.0000
Epoch: 016/100, Runtime 0.376550, Loss 1.383167, forward nfe 5216, backward nfe 0, Train: 0.7333, Val: 0.7645, Test: 0.7532, Best time: 30.0000
Epoch: 017/100, Runtime 0.362539, Loss 1.275317, forward nfe 5532, backward nfe 0, Train: 0.7333, Val: 0.7645, Test: 0.7532, Best time: 30.0000
Epoch: 018/100, Runtime 0.384739, Loss 1.327887, forward nfe 5836, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 22.7751
Epoch: 019/100, Runtime 0.372607, Loss 1.254415, forward nfe 6140, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 020/100, Runtime 0.358877, Loss 1.247497, forward nfe 6444, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 021/100, Runtime 0.363570, Loss 1.238960, forward nfe 6742, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 022/100, Runtime 0.344978, Loss 1.170010, forward nfe 7028, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 023/100, Runtime 0.353124, Loss 1.167537, forward nfe 7314, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 024/100, Runtime 0.338332, Loss 1.143502, forward nfe 7594, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 025/100, Runtime 0.339606, Loss 1.140082, forward nfe 7868, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 026/100, Runtime 0.332752, Loss 1.149984, forward nfe 8142, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 027/100, Runtime 0.326814, Loss 1.207637, forward nfe 8416, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 028/100, Runtime 0.336680, Loss 1.093692, forward nfe 8684, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 029/100, Runtime 0.326967, Loss 1.132308, forward nfe 8946, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 030/100, Runtime 0.302759, Loss 1.100721, forward nfe 9202, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 031/100, Runtime 0.313630, Loss 1.130692, forward nfe 9452, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 032/100, Runtime 0.305495, Loss 1.280954, forward nfe 9702, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 033/100, Runtime 0.313917, Loss 1.045488, forward nfe 9952, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 034/100, Runtime 0.317204, Loss 1.082780, forward nfe 10202, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 035/100, Runtime 0.305922, Loss 1.062242, forward nfe 10446, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 036/100, Runtime 0.303184, Loss 1.126848, forward nfe 10684, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 037/100, Runtime 0.290500, Loss 1.057853, forward nfe 10922, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 038/100, Runtime 0.287833, Loss 1.125390, forward nfe 11160, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 039/100, Runtime 0.285564, Loss 1.050795, forward nfe 11392, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 040/100, Runtime 0.290344, Loss 1.158559, forward nfe 11618, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 041/100, Runtime 0.280180, Loss 1.049176, forward nfe 11844, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 042/100, Runtime 0.277910, Loss 1.253395, forward nfe 12070, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 043/100, Runtime 0.291077, Loss 1.215668, forward nfe 12296, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 044/100, Runtime 0.282619, Loss 1.038137, forward nfe 12522, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 045/100, Runtime 0.264330, Loss 1.183083, forward nfe 12742, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 046/100, Runtime 0.273984, Loss 1.147227, forward nfe 12962, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 047/100, Runtime 0.274532, Loss 1.051139, forward nfe 13182, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 048/100, Runtime 0.272603, Loss 1.083014, forward nfe 13396, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 049/100, Runtime 0.262473, Loss 1.144384, forward nfe 13610, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 050/100, Runtime 0.266126, Loss 1.106020, forward nfe 13824, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 051/100, Runtime 0.259548, Loss 1.129283, forward nfe 14032, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 052/100, Runtime 0.271226, Loss 1.122058, forward nfe 14240, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 053/100, Runtime 0.260435, Loss 1.049816, forward nfe 14448, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 054/100, Runtime 0.256850, Loss 1.057537, forward nfe 14656, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 055/100, Runtime 0.281495, Loss 1.046146, forward nfe 14864, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 056/100, Runtime 0.279270, Loss 1.051760, forward nfe 15084, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 057/100, Runtime 0.285544, Loss 1.003488, forward nfe 15304, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 058/100, Runtime 0.252930, Loss 1.014279, forward nfe 15524, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 059/100, Runtime 0.258106, Loss 1.227627, forward nfe 15738, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 060/100, Runtime 0.268718, Loss 1.066005, forward nfe 15952, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 061/100, Runtime 0.269215, Loss 1.029473, forward nfe 16166, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 062/100, Runtime 0.280083, Loss 1.098494, forward nfe 16380, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 063/100, Runtime 0.288971, Loss 1.023069, forward nfe 16594, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 064/100, Runtime 0.266929, Loss 1.063938, forward nfe 16808, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 065/100, Runtime 0.272362, Loss 1.135659, forward nfe 17022, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 066/100, Runtime 0.269110, Loss 0.954382, forward nfe 17236, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 067/100, Runtime 0.271522, Loss 1.068928, forward nfe 17450, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 068/100, Runtime 0.262680, Loss 1.055702, forward nfe 17664, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 069/100, Runtime 0.265890, Loss 1.096390, forward nfe 17878, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 070/100, Runtime 0.274297, Loss 1.115565, forward nfe 18092, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 071/100, Runtime 0.276271, Loss 1.063218, forward nfe 18306, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 072/100, Runtime 0.283629, Loss 0.997376, forward nfe 18526, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 073/100, Runtime 0.280554, Loss 1.147370, forward nfe 18752, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 074/100, Runtime 0.274972, Loss 1.036796, forward nfe 18978, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 075/100, Runtime 0.279313, Loss 1.023178, forward nfe 19204, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 076/100, Runtime 0.283499, Loss 0.885004, forward nfe 19430, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 077/100, Runtime 0.283621, Loss 1.008994, forward nfe 19650, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 078/100, Runtime 0.269707, Loss 0.967657, forward nfe 19870, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 079/100, Runtime 0.285780, Loss 1.006294, forward nfe 20096, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 080/100, Runtime 0.268855, Loss 1.152127, forward nfe 20310, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 081/100, Runtime 0.270471, Loss 1.126002, forward nfe 20524, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 082/100, Runtime 0.259318, Loss 1.150446, forward nfe 20738, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 083/100, Runtime 0.267512, Loss 0.993041, forward nfe 20952, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 084/100, Runtime 0.422190, Loss 1.040310, forward nfe 21166, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 085/100, Runtime 0.272752, Loss 1.160806, forward nfe 21386, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 086/100, Runtime 0.281751, Loss 1.060030, forward nfe 21606, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 087/100, Runtime 0.279091, Loss 0.919544, forward nfe 21826, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 088/100, Runtime 0.280331, Loss 1.027797, forward nfe 22046, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 089/100, Runtime 0.274792, Loss 1.104905, forward nfe 22266, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 090/100, Runtime 0.279243, Loss 1.080472, forward nfe 22486, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 091/100, Runtime 0.277959, Loss 1.157867, forward nfe 22706, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 092/100, Runtime 0.287912, Loss 1.100796, forward nfe 22926, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 093/100, Runtime 0.282548, Loss 1.092916, forward nfe 23146, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 094/100, Runtime 0.268679, Loss 1.035824, forward nfe 23366, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 095/100, Runtime 0.274882, Loss 1.041370, forward nfe 23580, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 096/100, Runtime 0.259682, Loss 0.959206, forward nfe 23794, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 097/100, Runtime 0.261134, Loss 1.093102, forward nfe 24008, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 098/100, Runtime 0.277545, Loss 1.023819, forward nfe 24222, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
Epoch: 099/100, Runtime 0.285258, Loss 1.073018, forward nfe 24436, backward nfe 0, Train: 0.7500, Val: 0.7659, Test: 0.7581, Best time: 30.0000
best val accuracy 0.765942 with test accuracy 0.758065 at epoch 18 and best time 30.000000