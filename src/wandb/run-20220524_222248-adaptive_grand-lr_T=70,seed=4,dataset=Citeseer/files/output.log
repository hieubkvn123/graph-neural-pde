/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.748089, Loss 1.790672, forward nfe 194, backward nfe 0, Train: 0.2250, Val: 0.1551, Test: 0.1903, Best time: 212.8439
Epoch: 002/100, Runtime 0.680472, Loss 1.767131, forward nfe 816, backward nfe 0, Train: 0.4583, Val: 0.4819, Test: 0.4661, Best time: 70.0000
Epoch: 003/100, Runtime 0.709718, Loss 1.730819, forward nfe 1432, backward nfe 0, Train: 0.4583, Val: 0.4819, Test: 0.4661, Best time: 70.0000
Epoch: 004/100, Runtime 0.721658, Loss 1.647674, forward nfe 2054, backward nfe 0, Train: 0.6250, Val: 0.5623, Test: 0.5532, Best time: 14.8353
Epoch: 005/100, Runtime 0.698395, Loss 1.631321, forward nfe 2670, backward nfe 0, Train: 0.7667, Val: 0.6949, Test: 0.6774, Best time: 3.5316
Epoch: 006/100, Runtime 0.683013, Loss 1.570715, forward nfe 3268, backward nfe 0, Train: 0.7583, Val: 0.7420, Test: 0.7016, Best time: 5.4348
Epoch: 007/100, Runtime 0.684454, Loss 1.561671, forward nfe 3872, backward nfe 0, Train: 0.7583, Val: 0.7420, Test: 0.7016, Best time: 70.0000
Epoch: 008/100, Runtime 0.643858, Loss 1.568115, forward nfe 4446, backward nfe 0, Train: 0.7583, Val: 0.7420, Test: 0.7016, Best time: 70.0000
Epoch: 009/100, Runtime 0.654596, Loss 1.501269, forward nfe 5026, backward nfe 0, Train: 0.7583, Val: 0.7420, Test: 0.7016, Best time: 70.0000
Epoch: 010/100, Runtime 0.616027, Loss 1.505014, forward nfe 5594, backward nfe 0, Train: 0.7583, Val: 0.7420, Test: 0.7016, Best time: 70.0000
Epoch: 011/100, Runtime 0.605319, Loss 1.471761, forward nfe 6144, backward nfe 0, Train: 0.7583, Val: 0.7420, Test: 0.7016, Best time: 70.0000
Epoch: 012/100, Runtime 0.633394, Loss 1.455832, forward nfe 6688, backward nfe 0, Train: 0.7583, Val: 0.7420, Test: 0.7016, Best time: 70.0000
Epoch: 013/100, Runtime 0.597412, Loss 1.501038, forward nfe 7226, backward nfe 0, Train: 0.7833, Val: 0.7500, Test: 0.7065, Best time: 32.3270
Epoch: 014/100, Runtime 0.605901, Loss 1.402209, forward nfe 7764, backward nfe 0, Train: 0.7833, Val: 0.7500, Test: 0.7065, Best time: 70.0000
Epoch: 015/100, Runtime 0.605979, Loss 1.400093, forward nfe 8284, backward nfe 0, Train: 0.7833, Val: 0.7500, Test: 0.7065, Best time: 70.0000
Epoch: 016/100, Runtime 0.564649, Loss 1.332386, forward nfe 8798, backward nfe 0, Train: 0.8333, Val: 0.7522, Test: 0.6919, Best time: 17.3981
Epoch: 017/100, Runtime 0.559119, Loss 1.325317, forward nfe 9306, backward nfe 0, Train: 0.8333, Val: 0.7522, Test: 0.6919, Best time: 70.0000
Epoch: 018/100, Runtime 0.570323, Loss 1.231201, forward nfe 9814, backward nfe 0, Train: 0.8167, Val: 0.7529, Test: 0.7113, Best time: 39.0076
Epoch: 019/100, Runtime 0.560327, Loss 1.291385, forward nfe 10322, backward nfe 0, Train: 0.8167, Val: 0.7529, Test: 0.7113, Best time: 70.0000
Epoch: 020/100, Runtime 0.547480, Loss 1.244269, forward nfe 10806, backward nfe 0, Train: 0.8167, Val: 0.7529, Test: 0.7113, Best time: 70.0000
Epoch: 021/100, Runtime 0.547163, Loss 1.248248, forward nfe 11290, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 35.6450
Epoch: 022/100, Runtime 0.521343, Loss 1.137370, forward nfe 11756, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 023/100, Runtime 0.505274, Loss 1.150295, forward nfe 12204, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 024/100, Runtime 0.505485, Loss 1.224464, forward nfe 12658, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 025/100, Runtime 0.507148, Loss 1.249599, forward nfe 13106, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 026/100, Runtime 0.507964, Loss 1.209057, forward nfe 13542, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 027/100, Runtime 0.492519, Loss 1.221508, forward nfe 13984, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 028/100, Runtime 0.486645, Loss 1.229098, forward nfe 14426, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 029/100, Runtime 0.479618, Loss 1.179124, forward nfe 14856, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 030/100, Runtime 0.482421, Loss 1.191158, forward nfe 15274, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 031/100, Runtime 0.465902, Loss 1.154348, forward nfe 15686, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 032/100, Runtime 0.448199, Loss 1.162967, forward nfe 16086, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 033/100, Runtime 0.460627, Loss 1.090457, forward nfe 16480, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 034/100, Runtime 0.441149, Loss 1.265986, forward nfe 16868, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 035/100, Runtime 0.456739, Loss 1.117542, forward nfe 17256, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 036/100, Runtime 0.454630, Loss 1.091782, forward nfe 17644, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 037/100, Runtime 0.442187, Loss 1.157900, forward nfe 18026, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 038/100, Runtime 0.438777, Loss 1.121699, forward nfe 18402, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 039/100, Runtime 0.437416, Loss 1.259919, forward nfe 18772, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 040/100, Runtime 0.440391, Loss 1.218755, forward nfe 19136, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 041/100, Runtime 0.417469, Loss 1.305744, forward nfe 19494, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 042/100, Runtime 0.414290, Loss 1.266875, forward nfe 19846, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 043/100, Runtime 0.415555, Loss 1.257633, forward nfe 20198, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 044/100, Runtime 0.417538, Loss 1.305400, forward nfe 20550, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 045/100, Runtime 0.534582, Loss 1.185873, forward nfe 20890, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 046/100, Runtime 0.389039, Loss 1.343393, forward nfe 21224, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 047/100, Runtime 0.388580, Loss 1.163641, forward nfe 21552, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 048/100, Runtime 0.385345, Loss 1.165374, forward nfe 21880, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 049/100, Runtime 0.387534, Loss 1.170841, forward nfe 22208, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 050/100, Runtime 0.383367, Loss 1.286461, forward nfe 22530, backward nfe 0, Train: 0.8333, Val: 0.7565, Test: 0.7177, Best time: 70.0000
Epoch: 051/100, Runtime 0.391621, Loss 1.219310, forward nfe 22852, backward nfe 0, Train: 0.8333, Val: 0.7601, Test: 0.7210, Best time: 77.2719
Epoch: 052/100, Runtime 0.377371, Loss 1.083089, forward nfe 23174, backward nfe 0, Train: 0.8333, Val: 0.7601, Test: 0.7210, Best time: 70.0000
Epoch: 053/100, Runtime 0.382308, Loss 1.234480, forward nfe 23490, backward nfe 0, Train: 0.8333, Val: 0.7601, Test: 0.7210, Best time: 70.0000
Epoch: 054/100, Runtime 0.388948, Loss 1.126552, forward nfe 23806, backward nfe 0, Train: 0.8333, Val: 0.7601, Test: 0.7210, Best time: 70.0000
Epoch: 055/100, Runtime 0.384719, Loss 1.105507, forward nfe 24122, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 59.3270
Epoch: 056/100, Runtime 0.373435, Loss 1.077727, forward nfe 24438, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 057/100, Runtime 0.371445, Loss 1.138060, forward nfe 24754, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 058/100, Runtime 0.389344, Loss 1.130354, forward nfe 25070, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 059/100, Runtime 0.373544, Loss 1.052514, forward nfe 25386, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 060/100, Runtime 0.367808, Loss 1.248264, forward nfe 25702, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 061/100, Runtime 0.364432, Loss 1.193221, forward nfe 26012, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 062/100, Runtime 0.369214, Loss 1.099275, forward nfe 26322, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 063/100, Runtime 0.360245, Loss 1.008334, forward nfe 26632, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 064/100, Runtime 0.364906, Loss 1.184252, forward nfe 26936, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 065/100, Runtime 0.375905, Loss 1.132597, forward nfe 27240, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 066/100, Runtime 0.376463, Loss 1.232319, forward nfe 27556, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 067/100, Runtime 0.378290, Loss 1.173882, forward nfe 27872, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 068/100, Runtime 0.397348, Loss 1.089205, forward nfe 28182, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 069/100, Runtime 0.373810, Loss 1.128592, forward nfe 28498, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 070/100, Runtime 0.378113, Loss 1.257972, forward nfe 28808, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 071/100, Runtime 0.359137, Loss 1.071333, forward nfe 29118, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 072/100, Runtime 0.356625, Loss 1.199975, forward nfe 29422, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 073/100, Runtime 0.360499, Loss 1.095672, forward nfe 29726, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 074/100, Runtime 0.372571, Loss 1.164078, forward nfe 30030, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 075/100, Runtime 0.371704, Loss 1.112552, forward nfe 30334, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 076/100, Runtime 0.369803, Loss 1.188645, forward nfe 30638, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 077/100, Runtime 0.362571, Loss 1.076623, forward nfe 30942, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 078/100, Runtime 0.368679, Loss 1.238008, forward nfe 31246, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 079/100, Runtime 0.368293, Loss 1.066115, forward nfe 31550, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 080/100, Runtime 0.364244, Loss 1.178000, forward nfe 31854, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 081/100, Runtime 0.368651, Loss 1.159609, forward nfe 32158, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 082/100, Runtime 0.369303, Loss 1.117350, forward nfe 32462, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 083/100, Runtime 0.362691, Loss 1.175759, forward nfe 32766, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 084/100, Runtime 0.346305, Loss 1.154481, forward nfe 33070, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 085/100, Runtime 0.352938, Loss 1.066267, forward nfe 33368, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 086/100, Runtime 0.363577, Loss 1.149023, forward nfe 33666, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 087/100, Runtime 0.359854, Loss 1.068340, forward nfe 33964, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 088/100, Runtime 0.353601, Loss 1.229027, forward nfe 34262, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 089/100, Runtime 0.359005, Loss 1.119891, forward nfe 34560, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 090/100, Runtime 0.359207, Loss 1.228703, forward nfe 34858, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 091/100, Runtime 0.349969, Loss 1.116837, forward nfe 35156, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 092/100, Runtime 0.362058, Loss 1.023919, forward nfe 35454, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 093/100, Runtime 0.382198, Loss 1.043190, forward nfe 35752, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 094/100, Runtime 0.365920, Loss 1.131797, forward nfe 36050, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 095/100, Runtime 0.362047, Loss 1.038624, forward nfe 36348, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 096/100, Runtime 0.351777, Loss 1.136096, forward nfe 36646, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 097/100, Runtime 0.350204, Loss 1.107429, forward nfe 36932, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 098/100, Runtime 0.358904, Loss 1.226498, forward nfe 37218, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
Epoch: 099/100, Runtime 0.341019, Loss 1.207945, forward nfe 37504, backward nfe 0, Train: 0.8250, Val: 0.7638, Test: 0.7290, Best time: 70.0000
best val accuracy 0.763768 with test accuracy 0.729032 at epoch 55 and best time 70.000000