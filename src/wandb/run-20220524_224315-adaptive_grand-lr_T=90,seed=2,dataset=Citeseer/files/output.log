/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.939587, Loss 1.792018, forward nfe 224, backward nfe 0, Train: 0.4083, Val: 0.4928, Test: 0.4839, Best time: 1.4998
Epoch: 002/100, Runtime 0.857963, Loss 1.790062, forward nfe 978, backward nfe 0, Train: 0.4250, Val: 0.5514, Test: 0.5355, Best time: 2.6736
Epoch: 003/100, Runtime 0.862335, Loss 1.777578, forward nfe 1738, backward nfe 0, Train: 0.4417, Val: 0.5833, Test: 0.5694, Best time: 2.6425
Epoch: 004/100, Runtime 0.845328, Loss 1.735705, forward nfe 2492, backward nfe 0, Train: 0.4417, Val: 0.5833, Test: 0.5694, Best time: 90.0000
Epoch: 005/100, Runtime 0.804841, Loss 1.705539, forward nfe 3240, backward nfe 0, Train: 0.4417, Val: 0.5833, Test: 0.5694, Best time: 90.0000
Epoch: 006/100, Runtime 0.849599, Loss 1.682299, forward nfe 3976, backward nfe 0, Train: 0.4417, Val: 0.5833, Test: 0.5694, Best time: 90.0000
Epoch: 007/100, Runtime 0.806901, Loss 1.649211, forward nfe 4694, backward nfe 0, Train: 0.5667, Val: 0.5928, Test: 0.5790, Best time: 4.5837
Epoch: 008/100, Runtime 0.780819, Loss 1.609816, forward nfe 5412, backward nfe 0, Train: 0.5667, Val: 0.6109, Test: 0.5952, Best time: 17.9543
Epoch: 009/100, Runtime 0.783088, Loss 1.578771, forward nfe 6100, backward nfe 0, Train: 0.6667, Val: 0.6609, Test: 0.6387, Best time: 54.2663
Epoch: 010/100, Runtime 0.758407, Loss 1.596190, forward nfe 6788, backward nfe 0, Train: 0.6583, Val: 0.6674, Test: 0.6500, Best time: 46.3307
Epoch: 011/100, Runtime 0.735079, Loss 1.590081, forward nfe 7464, backward nfe 0, Train: 0.6583, Val: 0.6674, Test: 0.6500, Best time: 90.0000
Epoch: 012/100, Runtime 0.752894, Loss 1.558835, forward nfe 8122, backward nfe 0, Train: 0.6583, Val: 0.6674, Test: 0.6500, Best time: 90.0000
Epoch: 013/100, Runtime 0.727754, Loss 1.508083, forward nfe 8780, backward nfe 0, Train: 0.6583, Val: 0.6674, Test: 0.6500, Best time: 90.0000
Epoch: 014/100, Runtime 0.729765, Loss 1.482275, forward nfe 9432, backward nfe 0, Train: 0.6667, Val: 0.6920, Test: 0.6774, Best time: 40.0029
Epoch: 015/100, Runtime 0.709212, Loss 1.476781, forward nfe 10078, backward nfe 0, Train: 0.6833, Val: 0.7000, Test: 0.6871, Best time: 53.0248
Epoch: 016/100, Runtime 0.687185, Loss 1.460528, forward nfe 10700, backward nfe 0, Train: 0.6833, Val: 0.7000, Test: 0.6871, Best time: 90.0000
Epoch: 017/100, Runtime 0.704446, Loss 1.385167, forward nfe 11322, backward nfe 0, Train: 0.6833, Val: 0.7000, Test: 0.6871, Best time: 90.0000
Epoch: 018/100, Runtime 0.681908, Loss 1.372499, forward nfe 11944, backward nfe 0, Train: 0.6667, Val: 0.7362, Test: 0.7129, Best time: 37.2922
Epoch: 019/100, Runtime 0.686045, Loss 1.320233, forward nfe 12536, backward nfe 0, Train: 0.6667, Val: 0.7362, Test: 0.7129, Best time: 90.0000
Epoch: 020/100, Runtime 0.686642, Loss 1.357056, forward nfe 13122, backward nfe 0, Train: 0.6667, Val: 0.7362, Test: 0.7129, Best time: 90.0000
Epoch: 021/100, Runtime 0.670592, Loss 1.354186, forward nfe 13714, backward nfe 0, Train: 0.6667, Val: 0.7362, Test: 0.7129, Best time: 90.0000
Epoch: 022/100, Runtime 0.657459, Loss 1.282238, forward nfe 14288, backward nfe 0, Train: 0.6667, Val: 0.7362, Test: 0.7129, Best time: 90.0000
Epoch: 023/100, Runtime 0.631653, Loss 1.347534, forward nfe 14850, backward nfe 0, Train: 0.7250, Val: 0.7399, Test: 0.7081, Best time: 56.7871
Epoch: 024/100, Runtime 0.609060, Loss 1.306122, forward nfe 15394, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 52.1813
Epoch: 025/100, Runtime 0.607759, Loss 1.253753, forward nfe 15932, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 026/100, Runtime 0.627363, Loss 1.235193, forward nfe 16464, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 027/100, Runtime 0.600346, Loss 1.277889, forward nfe 16996, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 028/100, Runtime 0.601918, Loss 1.212299, forward nfe 17510, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 029/100, Runtime 0.582995, Loss 1.251015, forward nfe 18024, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 030/100, Runtime 0.580488, Loss 1.194311, forward nfe 18526, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 031/100, Runtime 0.566433, Loss 1.228575, forward nfe 19022, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 032/100, Runtime 0.556039, Loss 1.223179, forward nfe 19512, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 033/100, Runtime 0.535143, Loss 1.284073, forward nfe 19990, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 034/100, Runtime 0.562155, Loss 1.394916, forward nfe 20462, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 035/100, Runtime 0.530036, Loss 1.175990, forward nfe 20928, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 036/100, Runtime 0.517060, Loss 1.273544, forward nfe 21382, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 037/100, Runtime 0.509749, Loss 1.321614, forward nfe 21836, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 038/100, Runtime 0.508553, Loss 1.317819, forward nfe 22284, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 039/100, Runtime 0.511485, Loss 1.266972, forward nfe 22726, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 040/100, Runtime 0.495764, Loss 1.357473, forward nfe 23162, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 041/100, Runtime 0.494006, Loss 1.479795, forward nfe 23592, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 042/100, Runtime 0.492698, Loss 1.294618, forward nfe 24022, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 043/100, Runtime 0.486653, Loss 1.429723, forward nfe 24446, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 044/100, Runtime 0.484997, Loss 1.384153, forward nfe 24870, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 045/100, Runtime 0.488362, Loss 1.350712, forward nfe 25282, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 046/100, Runtime 0.480650, Loss 1.337967, forward nfe 25694, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 047/100, Runtime 0.485986, Loss 1.343584, forward nfe 26100, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 048/100, Runtime 0.471868, Loss 1.276154, forward nfe 26506, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 049/100, Runtime 0.458789, Loss 1.225363, forward nfe 26900, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 050/100, Runtime 0.585681, Loss 1.318584, forward nfe 27294, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 051/100, Runtime 0.441260, Loss 1.204447, forward nfe 27682, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 052/100, Runtime 0.432823, Loss 1.225532, forward nfe 28064, backward nfe 0, Train: 0.7417, Val: 0.7428, Test: 0.7177, Best time: 90.0000
Epoch: 053/100, Runtime 0.433942, Loss 1.199011, forward nfe 28446, backward nfe 0, Train: 0.7583, Val: 0.7449, Test: 0.7210, Best time: 56.7966
Epoch: 054/100, Runtime 0.434793, Loss 1.201123, forward nfe 28822, backward nfe 0, Train: 0.7583, Val: 0.7449, Test: 0.7210, Best time: 90.0000
Epoch: 055/100, Runtime 0.427361, Loss 1.205921, forward nfe 29186, backward nfe 0, Train: 0.7583, Val: 0.7464, Test: 0.7177, Best time: 68.6375
Epoch: 056/100, Runtime 0.415716, Loss 1.192544, forward nfe 29550, backward nfe 0, Train: 0.7583, Val: 0.7464, Test: 0.7177, Best time: 90.0000
Epoch: 057/100, Runtime 0.404793, Loss 1.141847, forward nfe 29914, backward nfe 0, Train: 0.7583, Val: 0.7464, Test: 0.7177, Best time: 90.0000
Epoch: 058/100, Runtime 0.417172, Loss 1.196171, forward nfe 30272, backward nfe 0, Train: 0.7583, Val: 0.7464, Test: 0.7177, Best time: 90.0000
Epoch: 059/100, Runtime 0.409227, Loss 1.152992, forward nfe 30630, backward nfe 0, Train: 0.7583, Val: 0.7464, Test: 0.7177, Best time: 90.0000
Epoch: 060/100, Runtime 0.412609, Loss 1.253187, forward nfe 30982, backward nfe 0, Train: 0.7667, Val: 0.7514, Test: 0.7097, Best time: 85.9609
Epoch: 061/100, Runtime 0.422745, Loss 1.077195, forward nfe 31334, backward nfe 0, Train: 0.7667, Val: 0.7514, Test: 0.7097, Best time: 90.0000
Epoch: 062/100, Runtime 0.428866, Loss 1.172748, forward nfe 31686, backward nfe 0, Train: 0.7667, Val: 0.7514, Test: 0.7097, Best time: 90.0000
Epoch: 063/100, Runtime 0.407905, Loss 1.212774, forward nfe 32032, backward nfe 0, Train: 0.7667, Val: 0.7514, Test: 0.7097, Best time: 90.0000
Epoch: 064/100, Runtime 0.424215, Loss 1.137709, forward nfe 32378, backward nfe 0, Train: 0.7667, Val: 0.7514, Test: 0.7097, Best time: 90.0000
Epoch: 065/100, Runtime 0.426269, Loss 1.248474, forward nfe 32724, backward nfe 0, Train: 0.7667, Val: 0.7514, Test: 0.7097, Best time: 90.0000
Epoch: 066/100, Runtime 0.404370, Loss 1.154068, forward nfe 33070, backward nfe 0, Train: 0.7833, Val: 0.7601, Test: 0.7113, Best time: 49.4322
Epoch: 067/100, Runtime 0.415257, Loss 1.244456, forward nfe 33416, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 48.4239
Epoch: 068/100, Runtime 0.415801, Loss 1.251878, forward nfe 33768, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 069/100, Runtime 0.420629, Loss 1.258141, forward nfe 34120, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 070/100, Runtime 0.424073, Loss 1.284561, forward nfe 34472, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 071/100, Runtime 0.416517, Loss 1.244284, forward nfe 34824, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 072/100, Runtime 0.418170, Loss 1.239769, forward nfe 35170, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 073/100, Runtime 0.416198, Loss 1.224915, forward nfe 35510, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 074/100, Runtime 0.437004, Loss 1.307493, forward nfe 35856, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 075/100, Runtime 0.410258, Loss 1.319428, forward nfe 36202, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 076/100, Runtime 0.400993, Loss 1.195592, forward nfe 36542, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 077/100, Runtime 0.408267, Loss 1.224996, forward nfe 36876, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 078/100, Runtime 0.415617, Loss 1.277862, forward nfe 37216, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 079/100, Runtime 0.413018, Loss 1.224541, forward nfe 37556, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 080/100, Runtime 0.409253, Loss 1.125986, forward nfe 37902, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 081/100, Runtime 0.438051, Loss 1.366875, forward nfe 38248, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 082/100, Runtime 0.411913, Loss 1.133967, forward nfe 38588, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 083/100, Runtime 0.398565, Loss 1.096829, forward nfe 38922, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 084/100, Runtime 0.395834, Loss 1.288052, forward nfe 39256, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 085/100, Runtime 0.392437, Loss 1.136779, forward nfe 39584, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 086/100, Runtime 0.395516, Loss 1.182277, forward nfe 39912, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 087/100, Runtime 0.387256, Loss 1.202304, forward nfe 40240, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 088/100, Runtime 0.396951, Loss 1.126375, forward nfe 40568, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 089/100, Runtime 0.410741, Loss 1.265783, forward nfe 40890, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 090/100, Runtime 0.410508, Loss 1.209208, forward nfe 41212, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 091/100, Runtime 0.408074, Loss 1.188045, forward nfe 41540, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 092/100, Runtime 0.388687, Loss 1.240717, forward nfe 41868, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 093/100, Runtime 0.383383, Loss 1.220921, forward nfe 42196, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 094/100, Runtime 0.393579, Loss 1.084629, forward nfe 42518, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 095/100, Runtime 0.391525, Loss 1.184458, forward nfe 42840, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 096/100, Runtime 0.386328, Loss 1.285813, forward nfe 43162, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 097/100, Runtime 0.383852, Loss 1.112369, forward nfe 43484, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 098/100, Runtime 0.389642, Loss 1.181238, forward nfe 43806, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
Epoch: 099/100, Runtime 0.390289, Loss 1.194176, forward nfe 44128, backward nfe 0, Train: 0.7917, Val: 0.7652, Test: 0.7274, Best time: 90.0000
best val accuracy 0.765217 with test accuracy 0.727419 at epoch 67 and best time 90.000000