/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.686550, Loss 1.793850, forward nfe 170, backward nfe 0, Train: 0.2000, Val: 0.2783, Test: 0.2984, Best time: 0.0408
Epoch: 002/100, Runtime 0.614988, Loss 1.786722, forward nfe 714, backward nfe 0, Train: 0.5250, Val: 0.5043, Test: 0.5403, Best time: 0.3195
Epoch: 003/100, Runtime 0.631280, Loss 1.765209, forward nfe 1264, backward nfe 0, Train: 0.6250, Val: 0.6239, Test: 0.6274, Best time: 0.8622
Epoch: 004/100, Runtime 0.639586, Loss 1.738931, forward nfe 1814, backward nfe 0, Train: 0.6333, Val: 0.6775, Test: 0.6919, Best time: 164.8549
Epoch: 005/100, Runtime 0.633883, Loss 1.700232, forward nfe 2364, backward nfe 0, Train: 0.6667, Val: 0.6920, Test: 0.7032, Best time: 83.2546
Epoch: 006/100, Runtime 0.616715, Loss 1.667825, forward nfe 2908, backward nfe 0, Train: 0.6917, Val: 0.7000, Test: 0.7161, Best time: 71.1834
Epoch: 007/100, Runtime 0.592114, Loss 1.623701, forward nfe 3434, backward nfe 0, Train: 0.7083, Val: 0.7152, Test: 0.7258, Best time: 48.6550
Epoch: 008/100, Runtime 0.593340, Loss 1.602189, forward nfe 3954, backward nfe 0, Train: 0.7250, Val: 0.7442, Test: 0.7484, Best time: 33.6194
Epoch: 009/100, Runtime 0.574587, Loss 1.561587, forward nfe 4474, backward nfe 0, Train: 0.7667, Val: 0.7558, Test: 0.7742, Best time: 18.1297
Epoch: 010/100, Runtime 0.605857, Loss 1.549217, forward nfe 4982, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 22.4351
Epoch: 011/100, Runtime 0.562903, Loss 1.491080, forward nfe 5484, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 012/100, Runtime 0.561117, Loss 1.475182, forward nfe 5986, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 013/100, Runtime 0.555122, Loss 1.467415, forward nfe 6476, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 014/100, Runtime 0.521968, Loss 1.382659, forward nfe 6948, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 015/100, Runtime 0.530483, Loss 1.338706, forward nfe 7414, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 016/100, Runtime 0.526136, Loss 1.328525, forward nfe 7892, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 017/100, Runtime 0.543205, Loss 1.261893, forward nfe 8364, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 018/100, Runtime 0.513547, Loss 1.258783, forward nfe 8824, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 019/100, Runtime 0.509196, Loss 1.186216, forward nfe 9266, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 020/100, Runtime 0.488667, Loss 1.188762, forward nfe 9702, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 021/100, Runtime 0.500484, Loss 1.145642, forward nfe 10132, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 022/100, Runtime 0.498101, Loss 1.166904, forward nfe 10568, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 023/100, Runtime 0.507076, Loss 1.084691, forward nfe 10992, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 024/100, Runtime 0.496181, Loss 1.121573, forward nfe 11410, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 025/100, Runtime 0.508102, Loss 1.085909, forward nfe 11828, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 026/100, Runtime 0.471169, Loss 1.158888, forward nfe 12228, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 027/100, Runtime 0.451207, Loss 1.138889, forward nfe 12628, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 028/100, Runtime 0.448554, Loss 1.086167, forward nfe 13022, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 029/100, Runtime 0.458511, Loss 1.053809, forward nfe 13404, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 030/100, Runtime 0.434409, Loss 1.033277, forward nfe 13786, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 031/100, Runtime 0.428766, Loss 1.121990, forward nfe 14156, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 032/100, Runtime 0.438089, Loss 1.053379, forward nfe 14526, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 033/100, Runtime 0.431777, Loss 0.973900, forward nfe 14896, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 034/100, Runtime 0.421815, Loss 1.087837, forward nfe 15266, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 035/100, Runtime 0.414613, Loss 0.977088, forward nfe 15630, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 036/100, Runtime 0.413140, Loss 1.062527, forward nfe 15982, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 037/100, Runtime 0.408430, Loss 1.117719, forward nfe 16334, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 038/100, Runtime 0.413474, Loss 1.084455, forward nfe 16674, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 039/100, Runtime 0.395389, Loss 1.042299, forward nfe 17020, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 040/100, Runtime 0.388773, Loss 1.074752, forward nfe 17354, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 041/100, Runtime 0.392488, Loss 1.023266, forward nfe 17688, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 042/100, Runtime 0.392236, Loss 1.058514, forward nfe 18022, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 043/100, Runtime 0.380099, Loss 1.110199, forward nfe 18350, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 044/100, Runtime 0.387535, Loss 1.229011, forward nfe 18672, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 045/100, Runtime 0.378664, Loss 1.140217, forward nfe 18994, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 046/100, Runtime 0.379468, Loss 1.136855, forward nfe 19310, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 047/100, Runtime 0.378229, Loss 1.036880, forward nfe 19626, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 048/100, Runtime 0.376605, Loss 1.086663, forward nfe 19942, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 049/100, Runtime 0.388515, Loss 0.989136, forward nfe 20258, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 050/100, Runtime 0.381768, Loss 1.084777, forward nfe 20568, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 051/100, Runtime 0.364456, Loss 1.013985, forward nfe 20872, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 052/100, Runtime 0.365307, Loss 1.055743, forward nfe 21170, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 053/100, Runtime 0.351066, Loss 1.115416, forward nfe 21468, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 054/100, Runtime 0.343237, Loss 1.034529, forward nfe 21766, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 055/100, Runtime 0.357192, Loss 1.198270, forward nfe 22058, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 056/100, Runtime 0.349224, Loss 1.044751, forward nfe 22350, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 057/100, Runtime 0.349809, Loss 1.076577, forward nfe 22642, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 058/100, Runtime 0.351537, Loss 1.130338, forward nfe 22934, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 059/100, Runtime 0.355664, Loss 1.029708, forward nfe 23226, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 060/100, Runtime 0.359363, Loss 1.107391, forward nfe 23512, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 061/100, Runtime 0.350434, Loss 1.067860, forward nfe 23798, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 062/100, Runtime 0.368443, Loss 1.019678, forward nfe 24084, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 063/100, Runtime 0.349894, Loss 1.018297, forward nfe 24370, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 064/100, Runtime 0.345337, Loss 0.941805, forward nfe 24656, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 065/100, Runtime 0.484576, Loss 1.175902, forward nfe 24942, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 066/100, Runtime 0.379270, Loss 1.069171, forward nfe 25234, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 067/100, Runtime 0.344737, Loss 0.981525, forward nfe 25532, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 068/100, Runtime 0.352736, Loss 1.015603, forward nfe 25818, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 069/100, Runtime 0.345102, Loss 0.963406, forward nfe 26110, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 070/100, Runtime 0.348342, Loss 1.106507, forward nfe 26396, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 071/100, Runtime 0.358809, Loss 1.036843, forward nfe 26688, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 072/100, Runtime 0.348519, Loss 1.012801, forward nfe 26980, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 073/100, Runtime 0.363168, Loss 1.140709, forward nfe 27272, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 074/100, Runtime 0.356406, Loss 1.157749, forward nfe 27558, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 075/100, Runtime 0.348183, Loss 1.035513, forward nfe 27844, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 076/100, Runtime 0.375007, Loss 1.214593, forward nfe 28136, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 077/100, Runtime 0.354828, Loss 1.034423, forward nfe 28428, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 078/100, Runtime 0.351786, Loss 1.042235, forward nfe 28714, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 079/100, Runtime 0.354974, Loss 1.001571, forward nfe 29000, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 080/100, Runtime 0.359626, Loss 0.998255, forward nfe 29286, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 081/100, Runtime 0.348349, Loss 0.955508, forward nfe 29572, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 082/100, Runtime 0.357369, Loss 1.063024, forward nfe 29858, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 083/100, Runtime 0.354993, Loss 1.010274, forward nfe 30144, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 084/100, Runtime 0.346269, Loss 1.139710, forward nfe 30424, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 085/100, Runtime 0.338691, Loss 1.088197, forward nfe 30704, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 086/100, Runtime 0.340439, Loss 1.144168, forward nfe 30984, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 087/100, Runtime 0.338757, Loss 1.063053, forward nfe 31264, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 088/100, Runtime 0.350954, Loss 1.124642, forward nfe 31544, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 089/100, Runtime 0.347379, Loss 1.051626, forward nfe 31824, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 090/100, Runtime 0.331892, Loss 1.083640, forward nfe 32104, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 091/100, Runtime 0.333694, Loss 0.972988, forward nfe 32378, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 092/100, Runtime 0.336958, Loss 1.137352, forward nfe 32652, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 093/100, Runtime 0.335390, Loss 1.002685, forward nfe 32932, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 094/100, Runtime 0.354598, Loss 1.010210, forward nfe 33200, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 095/100, Runtime 0.328520, Loss 1.148650, forward nfe 33468, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 096/100, Runtime 0.326024, Loss 0.895664, forward nfe 33736, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 097/100, Runtime 0.325776, Loss 1.022761, forward nfe 34004, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 098/100, Runtime 0.321520, Loss 0.952890, forward nfe 34272, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
Epoch: 099/100, Runtime 0.342389, Loss 1.088651, forward nfe 34540, backward nfe 0, Train: 0.7583, Val: 0.7594, Test: 0.7532, Best time: 60.0000
best val accuracy 0.759420 with test accuracy 0.753226 at epoch 10 and best time 60.000000