/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 4.944521, Loss 1.947987, forward nfe 110, backward nfe 0, Train: 0.1786, Val: 0.3441, Test: 0.2985, Best time: 0.0916
Epoch: 002/100, Runtime 5.103164, Loss 1.977257, forward nfe 546, backward nfe 0, Train: 0.1786, Val: 0.3441, Test: 0.2985, Best time: 55.0000
Epoch: 003/100, Runtime 4.831802, Loss 1.932450, forward nfe 970, backward nfe 0, Train: 0.1786, Val: 0.3441, Test: 0.2985, Best time: 55.0000
Epoch: 004/100, Runtime 4.881493, Loss 1.886556, forward nfe 1388, backward nfe 0, Train: 0.2714, Val: 0.3875, Test: 0.3553, Best time: 0.0851
Epoch: 005/100, Runtime 4.456851, Loss 1.774320, forward nfe 1788, backward nfe 0, Train: 0.6071, Val: 0.7603, Test: 0.7513, Best time: 12.7365
Epoch: 006/100, Runtime 4.644336, Loss 1.598814, forward nfe 2176, backward nfe 0, Train: 0.7571, Val: 0.7743, Test: 0.7807, Best time: 7.6232
Epoch: 007/100, Runtime 4.461596, Loss 1.426569, forward nfe 2558, backward nfe 0, Train: 0.8143, Val: 0.7787, Test: 0.7970, Best time: 7.9185
Epoch: 008/100, Runtime 4.327325, Loss 1.239501, forward nfe 2934, backward nfe 0, Train: 0.8429, Val: 0.8250, Test: 0.8173, Best time: 42.6656
Epoch: 009/100, Runtime 4.162109, Loss 1.038867, forward nfe 3304, backward nfe 0, Train: 0.8429, Val: 0.8250, Test: 0.8173, Best time: 55.0000
Epoch: 010/100, Runtime 4.171507, Loss 0.859701, forward nfe 3662, backward nfe 0, Train: 0.8429, Val: 0.8250, Test: 0.8173, Best time: 55.0000
Epoch: 011/100, Runtime 4.155467, Loss 0.724626, forward nfe 4020, backward nfe 0, Train: 0.8429, Val: 0.8250, Test: 0.8173, Best time: 55.0000
Epoch: 012/100, Runtime 4.153399, Loss 0.618310, forward nfe 4372, backward nfe 0, Train: 0.8714, Val: 0.8272, Test: 0.8274, Best time: 17.1764
Epoch: 013/100, Runtime 3.892568, Loss 0.519657, forward nfe 4712, backward nfe 0, Train: 0.8786, Val: 0.8331, Test: 0.8244, Best time: 24.1454
Epoch: 014/100, Runtime 3.852572, Loss 0.519309, forward nfe 5046, backward nfe 0, Train: 0.9071, Val: 0.8346, Test: 0.8294, Best time: 34.1709
Epoch: 015/100, Runtime 3.617015, Loss 0.446641, forward nfe 5368, backward nfe 0, Train: 0.9071, Val: 0.8346, Test: 0.8294, Best time: 55.0000
Epoch: 016/100, Runtime 3.481764, Loss 0.392006, forward nfe 5666, backward nfe 0, Train: 0.9071, Val: 0.8346, Test: 0.8294, Best time: 55.0000
Epoch: 017/100, Runtime 3.542075, Loss 0.393726, forward nfe 5964, backward nfe 0, Train: 0.9071, Val: 0.8412, Test: 0.8406, Best time: 39.4731
Epoch: 018/100, Runtime 3.552523, Loss 0.379566, forward nfe 6268, backward nfe 0, Train: 0.9071, Val: 0.8419, Test: 0.8396, Best time: 41.3153
Epoch: 019/100, Runtime 3.387042, Loss 0.321334, forward nfe 6560, backward nfe 0, Train: 0.9071, Val: 0.8419, Test: 0.8396, Best time: 55.0000
Epoch: 020/100, Runtime 3.242389, Loss 0.417027, forward nfe 6840, backward nfe 0, Train: 0.9071, Val: 0.8419, Test: 0.8396, Best time: 55.0000
Epoch: 021/100, Runtime 3.121193, Loss 0.344784, forward nfe 7120, backward nfe 0, Train: 0.9071, Val: 0.8419, Test: 0.8396, Best time: 55.0000
Epoch: 022/100, Runtime 3.279831, Loss 0.341009, forward nfe 7382, backward nfe 0, Train: 0.9071, Val: 0.8419, Test: 0.8396, Best time: 55.0000
Epoch: 023/100, Runtime 3.136092, Loss 0.305439, forward nfe 7644, backward nfe 0, Train: 0.9071, Val: 0.8419, Test: 0.8396, Best time: 55.0000
Epoch: 024/100, Runtime 3.019054, Loss 0.282850, forward nfe 7912, backward nfe 0, Train: 0.9071, Val: 0.8419, Test: 0.8396, Best time: 55.0000
Epoch: 025/100, Runtime 3.099419, Loss 0.253128, forward nfe 8168, backward nfe 0, Train: 0.9071, Val: 0.8419, Test: 0.8396, Best time: 55.0000
Epoch: 026/100, Runtime 2.869220, Loss 0.317495, forward nfe 8412, backward nfe 0, Train: 0.9071, Val: 0.8419, Test: 0.8396, Best time: 55.0000
Epoch: 027/100, Runtime 2.836517, Loss 0.364649, forward nfe 8656, backward nfe 0, Train: 0.9071, Val: 0.8419, Test: 0.8396, Best time: 55.0000
Epoch: 028/100, Runtime 2.830609, Loss 0.279630, forward nfe 8888, backward nfe 0, Train: 0.9071, Val: 0.8419, Test: 0.8396, Best time: 55.0000
Epoch: 029/100, Runtime 2.902638, Loss 0.298795, forward nfe 9126, backward nfe 0, Train: 0.9071, Val: 0.8419, Test: 0.8396, Best time: 55.0000
Epoch: 030/100, Runtime 2.836607, Loss 0.303318, forward nfe 9364, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 121.1762
Epoch: 031/100, Runtime 2.888538, Loss 0.262138, forward nfe 9602, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 032/100, Runtime 2.875517, Loss 0.321914, forward nfe 9840, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 033/100, Runtime 2.857562, Loss 0.236482, forward nfe 10078, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 034/100, Runtime 2.838186, Loss 0.228049, forward nfe 10316, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 035/100, Runtime 2.763029, Loss 0.209096, forward nfe 10548, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 036/100, Runtime 2.871677, Loss 0.225917, forward nfe 10774, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 037/100, Runtime 2.537468, Loss 0.215231, forward nfe 11000, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 038/100, Runtime 2.846173, Loss 0.190679, forward nfe 11226, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 039/100, Runtime 2.656583, Loss 0.148559, forward nfe 11452, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 040/100, Runtime 2.724093, Loss 0.229434, forward nfe 11678, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 041/100, Runtime 2.723284, Loss 0.181985, forward nfe 11904, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 042/100, Runtime 2.702584, Loss 0.149174, forward nfe 12130, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 043/100, Runtime 2.760022, Loss 0.132436, forward nfe 12356, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 044/100, Runtime 2.664903, Loss 0.148558, forward nfe 12582, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 045/100, Runtime 2.863181, Loss 0.139535, forward nfe 12808, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 046/100, Runtime 2.606701, Loss 0.128239, forward nfe 13034, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 047/100, Runtime 2.863465, Loss 0.153034, forward nfe 13260, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 048/100, Runtime 2.686038, Loss 0.150794, forward nfe 13486, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 049/100, Runtime 2.791767, Loss 0.137305, forward nfe 13712, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 050/100, Runtime 2.668748, Loss 0.140828, forward nfe 13938, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 051/100, Runtime 2.541271, Loss 0.117894, forward nfe 14158, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 052/100, Runtime 2.690042, Loss 0.142986, forward nfe 14372, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 053/100, Runtime 2.524375, Loss 0.138721, forward nfe 14586, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 054/100, Runtime 2.517736, Loss 0.073679, forward nfe 14800, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 055/100, Runtime 2.644433, Loss 0.111482, forward nfe 15014, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 056/100, Runtime 2.588693, Loss 0.162372, forward nfe 15228, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 057/100, Runtime 2.392674, Loss 0.076320, forward nfe 15442, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 058/100, Runtime 2.695008, Loss 0.068586, forward nfe 15650, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 059/100, Runtime 2.503565, Loss 0.077571, forward nfe 15864, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 060/100, Runtime 2.472288, Loss 0.063490, forward nfe 16078, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 061/100, Runtime 2.567094, Loss 0.096101, forward nfe 16286, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 062/100, Runtime 2.521679, Loss 0.092050, forward nfe 16494, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 063/100, Runtime 2.472377, Loss 0.069726, forward nfe 16702, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 064/100, Runtime 2.635830, Loss 0.061521, forward nfe 16910, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 065/100, Runtime 2.488418, Loss 0.085248, forward nfe 17118, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 066/100, Runtime 0.475225, Loss 0.068401, forward nfe 17326, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 067/100, Runtime 0.392443, Loss 0.097993, forward nfe 17534, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 068/100, Runtime 0.367159, Loss 0.130208, forward nfe 17742, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 069/100, Runtime 0.303149, Loss 0.071773, forward nfe 17950, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 070/100, Runtime 0.292542, Loss 0.079513, forward nfe 18158, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 071/100, Runtime 0.296273, Loss 0.077859, forward nfe 18366, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 072/100, Runtime 0.298526, Loss 0.119768, forward nfe 18574, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 073/100, Runtime 0.292104, Loss 0.038999, forward nfe 18782, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 074/100, Runtime 0.290820, Loss 0.061580, forward nfe 18984, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 075/100, Runtime 0.287879, Loss 0.047852, forward nfe 19186, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 076/100, Runtime 0.300924, Loss 0.086229, forward nfe 19388, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 077/100, Runtime 0.293276, Loss 0.058791, forward nfe 19590, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 078/100, Runtime 0.332688, Loss 0.082450, forward nfe 19792, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 079/100, Runtime 0.333447, Loss 0.079369, forward nfe 19994, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 080/100, Runtime 0.466469, Loss 0.047171, forward nfe 20196, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 081/100, Runtime 0.722764, Loss 0.092442, forward nfe 20398, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 082/100, Runtime 0.681814, Loss 0.057181, forward nfe 20600, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 083/100, Runtime 0.630081, Loss 0.069315, forward nfe 20802, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 084/100, Runtime 0.747960, Loss 0.063613, forward nfe 21004, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 085/100, Runtime 0.697906, Loss 0.069185, forward nfe 21206, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 086/100, Runtime 0.638155, Loss 0.081137, forward nfe 21408, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 087/100, Runtime 0.705296, Loss 0.079268, forward nfe 21610, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 088/100, Runtime 0.696037, Loss 0.056860, forward nfe 21812, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 089/100, Runtime 0.621772, Loss 0.069143, forward nfe 22014, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 090/100, Runtime 0.688604, Loss 0.062730, forward nfe 22216, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 091/100, Runtime 0.566708, Loss 0.063685, forward nfe 22418, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 092/100, Runtime 0.690439, Loss 0.030492, forward nfe 22620, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 093/100, Runtime 0.558379, Loss 0.089942, forward nfe 22822, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 094/100, Runtime 0.688241, Loss 0.046013, forward nfe 23024, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 095/100, Runtime 0.566847, Loss 0.075438, forward nfe 23226, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 096/100, Runtime 0.684349, Loss 0.064063, forward nfe 23428, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 097/100, Runtime 0.590298, Loss 0.055488, forward nfe 23630, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 098/100, Runtime 0.701921, Loss 0.041819, forward nfe 23832, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
Epoch: 099/100, Runtime 0.640060, Loss 0.063811, forward nfe 24034, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8284, Best time: 55.0000
best val accuracy 0.849265 with test accuracy 0.828426 at epoch 30 and best time 55.000000