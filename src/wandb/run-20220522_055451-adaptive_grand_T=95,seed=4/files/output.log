/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 5.477426, Loss 1.948213, forward nfe 176, backward nfe 0, Train: 0.2286, Val: 0.2228, Test: 0.2000, Best time: 17.7976
Epoch: 002/100, Runtime 5.372241, Loss 2.017586, forward nfe 858, backward nfe 0, Train: 0.2286, Val: 0.2228, Test: 0.2000, Best time: 95.0000
Epoch: 003/100, Runtime 5.154575, Loss 1.969743, forward nfe 1522, backward nfe 0, Train: 0.2071, Val: 0.2272, Test: 0.2183, Best time: 2.1293
Epoch: 004/100, Runtime 6.865471, Loss 1.919267, forward nfe 2192, backward nfe 0, Train: 0.2071, Val: 0.2272, Test: 0.2183, Best time: 95.0000
Epoch: 005/100, Runtime 7.110063, Loss 1.884711, forward nfe 2844, backward nfe 0, Train: 0.2071, Val: 0.2272, Test: 0.2183, Best time: 95.0000
Epoch: 006/100, Runtime 6.449422, Loss 1.829412, forward nfe 3484, backward nfe 0, Train: 0.3786, Val: 0.3301, Test: 0.2954, Best time: 9.6555
Epoch: 007/100, Runtime 6.085205, Loss 1.745441, forward nfe 4112, backward nfe 0, Train: 0.5214, Val: 0.4971, Test: 0.4447, Best time: 22.3985
Epoch: 008/100, Runtime 6.298885, Loss 1.654645, forward nfe 4716, backward nfe 0, Train: 0.5714, Val: 0.5500, Test: 0.4883, Best time: 5.8013
Epoch: 009/100, Runtime 4.213845, Loss 1.529567, forward nfe 5302, backward nfe 0, Train: 0.6857, Val: 0.6199, Test: 0.5635, Best time: 32.9466
Epoch: 010/100, Runtime 4.322376, Loss 1.384710, forward nfe 5864, backward nfe 0, Train: 0.8143, Val: 0.6757, Test: 0.6406, Best time: 26.6762
Epoch: 011/100, Runtime 4.177402, Loss 1.228900, forward nfe 6420, backward nfe 0, Train: 0.8286, Val: 0.7551, Test: 0.7289, Best time: 28.1388
Epoch: 012/100, Runtime 4.254644, Loss 1.079111, forward nfe 6964, backward nfe 0, Train: 0.8500, Val: 0.7654, Test: 0.7330, Best time: 16.8662
Epoch: 013/100, Runtime 3.920588, Loss 0.926001, forward nfe 7508, backward nfe 0, Train: 0.8714, Val: 0.7926, Test: 0.7797, Best time: 17.5662
Epoch: 014/100, Runtime 4.033925, Loss 0.812152, forward nfe 8040, backward nfe 0, Train: 0.8357, Val: 0.7971, Test: 0.7645, Best time: 32.4962
Epoch: 015/100, Runtime 3.819371, Loss 0.682652, forward nfe 8554, backward nfe 0, Train: 0.8357, Val: 0.7971, Test: 0.7645, Best time: 95.0000
Epoch: 016/100, Runtime 3.131654, Loss 0.643188, forward nfe 9062, backward nfe 0, Train: 0.8357, Val: 0.7971, Test: 0.7645, Best time: 95.0000
Epoch: 017/100, Runtime 3.459850, Loss 0.591256, forward nfe 9546, backward nfe 0, Train: 0.8286, Val: 0.8074, Test: 0.7939, Best time: 114.8202
Epoch: 018/100, Runtime 3.366569, Loss 0.564746, forward nfe 10012, backward nfe 0, Train: 0.8643, Val: 0.8081, Test: 0.7980, Best time: 83.1989
Epoch: 019/100, Runtime 3.403781, Loss 0.497425, forward nfe 10466, backward nfe 0, Train: 0.8929, Val: 0.8140, Test: 0.8030, Best time: 23.5318
Epoch: 020/100, Runtime 3.348578, Loss 0.580741, forward nfe 10908, backward nfe 0, Train: 0.8929, Val: 0.8140, Test: 0.8030, Best time: 95.0000
Epoch: 021/100, Runtime 3.369111, Loss 0.453040, forward nfe 11350, backward nfe 0, Train: 0.8929, Val: 0.8140, Test: 0.8030, Best time: 95.0000
Epoch: 022/100, Runtime 3.014402, Loss 0.592490, forward nfe 11786, backward nfe 0, Train: 0.8929, Val: 0.8140, Test: 0.8030, Best time: 95.0000
Epoch: 023/100, Runtime 3.244475, Loss 0.441865, forward nfe 12216, backward nfe 0, Train: 0.8929, Val: 0.8140, Test: 0.8030, Best time: 95.0000
Epoch: 024/100, Runtime 3.115733, Loss 0.516031, forward nfe 12628, backward nfe 0, Train: 0.9071, Val: 0.8191, Test: 0.8071, Best time: 42.7820
Epoch: 025/100, Runtime 3.097484, Loss 0.494345, forward nfe 13034, backward nfe 0, Train: 0.8786, Val: 0.8353, Test: 0.7939, Best time: 61.7581
Epoch: 026/100, Runtime 3.113727, Loss 0.527267, forward nfe 13422, backward nfe 0, Train: 0.8786, Val: 0.8353, Test: 0.7939, Best time: 95.0000
Epoch: 027/100, Runtime 3.093233, Loss 0.412216, forward nfe 13810, backward nfe 0, Train: 0.8786, Val: 0.8353, Test: 0.7939, Best time: 95.0000
Epoch: 028/100, Runtime 3.017748, Loss 0.400655, forward nfe 14198, backward nfe 0, Train: 0.8786, Val: 0.8353, Test: 0.7939, Best time: 95.0000
Epoch: 029/100, Runtime 2.911126, Loss 0.444745, forward nfe 14568, backward nfe 0, Train: 0.9071, Val: 0.8404, Test: 0.8213, Best time: 62.9762
Epoch: 030/100, Runtime 2.902062, Loss 0.450285, forward nfe 14932, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 91.5229
Epoch: 031/100, Runtime 2.820766, Loss 0.336213, forward nfe 15284, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 032/100, Runtime 2.768808, Loss 0.355128, forward nfe 15630, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 033/100, Runtime 2.717657, Loss 0.382724, forward nfe 15964, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 034/100, Runtime 2.602860, Loss 0.321392, forward nfe 16304, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 035/100, Runtime 2.583060, Loss 0.291091, forward nfe 16644, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 036/100, Runtime 2.553447, Loss 0.384248, forward nfe 16984, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 037/100, Runtime 2.482342, Loss 0.275650, forward nfe 17306, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 038/100, Runtime 2.328935, Loss 0.260005, forward nfe 17634, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 039/100, Runtime 2.274785, Loss 0.297261, forward nfe 17950, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 040/100, Runtime 2.494111, Loss 0.309832, forward nfe 18260, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 041/100, Runtime 2.492859, Loss 0.224725, forward nfe 18576, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 042/100, Runtime 2.500372, Loss 0.252211, forward nfe 18874, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 043/100, Runtime 2.298522, Loss 0.282442, forward nfe 19166, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 044/100, Runtime 2.879639, Loss 0.246593, forward nfe 19446, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 045/100, Runtime 3.088630, Loss 0.242736, forward nfe 19726, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 046/100, Runtime 3.126524, Loss 0.262144, forward nfe 20006, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 047/100, Runtime 3.213410, Loss 0.242305, forward nfe 20280, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 048/100, Runtime 3.214493, Loss 0.215619, forward nfe 20560, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 049/100, Runtime 3.002885, Loss 0.257736, forward nfe 20840, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 050/100, Runtime 3.147079, Loss 0.186991, forward nfe 21120, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 051/100, Runtime 3.131038, Loss 0.245912, forward nfe 21388, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 052/100, Runtime 2.762914, Loss 0.185981, forward nfe 21650, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 053/100, Runtime 2.636956, Loss 0.175829, forward nfe 21906, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 054/100, Runtime 2.489894, Loss 0.207649, forward nfe 22162, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 055/100, Runtime 1.981325, Loss 0.184893, forward nfe 22418, backward nfe 0, Train: 0.9143, Val: 0.8434, Test: 0.8274, Best time: 95.0000
Epoch: 056/100, Runtime 1.995897, Loss 0.206168, forward nfe 22674, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 192.1175
Epoch: 057/100, Runtime 1.964471, Loss 0.205524, forward nfe 22936, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 058/100, Runtime 2.031929, Loss 0.190898, forward nfe 23180, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 059/100, Runtime 2.024194, Loss 0.146439, forward nfe 23424, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 060/100, Runtime 2.014438, Loss 0.200981, forward nfe 23668, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 061/100, Runtime 2.072284, Loss 0.141734, forward nfe 23918, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 062/100, Runtime 2.035936, Loss 0.156156, forward nfe 24168, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 063/100, Runtime 2.044273, Loss 0.147819, forward nfe 24418, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 064/100, Runtime 2.071803, Loss 0.121429, forward nfe 24668, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 065/100, Runtime 1.923982, Loss 0.121419, forward nfe 24918, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 066/100, Runtime 1.984310, Loss 0.135653, forward nfe 25162, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 067/100, Runtime 1.963109, Loss 0.130061, forward nfe 25406, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 068/100, Runtime 1.861395, Loss 0.090234, forward nfe 25650, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 069/100, Runtime 1.859543, Loss 0.114037, forward nfe 25894, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 070/100, Runtime 1.881900, Loss 0.120651, forward nfe 26138, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 071/100, Runtime 1.864818, Loss 0.086526, forward nfe 26382, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 072/100, Runtime 1.808131, Loss 0.071981, forward nfe 26626, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 073/100, Runtime 1.735029, Loss 0.072724, forward nfe 26864, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 074/100, Runtime 1.887049, Loss 0.071019, forward nfe 27102, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 075/100, Runtime 1.822031, Loss 0.085154, forward nfe 27340, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 076/100, Runtime 1.763782, Loss 0.051316, forward nfe 27572, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 077/100, Runtime 1.910341, Loss 0.088463, forward nfe 27804, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 078/100, Runtime 1.956238, Loss 0.088724, forward nfe 28042, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 079/100, Runtime 1.981645, Loss 0.081112, forward nfe 28286, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 080/100, Runtime 1.916501, Loss 0.088856, forward nfe 28530, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 081/100, Runtime 1.851334, Loss 0.081180, forward nfe 28768, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 082/100, Runtime 1.848377, Loss 0.089788, forward nfe 29006, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 083/100, Runtime 1.763006, Loss 0.116932, forward nfe 29250, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 084/100, Runtime 1.844243, Loss 0.138844, forward nfe 29488, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 085/100, Runtime 1.873892, Loss 0.075605, forward nfe 29726, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 086/100, Runtime 1.807776, Loss 0.087279, forward nfe 29958, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 087/100, Runtime 1.721095, Loss 0.066386, forward nfe 30172, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 088/100, Runtime 1.652787, Loss 0.066073, forward nfe 30386, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 089/100, Runtime 1.651723, Loss 0.082513, forward nfe 30594, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 090/100, Runtime 1.610227, Loss 0.040515, forward nfe 30802, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 091/100, Runtime 1.607718, Loss 0.053445, forward nfe 31010, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 092/100, Runtime 1.670091, Loss 0.074926, forward nfe 31218, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 093/100, Runtime 1.669412, Loss 0.062465, forward nfe 31426, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 094/100, Runtime 1.678738, Loss 0.061835, forward nfe 31634, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 095/100, Runtime 1.654183, Loss 0.097485, forward nfe 31842, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 096/100, Runtime 1.659600, Loss 0.069540, forward nfe 32050, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 097/100, Runtime 1.791770, Loss 0.032322, forward nfe 32258, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 098/100, Runtime 1.674096, Loss 0.041059, forward nfe 32466, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
Epoch: 099/100, Runtime 1.749215, Loss 0.083712, forward nfe 32674, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8386, Best time: 95.0000
best val accuracy 0.852941 with test accuracy 0.838579 at epoch 56 and best time 95.000000