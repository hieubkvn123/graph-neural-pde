/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 5.256410, Loss 1.946700, forward nfe 170, backward nfe 0, Train: 0.2429, Val: 0.1419, Test: 0.1482, Best time: 0.0969
Epoch: 002/100, Runtime 5.194806, Loss 1.888775, forward nfe 804, backward nfe 0, Train: 0.4929, Val: 0.5228, Test: 0.5239, Best time: 3.8473
Epoch: 003/100, Runtime 5.014131, Loss 1.790347, forward nfe 1438, backward nfe 0, Train: 0.6071, Val: 0.6596, Test: 0.6467, Best time: 7.9089
Epoch: 004/100, Runtime 4.548309, Loss 1.564602, forward nfe 2066, backward nfe 0, Train: 0.6071, Val: 0.6596, Test: 0.6467, Best time: 90.0000
Epoch: 005/100, Runtime 4.503512, Loss 1.375688, forward nfe 2676, backward nfe 0, Train: 0.6071, Val: 0.6596, Test: 0.6467, Best time: 90.0000
Epoch: 006/100, Runtime 4.601992, Loss 1.241069, forward nfe 3274, backward nfe 0, Train: 0.7929, Val: 0.7654, Test: 0.7492, Best time: 15.6721
Epoch: 007/100, Runtime 4.583044, Loss 0.990698, forward nfe 3848, backward nfe 0, Train: 0.7429, Val: 0.7735, Test: 0.7777, Best time: 9.0491
Epoch: 008/100, Runtime 4.158560, Loss 0.978079, forward nfe 4410, backward nfe 0, Train: 0.7786, Val: 0.8110, Test: 0.7990, Best time: 47.2214
Epoch: 009/100, Runtime 4.008064, Loss 0.799611, forward nfe 4948, backward nfe 0, Train: 0.7786, Val: 0.8110, Test: 0.7990, Best time: 90.0000
Epoch: 010/100, Runtime 4.023023, Loss 0.691433, forward nfe 5480, backward nfe 0, Train: 0.7786, Val: 0.8110, Test: 0.7990, Best time: 90.0000
Epoch: 011/100, Runtime 3.938657, Loss 0.703655, forward nfe 6000, backward nfe 0, Train: 0.8571, Val: 0.8294, Test: 0.8213, Best time: 10.6423
Epoch: 012/100, Runtime 3.947545, Loss 0.622352, forward nfe 6508, backward nfe 0, Train: 0.8571, Val: 0.8294, Test: 0.8213, Best time: 90.0000
Epoch: 013/100, Runtime 3.590799, Loss 0.572477, forward nfe 7010, backward nfe 0, Train: 0.8571, Val: 0.8294, Test: 0.8213, Best time: 90.0000
Epoch: 014/100, Runtime 3.698251, Loss 0.542841, forward nfe 7506, backward nfe 0, Train: 0.8714, Val: 0.8331, Test: 0.8426, Best time: 38.4067
Epoch: 015/100, Runtime 3.606762, Loss 0.515672, forward nfe 7990, backward nfe 0, Train: 0.8714, Val: 0.8331, Test: 0.8426, Best time: 90.0000
Epoch: 016/100, Runtime 3.349936, Loss 0.501610, forward nfe 8456, backward nfe 0, Train: 0.8714, Val: 0.8331, Test: 0.8426, Best time: 90.0000
Epoch: 017/100, Runtime 4.359022, Loss 0.484530, forward nfe 8910, backward nfe 0, Train: 0.8857, Val: 0.8375, Test: 0.8406, Best time: 57.7832
Epoch: 018/100, Runtime 3.855602, Loss 0.493892, forward nfe 9352, backward nfe 0, Train: 0.8857, Val: 0.8375, Test: 0.8406, Best time: 90.0000
Epoch: 019/100, Runtime 4.176671, Loss 0.485858, forward nfe 9800, backward nfe 0, Train: 0.8857, Val: 0.8375, Test: 0.8406, Best time: 90.0000
Epoch: 020/100, Runtime 2.132509, Loss 0.423563, forward nfe 10230, backward nfe 0, Train: 0.8857, Val: 0.8375, Test: 0.8406, Best time: 90.0000
Epoch: 021/100, Runtime 1.371615, Loss 0.424711, forward nfe 10660, backward nfe 0, Train: 0.9143, Val: 0.8390, Test: 0.8365, Best time: 81.4902
Epoch: 022/100, Runtime 1.366678, Loss 0.439305, forward nfe 11072, backward nfe 0, Train: 0.9143, Val: 0.8390, Test: 0.8365, Best time: 90.0000
Epoch: 023/100, Runtime 1.270400, Loss 0.400684, forward nfe 11460, backward nfe 0, Train: 0.9143, Val: 0.8390, Test: 0.8365, Best time: 90.0000
Epoch: 024/100, Runtime 1.401200, Loss 0.348420, forward nfe 11842, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8416, Best time: 104.4810
Epoch: 025/100, Runtime 1.389233, Loss 0.346337, forward nfe 12218, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8416, Best time: 90.0000
Epoch: 026/100, Runtime 1.321277, Loss 0.360495, forward nfe 12600, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8416, Best time: 90.0000
Epoch: 027/100, Runtime 1.388938, Loss 0.344074, forward nfe 12976, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 103.8574
Epoch: 028/100, Runtime 1.264655, Loss 0.352581, forward nfe 13340, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 029/100, Runtime 1.234398, Loss 0.377783, forward nfe 13680, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 030/100, Runtime 1.220814, Loss 0.406416, forward nfe 14020, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 031/100, Runtime 1.181530, Loss 0.307156, forward nfe 14354, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 032/100, Runtime 1.269799, Loss 0.353138, forward nfe 14694, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 033/100, Runtime 1.143664, Loss 0.319836, forward nfe 15028, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 034/100, Runtime 1.215246, Loss 0.354746, forward nfe 15356, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 035/100, Runtime 1.217676, Loss 0.241523, forward nfe 15678, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 036/100, Runtime 1.168477, Loss 0.285273, forward nfe 15994, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 037/100, Runtime 1.188791, Loss 0.316894, forward nfe 16298, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 038/100, Runtime 1.527924, Loss 0.242356, forward nfe 16608, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 039/100, Runtime 2.427341, Loss 0.256375, forward nfe 16906, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 040/100, Runtime 2.515640, Loss 0.360364, forward nfe 17204, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 041/100, Runtime 2.500110, Loss 0.202405, forward nfe 17502, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 042/100, Runtime 2.341643, Loss 0.180341, forward nfe 17794, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 043/100, Runtime 2.372325, Loss 0.291664, forward nfe 18086, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 044/100, Runtime 2.376773, Loss 0.280011, forward nfe 18378, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 045/100, Runtime 2.368043, Loss 0.204481, forward nfe 18670, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 046/100, Runtime 2.282299, Loss 0.247928, forward nfe 18962, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 047/100, Runtime 2.246405, Loss 0.297525, forward nfe 19242, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 048/100, Runtime 2.246520, Loss 0.288873, forward nfe 19522, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 049/100, Runtime 2.341573, Loss 0.350197, forward nfe 19802, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 050/100, Runtime 2.290279, Loss 0.223017, forward nfe 20082, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 051/100, Runtime 2.178986, Loss 0.170582, forward nfe 20362, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 052/100, Runtime 2.206276, Loss 0.160323, forward nfe 20636, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 053/100, Runtime 2.250124, Loss 0.242388, forward nfe 20910, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 054/100, Runtime 2.124429, Loss 0.177600, forward nfe 21184, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 055/100, Runtime 2.166257, Loss 0.124564, forward nfe 21458, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 056/100, Runtime 2.052847, Loss 0.133037, forward nfe 21732, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 057/100, Runtime 2.080657, Loss 0.114668, forward nfe 22006, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 058/100, Runtime 2.091934, Loss 0.103886, forward nfe 22280, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 059/100, Runtime 2.232968, Loss 0.085992, forward nfe 22554, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 060/100, Runtime 2.072294, Loss 0.068521, forward nfe 22828, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 061/100, Runtime 2.150627, Loss 0.101710, forward nfe 23096, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 062/100, Runtime 2.101181, Loss 0.100919, forward nfe 23370, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 063/100, Runtime 2.103981, Loss 0.084431, forward nfe 23644, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 064/100, Runtime 2.075020, Loss 0.070548, forward nfe 23912, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 065/100, Runtime 2.204338, Loss 0.088731, forward nfe 24180, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 066/100, Runtime 2.145774, Loss 0.062527, forward nfe 24448, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 067/100, Runtime 2.141007, Loss 0.129591, forward nfe 24716, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 068/100, Runtime 2.198115, Loss 0.116072, forward nfe 24984, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 069/100, Runtime 2.093725, Loss 0.142760, forward nfe 25252, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 070/100, Runtime 2.072781, Loss 0.092675, forward nfe 25520, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 071/100, Runtime 2.011786, Loss 0.070061, forward nfe 25776, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 072/100, Runtime 2.827692, Loss 0.089777, forward nfe 26032, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 073/100, Runtime 2.808057, Loss 0.110378, forward nfe 26288, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 074/100, Runtime 2.894371, Loss 0.068637, forward nfe 26550, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 075/100, Runtime 3.067086, Loss 0.072723, forward nfe 26812, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 076/100, Runtime 3.052580, Loss 0.079702, forward nfe 27074, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 077/100, Runtime 2.986163, Loss 0.074744, forward nfe 27336, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 078/100, Runtime 2.988226, Loss 0.053017, forward nfe 27598, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 079/100, Runtime 3.063703, Loss 0.039841, forward nfe 27860, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 080/100, Runtime 3.010675, Loss 0.033269, forward nfe 28122, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 081/100, Runtime 2.923542, Loss 0.067516, forward nfe 28384, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 082/100, Runtime 2.977528, Loss 0.062080, forward nfe 28634, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 083/100, Runtime 1.460189, Loss 0.044176, forward nfe 28884, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 084/100, Runtime 0.815781, Loss 0.051546, forward nfe 29134, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 085/100, Runtime 0.785412, Loss 0.077846, forward nfe 29384, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 086/100, Runtime 0.839159, Loss 0.054205, forward nfe 29634, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 087/100, Runtime 0.738799, Loss 0.108590, forward nfe 29884, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 088/100, Runtime 0.860231, Loss 0.085475, forward nfe 30128, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 089/100, Runtime 0.807786, Loss 0.065566, forward nfe 30372, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 090/100, Runtime 0.833282, Loss 0.042856, forward nfe 30622, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 091/100, Runtime 0.815299, Loss 0.063885, forward nfe 30878, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 092/100, Runtime 0.788471, Loss 0.116155, forward nfe 31128, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 093/100, Runtime 0.827419, Loss 0.056177, forward nfe 31384, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 094/100, Runtime 0.879127, Loss 0.078530, forward nfe 31628, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 095/100, Runtime 0.885811, Loss 0.032464, forward nfe 31872, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 096/100, Runtime 0.892148, Loss 0.086963, forward nfe 32116, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 097/100, Runtime 0.930294, Loss 0.054388, forward nfe 32366, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 098/100, Runtime 0.913602, Loss 0.058483, forward nfe 32616, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
Epoch: 099/100, Runtime 0.889551, Loss 0.038061, forward nfe 32866, backward nfe 0, Train: 0.9286, Val: 0.8441, Test: 0.8457, Best time: 90.0000
best val accuracy 0.844118 with test accuracy 0.845685 at epoch 27 and best time 90.000000