/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 1.269763, Loss 1.948048, forward nfe 32, backward nfe 0, Train: 0.6571, Val: 0.3926, Test: 0.4020, Best time: 5.8519
Epoch: 002/100, Runtime 1.323325, Loss 1.794538, forward nfe 120, backward nfe 0, Train: 0.8714, Val: 0.5713, Test: 0.5888, Best time: 5.5128
Epoch: 003/100, Runtime 1.413683, Loss 1.556167, forward nfe 208, backward nfe 0, Train: 0.9071, Val: 0.7684, Test: 0.7492, Best time: 12.6318
Epoch: 004/100, Runtime 1.203929, Loss 1.250096, forward nfe 296, backward nfe 0, Train: 0.9214, Val: 0.8169, Test: 0.8061, Best time: 5.0000
Epoch: 005/100, Runtime 1.409957, Loss 0.949518, forward nfe 384, backward nfe 0, Train: 0.9429, Val: 0.8324, Test: 0.8173, Best time: 5.0000
Epoch: 006/100, Runtime 1.283537, Loss 0.710268, forward nfe 472, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 007/100, Runtime 1.287474, Loss 0.484373, forward nfe 560, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 008/100, Runtime 1.388881, Loss 0.320592, forward nfe 648, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 009/100, Runtime 1.170095, Loss 0.210579, forward nfe 736, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 010/100, Runtime 1.421822, Loss 0.129852, forward nfe 824, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 011/100, Runtime 1.295634, Loss 0.112242, forward nfe 912, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 012/100, Runtime 1.284444, Loss 0.122802, forward nfe 1000, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 013/100, Runtime 1.284958, Loss 0.100321, forward nfe 1088, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 014/100, Runtime 1.149128, Loss 0.086999, forward nfe 1170, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 015/100, Runtime 1.316975, Loss 0.085039, forward nfe 1252, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 016/100, Runtime 1.079423, Loss 0.088343, forward nfe 1334, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 017/100, Runtime 1.351332, Loss 0.095698, forward nfe 1416, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 018/100, Runtime 1.205285, Loss 0.057913, forward nfe 1498, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 019/100, Runtime 1.288471, Loss 0.080570, forward nfe 1580, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 020/100, Runtime 1.054756, Loss 0.079615, forward nfe 1656, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 021/100, Runtime 1.119492, Loss 0.097831, forward nfe 1726, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 022/100, Runtime 1.087784, Loss 0.114409, forward nfe 1796, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 023/100, Runtime 1.159022, Loss 0.116710, forward nfe 1866, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 024/100, Runtime 1.049725, Loss 0.106056, forward nfe 1936, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 025/100, Runtime 1.179998, Loss 0.132032, forward nfe 2006, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 026/100, Runtime 1.038347, Loss 0.119360, forward nfe 2076, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 027/100, Runtime 1.194970, Loss 0.116866, forward nfe 2146, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 028/100, Runtime 1.009779, Loss 0.106565, forward nfe 2216, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 029/100, Runtime 1.234792, Loss 0.149934, forward nfe 2286, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 030/100, Runtime 0.847616, Loss 0.112963, forward nfe 2356, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 031/100, Runtime 1.122690, Loss 0.096417, forward nfe 2420, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 032/100, Runtime 0.943418, Loss 0.155413, forward nfe 2484, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 033/100, Runtime 1.024301, Loss 0.114082, forward nfe 2548, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 034/100, Runtime 0.993621, Loss 0.089015, forward nfe 2612, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 035/100, Runtime 0.998356, Loss 0.092592, forward nfe 2676, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 036/100, Runtime 1.056108, Loss 0.069368, forward nfe 2740, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 037/100, Runtime 0.898715, Loss 0.116104, forward nfe 2804, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 038/100, Runtime 1.133848, Loss 0.085915, forward nfe 2868, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 039/100, Runtime 0.913631, Loss 0.075542, forward nfe 2932, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 040/100, Runtime 1.068066, Loss 0.098281, forward nfe 2996, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 041/100, Runtime 0.940671, Loss 0.077298, forward nfe 3060, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 042/100, Runtime 1.024644, Loss 0.071807, forward nfe 3124, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 043/100, Runtime 1.009310, Loss 0.064256, forward nfe 3188, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 044/100, Runtime 0.966156, Loss 0.081234, forward nfe 3252, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 045/100, Runtime 1.052068, Loss 0.068616, forward nfe 3310, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 046/100, Runtime 0.840570, Loss 0.084992, forward nfe 3368, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 047/100, Runtime 0.984581, Loss 0.081291, forward nfe 3426, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 048/100, Runtime 0.816981, Loss 0.059455, forward nfe 3478, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 049/100, Runtime 0.828017, Loss 0.071020, forward nfe 3530, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 050/100, Runtime 0.952008, Loss 0.079141, forward nfe 3582, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 051/100, Runtime 0.788691, Loss 0.101687, forward nfe 3634, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 052/100, Runtime 0.889064, Loss 0.056995, forward nfe 3686, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 053/100, Runtime 0.853299, Loss 0.119620, forward nfe 3738, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 054/100, Runtime 0.785404, Loss 0.106871, forward nfe 3790, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 055/100, Runtime 0.957033, Loss 0.084930, forward nfe 3842, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 056/100, Runtime 0.807620, Loss 0.070953, forward nfe 3894, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 057/100, Runtime 0.794286, Loss 0.095906, forward nfe 3946, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 058/100, Runtime 0.980090, Loss 0.067616, forward nfe 3998, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 059/100, Runtime 0.810485, Loss 0.085661, forward nfe 4050, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 060/100, Runtime 0.880053, Loss 0.082824, forward nfe 4102, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 061/100, Runtime 0.896500, Loss 0.075264, forward nfe 4154, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 062/100, Runtime 0.747476, Loss 0.097773, forward nfe 4206, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 063/100, Runtime 0.980420, Loss 0.090285, forward nfe 4258, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 064/100, Runtime 0.806211, Loss 0.083250, forward nfe 4310, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 065/100, Runtime 0.837964, Loss 0.089799, forward nfe 4362, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 066/100, Runtime 0.906617, Loss 0.074700, forward nfe 4414, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 067/100, Runtime 0.730752, Loss 0.078049, forward nfe 4466, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 068/100, Runtime 0.933238, Loss 0.100948, forward nfe 4518, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 069/100, Runtime 0.801055, Loss 0.089749, forward nfe 4570, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 070/100, Runtime 0.834394, Loss 0.062689, forward nfe 4622, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 071/100, Runtime 0.938175, Loss 0.130528, forward nfe 4674, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 072/100, Runtime 0.751253, Loss 0.089317, forward nfe 4726, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 073/100, Runtime 0.890349, Loss 0.100002, forward nfe 4778, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 074/100, Runtime 0.843755, Loss 0.059383, forward nfe 4830, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 075/100, Runtime 0.745349, Loss 0.085762, forward nfe 4882, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 076/100, Runtime 0.969972, Loss 0.074668, forward nfe 4934, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 077/100, Runtime 0.769246, Loss 0.088329, forward nfe 4986, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 078/100, Runtime 0.858068, Loss 0.069804, forward nfe 5038, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 079/100, Runtime 0.888646, Loss 0.088489, forward nfe 5090, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 080/100, Runtime 0.740294, Loss 0.110246, forward nfe 5142, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 081/100, Runtime 0.941664, Loss 0.052584, forward nfe 5194, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 082/100, Runtime 0.781140, Loss 0.076528, forward nfe 5246, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 083/100, Runtime 0.839318, Loss 0.057547, forward nfe 5298, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 084/100, Runtime 0.953871, Loss 0.052887, forward nfe 5350, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 085/100, Runtime 0.712625, Loss 0.062754, forward nfe 5402, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 086/100, Runtime 0.886049, Loss 0.077013, forward nfe 5454, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 087/100, Runtime 0.860911, Loss 0.079394, forward nfe 5506, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 088/100, Runtime 0.747734, Loss 0.096725, forward nfe 5558, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 089/100, Runtime 0.960664, Loss 0.083904, forward nfe 5610, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 090/100, Runtime 0.770305, Loss 0.068960, forward nfe 5662, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 091/100, Runtime 0.842390, Loss 0.060205, forward nfe 5714, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 092/100, Runtime 0.912755, Loss 0.100395, forward nfe 5766, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 093/100, Runtime 0.738422, Loss 0.084908, forward nfe 5818, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 094/100, Runtime 0.942275, Loss 0.102299, forward nfe 5870, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 095/100, Runtime 0.809928, Loss 0.072825, forward nfe 5922, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 096/100, Runtime 0.796793, Loss 0.092361, forward nfe 5974, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 097/100, Runtime 0.966689, Loss 0.078162, forward nfe 6026, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 098/100, Runtime 0.774765, Loss 0.079926, forward nfe 6078, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
Epoch: 099/100, Runtime 0.883978, Loss 0.069996, forward nfe 6130, backward nfe 0, Train: 0.9643, Val: 0.8412, Test: 0.8325, Best time: 5.0000
best val accuracy 0.841176 with test accuracy 0.832487 at epoch 6 and best time 5.000000