/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
Epoch: 001/100, Runtime 0.315584, Loss 1.098910, forward nfe 20, backward nfe 8, Train: 0.8500, Val: 0.7069, Test: 0.7124, Best time: 15.9965
Epoch: 002/100, Runtime 0.280502, Loss 1.082941, forward nfe 96, backward nfe 16, Train: 0.8500, Val: 0.7069, Test: 0.7124, Best time: 5.0000
Epoch: 003/100, Runtime 0.289468, Loss 1.062406, forward nfe 166, backward nfe 25, Train: 0.8500, Val: 0.7069, Test: 0.7124, Best time: 5.0000
Epoch: 004/100, Runtime 0.310722, Loss 1.036864, forward nfe 236, backward nfe 35, Train: 0.8500, Val: 0.7069, Test: 0.7124, Best time: 5.0000
Epoch: 005/100, Runtime 0.324258, Loss 1.013488, forward nfe 312, backward nfe 46, Train: 0.8500, Val: 0.7069, Test: 0.7124, Best time: 5.0000
Epoch: 006/100, Runtime 0.342394, Loss 0.972020, forward nfe 388, backward nfe 59, Train: 0.8500, Val: 0.7069, Test: 0.7124, Best time: 5.0000
Epoch: 007/100, Runtime 0.350214, Loss 0.928779, forward nfe 464, backward nfe 73, Train: 0.9333, Val: 0.7090, Test: 0.7045, Best time: 2.3043
Epoch: 008/100, Runtime 0.360885, Loss 0.895326, forward nfe 540, backward nfe 86, Train: 0.8667, Val: 0.7132, Test: 0.7147, Best time: 26.4415
Epoch: 009/100, Runtime 0.380265, Loss 0.820986, forward nfe 616, backward nfe 103, Train: 0.8667, Val: 0.7188, Test: 0.7223, Best time: 26.6835
Epoch: 010/100, Runtime 0.358439, Loss 0.787149, forward nfe 692, backward nfe 119, Train: 0.8833, Val: 0.7292, Test: 0.7286, Best time: 5.0000
Epoch: 011/100, Runtime 0.359990, Loss 0.715520, forward nfe 762, backward nfe 135, Train: 0.8833, Val: 0.7340, Test: 0.7387, Best time: 27.2942
Epoch: 012/100, Runtime 0.363830, Loss 0.653015, forward nfe 832, backward nfe 152, Train: 0.8833, Val: 0.7417, Test: 0.7439, Best time: 27.6200
Epoch: 013/100, Runtime 0.384003, Loss 0.583928, forward nfe 902, backward nfe 170, Train: 0.8833, Val: 0.7507, Test: 0.7515, Best time: 27.9630
Epoch: 014/100, Runtime 0.368070, Loss 0.551810, forward nfe 972, backward nfe 187, Train: 0.8833, Val: 0.7556, Test: 0.7565, Best time: 28.3430
Epoch: 015/100, Runtime 0.359002, Loss 0.491800, forward nfe 1042, backward nfe 203, Train: 0.9000, Val: 0.7597, Test: 0.7602, Best time: 28.7708
Epoch: 016/100, Runtime 0.360302, Loss 0.439603, forward nfe 1112, backward nfe 219, Train: 0.9000, Val: 0.7597, Test: 0.7602, Best time: 5.0000
Epoch: 017/100, Runtime 0.367959, Loss 0.364147, forward nfe 1182, backward nfe 236, Train: 0.9333, Val: 0.7660, Test: 0.7664, Best time: 5.0000
Epoch: 018/100, Runtime 0.334865, Loss 0.372694, forward nfe 1252, backward nfe 250, Train: 0.9500, Val: 0.7722, Test: 0.7669, Best time: 5.9647
Epoch: 019/100, Runtime 0.338097, Loss 0.268322, forward nfe 1322, backward nfe 266, Train: 0.9500, Val: 0.7771, Test: 0.7706, Best time: 6.0729
Epoch: 020/100, Runtime 0.312299, Loss 0.251988, forward nfe 1380, backward nfe 281, Train: 0.9500, Val: 0.7806, Test: 0.7761, Best time: 10.9108
Epoch: 021/100, Runtime 0.284021, Loss 0.272727, forward nfe 1438, backward nfe 293, Train: 0.9833, Val: 0.7847, Test: 0.7754, Best time: 6.3363
Epoch: 022/100, Runtime 0.296613, Loss 0.205600, forward nfe 1496, backward nfe 306, Train: 0.9500, Val: 0.7889, Test: 0.7826, Best time: 18.4263
Epoch: 023/100, Runtime 0.299171, Loss 0.229739, forward nfe 1554, backward nfe 319, Train: 0.9667, Val: 0.7924, Test: 0.7847, Best time: 18.9539
Epoch: 024/100, Runtime 0.301776, Loss 0.176419, forward nfe 1612, backward nfe 332, Train: 0.9667, Val: 0.7924, Test: 0.7847, Best time: 5.0000
Epoch: 025/100, Runtime 0.286857, Loss 0.189336, forward nfe 1676, backward nfe 343, Train: 0.9667, Val: 0.7924, Test: 0.7847, Best time: 5.0000
Epoch: 026/100, Runtime 0.278757, Loss 0.167590, forward nfe 1740, backward nfe 353, Train: 0.9667, Val: 0.7924, Test: 0.7847, Best time: 5.0000
Epoch: 027/100, Runtime 0.287304, Loss 0.162554, forward nfe 1804, backward nfe 364, Train: 0.9667, Val: 0.7924, Test: 0.7847, Best time: 5.0000
Epoch: 028/100, Runtime 0.288800, Loss 0.157657, forward nfe 1868, backward nfe 376, Train: 0.9667, Val: 0.7924, Test: 0.7847, Best time: 5.0000
Epoch: 029/100, Runtime 0.258158, Loss 0.194968, forward nfe 1932, backward nfe 383, Train: 0.9667, Val: 0.7924, Test: 0.7847, Best time: 5.0000
Epoch: 030/100, Runtime 0.287383, Loss 0.169009, forward nfe 1996, backward nfe 394, Train: 1.0000, Val: 0.7958, Test: 0.7831, Best time: 8.3470
Epoch: 031/100, Runtime 0.267151, Loss 0.123340, forward nfe 2060, backward nfe 403, Train: 1.0000, Val: 0.7958, Test: 0.7831, Best time: 5.0000
Epoch: 032/100, Runtime 0.269684, Loss 0.158829, forward nfe 2124, backward nfe 413, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 9.0540
Epoch: 033/100, Runtime 0.252829, Loss 0.148224, forward nfe 2182, backward nfe 422, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 034/100, Runtime 0.244856, Loss 0.110874, forward nfe 2234, backward nfe 432, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 035/100, Runtime 0.217725, Loss 0.125732, forward nfe 2286, backward nfe 439, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 036/100, Runtime 0.239807, Loss 0.106586, forward nfe 2338, backward nfe 447, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 037/100, Runtime 0.254223, Loss 0.123961, forward nfe 2396, backward nfe 457, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 038/100, Runtime 0.235286, Loss 0.135837, forward nfe 2454, backward nfe 466, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 039/100, Runtime 0.222417, Loss 0.109505, forward nfe 2506, backward nfe 473, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 040/100, Runtime 0.249305, Loss 0.154340, forward nfe 2558, backward nfe 483, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 041/100, Runtime 0.229442, Loss 0.083032, forward nfe 2610, backward nfe 490, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 042/100, Runtime 0.237017, Loss 0.113564, forward nfe 2662, backward nfe 499, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 043/100, Runtime 0.240607, Loss 0.072282, forward nfe 2714, backward nfe 508, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 044/100, Runtime 0.240906, Loss 0.090619, forward nfe 2766, backward nfe 517, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 045/100, Runtime 0.244364, Loss 0.127631, forward nfe 2818, backward nfe 526, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 046/100, Runtime 0.230979, Loss 0.158163, forward nfe 2870, backward nfe 534, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 047/100, Runtime 0.234993, Loss 0.116951, forward nfe 2922, backward nfe 542, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 048/100, Runtime 0.229191, Loss 0.121349, forward nfe 2974, backward nfe 550, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 049/100, Runtime 0.220485, Loss 0.113903, forward nfe 3026, backward nfe 557, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 050/100, Runtime 0.226441, Loss 0.150604, forward nfe 3078, backward nfe 564, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 051/100, Runtime 0.249253, Loss 0.178700, forward nfe 3130, backward nfe 574, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 052/100, Runtime 0.233980, Loss 0.123978, forward nfe 3182, backward nfe 582, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 053/100, Runtime 0.231279, Loss 0.075984, forward nfe 3234, backward nfe 590, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 054/100, Runtime 0.238165, Loss 0.099340, forward nfe 3286, backward nfe 599, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 055/100, Runtime 0.224865, Loss 0.070873, forward nfe 3338, backward nfe 607, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 056/100, Runtime 0.231123, Loss 0.098198, forward nfe 3390, backward nfe 615, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 057/100, Runtime 0.226213, Loss 0.087824, forward nfe 3442, backward nfe 623, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 058/100, Runtime 0.234221, Loss 0.097067, forward nfe 3494, backward nfe 631, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 059/100, Runtime 0.236849, Loss 0.068824, forward nfe 3546, backward nfe 639, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 060/100, Runtime 0.225373, Loss 0.068767, forward nfe 3598, backward nfe 647, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 061/100, Runtime 0.255171, Loss 0.136345, forward nfe 3650, backward nfe 657, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 062/100, Runtime 0.231441, Loss 0.102758, forward nfe 3702, backward nfe 666, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 063/100, Runtime 0.229628, Loss 0.117011, forward nfe 3754, backward nfe 674, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 064/100, Runtime 0.226438, Loss 0.085714, forward nfe 3806, backward nfe 682, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 065/100, Runtime 0.234392, Loss 0.157418, forward nfe 3858, backward nfe 691, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 066/100, Runtime 0.218595, Loss 0.081901, forward nfe 3910, backward nfe 698, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 067/100, Runtime 0.239959, Loss 0.094756, forward nfe 3962, backward nfe 706, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 068/100, Runtime 0.220084, Loss 0.099301, forward nfe 4014, backward nfe 714, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 069/100, Runtime 0.230196, Loss 0.079011, forward nfe 4066, backward nfe 722, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 070/100, Runtime 0.217172, Loss 0.071002, forward nfe 4118, backward nfe 729, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 071/100, Runtime 0.224878, Loss 0.088192, forward nfe 4170, backward nfe 736, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 072/100, Runtime 0.225457, Loss 0.072850, forward nfe 4222, backward nfe 744, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 073/100, Runtime 0.226928, Loss 0.116021, forward nfe 4274, backward nfe 752, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 074/100, Runtime 0.234777, Loss 0.088026, forward nfe 4326, backward nfe 761, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 075/100, Runtime 0.228496, Loss 0.080748, forward nfe 4378, backward nfe 770, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 076/100, Runtime 0.236274, Loss 0.081350, forward nfe 4430, backward nfe 779, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 077/100, Runtime 0.224942, Loss 0.070882, forward nfe 4482, backward nfe 787, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 078/100, Runtime 0.216304, Loss 0.068480, forward nfe 4534, backward nfe 794, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 079/100, Runtime 0.230208, Loss 0.069498, forward nfe 4586, backward nfe 803, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 080/100, Runtime 0.232037, Loss 0.050540, forward nfe 4638, backward nfe 812, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 081/100, Runtime 0.223957, Loss 0.075437, forward nfe 4690, backward nfe 820, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 082/100, Runtime 0.217219, Loss 0.106801, forward nfe 4742, backward nfe 827, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 083/100, Runtime 0.224919, Loss 0.062292, forward nfe 4794, backward nfe 835, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 084/100, Runtime 0.218738, Loss 0.064888, forward nfe 4846, backward nfe 842, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 085/100, Runtime 0.235097, Loss 0.105826, forward nfe 4898, backward nfe 850, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 086/100, Runtime 0.224818, Loss 0.076414, forward nfe 4950, backward nfe 858, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 087/100, Runtime 0.225478, Loss 0.078345, forward nfe 5002, backward nfe 865, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 088/100, Runtime 0.226439, Loss 0.039682, forward nfe 5054, backward nfe 873, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 089/100, Runtime 0.234496, Loss 0.060613, forward nfe 5106, backward nfe 881, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 090/100, Runtime 0.232871, Loss 0.087872, forward nfe 5158, backward nfe 890, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 091/100, Runtime 0.236799, Loss 0.105288, forward nfe 5210, backward nfe 899, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 092/100, Runtime 0.221765, Loss 0.108229, forward nfe 5262, backward nfe 906, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 093/100, Runtime 0.238945, Loss 0.079472, forward nfe 5314, backward nfe 914, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 094/100, Runtime 0.236674, Loss 0.052387, forward nfe 5366, backward nfe 923, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 095/100, Runtime 0.217792, Loss 0.098823, forward nfe 5418, backward nfe 930, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 096/100, Runtime 0.223013, Loss 0.056952, forward nfe 5470, backward nfe 937, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 097/100, Runtime 0.215159, Loss 0.099932, forward nfe 5522, backward nfe 946, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 098/100, Runtime 0.216292, Loss 0.050498, forward nfe 5568, backward nfe 955, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
Epoch: 099/100, Runtime 0.223800, Loss 0.084063, forward nfe 5614, backward nfe 964, Train: 1.0000, Val: 0.7993, Test: 0.7878, Best time: 5.0000
best val accuracy 0.799306 with test accuracy 0.787836 at epoch 32 and best time 5.000000