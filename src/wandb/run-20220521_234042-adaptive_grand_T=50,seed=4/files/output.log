/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 3.172601, Loss 1.947175, forward nfe 104, backward nfe 0, Train: 0.2786, Val: 0.2272, Test: 0.2365, Best time: 0.0917
Epoch: 002/100, Runtime 3.074847, Loss 1.883287, forward nfe 498, backward nfe 0, Train: 0.6714, Val: 0.6537, Test: 0.6010, Best time: 7.4527
Epoch: 003/100, Runtime 3.010635, Loss 1.760878, forward nfe 880, backward nfe 0, Train: 0.8143, Val: 0.7272, Test: 0.6711, Best time: 13.2571
Epoch: 004/100, Runtime 2.913455, Loss 1.573229, forward nfe 1250, backward nfe 0, Train: 0.8286, Val: 0.7419, Test: 0.6934, Best time: 7.6794
Epoch: 005/100, Runtime 2.960173, Loss 1.349950, forward nfe 1602, backward nfe 0, Train: 0.8357, Val: 0.7868, Test: 0.7421, Best time: 7.8526
Epoch: 006/100, Runtime 2.902155, Loss 1.080987, forward nfe 1954, backward nfe 0, Train: 0.8357, Val: 0.8235, Test: 0.7888, Best time: 24.4645
Epoch: 007/100, Runtime 2.699230, Loss 0.848241, forward nfe 2300, backward nfe 0, Train: 0.8357, Val: 0.8235, Test: 0.7888, Best time: 50.0000
Epoch: 008/100, Runtime 2.826236, Loss 0.662517, forward nfe 2640, backward nfe 0, Train: 0.8643, Val: 0.8265, Test: 0.7766, Best time: 8.5951
Epoch: 009/100, Runtime 2.582659, Loss 0.535567, forward nfe 2968, backward nfe 0, Train: 0.8643, Val: 0.8265, Test: 0.7766, Best time: 50.0000
Epoch: 010/100, Runtime 2.392189, Loss 0.485202, forward nfe 3290, backward nfe 0, Train: 0.8714, Val: 0.8368, Test: 0.8020, Best time: 16.5482
Epoch: 011/100, Runtime 2.348130, Loss 0.440274, forward nfe 3606, backward nfe 0, Train: 0.8714, Val: 0.8368, Test: 0.8020, Best time: 50.0000
Epoch: 012/100, Runtime 2.355276, Loss 0.386034, forward nfe 3916, backward nfe 0, Train: 0.8714, Val: 0.8368, Test: 0.8020, Best time: 50.0000
Epoch: 013/100, Runtime 2.189609, Loss 0.407770, forward nfe 4220, backward nfe 0, Train: 0.8714, Val: 0.8368, Test: 0.8020, Best time: 50.0000
Epoch: 014/100, Runtime 2.260847, Loss 0.359337, forward nfe 4512, backward nfe 0, Train: 0.8714, Val: 0.8368, Test: 0.8020, Best time: 50.0000
Epoch: 015/100, Runtime 2.116555, Loss 0.325513, forward nfe 4798, backward nfe 0, Train: 0.8714, Val: 0.8368, Test: 0.8020, Best time: 50.0000
Epoch: 016/100, Runtime 2.136576, Loss 0.348750, forward nfe 5072, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 81.7396
Epoch: 017/100, Runtime 2.151594, Loss 0.383859, forward nfe 5346, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 018/100, Runtime 2.133644, Loss 0.339613, forward nfe 5626, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 019/100, Runtime 2.113952, Loss 0.376955, forward nfe 5900, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 020/100, Runtime 2.066535, Loss 0.406712, forward nfe 6162, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 021/100, Runtime 2.542153, Loss 0.286790, forward nfe 6406, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 022/100, Runtime 2.632372, Loss 0.262705, forward nfe 6650, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 023/100, Runtime 2.744335, Loss 0.311840, forward nfe 6894, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 024/100, Runtime 2.820649, Loss 0.316135, forward nfe 7138, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 025/100, Runtime 2.488578, Loss 0.269885, forward nfe 7382, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 026/100, Runtime 2.490444, Loss 0.225867, forward nfe 7626, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 027/100, Runtime 2.420080, Loss 0.290547, forward nfe 7870, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 028/100, Runtime 2.527339, Loss 0.280840, forward nfe 8102, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 029/100, Runtime 2.438112, Loss 0.185030, forward nfe 8328, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 030/100, Runtime 2.563436, Loss 0.199105, forward nfe 8542, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 031/100, Runtime 2.574376, Loss 0.252198, forward nfe 8756, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 032/100, Runtime 2.433224, Loss 0.212007, forward nfe 8976, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 033/100, Runtime 0.633318, Loss 0.203360, forward nfe 9196, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 034/100, Runtime 0.685059, Loss 0.200244, forward nfe 9422, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 035/100, Runtime 0.730544, Loss 0.254493, forward nfe 9642, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 036/100, Runtime 0.736166, Loss 0.216019, forward nfe 9862, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 037/100, Runtime 0.740637, Loss 0.198585, forward nfe 10076, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 038/100, Runtime 0.717939, Loss 0.175834, forward nfe 10290, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 039/100, Runtime 0.709236, Loss 0.205009, forward nfe 10504, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 040/100, Runtime 0.708506, Loss 0.200883, forward nfe 10718, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 041/100, Runtime 0.759394, Loss 0.153410, forward nfe 10932, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 042/100, Runtime 0.778553, Loss 0.132289, forward nfe 11146, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 043/100, Runtime 0.785226, Loss 0.199397, forward nfe 11354, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 044/100, Runtime 0.797044, Loss 0.143114, forward nfe 11562, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 045/100, Runtime 0.732619, Loss 0.130898, forward nfe 11758, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 046/100, Runtime 0.680062, Loss 0.114450, forward nfe 11954, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 047/100, Runtime 0.753387, Loss 0.138005, forward nfe 12150, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 048/100, Runtime 0.757057, Loss 0.130968, forward nfe 12346, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 049/100, Runtime 0.753928, Loss 0.142002, forward nfe 12542, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 050/100, Runtime 0.746615, Loss 0.158984, forward nfe 12738, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 051/100, Runtime 0.699630, Loss 0.101686, forward nfe 12934, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 052/100, Runtime 0.686283, Loss 0.200665, forward nfe 13124, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 053/100, Runtime 0.701033, Loss 0.107259, forward nfe 13314, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 054/100, Runtime 0.698917, Loss 0.126941, forward nfe 13504, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 055/100, Runtime 0.709474, Loss 0.134202, forward nfe 13694, backward nfe 0, Train: 0.9000, Val: 0.8449, Test: 0.8122, Best time: 50.0000
Epoch: 056/100, Runtime 0.707579, Loss 0.107505, forward nfe 13884, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 134.4247
Epoch: 057/100, Runtime 0.770957, Loss 0.103581, forward nfe 14074, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 058/100, Runtime 0.739684, Loss 0.135203, forward nfe 14264, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 059/100, Runtime 0.798993, Loss 0.150973, forward nfe 14454, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 060/100, Runtime 0.700943, Loss 0.094874, forward nfe 14644, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 061/100, Runtime 0.773847, Loss 0.098831, forward nfe 14834, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 062/100, Runtime 0.760448, Loss 0.081409, forward nfe 15024, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 063/100, Runtime 0.684569, Loss 0.102222, forward nfe 15214, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 064/100, Runtime 1.432261, Loss 0.072589, forward nfe 15404, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 065/100, Runtime 1.566571, Loss 0.102020, forward nfe 15594, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 066/100, Runtime 1.672922, Loss 0.112040, forward nfe 15784, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 067/100, Runtime 1.677255, Loss 0.067386, forward nfe 15974, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 068/100, Runtime 1.680071, Loss 0.072809, forward nfe 16164, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 069/100, Runtime 1.637675, Loss 0.138285, forward nfe 16354, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 070/100, Runtime 1.604011, Loss 0.075275, forward nfe 16544, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 071/100, Runtime 1.482303, Loss 0.069287, forward nfe 16734, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 072/100, Runtime 1.481761, Loss 0.060241, forward nfe 16918, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 073/100, Runtime 1.628632, Loss 0.067288, forward nfe 17102, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 074/100, Runtime 1.569220, Loss 0.090727, forward nfe 17286, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 075/100, Runtime 1.539556, Loss 0.101242, forward nfe 17470, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 076/100, Runtime 1.499124, Loss 0.071543, forward nfe 17648, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 077/100, Runtime 1.510485, Loss 0.113938, forward nfe 17826, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 078/100, Runtime 1.504911, Loss 0.073663, forward nfe 18004, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 079/100, Runtime 1.421936, Loss 0.056238, forward nfe 18182, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 080/100, Runtime 1.426599, Loss 0.106528, forward nfe 18360, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 081/100, Runtime 1.476205, Loss 0.077260, forward nfe 18532, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 082/100, Runtime 1.443196, Loss 0.060788, forward nfe 18704, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 083/100, Runtime 1.288829, Loss 0.048365, forward nfe 18876, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 084/100, Runtime 1.349079, Loss 0.038434, forward nfe 19036, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 085/100, Runtime 1.430522, Loss 0.053122, forward nfe 19202, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 086/100, Runtime 1.354422, Loss 0.037858, forward nfe 19368, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 087/100, Runtime 1.307627, Loss 0.057362, forward nfe 19534, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 088/100, Runtime 1.348052, Loss 0.060470, forward nfe 19700, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 089/100, Runtime 1.344578, Loss 0.043921, forward nfe 19866, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 090/100, Runtime 1.430648, Loss 0.035030, forward nfe 20032, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 091/100, Runtime 1.515790, Loss 0.049967, forward nfe 20198, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 092/100, Runtime 1.411927, Loss 0.029525, forward nfe 20364, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 093/100, Runtime 1.361992, Loss 0.044384, forward nfe 20530, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 094/100, Runtime 1.423132, Loss 0.070880, forward nfe 20696, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 095/100, Runtime 1.446885, Loss 0.061419, forward nfe 20862, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 096/100, Runtime 1.428528, Loss 0.040579, forward nfe 21028, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 097/100, Runtime 1.362457, Loss 0.039649, forward nfe 21194, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 098/100, Runtime 1.429004, Loss 0.029888, forward nfe 21360, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
Epoch: 099/100, Runtime 1.412536, Loss 0.029800, forward nfe 21526, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8041, Best time: 50.0000
best val accuracy 0.846324 with test accuracy 0.804061 at epoch 56 and best time 50.000000