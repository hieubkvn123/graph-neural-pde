/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 3.627037, Loss 1.947502, forward nfe 116, backward nfe 0, Train: 0.3143, Val: 0.3000, Test: 0.2954, Best time: 0.0930
Epoch: 002/100, Runtime 3.632670, Loss 1.853513, forward nfe 570, backward nfe 0, Train: 0.5071, Val: 0.5941, Test: 0.5523, Best time: 10.0372
Epoch: 003/100, Runtime 3.538244, Loss 1.658159, forward nfe 1012, backward nfe 0, Train: 0.7000, Val: 0.6919, Test: 0.7208, Best time: 17.6058
Epoch: 004/100, Runtime 4.094417, Loss 1.464256, forward nfe 1448, backward nfe 0, Train: 0.7000, Val: 0.6919, Test: 0.7208, Best time: 60.0000
Epoch: 005/100, Runtime 4.621547, Loss 1.269379, forward nfe 1872, backward nfe 0, Train: 0.8000, Val: 0.7243, Test: 0.7482, Best time: 36.5302
Epoch: 006/100, Runtime 4.144587, Loss 1.072050, forward nfe 2290, backward nfe 0, Train: 0.8000, Val: 0.7243, Test: 0.7482, Best time: 60.0000
Epoch: 007/100, Runtime 4.165020, Loss 0.935886, forward nfe 2702, backward nfe 0, Train: 0.8000, Val: 0.7243, Test: 0.7482, Best time: 60.0000
Epoch: 008/100, Runtime 4.152809, Loss 0.857197, forward nfe 3096, backward nfe 0, Train: 0.8357, Val: 0.7912, Test: 0.8274, Best time: 51.6140
Epoch: 009/100, Runtime 3.487593, Loss 0.725402, forward nfe 3484, backward nfe 0, Train: 0.8357, Val: 0.7912, Test: 0.8274, Best time: 60.0000
Epoch: 010/100, Runtime 2.762777, Loss 0.748007, forward nfe 3854, backward nfe 0, Train: 0.8357, Val: 0.7912, Test: 0.8274, Best time: 60.0000
Epoch: 011/100, Runtime 2.817153, Loss 0.722322, forward nfe 4212, backward nfe 0, Train: 0.8357, Val: 0.7912, Test: 0.8274, Best time: 60.0000
Epoch: 012/100, Runtime 2.938720, Loss 0.649377, forward nfe 4564, backward nfe 0, Train: 0.8643, Val: 0.8162, Test: 0.8396, Best time: 60.4147
Epoch: 013/100, Runtime 2.744063, Loss 0.532480, forward nfe 4910, backward nfe 0, Train: 0.8643, Val: 0.8206, Test: 0.8365, Best time: 36.2668
Epoch: 014/100, Runtime 2.762480, Loss 0.532220, forward nfe 5250, backward nfe 0, Train: 0.8714, Val: 0.8221, Test: 0.8477, Best time: 44.5536
Epoch: 015/100, Runtime 2.450039, Loss 0.546450, forward nfe 5590, backward nfe 0, Train: 0.9143, Val: 0.8243, Test: 0.8437, Best time: 73.2193
Epoch: 016/100, Runtime 2.311326, Loss 0.472263, forward nfe 5912, backward nfe 0, Train: 0.9143, Val: 0.8243, Test: 0.8437, Best time: 60.0000
Epoch: 017/100, Runtime 2.409965, Loss 0.451706, forward nfe 6234, backward nfe 0, Train: 0.9143, Val: 0.8243, Test: 0.8437, Best time: 60.0000
Epoch: 018/100, Runtime 2.243217, Loss 0.453552, forward nfe 6544, backward nfe 0, Train: 0.9143, Val: 0.8243, Test: 0.8437, Best time: 60.0000
Epoch: 019/100, Runtime 2.306665, Loss 0.392447, forward nfe 6830, backward nfe 0, Train: 0.9143, Val: 0.8243, Test: 0.8437, Best time: 60.0000
Epoch: 020/100, Runtime 2.426141, Loss 0.401363, forward nfe 7116, backward nfe 0, Train: 0.9143, Val: 0.8243, Test: 0.8437, Best time: 60.0000
Epoch: 021/100, Runtime 2.245395, Loss 0.382311, forward nfe 7402, backward nfe 0, Train: 0.9143, Val: 0.8243, Test: 0.8437, Best time: 60.0000
Epoch: 022/100, Runtime 2.224873, Loss 0.419172, forward nfe 7688, backward nfe 0, Train: 0.9143, Val: 0.8243, Test: 0.8437, Best time: 60.0000
Epoch: 023/100, Runtime 2.152921, Loss 0.378264, forward nfe 7968, backward nfe 0, Train: 0.9143, Val: 0.8243, Test: 0.8437, Best time: 60.0000
Epoch: 024/100, Runtime 2.064542, Loss 0.349888, forward nfe 8236, backward nfe 0, Train: 0.9143, Val: 0.8243, Test: 0.8437, Best time: 60.0000
Epoch: 025/100, Runtime 2.134329, Loss 0.342028, forward nfe 8504, backward nfe 0, Train: 0.9143, Val: 0.8243, Test: 0.8437, Best time: 60.0000
Epoch: 026/100, Runtime 2.131609, Loss 0.359147, forward nfe 8760, backward nfe 0, Train: 0.9143, Val: 0.8243, Test: 0.8437, Best time: 60.0000
Epoch: 027/100, Runtime 1.990700, Loss 0.286546, forward nfe 9016, backward nfe 0, Train: 0.9143, Val: 0.8243, Test: 0.8437, Best time: 60.0000
Epoch: 028/100, Runtime 2.192762, Loss 0.332220, forward nfe 9266, backward nfe 0, Train: 0.9143, Val: 0.8243, Test: 0.8437, Best time: 60.0000
Epoch: 029/100, Runtime 2.139881, Loss 0.315491, forward nfe 9522, backward nfe 0, Train: 0.9429, Val: 0.8250, Test: 0.8386, Best time: 63.5701
Epoch: 030/100, Runtime 1.945889, Loss 0.309415, forward nfe 9778, backward nfe 0, Train: 0.9429, Val: 0.8250, Test: 0.8386, Best time: 60.0000
Epoch: 031/100, Runtime 1.945612, Loss 0.337078, forward nfe 10022, backward nfe 0, Train: 0.9429, Val: 0.8250, Test: 0.8386, Best time: 60.0000
Epoch: 032/100, Runtime 2.064876, Loss 0.196255, forward nfe 10266, backward nfe 0, Train: 0.9429, Val: 0.8250, Test: 0.8386, Best time: 60.0000
Epoch: 033/100, Runtime 1.920191, Loss 0.271318, forward nfe 10510, backward nfe 0, Train: 0.9429, Val: 0.8250, Test: 0.8386, Best time: 60.0000
Epoch: 034/100, Runtime 1.781238, Loss 0.321554, forward nfe 10742, backward nfe 0, Train: 0.9429, Val: 0.8250, Test: 0.8386, Best time: 60.0000
Epoch: 035/100, Runtime 1.796366, Loss 0.184489, forward nfe 10974, backward nfe 0, Train: 0.9429, Val: 0.8250, Test: 0.8386, Best time: 60.0000
Epoch: 036/100, Runtime 1.780810, Loss 0.235288, forward nfe 11200, backward nfe 0, Train: 0.9429, Val: 0.8250, Test: 0.8386, Best time: 60.0000
Epoch: 037/100, Runtime 1.787693, Loss 0.202207, forward nfe 11426, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 111.9329
Epoch: 038/100, Runtime 1.657527, Loss 0.223395, forward nfe 11652, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 039/100, Runtime 1.797385, Loss 0.167934, forward nfe 11866, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 040/100, Runtime 1.771071, Loss 0.145316, forward nfe 12074, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 041/100, Runtime 1.784969, Loss 0.167739, forward nfe 12288, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 042/100, Runtime 1.725926, Loss 0.222953, forward nfe 12502, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 043/100, Runtime 1.864691, Loss 0.151359, forward nfe 12716, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 044/100, Runtime 1.729165, Loss 0.201694, forward nfe 12936, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 045/100, Runtime 1.781045, Loss 0.186513, forward nfe 13150, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 046/100, Runtime 1.776845, Loss 0.118423, forward nfe 13364, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 047/100, Runtime 1.783199, Loss 0.130078, forward nfe 13578, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 048/100, Runtime 1.634343, Loss 0.149028, forward nfe 13792, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 049/100, Runtime 1.816725, Loss 0.182878, forward nfe 14006, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 050/100, Runtime 1.669038, Loss 0.113267, forward nfe 14220, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 051/100, Runtime 1.781768, Loss 0.158707, forward nfe 14434, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 052/100, Runtime 1.736302, Loss 0.162263, forward nfe 14648, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 053/100, Runtime 1.758396, Loss 0.102691, forward nfe 14862, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 054/100, Runtime 1.700356, Loss 0.107688, forward nfe 15070, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 055/100, Runtime 1.721689, Loss 0.118940, forward nfe 15278, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 056/100, Runtime 1.728621, Loss 0.169438, forward nfe 15486, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 057/100, Runtime 1.691187, Loss 0.179599, forward nfe 15700, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 058/100, Runtime 1.669312, Loss 0.216355, forward nfe 15914, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 059/100, Runtime 1.749045, Loss 0.220305, forward nfe 16128, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 060/100, Runtime 1.680706, Loss 0.138719, forward nfe 16336, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 061/100, Runtime 1.750511, Loss 0.157907, forward nfe 16544, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 062/100, Runtime 1.755575, Loss 0.177436, forward nfe 16752, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 063/100, Runtime 1.677985, Loss 0.108077, forward nfe 16960, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 064/100, Runtime 1.830667, Loss 0.089449, forward nfe 17174, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 065/100, Runtime 1.724754, Loss 0.076562, forward nfe 17388, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 066/100, Runtime 1.617985, Loss 0.115404, forward nfe 17596, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 067/100, Runtime 1.713187, Loss 0.074847, forward nfe 17804, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 068/100, Runtime 1.701230, Loss 0.100732, forward nfe 18012, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 069/100, Runtime 1.699604, Loss 0.061080, forward nfe 18220, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 070/100, Runtime 1.614973, Loss 0.077429, forward nfe 18428, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 071/100, Runtime 1.714547, Loss 0.056638, forward nfe 18630, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 072/100, Runtime 1.701693, Loss 0.081021, forward nfe 18832, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 073/100, Runtime 1.695266, Loss 0.095081, forward nfe 19040, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 074/100, Runtime 1.739894, Loss 0.051645, forward nfe 19248, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 075/100, Runtime 1.682501, Loss 0.102025, forward nfe 19456, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 076/100, Runtime 1.776424, Loss 0.089846, forward nfe 19664, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 077/100, Runtime 1.696915, Loss 0.064790, forward nfe 19872, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 078/100, Runtime 1.642848, Loss 0.071559, forward nfe 20080, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 079/100, Runtime 1.563711, Loss 0.077299, forward nfe 20288, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 080/100, Runtime 1.611217, Loss 0.076944, forward nfe 20496, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 081/100, Runtime 1.643980, Loss 0.090580, forward nfe 20698, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 082/100, Runtime 1.650734, Loss 0.045460, forward nfe 20906, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 083/100, Runtime 1.855402, Loss 0.069454, forward nfe 21120, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 084/100, Runtime 1.851294, Loss 0.048960, forward nfe 21346, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 085/100, Runtime 1.892350, Loss 0.059924, forward nfe 21572, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 086/100, Runtime 1.843810, Loss 0.072292, forward nfe 21798, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 087/100, Runtime 1.811289, Loss 0.042895, forward nfe 22024, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 088/100, Runtime 1.814356, Loss 0.102192, forward nfe 22244, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 089/100, Runtime 1.812639, Loss 0.054464, forward nfe 22464, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 090/100, Runtime 1.708880, Loss 0.053936, forward nfe 22684, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 091/100, Runtime 1.789791, Loss 0.072344, forward nfe 22892, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 092/100, Runtime 1.428073, Loss 0.070392, forward nfe 23100, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 093/100, Runtime 1.695498, Loss 0.046614, forward nfe 23308, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 094/100, Runtime 1.684215, Loss 0.048357, forward nfe 23516, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 095/100, Runtime 1.654633, Loss 0.070148, forward nfe 23724, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 096/100, Runtime 1.625172, Loss 0.125059, forward nfe 23932, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 097/100, Runtime 1.710539, Loss 0.067242, forward nfe 24140, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 098/100, Runtime 1.749868, Loss 0.084286, forward nfe 24348, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
Epoch: 099/100, Runtime 1.696902, Loss 0.097711, forward nfe 24556, backward nfe 0, Train: 0.9429, Val: 0.8257, Test: 0.8396, Best time: 60.0000
best val accuracy 0.825735 with test accuracy 0.839594 at epoch 37 and best time 60.000000