/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.526660, Loss 1.796285, forward nfe 140, backward nfe 0, Train: 0.2250, Val: 0.0761, Test: 0.0903, Best time: 0.0411
Epoch: 002/100, Runtime 0.444218, Loss 1.782347, forward nfe 522, backward nfe 0, Train: 0.3667, Val: 0.1703, Test: 0.2032, Best time: 0.0393
Epoch: 003/100, Runtime 0.445763, Loss 1.761091, forward nfe 910, backward nfe 0, Train: 0.5833, Val: 0.3862, Test: 0.4194, Best time: 0.2987
Epoch: 004/100, Runtime 0.476666, Loss 1.730215, forward nfe 1298, backward nfe 0, Train: 0.6667, Val: 0.6587, Test: 0.6419, Best time: 35.0000
Epoch: 005/100, Runtime 0.481321, Loss 1.713522, forward nfe 1686, backward nfe 0, Train: 0.7250, Val: 0.7254, Test: 0.7145, Best time: 47.9868
Epoch: 006/100, Runtime 0.467843, Loss 1.685196, forward nfe 2068, backward nfe 0, Train: 0.7583, Val: 0.7572, Test: 0.7371, Best time: 24.0168
Epoch: 007/100, Runtime 0.444771, Loss 1.669066, forward nfe 2450, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 10.1461
Epoch: 008/100, Runtime 0.449499, Loss 1.648901, forward nfe 2826, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 009/100, Runtime 0.435391, Loss 1.603833, forward nfe 3202, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 010/100, Runtime 0.420153, Loss 1.593031, forward nfe 3572, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 011/100, Runtime 0.415351, Loss 1.581975, forward nfe 3930, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 012/100, Runtime 0.418462, Loss 1.527869, forward nfe 4282, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 013/100, Runtime 0.432972, Loss 1.511681, forward nfe 4634, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 014/100, Runtime 0.437753, Loss 1.515043, forward nfe 4986, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 015/100, Runtime 0.417705, Loss 1.449206, forward nfe 5332, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 016/100, Runtime 0.424834, Loss 1.397520, forward nfe 5666, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 017/100, Runtime 0.406679, Loss 1.368642, forward nfe 6000, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 018/100, Runtime 0.409565, Loss 1.295337, forward nfe 6334, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 019/100, Runtime 0.400480, Loss 1.213899, forward nfe 6662, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 020/100, Runtime 0.388476, Loss 1.182292, forward nfe 6990, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 021/100, Runtime 0.387896, Loss 1.151070, forward nfe 7312, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 022/100, Runtime 0.377124, Loss 1.206808, forward nfe 7628, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 023/100, Runtime 0.376522, Loss 1.184671, forward nfe 7944, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 024/100, Runtime 0.364589, Loss 1.105336, forward nfe 8254, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 025/100, Runtime 0.353738, Loss 1.127187, forward nfe 8552, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 026/100, Runtime 0.359130, Loss 1.117541, forward nfe 8850, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 027/100, Runtime 0.358597, Loss 1.063388, forward nfe 9142, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 028/100, Runtime 0.352286, Loss 1.102320, forward nfe 9434, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 029/100, Runtime 0.360213, Loss 1.079693, forward nfe 9726, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 030/100, Runtime 0.348852, Loss 1.051996, forward nfe 10006, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 031/100, Runtime 0.346357, Loss 1.069112, forward nfe 10286, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 032/100, Runtime 0.331398, Loss 1.023057, forward nfe 10566, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 033/100, Runtime 0.329905, Loss 1.053654, forward nfe 10840, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 034/100, Runtime 0.344767, Loss 1.083012, forward nfe 11114, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 035/100, Runtime 0.339475, Loss 1.044464, forward nfe 11388, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 036/100, Runtime 0.325196, Loss 1.048101, forward nfe 11656, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 037/100, Runtime 0.315755, Loss 1.017425, forward nfe 11912, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 038/100, Runtime 0.325255, Loss 1.101477, forward nfe 12168, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 039/100, Runtime 0.316196, Loss 1.025120, forward nfe 12430, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 040/100, Runtime 0.310527, Loss 1.039029, forward nfe 12686, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 041/100, Runtime 0.316479, Loss 1.132622, forward nfe 12936, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 042/100, Runtime 0.299914, Loss 1.053341, forward nfe 13180, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 043/100, Runtime 0.298681, Loss 1.038904, forward nfe 13424, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 044/100, Runtime 0.300810, Loss 1.075534, forward nfe 13668, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 045/100, Runtime 0.287943, Loss 0.955303, forward nfe 13912, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 046/100, Runtime 0.291451, Loss 1.022189, forward nfe 14150, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 047/100, Runtime 0.309799, Loss 1.137120, forward nfe 14388, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 048/100, Runtime 0.295677, Loss 1.058407, forward nfe 14626, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 049/100, Runtime 0.297820, Loss 1.034485, forward nfe 14858, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 050/100, Runtime 0.285658, Loss 0.932731, forward nfe 15084, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 051/100, Runtime 0.283115, Loss 0.991504, forward nfe 15310, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 052/100, Runtime 0.286252, Loss 1.059543, forward nfe 15536, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 053/100, Runtime 0.280370, Loss 1.091594, forward nfe 15762, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 054/100, Runtime 0.287181, Loss 1.053954, forward nfe 15988, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 055/100, Runtime 0.280808, Loss 0.891207, forward nfe 16214, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 056/100, Runtime 0.278583, Loss 0.917127, forward nfe 16440, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 057/100, Runtime 0.284106, Loss 0.848460, forward nfe 16672, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 058/100, Runtime 0.296714, Loss 0.839720, forward nfe 16904, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 059/100, Runtime 0.296504, Loss 1.011368, forward nfe 17136, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 060/100, Runtime 0.293093, Loss 0.958551, forward nfe 17368, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 061/100, Runtime 0.290410, Loss 1.073721, forward nfe 17600, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 062/100, Runtime 0.274373, Loss 0.971554, forward nfe 17832, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 063/100, Runtime 0.285290, Loss 0.983002, forward nfe 18058, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 064/100, Runtime 0.279030, Loss 1.034979, forward nfe 18284, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 065/100, Runtime 0.282953, Loss 0.921089, forward nfe 18510, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 066/100, Runtime 0.286414, Loss 1.009875, forward nfe 18736, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 067/100, Runtime 0.285298, Loss 0.899640, forward nfe 18968, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 068/100, Runtime 0.295065, Loss 1.064611, forward nfe 19200, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 069/100, Runtime 0.295884, Loss 0.926251, forward nfe 19432, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 070/100, Runtime 0.308606, Loss 0.993204, forward nfe 19664, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 071/100, Runtime 0.297373, Loss 0.953250, forward nfe 19896, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 072/100, Runtime 0.295756, Loss 1.021684, forward nfe 20128, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 073/100, Runtime 0.294137, Loss 1.041839, forward nfe 20360, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 074/100, Runtime 0.294931, Loss 0.947089, forward nfe 20592, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 075/100, Runtime 0.298441, Loss 1.016809, forward nfe 20824, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 076/100, Runtime 0.289024, Loss 1.005038, forward nfe 21056, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 077/100, Runtime 0.296772, Loss 1.061712, forward nfe 21288, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 078/100, Runtime 0.296598, Loss 0.884287, forward nfe 21520, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 079/100, Runtime 0.308196, Loss 1.147980, forward nfe 21752, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 080/100, Runtime 0.404586, Loss 0.983847, forward nfe 21984, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 081/100, Runtime 0.292819, Loss 0.964987, forward nfe 22216, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 082/100, Runtime 0.289163, Loss 0.991731, forward nfe 22448, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 083/100, Runtime 0.285867, Loss 0.975686, forward nfe 22680, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 084/100, Runtime 0.300549, Loss 0.964561, forward nfe 22918, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 085/100, Runtime 0.294531, Loss 0.945346, forward nfe 23156, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 086/100, Runtime 0.289849, Loss 0.892246, forward nfe 23388, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 087/100, Runtime 0.307399, Loss 0.950457, forward nfe 23620, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 088/100, Runtime 0.291173, Loss 0.903987, forward nfe 23852, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 089/100, Runtime 0.286203, Loss 1.066545, forward nfe 24084, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 090/100, Runtime 0.294380, Loss 1.005773, forward nfe 24316, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 091/100, Runtime 0.293897, Loss 1.032264, forward nfe 24548, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 092/100, Runtime 0.294550, Loss 0.906373, forward nfe 24780, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 093/100, Runtime 0.286767, Loss 0.958765, forward nfe 25012, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 094/100, Runtime 0.296338, Loss 1.012332, forward nfe 25244, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 095/100, Runtime 0.292780, Loss 1.029391, forward nfe 25476, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 096/100, Runtime 0.286331, Loss 0.955505, forward nfe 25708, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 097/100, Runtime 0.280552, Loss 1.034790, forward nfe 25940, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 098/100, Runtime 0.292572, Loss 1.024332, forward nfe 26172, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
Epoch: 099/100, Runtime 0.283526, Loss 1.008780, forward nfe 26404, backward nfe 0, Train: 0.7667, Val: 0.7754, Test: 0.7484, Best time: 35.0000
best val accuracy 0.775362 with test accuracy 0.748387 at epoch 7 and best time 35.000000