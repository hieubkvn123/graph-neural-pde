/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 5.905407, Loss 1.951190, forward nfe 104, backward nfe 0, Train: 0.2000, Val: 0.1051, Test: 0.1208, Best time: 0.0944
Epoch: 002/100, Runtime 5.979911, Loss 1.971425, forward nfe 498, backward nfe 0, Train: 0.2000, Val: 0.1051, Test: 0.1208, Best time: 50.0000
Epoch: 003/100, Runtime 5.978334, Loss 1.939069, forward nfe 886, backward nfe 0, Train: 0.2000, Val: 0.1051, Test: 0.1208, Best time: 50.0000
Epoch: 004/100, Runtime 5.660791, Loss 1.904568, forward nfe 1262, backward nfe 0, Train: 0.2000, Val: 0.1051, Test: 0.1208, Best time: 50.0000
Epoch: 005/100, Runtime 5.520685, Loss 1.842798, forward nfe 1632, backward nfe 0, Train: 0.4571, Val: 0.3375, Test: 0.3655, Best time: 0.9486
Epoch: 006/100, Runtime 5.751855, Loss 1.747327, forward nfe 1996, backward nfe 0, Train: 0.7500, Val: 0.6471, Test: 0.6741, Best time: 13.3110
Epoch: 007/100, Runtime 5.342436, Loss 1.604359, forward nfe 2354, backward nfe 0, Train: 0.7857, Val: 0.7081, Test: 0.7381, Best time: 47.4593
Epoch: 008/100, Runtime 5.384935, Loss 1.424136, forward nfe 2700, backward nfe 0, Train: 0.8000, Val: 0.7375, Test: 0.7746, Best time: 24.9388
Epoch: 009/100, Runtime 5.097062, Loss 1.239209, forward nfe 3040, backward nfe 0, Train: 0.8143, Val: 0.7706, Test: 0.8061, Best time: 106.6113
Epoch: 010/100, Runtime 5.165161, Loss 1.030269, forward nfe 3362, backward nfe 0, Train: 0.8143, Val: 0.7706, Test: 0.8061, Best time: 50.0000
Epoch: 011/100, Runtime 4.913865, Loss 0.876559, forward nfe 3690, backward nfe 0, Train: 0.8143, Val: 0.7706, Test: 0.8061, Best time: 50.0000
Epoch: 012/100, Runtime 4.904826, Loss 0.748397, forward nfe 4012, backward nfe 0, Train: 0.9071, Val: 0.7801, Test: 0.7980, Best time: 22.5816
Epoch: 013/100, Runtime 4.789136, Loss 0.654276, forward nfe 4328, backward nfe 0, Train: 0.8929, Val: 0.7926, Test: 0.8335, Best time: 17.9052
Epoch: 014/100, Runtime 4.472279, Loss 0.566745, forward nfe 4632, backward nfe 0, Train: 0.8786, Val: 0.8022, Test: 0.8264, Best time: 118.1154
Epoch: 015/100, Runtime 4.566901, Loss 0.507584, forward nfe 4924, backward nfe 0, Train: 0.9143, Val: 0.8110, Test: 0.8376, Best time: 35.8459
Epoch: 016/100, Runtime 4.534069, Loss 0.461491, forward nfe 5216, backward nfe 0, Train: 0.9143, Val: 0.8140, Test: 0.8376, Best time: 38.0967
Epoch: 017/100, Runtime 4.269984, Loss 0.463973, forward nfe 5490, backward nfe 0, Train: 0.9143, Val: 0.8140, Test: 0.8376, Best time: 50.0000
Epoch: 018/100, Runtime 4.295688, Loss 0.460294, forward nfe 5764, backward nfe 0, Train: 0.9143, Val: 0.8140, Test: 0.8376, Best time: 50.0000
Epoch: 019/100, Runtime 4.271569, Loss 0.447144, forward nfe 6044, backward nfe 0, Train: 0.9143, Val: 0.8140, Test: 0.8376, Best time: 50.0000
Epoch: 020/100, Runtime 4.234295, Loss 0.421494, forward nfe 6312, backward nfe 0, Train: 0.9143, Val: 0.8140, Test: 0.8376, Best time: 50.0000
Epoch: 021/100, Runtime 3.847575, Loss 0.464339, forward nfe 6574, backward nfe 0, Train: 0.9143, Val: 0.8140, Test: 0.8376, Best time: 50.0000
Epoch: 022/100, Runtime 3.874468, Loss 0.374430, forward nfe 6818, backward nfe 0, Train: 0.9143, Val: 0.8140, Test: 0.8376, Best time: 50.0000
Epoch: 023/100, Runtime 3.804082, Loss 0.377639, forward nfe 7062, backward nfe 0, Train: 0.9143, Val: 0.8140, Test: 0.8376, Best time: 50.0000
Epoch: 024/100, Runtime 3.872928, Loss 0.324885, forward nfe 7300, backward nfe 0, Train: 0.9143, Val: 0.8140, Test: 0.8376, Best time: 50.0000
Epoch: 025/100, Runtime 3.870880, Loss 0.447178, forward nfe 7544, backward nfe 0, Train: 0.9143, Val: 0.8140, Test: 0.8376, Best time: 50.0000
Epoch: 026/100, Runtime 3.658608, Loss 0.430971, forward nfe 7788, backward nfe 0, Train: 0.9143, Val: 0.8140, Test: 0.8376, Best time: 50.0000
Epoch: 027/100, Runtime 3.646054, Loss 0.280465, forward nfe 8020, backward nfe 0, Train: 0.9357, Val: 0.8176, Test: 0.8426, Best time: 56.3229
Epoch: 028/100, Runtime 3.576313, Loss 0.346581, forward nfe 8246, backward nfe 0, Train: 0.9357, Val: 0.8176, Test: 0.8426, Best time: 50.0000
Epoch: 029/100, Runtime 3.846606, Loss 0.400965, forward nfe 8472, backward nfe 0, Train: 0.9357, Val: 0.8176, Test: 0.8426, Best time: 50.0000
Epoch: 030/100, Runtime 3.656815, Loss 0.269344, forward nfe 8704, backward nfe 0, Train: 0.9357, Val: 0.8176, Test: 0.8426, Best time: 50.0000
Epoch: 031/100, Runtime 3.532707, Loss 0.367719, forward nfe 8930, backward nfe 0, Train: 0.9357, Val: 0.8176, Test: 0.8426, Best time: 50.0000
Epoch: 032/100, Runtime 3.472614, Loss 0.290377, forward nfe 9150, backward nfe 0, Train: 0.9357, Val: 0.8176, Test: 0.8426, Best time: 50.0000
Epoch: 033/100, Runtime 3.442876, Loss 0.236306, forward nfe 9370, backward nfe 0, Train: 0.9357, Val: 0.8176, Test: 0.8426, Best time: 50.0000
Epoch: 034/100, Runtime 3.656161, Loss 0.249529, forward nfe 9590, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8426, Best time: 93.3626
Epoch: 035/100, Runtime 3.466844, Loss 0.296620, forward nfe 9810, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8426, Best time: 50.0000
Epoch: 036/100, Runtime 3.560635, Loss 0.320107, forward nfe 10030, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8426, Best time: 50.0000
Epoch: 037/100, Runtime 3.618153, Loss 0.278988, forward nfe 10250, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8426, Best time: 50.0000
Epoch: 038/100, Runtime 3.377589, Loss 0.217964, forward nfe 10470, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8426, Best time: 50.0000
Epoch: 039/100, Runtime 3.432831, Loss 0.220833, forward nfe 10684, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8426, Best time: 50.0000
Epoch: 040/100, Runtime 3.407057, Loss 0.201093, forward nfe 10898, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8426, Best time: 50.0000
Epoch: 041/100, Runtime 3.386966, Loss 0.250357, forward nfe 11112, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8426, Best time: 50.0000
Epoch: 042/100, Runtime 3.454738, Loss 0.195553, forward nfe 11326, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8426, Best time: 50.0000
Epoch: 043/100, Runtime 3.528903, Loss 0.186424, forward nfe 11540, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8426, Best time: 50.0000
Epoch: 044/100, Runtime 3.406194, Loss 0.203445, forward nfe 11754, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8426, Best time: 50.0000
Epoch: 045/100, Runtime 3.426151, Loss 0.235737, forward nfe 11968, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8426, Best time: 50.0000
Epoch: 046/100, Runtime 3.397313, Loss 0.146512, forward nfe 12182, backward nfe 0, Train: 0.9714, Val: 0.8265, Test: 0.8558, Best time: 86.6546
Epoch: 047/100, Runtime 3.469723, Loss 0.191910, forward nfe 12396, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 93.1072
Epoch: 048/100, Runtime 3.623695, Loss 0.308753, forward nfe 12616, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 049/100, Runtime 3.480944, Loss 0.162493, forward nfe 12836, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 050/100, Runtime 3.638823, Loss 0.159210, forward nfe 13056, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 051/100, Runtime 3.705468, Loss 0.169481, forward nfe 13282, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 052/100, Runtime 3.569624, Loss 0.196992, forward nfe 13514, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 053/100, Runtime 3.812329, Loss 0.130514, forward nfe 13746, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 054/100, Runtime 3.567622, Loss 0.140422, forward nfe 13978, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 055/100, Runtime 3.738352, Loss 0.144130, forward nfe 14210, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 056/100, Runtime 3.577716, Loss 0.139619, forward nfe 14442, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 057/100, Runtime 3.684754, Loss 0.156396, forward nfe 14674, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 058/100, Runtime 3.664808, Loss 0.137299, forward nfe 14906, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 059/100, Runtime 3.621802, Loss 0.144550, forward nfe 15138, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 060/100, Runtime 3.637149, Loss 0.153821, forward nfe 15364, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 061/100, Runtime 3.486775, Loss 0.105211, forward nfe 15590, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 062/100, Runtime 3.680119, Loss 0.099756, forward nfe 15816, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 063/100, Runtime 3.478554, Loss 0.095554, forward nfe 16042, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 064/100, Runtime 3.569359, Loss 0.114869, forward nfe 16268, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 065/100, Runtime 3.484826, Loss 0.118293, forward nfe 16494, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 066/100, Runtime 3.397182, Loss 0.114363, forward nfe 16714, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 067/100, Runtime 3.616075, Loss 0.067059, forward nfe 16934, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 068/100, Runtime 3.424063, Loss 0.089639, forward nfe 17154, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 069/100, Runtime 3.382257, Loss 0.074564, forward nfe 17374, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 070/100, Runtime 3.524276, Loss 0.080730, forward nfe 17594, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 071/100, Runtime 3.419844, Loss 0.097550, forward nfe 17814, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 072/100, Runtime 2.892781, Loss 0.067506, forward nfe 18040, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 073/100, Runtime 2.149825, Loss 0.147222, forward nfe 18266, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 074/100, Runtime 2.024614, Loss 0.066576, forward nfe 18492, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 075/100, Runtime 2.251475, Loss 0.116297, forward nfe 18718, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 076/100, Runtime 2.117475, Loss 0.061972, forward nfe 18944, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 077/100, Runtime 2.052712, Loss 0.097982, forward nfe 19170, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 078/100, Runtime 2.245678, Loss 0.071864, forward nfe 19396, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 079/100, Runtime 2.006059, Loss 0.084154, forward nfe 19604, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 080/100, Runtime 2.000062, Loss 0.047315, forward nfe 19812, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 081/100, Runtime 2.243719, Loss 0.053723, forward nfe 20038, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 082/100, Runtime 2.120630, Loss 0.046676, forward nfe 20246, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 083/100, Runtime 2.224530, Loss 0.079199, forward nfe 20454, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 084/100, Runtime 2.651357, Loss 0.055511, forward nfe 20662, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 085/100, Runtime 2.507809, Loss 0.065759, forward nfe 20870, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 086/100, Runtime 2.403953, Loss 0.083113, forward nfe 21072, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 087/100, Runtime 2.558221, Loss 0.044262, forward nfe 21274, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 088/100, Runtime 2.504025, Loss 0.079422, forward nfe 21476, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 089/100, Runtime 2.322107, Loss 0.054041, forward nfe 21672, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 090/100, Runtime 2.466445, Loss 0.064091, forward nfe 21868, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 091/100, Runtime 2.583762, Loss 0.067103, forward nfe 22070, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 092/100, Runtime 2.417116, Loss 0.045814, forward nfe 22272, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 093/100, Runtime 2.432897, Loss 0.150830, forward nfe 22474, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 094/100, Runtime 2.611079, Loss 0.086655, forward nfe 22676, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 095/100, Runtime 2.530501, Loss 0.083200, forward nfe 22878, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 096/100, Runtime 2.469003, Loss 0.074655, forward nfe 23080, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 097/100, Runtime 2.664263, Loss 0.061484, forward nfe 23282, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 098/100, Runtime 2.560406, Loss 0.056564, forward nfe 23484, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
Epoch: 099/100, Runtime 2.458542, Loss 0.081824, forward nfe 23686, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8558, Best time: 50.0000
best val accuracy 0.827206 with test accuracy 0.855838 at epoch 47 and best time 50.000000