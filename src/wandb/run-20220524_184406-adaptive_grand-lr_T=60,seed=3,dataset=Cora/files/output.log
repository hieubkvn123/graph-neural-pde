/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 6.991263, Loss 1.946450, forward nfe 116, backward nfe 0, Train: 0.1571, Val: 0.3213, Test: 0.2975, Best time: 0.0933
Epoch: 002/100, Runtime 6.698010, Loss 1.924412, forward nfe 570, backward nfe 0, Train: 0.7071, Val: 0.5882, Test: 0.5746, Best time: 1.0019
Epoch: 003/100, Runtime 6.880431, Loss 1.806370, forward nfe 1012, backward nfe 0, Train: 0.7071, Val: 0.5882, Test: 0.5746, Best time: 60.0000
Epoch: 004/100, Runtime 6.472527, Loss 1.660289, forward nfe 1442, backward nfe 0, Train: 0.6643, Val: 0.7728, Test: 0.7685, Best time: 44.9887
Epoch: 005/100, Runtime 6.317826, Loss 1.457751, forward nfe 1854, backward nfe 0, Train: 0.8071, Val: 0.8206, Test: 0.8183, Best time: 10.4875
Epoch: 006/100, Runtime 6.297194, Loss 1.241755, forward nfe 2260, backward nfe 0, Train: 0.8643, Val: 0.8228, Test: 0.8203, Best time: 31.9652
Epoch: 007/100, Runtime 6.198420, Loss 1.001855, forward nfe 2666, backward nfe 0, Train: 0.8643, Val: 0.8228, Test: 0.8203, Best time: 60.0000
Epoch: 008/100, Runtime 6.025773, Loss 0.788858, forward nfe 3066, backward nfe 0, Train: 0.8643, Val: 0.8228, Test: 0.8203, Best time: 60.0000
Epoch: 009/100, Runtime 6.073417, Loss 0.687411, forward nfe 3454, backward nfe 0, Train: 0.8643, Val: 0.8228, Test: 0.8203, Best time: 60.0000
Epoch: 010/100, Runtime 5.823571, Loss 0.601701, forward nfe 3842, backward nfe 0, Train: 0.8643, Val: 0.8228, Test: 0.8203, Best time: 60.0000
Epoch: 011/100, Runtime 5.437476, Loss 0.542563, forward nfe 4218, backward nfe 0, Train: 0.8500, Val: 0.8250, Test: 0.8254, Best time: 99.2459
Epoch: 012/100, Runtime 5.564727, Loss 0.491686, forward nfe 4582, backward nfe 0, Train: 0.8500, Val: 0.8250, Test: 0.8254, Best time: 60.0000
Epoch: 013/100, Runtime 5.225157, Loss 0.451843, forward nfe 4934, backward nfe 0, Train: 0.8500, Val: 0.8250, Test: 0.8254, Best time: 60.0000
Epoch: 014/100, Runtime 5.114693, Loss 0.435854, forward nfe 5268, backward nfe 0, Train: 0.8500, Val: 0.8250, Test: 0.8254, Best time: 60.0000
Epoch: 015/100, Runtime 5.041634, Loss 0.381112, forward nfe 5596, backward nfe 0, Train: 0.8500, Val: 0.8250, Test: 0.8254, Best time: 60.0000
Epoch: 016/100, Runtime 5.068094, Loss 0.430678, forward nfe 5918, backward nfe 0, Train: 0.8500, Val: 0.8250, Test: 0.8254, Best time: 60.0000
Epoch: 017/100, Runtime 4.884865, Loss 0.327558, forward nfe 6240, backward nfe 0, Train: 0.9214, Val: 0.8294, Test: 0.8355, Best time: 76.1715
Epoch: 018/100, Runtime 4.968514, Loss 0.381388, forward nfe 6556, backward nfe 0, Train: 0.9214, Val: 0.8294, Test: 0.8355, Best time: 60.0000
Epoch: 019/100, Runtime 4.693833, Loss 0.423760, forward nfe 6872, backward nfe 0, Train: 0.9214, Val: 0.8294, Test: 0.8355, Best time: 60.0000
Epoch: 020/100, Runtime 4.791101, Loss 0.312497, forward nfe 7182, backward nfe 0, Train: 0.9214, Val: 0.8294, Test: 0.8355, Best time: 60.0000
Epoch: 021/100, Runtime 4.540634, Loss 0.313164, forward nfe 7480, backward nfe 0, Train: 0.9214, Val: 0.8294, Test: 0.8355, Best time: 60.0000
Epoch: 022/100, Runtime 4.483272, Loss 0.311630, forward nfe 7760, backward nfe 0, Train: 0.9214, Val: 0.8294, Test: 0.8355, Best time: 60.0000
Epoch: 023/100, Runtime 4.447369, Loss 0.293531, forward nfe 8046, backward nfe 0, Train: 0.9214, Val: 0.8294, Test: 0.8355, Best time: 60.0000
Epoch: 024/100, Runtime 4.404932, Loss 0.275896, forward nfe 8332, backward nfe 0, Train: 0.9214, Val: 0.8294, Test: 0.8355, Best time: 60.0000
Epoch: 025/100, Runtime 4.510098, Loss 0.294221, forward nfe 8618, backward nfe 0, Train: 0.9214, Val: 0.8294, Test: 0.8355, Best time: 60.0000
Epoch: 026/100, Runtime 4.467197, Loss 0.215708, forward nfe 8904, backward nfe 0, Train: 0.9571, Val: 0.8456, Test: 0.8416, Best time: 76.5889
Epoch: 027/100, Runtime 4.215915, Loss 0.259285, forward nfe 9184, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 101.9238
Epoch: 028/100, Runtime 4.093426, Loss 0.253751, forward nfe 9452, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 029/100, Runtime 4.344300, Loss 0.221944, forward nfe 9714, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 030/100, Runtime 3.991683, Loss 0.218581, forward nfe 9976, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 031/100, Runtime 4.174390, Loss 0.180397, forward nfe 10238, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 032/100, Runtime 4.204813, Loss 0.235264, forward nfe 10500, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 033/100, Runtime 4.096902, Loss 0.172474, forward nfe 10768, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 034/100, Runtime 4.216424, Loss 0.200302, forward nfe 11030, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 035/100, Runtime 4.044128, Loss 0.199681, forward nfe 11292, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 036/100, Runtime 4.109241, Loss 0.176624, forward nfe 11548, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 037/100, Runtime 4.018411, Loss 0.173087, forward nfe 11804, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 038/100, Runtime 3.797206, Loss 0.131698, forward nfe 12054, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 039/100, Runtime 4.077821, Loss 0.112289, forward nfe 12304, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 040/100, Runtime 3.923434, Loss 0.156036, forward nfe 12554, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 041/100, Runtime 3.972639, Loss 0.107317, forward nfe 12804, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 042/100, Runtime 3.733912, Loss 0.128455, forward nfe 13048, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 043/100, Runtime 3.932812, Loss 0.103934, forward nfe 13292, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 044/100, Runtime 3.691182, Loss 0.132068, forward nfe 13536, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 045/100, Runtime 3.869171, Loss 0.091839, forward nfe 13768, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 046/100, Runtime 3.458921, Loss 0.088614, forward nfe 14000, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 047/100, Runtime 3.556180, Loss 0.114547, forward nfe 14220, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 048/100, Runtime 3.550112, Loss 0.111743, forward nfe 14440, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 049/100, Runtime 3.487448, Loss 0.086509, forward nfe 14660, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 050/100, Runtime 3.646483, Loss 0.119927, forward nfe 14880, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 051/100, Runtime 3.503444, Loss 0.098969, forward nfe 15100, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 052/100, Runtime 3.577125, Loss 0.097962, forward nfe 15320, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 053/100, Runtime 3.472995, Loss 0.062591, forward nfe 15540, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 054/100, Runtime 3.314054, Loss 0.084079, forward nfe 15754, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 055/100, Runtime 3.432787, Loss 0.045028, forward nfe 15968, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 056/100, Runtime 3.529941, Loss 0.078083, forward nfe 16182, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 057/100, Runtime 3.351605, Loss 0.094776, forward nfe 16396, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 058/100, Runtime 3.471737, Loss 0.078447, forward nfe 16610, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 059/100, Runtime 3.501428, Loss 0.043851, forward nfe 16824, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 060/100, Runtime 3.301605, Loss 0.071774, forward nfe 17038, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 061/100, Runtime 3.388556, Loss 0.061076, forward nfe 17258, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 062/100, Runtime 3.482106, Loss 0.069227, forward nfe 17472, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 063/100, Runtime 3.356524, Loss 0.052207, forward nfe 17686, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 064/100, Runtime 3.300398, Loss 0.046920, forward nfe 17900, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 065/100, Runtime 3.380851, Loss 0.074863, forward nfe 18114, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 066/100, Runtime 3.387045, Loss 0.051590, forward nfe 18328, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 067/100, Runtime 3.384609, Loss 0.034907, forward nfe 18536, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 068/100, Runtime 3.498212, Loss 0.085237, forward nfe 18744, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 069/100, Runtime 3.305255, Loss 0.093941, forward nfe 18952, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 070/100, Runtime 3.058476, Loss 0.056490, forward nfe 19160, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 071/100, Runtime 3.206045, Loss 0.041611, forward nfe 19350, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 072/100, Runtime 3.095026, Loss 0.081598, forward nfe 19540, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 073/100, Runtime 2.996406, Loss 0.061500, forward nfe 19730, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 074/100, Runtime 2.925183, Loss 0.086839, forward nfe 19914, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 075/100, Runtime 3.032491, Loss 0.061661, forward nfe 20098, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 076/100, Runtime 2.956037, Loss 0.053410, forward nfe 20282, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 077/100, Runtime 3.137521, Loss 0.081721, forward nfe 20466, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 078/100, Runtime 2.975637, Loss 0.218409, forward nfe 20650, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 079/100, Runtime 3.040859, Loss 0.059568, forward nfe 20834, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 080/100, Runtime 2.913863, Loss 0.038212, forward nfe 21018, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 081/100, Runtime 3.065140, Loss 0.139734, forward nfe 21202, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 082/100, Runtime 2.965255, Loss 0.091780, forward nfe 21386, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 083/100, Runtime 3.113234, Loss 0.085934, forward nfe 21570, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 084/100, Runtime 2.973047, Loss 0.076157, forward nfe 21754, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 085/100, Runtime 3.006208, Loss 0.081147, forward nfe 21938, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 086/100, Runtime 2.936777, Loss 0.048081, forward nfe 22122, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 087/100, Runtime 3.007817, Loss 0.046581, forward nfe 22306, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 088/100, Runtime 3.009231, Loss 0.031932, forward nfe 22490, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 089/100, Runtime 3.048008, Loss 0.065801, forward nfe 22674, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 090/100, Runtime 3.040173, Loss 0.025722, forward nfe 22858, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 091/100, Runtime 2.903537, Loss 0.014178, forward nfe 23042, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 092/100, Runtime 3.016008, Loss 0.019495, forward nfe 23226, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 093/100, Runtime 2.950130, Loss 0.062692, forward nfe 23410, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 094/100, Runtime 3.052282, Loss 0.093698, forward nfe 23594, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 095/100, Runtime 2.984795, Loss 0.024439, forward nfe 23778, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 096/100, Runtime 3.132365, Loss 0.051994, forward nfe 23962, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 097/100, Runtime 2.930167, Loss 0.036720, forward nfe 24146, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 098/100, Runtime 3.029030, Loss 0.077719, forward nfe 24330, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
Epoch: 099/100, Runtime 2.924507, Loss 0.031181, forward nfe 24514, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8528, Best time: 60.0000
best val accuracy 0.847059 with test accuracy 0.852792 at epoch 27 and best time 60.000000