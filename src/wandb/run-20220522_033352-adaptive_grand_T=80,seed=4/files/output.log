/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 4.480891, Loss 1.948794, forward nfe 152, backward nfe 0, Train: 0.2714, Val: 0.2191, Test: 0.2162, Best time: 0.0954
Epoch: 002/100, Runtime 4.666180, Loss 1.979731, forward nfe 750, backward nfe 0, Train: 0.2714, Val: 0.2191, Test: 0.2162, Best time: 80.0000
Epoch: 003/100, Runtime 4.602657, Loss 1.956188, forward nfe 1342, backward nfe 0, Train: 0.2714, Val: 0.2191, Test: 0.2162, Best time: 80.0000
Epoch: 004/100, Runtime 4.396152, Loss 1.917845, forward nfe 1916, backward nfe 0, Train: 0.3929, Val: 0.3647, Test: 0.3259, Best time: 2.2508
Epoch: 005/100, Runtime 4.351428, Loss 1.851433, forward nfe 2466, backward nfe 0, Train: 0.5000, Val: 0.4831, Test: 0.4365, Best time: 0.0889
Epoch: 006/100, Runtime 4.177107, Loss 1.728253, forward nfe 3010, backward nfe 0, Train: 0.8143, Val: 0.7551, Test: 0.7218, Best time: 5.6719
Epoch: 007/100, Runtime 4.017582, Loss 1.555568, forward nfe 3542, backward nfe 0, Train: 0.8714, Val: 0.8125, Test: 0.8010, Best time: 10.8224
Epoch: 008/100, Runtime 3.925557, Loss 1.365401, forward nfe 4062, backward nfe 0, Train: 0.9071, Val: 0.8176, Test: 0.8020, Best time: 11.2546
Epoch: 009/100, Runtime 3.988998, Loss 1.145894, forward nfe 4576, backward nfe 0, Train: 0.9071, Val: 0.8176, Test: 0.8020, Best time: 80.0000
Epoch: 010/100, Runtime 3.994108, Loss 0.957176, forward nfe 5084, backward nfe 0, Train: 0.9071, Val: 0.8176, Test: 0.8020, Best time: 80.0000
Epoch: 011/100, Runtime 3.815644, Loss 0.803997, forward nfe 5580, backward nfe 0, Train: 0.9071, Val: 0.8272, Test: 0.8162, Best time: 22.3236
Epoch: 012/100, Runtime 3.817168, Loss 0.660213, forward nfe 6064, backward nfe 0, Train: 0.9214, Val: 0.8382, Test: 0.8142, Best time: 37.3999
Epoch: 013/100, Runtime 3.645314, Loss 0.590630, forward nfe 6536, backward nfe 0, Train: 0.9214, Val: 0.8382, Test: 0.8142, Best time: 80.0000
Epoch: 014/100, Runtime 3.478038, Loss 0.522677, forward nfe 6990, backward nfe 0, Train: 0.9214, Val: 0.8382, Test: 0.8142, Best time: 80.0000
Epoch: 015/100, Runtime 3.574199, Loss 0.428586, forward nfe 7432, backward nfe 0, Train: 0.9214, Val: 0.8382, Test: 0.8142, Best time: 80.0000
Epoch: 016/100, Runtime 3.319232, Loss 0.361795, forward nfe 7868, backward nfe 0, Train: 0.9214, Val: 0.8434, Test: 0.8386, Best time: 71.4056
Epoch: 017/100, Runtime 3.336887, Loss 0.352360, forward nfe 8292, backward nfe 0, Train: 0.9214, Val: 0.8434, Test: 0.8386, Best time: 80.0000
Epoch: 018/100, Runtime 3.128959, Loss 0.366208, forward nfe 8704, backward nfe 0, Train: 0.9214, Val: 0.8434, Test: 0.8386, Best time: 80.0000
Epoch: 019/100, Runtime 3.135655, Loss 0.335891, forward nfe 9104, backward nfe 0, Train: 0.9214, Val: 0.8434, Test: 0.8386, Best time: 80.0000
Epoch: 020/100, Runtime 3.038286, Loss 0.310350, forward nfe 9486, backward nfe 0, Train: 0.9214, Val: 0.8434, Test: 0.8386, Best time: 80.0000
Epoch: 021/100, Runtime 2.891203, Loss 0.344966, forward nfe 9862, backward nfe 0, Train: 0.9214, Val: 0.8434, Test: 0.8386, Best time: 80.0000
Epoch: 022/100, Runtime 2.899361, Loss 0.467847, forward nfe 10238, backward nfe 0, Train: 0.9214, Val: 0.8434, Test: 0.8386, Best time: 80.0000
Epoch: 023/100, Runtime 2.525998, Loss 0.337223, forward nfe 10602, backward nfe 0, Train: 0.9214, Val: 0.8434, Test: 0.8386, Best time: 80.0000
Epoch: 024/100, Runtime 2.661069, Loss 0.354093, forward nfe 10954, backward nfe 0, Train: 0.9214, Val: 0.8434, Test: 0.8386, Best time: 80.0000
Epoch: 025/100, Runtime 2.415442, Loss 0.355166, forward nfe 11288, backward nfe 0, Train: 0.9214, Val: 0.8434, Test: 0.8386, Best time: 80.0000
Epoch: 026/100, Runtime 2.613295, Loss 0.270234, forward nfe 11610, backward nfe 0, Train: 0.9214, Val: 0.8434, Test: 0.8386, Best time: 80.0000
Epoch: 027/100, Runtime 2.550762, Loss 0.304525, forward nfe 11932, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8345, Best time: 81.7845
Epoch: 028/100, Runtime 2.518174, Loss 0.267362, forward nfe 12248, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8345, Best time: 80.0000
Epoch: 029/100, Runtime 2.495570, Loss 0.251746, forward nfe 12558, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8345, Best time: 80.0000
Epoch: 030/100, Runtime 2.414023, Loss 0.191382, forward nfe 12862, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8345, Best time: 80.0000
Epoch: 031/100, Runtime 2.419524, Loss 0.219126, forward nfe 13160, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8345, Best time: 80.0000
Epoch: 032/100, Runtime 2.230907, Loss 0.261161, forward nfe 13446, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8345, Best time: 80.0000
Epoch: 033/100, Runtime 2.286947, Loss 0.196987, forward nfe 13720, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8345, Best time: 80.0000
Epoch: 034/100, Runtime 2.243553, Loss 0.169925, forward nfe 14000, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8589, Best time: 117.6026
Epoch: 035/100, Runtime 2.166726, Loss 0.194800, forward nfe 14274, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8589, Best time: 80.0000
Epoch: 036/100, Runtime 2.051845, Loss 0.201590, forward nfe 14548, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8589, Best time: 80.0000
Epoch: 037/100, Runtime 2.136929, Loss 0.220561, forward nfe 14816, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8589, Best time: 80.0000
Epoch: 038/100, Runtime 1.975806, Loss 0.198724, forward nfe 15084, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8589, Best time: 80.0000
Epoch: 039/100, Runtime 2.268044, Loss 0.183477, forward nfe 15346, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8589, Best time: 80.0000
Epoch: 040/100, Runtime 2.183918, Loss 0.183688, forward nfe 15608, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 124.3249
Epoch: 041/100, Runtime 2.107553, Loss 0.206775, forward nfe 15870, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 042/100, Runtime 2.141170, Loss 0.156310, forward nfe 16132, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 043/100, Runtime 2.128133, Loss 0.223378, forward nfe 16388, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 044/100, Runtime 2.091908, Loss 0.152305, forward nfe 16644, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 045/100, Runtime 2.082742, Loss 0.107057, forward nfe 16900, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 046/100, Runtime 2.101235, Loss 0.123506, forward nfe 17156, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 047/100, Runtime 1.902291, Loss 0.123653, forward nfe 17412, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 048/100, Runtime 2.017929, Loss 0.156820, forward nfe 17668, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 049/100, Runtime 2.008096, Loss 0.109964, forward nfe 17924, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 050/100, Runtime 2.001280, Loss 0.140688, forward nfe 18180, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 051/100, Runtime 2.010953, Loss 0.103577, forward nfe 18436, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 052/100, Runtime 1.917196, Loss 0.117752, forward nfe 18692, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 053/100, Runtime 1.998374, Loss 0.097890, forward nfe 18936, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 054/100, Runtime 1.877974, Loss 0.165637, forward nfe 19180, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 055/100, Runtime 1.923940, Loss 0.111439, forward nfe 19424, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 056/100, Runtime 1.975519, Loss 0.104312, forward nfe 19674, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 057/100, Runtime 1.898806, Loss 0.131781, forward nfe 19924, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 058/100, Runtime 1.943568, Loss 0.089174, forward nfe 20174, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 059/100, Runtime 1.997317, Loss 0.094847, forward nfe 20424, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 060/100, Runtime 1.913616, Loss 0.109181, forward nfe 20674, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 061/100, Runtime 2.122975, Loss 0.078965, forward nfe 20924, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 062/100, Runtime 2.106122, Loss 0.136046, forward nfe 21180, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 063/100, Runtime 2.112403, Loss 0.092439, forward nfe 21436, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 064/100, Runtime 2.060318, Loss 0.132590, forward nfe 21692, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 065/100, Runtime 2.066771, Loss 0.138128, forward nfe 21948, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 066/100, Runtime 2.118950, Loss 0.062522, forward nfe 22204, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 067/100, Runtime 2.051645, Loss 0.074824, forward nfe 22460, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 068/100, Runtime 2.108230, Loss 0.120950, forward nfe 22716, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 069/100, Runtime 1.978543, Loss 0.080905, forward nfe 22972, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 070/100, Runtime 1.983523, Loss 0.060209, forward nfe 23228, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 071/100, Runtime 1.907867, Loss 0.065594, forward nfe 23484, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 072/100, Runtime 1.952171, Loss 0.096287, forward nfe 23740, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 073/100, Runtime 1.895106, Loss 0.043936, forward nfe 23990, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 074/100, Runtime 2.061759, Loss 0.076037, forward nfe 24240, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 075/100, Runtime 1.970273, Loss 0.054513, forward nfe 24490, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 076/100, Runtime 1.876236, Loss 0.067897, forward nfe 24734, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 077/100, Runtime 2.002114, Loss 0.069512, forward nfe 24978, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 078/100, Runtime 1.997193, Loss 0.091502, forward nfe 25222, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 079/100, Runtime 1.989708, Loss 0.053368, forward nfe 25466, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 080/100, Runtime 1.970991, Loss 0.070975, forward nfe 25710, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 081/100, Runtime 2.008721, Loss 0.059649, forward nfe 25954, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 082/100, Runtime 1.982421, Loss 0.076270, forward nfe 26198, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 083/100, Runtime 2.016774, Loss 0.148662, forward nfe 26442, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 084/100, Runtime 1.922534, Loss 0.036749, forward nfe 26686, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 085/100, Runtime 1.921243, Loss 0.109357, forward nfe 26930, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 086/100, Runtime 1.931829, Loss 0.026477, forward nfe 27168, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 087/100, Runtime 1.889653, Loss 0.052064, forward nfe 27406, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 088/100, Runtime 1.987017, Loss 0.101715, forward nfe 27644, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 089/100, Runtime 1.805850, Loss 0.084519, forward nfe 27882, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 090/100, Runtime 2.054767, Loss 0.073982, forward nfe 28120, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 091/100, Runtime 1.985843, Loss 0.054736, forward nfe 28358, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 092/100, Runtime 1.912441, Loss 0.043158, forward nfe 28596, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 093/100, Runtime 1.828439, Loss 0.063687, forward nfe 28816, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 094/100, Runtime 1.789483, Loss 0.078027, forward nfe 29036, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 095/100, Runtime 2.250552, Loss 0.033897, forward nfe 29256, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 096/100, Runtime 2.258168, Loss 0.048439, forward nfe 29464, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 097/100, Runtime 2.615718, Loss 0.079639, forward nfe 29678, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 098/100, Runtime 2.737083, Loss 0.071797, forward nfe 29910, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
Epoch: 099/100, Runtime 2.736673, Loss 0.031748, forward nfe 30160, backward nfe 0, Train: 0.9786, Val: 0.8566, Test: 0.8477, Best time: 80.0000
best val accuracy 0.856618 with test accuracy 0.847716 at epoch 40 and best time 80.000000