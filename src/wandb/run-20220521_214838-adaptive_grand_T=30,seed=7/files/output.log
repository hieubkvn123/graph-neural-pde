/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 2.092446, Loss 1.947491, forward nfe 74, backward nfe 0, Train: 0.3214, Val: 0.2603, Test: 0.2609, Best time: 0.0956
Epoch: 002/100, Runtime 2.112518, Loss 1.835602, forward nfe 330, backward nfe 0, Train: 0.7857, Val: 0.5618, Test: 0.5655, Best time: 3.7990
Epoch: 003/100, Runtime 1.875211, Loss 1.595657, forward nfe 592, backward nfe 0, Train: 0.8500, Val: 0.6676, Test: 0.6629, Best time: 5.5354
Epoch: 004/100, Runtime 2.261513, Loss 1.306350, forward nfe 848, backward nfe 0, Train: 0.8643, Val: 0.7368, Test: 0.7137, Best time: 5.5904
Epoch: 005/100, Runtime 2.426044, Loss 1.008734, forward nfe 1092, backward nfe 0, Train: 0.9071, Val: 0.8235, Test: 0.7919, Best time: 17.9768
Epoch: 006/100, Runtime 2.169705, Loss 0.739085, forward nfe 1324, backward nfe 0, Train: 0.9214, Val: 0.8529, Test: 0.8254, Best time: 31.7008
Epoch: 007/100, Runtime 2.201538, Loss 0.542475, forward nfe 1550, backward nfe 0, Train: 0.9286, Val: 0.8544, Test: 0.8376, Best time: 14.5380
Epoch: 008/100, Runtime 2.041609, Loss 0.445323, forward nfe 1776, backward nfe 0, Train: 0.9286, Val: 0.8544, Test: 0.8376, Best time: 30.0000
Epoch: 009/100, Runtime 2.106841, Loss 0.334722, forward nfe 1996, backward nfe 0, Train: 0.9286, Val: 0.8544, Test: 0.8376, Best time: 30.0000
Epoch: 010/100, Runtime 2.122988, Loss 0.278552, forward nfe 2222, backward nfe 0, Train: 0.9286, Val: 0.8544, Test: 0.8376, Best time: 30.0000
Epoch: 011/100, Runtime 2.107209, Loss 0.236705, forward nfe 2442, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 31.0784
Epoch: 012/100, Runtime 2.062280, Loss 0.218015, forward nfe 2650, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 013/100, Runtime 1.927097, Loss 0.221626, forward nfe 2846, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 014/100, Runtime 1.759326, Loss 0.216036, forward nfe 3042, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 015/100, Runtime 2.127679, Loss 0.240556, forward nfe 3226, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 016/100, Runtime 2.203215, Loss 0.209232, forward nfe 3416, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 017/100, Runtime 2.038405, Loss 0.209912, forward nfe 3606, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 018/100, Runtime 1.609686, Loss 0.233738, forward nfe 3784, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 019/100, Runtime 1.319771, Loss 0.198729, forward nfe 3962, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 020/100, Runtime 1.334062, Loss 0.223823, forward nfe 4140, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 021/100, Runtime 1.306344, Loss 0.139957, forward nfe 4306, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 022/100, Runtime 1.352051, Loss 0.183462, forward nfe 4472, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 023/100, Runtime 1.389936, Loss 0.199214, forward nfe 4638, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 024/100, Runtime 1.421952, Loss 0.136453, forward nfe 4804, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 025/100, Runtime 1.364824, Loss 0.182226, forward nfe 4964, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 026/100, Runtime 1.371038, Loss 0.135281, forward nfe 5124, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 027/100, Runtime 1.290416, Loss 0.151885, forward nfe 5284, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 028/100, Runtime 1.371907, Loss 0.157460, forward nfe 5444, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 029/100, Runtime 1.335525, Loss 0.113229, forward nfe 5604, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 030/100, Runtime 1.306094, Loss 0.206698, forward nfe 5758, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 031/100, Runtime 1.186391, Loss 0.141425, forward nfe 5912, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 032/100, Runtime 1.286660, Loss 0.153011, forward nfe 6060, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 033/100, Runtime 1.287453, Loss 0.198078, forward nfe 6208, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 034/100, Runtime 1.267200, Loss 0.190445, forward nfe 6350, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 035/100, Runtime 1.267140, Loss 0.108416, forward nfe 6498, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 036/100, Runtime 1.250822, Loss 0.163201, forward nfe 6646, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 037/100, Runtime 1.194777, Loss 0.156574, forward nfe 6794, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 038/100, Runtime 1.189192, Loss 0.074615, forward nfe 6942, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 039/100, Runtime 1.230102, Loss 0.084609, forward nfe 7090, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 040/100, Runtime 1.102221, Loss 0.103872, forward nfe 7238, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 041/100, Runtime 1.258583, Loss 0.106223, forward nfe 7386, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 042/100, Runtime 1.252999, Loss 0.094994, forward nfe 7534, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 043/100, Runtime 1.178981, Loss 0.115847, forward nfe 7682, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 044/100, Runtime 1.250051, Loss 0.091614, forward nfe 7830, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 045/100, Runtime 1.180877, Loss 0.122565, forward nfe 7978, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 046/100, Runtime 1.241777, Loss 0.166799, forward nfe 8126, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 047/100, Runtime 1.232415, Loss 0.083259, forward nfe 8274, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 048/100, Runtime 1.274171, Loss 0.074244, forward nfe 8422, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 049/100, Runtime 1.331302, Loss 0.117921, forward nfe 8570, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 050/100, Runtime 1.325395, Loss 0.120357, forward nfe 8718, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 051/100, Runtime 1.224909, Loss 0.060335, forward nfe 8866, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 052/100, Runtime 1.209001, Loss 0.075528, forward nfe 9014, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 053/100, Runtime 1.109221, Loss 0.065629, forward nfe 9162, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 054/100, Runtime 1.163844, Loss 0.122959, forward nfe 9304, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 055/100, Runtime 1.113437, Loss 0.085431, forward nfe 9446, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 056/100, Runtime 1.176474, Loss 0.052414, forward nfe 9588, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 057/100, Runtime 1.105456, Loss 0.098314, forward nfe 9730, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 058/100, Runtime 1.310210, Loss 0.109025, forward nfe 9878, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 059/100, Runtime 1.242985, Loss 0.098765, forward nfe 10026, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 060/100, Runtime 1.201950, Loss 0.074309, forward nfe 10168, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 061/100, Runtime 1.235047, Loss 0.058326, forward nfe 10310, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 062/100, Runtime 1.270000, Loss 0.069747, forward nfe 10452, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 063/100, Runtime 1.276879, Loss 0.076349, forward nfe 10600, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 064/100, Runtime 1.249646, Loss 0.096682, forward nfe 10748, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 065/100, Runtime 1.170544, Loss 0.064563, forward nfe 10896, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 066/100, Runtime 1.132051, Loss 0.100517, forward nfe 11032, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 067/100, Runtime 1.139570, Loss 0.081703, forward nfe 11168, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 068/100, Runtime 1.103916, Loss 0.086245, forward nfe 11304, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 069/100, Runtime 1.098770, Loss 0.051997, forward nfe 11440, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 070/100, Runtime 1.167218, Loss 0.066183, forward nfe 11576, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 071/100, Runtime 1.183078, Loss 0.073436, forward nfe 11712, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 072/100, Runtime 1.246968, Loss 0.068402, forward nfe 11854, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 073/100, Runtime 1.204577, Loss 0.046213, forward nfe 11996, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 074/100, Runtime 1.195261, Loss 0.043117, forward nfe 12138, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 075/100, Runtime 1.186723, Loss 0.074938, forward nfe 12280, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 076/100, Runtime 1.171315, Loss 0.053707, forward nfe 12422, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 077/100, Runtime 1.201575, Loss 0.061016, forward nfe 12564, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 078/100, Runtime 1.257827, Loss 0.039775, forward nfe 12706, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 079/100, Runtime 1.216036, Loss 0.055947, forward nfe 12848, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 080/100, Runtime 1.091197, Loss 0.041525, forward nfe 12990, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 081/100, Runtime 1.164426, Loss 0.044269, forward nfe 13126, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 082/100, Runtime 1.018438, Loss 0.040165, forward nfe 13262, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 083/100, Runtime 1.118927, Loss 0.033270, forward nfe 13392, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 084/100, Runtime 1.093138, Loss 0.035173, forward nfe 13522, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 085/100, Runtime 1.123420, Loss 0.029270, forward nfe 13652, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 086/100, Runtime 1.204899, Loss 0.041495, forward nfe 13782, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 087/100, Runtime 1.156491, Loss 0.057652, forward nfe 13918, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 088/100, Runtime 1.203288, Loss 0.045635, forward nfe 14054, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 089/100, Runtime 1.183681, Loss 0.043683, forward nfe 14196, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 090/100, Runtime 1.203177, Loss 0.041617, forward nfe 14338, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 091/100, Runtime 1.298524, Loss 0.047358, forward nfe 14480, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 092/100, Runtime 1.309666, Loss 0.044727, forward nfe 14628, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 093/100, Runtime 1.411231, Loss 0.053125, forward nfe 14782, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 094/100, Runtime 1.404381, Loss 0.045345, forward nfe 14942, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 095/100, Runtime 1.428432, Loss 0.029381, forward nfe 15108, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 096/100, Runtime 1.504152, Loss 0.020196, forward nfe 15274, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 097/100, Runtime 1.621842, Loss 0.065466, forward nfe 15452, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 098/100, Runtime 1.625820, Loss 0.051309, forward nfe 15642, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
Epoch: 099/100, Runtime 1.558829, Loss 0.041173, forward nfe 15838, backward nfe 0, Train: 0.9571, Val: 0.8566, Test: 0.8315, Best time: 30.0000
best val accuracy 0.856618 with test accuracy 0.831472 at epoch 11 and best time 30.000000