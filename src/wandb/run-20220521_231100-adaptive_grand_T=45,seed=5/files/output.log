/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 2.941760, Loss 1.948297, forward nfe 98, backward nfe 0, Train: 0.5500, Val: 0.5250, Test: 0.4975, Best time: 2.3370
Epoch: 002/100, Runtime 2.888147, Loss 1.964996, forward nfe 462, backward nfe 0, Train: 0.5500, Val: 0.5250, Test: 0.4975, Best time: 45.0000
Epoch: 003/100, Runtime 2.795170, Loss 1.932839, forward nfe 808, backward nfe 0, Train: 0.5500, Val: 0.5250, Test: 0.4975, Best time: 45.0000
Epoch: 004/100, Runtime 2.752552, Loss 1.877327, forward nfe 1154, backward nfe 0, Train: 0.5500, Val: 0.5250, Test: 0.4975, Best time: 45.0000
Epoch: 005/100, Runtime 2.670301, Loss 1.759038, forward nfe 1494, backward nfe 0, Train: 0.6286, Val: 0.5750, Test: 0.5462, Best time: 5.4302
Epoch: 006/100, Runtime 2.565502, Loss 1.585790, forward nfe 1828, backward nfe 0, Train: 0.7571, Val: 0.6640, Test: 0.6426, Best time: 7.6910
Epoch: 007/100, Runtime 2.589968, Loss 1.386322, forward nfe 2138, backward nfe 0, Train: 0.8429, Val: 0.7368, Test: 0.7147, Best time: 23.9826
Epoch: 008/100, Runtime 2.303689, Loss 1.179199, forward nfe 2448, backward nfe 0, Train: 0.8571, Val: 0.7684, Test: 0.7442, Best time: 25.0522
Epoch: 009/100, Runtime 2.249827, Loss 0.936564, forward nfe 2752, backward nfe 0, Train: 0.8714, Val: 0.7824, Test: 0.7584, Best time: 84.7631
Epoch: 010/100, Runtime 2.292096, Loss 0.762052, forward nfe 3050, backward nfe 0, Train: 0.8857, Val: 0.8029, Test: 0.7868, Best time: 45.0000
Epoch: 011/100, Runtime 2.327219, Loss 0.578075, forward nfe 3348, backward nfe 0, Train: 0.8786, Val: 0.8118, Test: 0.8010, Best time: 107.1120
Epoch: 012/100, Runtime 2.464290, Loss 0.486419, forward nfe 3646, backward nfe 0, Train: 0.8786, Val: 0.8118, Test: 0.8010, Best time: 45.0000
Epoch: 013/100, Runtime 2.359656, Loss 0.419278, forward nfe 3944, backward nfe 0, Train: 0.8786, Val: 0.8118, Test: 0.8010, Best time: 45.0000
Epoch: 014/100, Runtime 2.176299, Loss 0.327592, forward nfe 4230, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8203, Best time: 137.0365
Epoch: 015/100, Runtime 2.091601, Loss 0.278576, forward nfe 4498, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 76.0844
Epoch: 016/100, Runtime 2.148264, Loss 0.253408, forward nfe 4754, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 017/100, Runtime 2.093427, Loss 0.273181, forward nfe 5010, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 018/100, Runtime 2.023768, Loss 0.240475, forward nfe 5260, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 019/100, Runtime 2.044166, Loss 0.231106, forward nfe 5516, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 020/100, Runtime 1.975538, Loss 0.194481, forward nfe 5766, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 021/100, Runtime 1.884470, Loss 0.194556, forward nfe 5998, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 022/100, Runtime 1.743604, Loss 0.232100, forward nfe 6224, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 023/100, Runtime 1.829375, Loss 0.226416, forward nfe 6438, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 024/100, Runtime 1.770413, Loss 0.206766, forward nfe 6664, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 025/100, Runtime 1.823986, Loss 0.182016, forward nfe 6884, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 026/100, Runtime 1.721137, Loss 0.180722, forward nfe 7098, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 027/100, Runtime 1.671169, Loss 0.203091, forward nfe 7306, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 028/100, Runtime 1.610716, Loss 0.180342, forward nfe 7502, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 029/100, Runtime 1.705583, Loss 0.149010, forward nfe 7698, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 030/100, Runtime 1.723905, Loss 0.163459, forward nfe 7900, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 031/100, Runtime 1.539027, Loss 0.167555, forward nfe 8090, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 032/100, Runtime 1.562910, Loss 0.171641, forward nfe 8274, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 033/100, Runtime 1.579177, Loss 0.161894, forward nfe 8458, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 034/100, Runtime 1.597980, Loss 0.102484, forward nfe 8642, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 035/100, Runtime 1.506991, Loss 0.128519, forward nfe 8826, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 036/100, Runtime 1.469900, Loss 0.114187, forward nfe 9004, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 037/100, Runtime 1.460939, Loss 0.146734, forward nfe 9176, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 038/100, Runtime 1.474451, Loss 0.115511, forward nfe 9348, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 039/100, Runtime 1.484609, Loss 0.095635, forward nfe 9520, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 040/100, Runtime 1.540291, Loss 0.132385, forward nfe 9692, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 041/100, Runtime 1.436022, Loss 0.105928, forward nfe 9870, backward nfe 0, Train: 0.9429, Val: 0.8375, Test: 0.8223, Best time: 45.0000
Epoch: 042/100, Runtime 1.388263, Loss 0.136876, forward nfe 10036, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 76.4705
Epoch: 043/100, Runtime 1.397145, Loss 0.131660, forward nfe 10202, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 044/100, Runtime 1.405816, Loss 0.129082, forward nfe 10368, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 045/100, Runtime 1.319937, Loss 0.117842, forward nfe 10528, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 046/100, Runtime 1.368180, Loss 0.092912, forward nfe 10688, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 047/100, Runtime 1.434783, Loss 0.101341, forward nfe 10848, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 048/100, Runtime 1.377084, Loss 0.056363, forward nfe 11014, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 049/100, Runtime 1.341425, Loss 0.071452, forward nfe 11180, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 050/100, Runtime 1.265374, Loss 0.075945, forward nfe 11334, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 051/100, Runtime 1.429791, Loss 0.093038, forward nfe 11488, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 052/100, Runtime 1.452766, Loss 0.049421, forward nfe 11654, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 053/100, Runtime 1.417516, Loss 0.084694, forward nfe 11820, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 054/100, Runtime 1.366496, Loss 0.052300, forward nfe 11986, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 055/100, Runtime 1.413615, Loss 0.052521, forward nfe 12152, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 056/100, Runtime 1.444246, Loss 0.078316, forward nfe 12318, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 057/100, Runtime 1.449490, Loss 0.052347, forward nfe 12484, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 058/100, Runtime 1.453945, Loss 0.045063, forward nfe 12650, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 059/100, Runtime 1.358860, Loss 0.089068, forward nfe 12816, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 060/100, Runtime 1.434610, Loss 0.101585, forward nfe 12982, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 061/100, Runtime 1.438953, Loss 0.094088, forward nfe 13148, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 062/100, Runtime 1.431987, Loss 0.067244, forward nfe 13314, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 063/100, Runtime 1.369630, Loss 0.059134, forward nfe 13480, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 064/100, Runtime 1.409858, Loss 0.094369, forward nfe 13646, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 065/100, Runtime 1.532168, Loss 0.064271, forward nfe 13812, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 066/100, Runtime 1.363779, Loss 0.062354, forward nfe 13978, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 067/100, Runtime 1.334893, Loss 0.073620, forward nfe 14144, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 068/100, Runtime 1.330911, Loss 0.084109, forward nfe 14310, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 069/100, Runtime 1.492162, Loss 0.051773, forward nfe 14482, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 070/100, Runtime 1.472831, Loss 0.040756, forward nfe 14654, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 071/100, Runtime 1.473677, Loss 0.054754, forward nfe 14826, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 072/100, Runtime 1.491524, Loss 0.040935, forward nfe 14998, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 073/100, Runtime 1.481163, Loss 0.027199, forward nfe 15170, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 074/100, Runtime 1.463016, Loss 0.036703, forward nfe 15342, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 075/100, Runtime 1.491315, Loss 0.051278, forward nfe 15514, backward nfe 0, Train: 0.9929, Val: 0.8382, Test: 0.8365, Best time: 45.0000
Epoch: 076/100, Runtime 1.472392, Loss 0.051703, forward nfe 15686, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 077/100, Runtime 1.485367, Loss 0.055955, forward nfe 15858, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 078/100, Runtime 1.497790, Loss 0.063428, forward nfe 16030, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 079/100, Runtime 1.479047, Loss 0.055070, forward nfe 16202, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 080/100, Runtime 1.470572, Loss 0.060193, forward nfe 16374, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 081/100, Runtime 1.456046, Loss 0.036183, forward nfe 16546, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 082/100, Runtime 1.481162, Loss 0.069741, forward nfe 16718, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 083/100, Runtime 1.479710, Loss 0.042979, forward nfe 16890, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 084/100, Runtime 1.511086, Loss 0.062289, forward nfe 17062, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 085/100, Runtime 1.498289, Loss 0.068086, forward nfe 17234, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 086/100, Runtime 1.512951, Loss 0.051986, forward nfe 17406, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 087/100, Runtime 1.499717, Loss 0.051797, forward nfe 17578, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 088/100, Runtime 1.476427, Loss 0.031385, forward nfe 17750, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 089/100, Runtime 1.482599, Loss 0.027299, forward nfe 17922, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 090/100, Runtime 1.451990, Loss 0.039742, forward nfe 18094, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 091/100, Runtime 1.484821, Loss 0.036360, forward nfe 18266, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 092/100, Runtime 1.433697, Loss 0.053633, forward nfe 18438, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 093/100, Runtime 1.417010, Loss 0.029659, forward nfe 18604, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 094/100, Runtime 1.566168, Loss 0.033202, forward nfe 18770, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 095/100, Runtime 1.870829, Loss 0.030531, forward nfe 18936, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 096/100, Runtime 1.938615, Loss 0.034645, forward nfe 19102, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 097/100, Runtime 2.068642, Loss 0.039908, forward nfe 19274, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 098/100, Runtime 2.074772, Loss 0.056821, forward nfe 19452, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
Epoch: 099/100, Runtime 2.083227, Loss 0.081656, forward nfe 19630, backward nfe 0, Train: 0.9929, Val: 0.8390, Test: 0.8406, Best time: 45.0000
best val accuracy 0.838971 with test accuracy 0.840609 at epoch 76 and best time 45.000000