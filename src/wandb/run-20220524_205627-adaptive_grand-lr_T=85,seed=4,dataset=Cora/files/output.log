/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 6.643029, Loss 1.949870, forward nfe 164, backward nfe 0, Train: 0.3429, Val: 0.3397, Test: 0.3675, Best time: 0.0935
Epoch: 002/100, Runtime 6.393587, Loss 2.004991, forward nfe 798, backward nfe 0, Train: 0.3429, Val: 0.3397, Test: 0.3675, Best time: 85.0000
Epoch: 003/100, Runtime 6.447937, Loss 1.958408, forward nfe 1414, backward nfe 0, Train: 0.3429, Val: 0.3397, Test: 0.3675, Best time: 85.0000
Epoch: 004/100, Runtime 6.415267, Loss 1.928732, forward nfe 2024, backward nfe 0, Train: 0.4000, Val: 0.3441, Test: 0.3716, Best time: 0.9257
Epoch: 005/100, Runtime 6.049612, Loss 1.899320, forward nfe 2622, backward nfe 0, Train: 0.5643, Val: 0.4831, Test: 0.5147, Best time: 37.9370
Epoch: 006/100, Runtime 5.978807, Loss 1.842369, forward nfe 3202, backward nfe 0, Train: 0.5643, Val: 0.4831, Test: 0.5147, Best time: 85.0000
Epoch: 007/100, Runtime 5.701659, Loss 1.752793, forward nfe 3776, backward nfe 0, Train: 0.6000, Val: 0.5338, Test: 0.5503, Best time: 2.3285
Epoch: 008/100, Runtime 5.639385, Loss 1.652499, forward nfe 4326, backward nfe 0, Train: 0.6786, Val: 0.6213, Test: 0.6426, Best time: 3.9659
Epoch: 009/100, Runtime 5.526115, Loss 1.509574, forward nfe 4864, backward nfe 0, Train: 0.6929, Val: 0.6912, Test: 0.6914, Best time: 2.4919
Epoch: 010/100, Runtime 5.469359, Loss 1.393667, forward nfe 5390, backward nfe 0, Train: 0.7643, Val: 0.7287, Test: 0.7655, Best time: 8.6885
Epoch: 011/100, Runtime 5.308527, Loss 1.191419, forward nfe 5904, backward nfe 0, Train: 0.7857, Val: 0.7676, Test: 0.8020, Best time: 154.8190
Epoch: 012/100, Runtime 5.400145, Loss 1.039098, forward nfe 6418, backward nfe 0, Train: 0.8071, Val: 0.7801, Test: 0.8102, Best time: 176.5849
Epoch: 013/100, Runtime 5.114636, Loss 0.941390, forward nfe 6926, backward nfe 0, Train: 0.8071, Val: 0.7801, Test: 0.8102, Best time: 85.0000
Epoch: 014/100, Runtime 4.926714, Loss 0.833042, forward nfe 7416, backward nfe 0, Train: 0.8071, Val: 0.7801, Test: 0.8102, Best time: 85.0000
Epoch: 015/100, Runtime 4.683403, Loss 0.784529, forward nfe 7894, backward nfe 0, Train: 0.8071, Val: 0.7801, Test: 0.8102, Best time: 85.0000
Epoch: 016/100, Runtime 4.656284, Loss 0.693875, forward nfe 8348, backward nfe 0, Train: 0.8571, Val: 0.7846, Test: 0.8112, Best time: 20.6871
Epoch: 017/100, Runtime 4.823929, Loss 0.654442, forward nfe 8796, backward nfe 0, Train: 0.8571, Val: 0.7846, Test: 0.8112, Best time: 85.0000
Epoch: 018/100, Runtime 4.537060, Loss 0.635540, forward nfe 9232, backward nfe 0, Train: 0.8643, Val: 0.7890, Test: 0.8081, Best time: 23.2383
Epoch: 019/100, Runtime 4.486171, Loss 0.568236, forward nfe 9668, backward nfe 0, Train: 0.8643, Val: 0.7941, Test: 0.8183, Best time: 18.0983
Epoch: 020/100, Runtime 4.315643, Loss 0.613826, forward nfe 10092, backward nfe 0, Train: 0.8643, Val: 0.7941, Test: 0.8183, Best time: 85.0000
Epoch: 021/100, Runtime 4.283486, Loss 0.577361, forward nfe 10504, backward nfe 0, Train: 0.8643, Val: 0.7941, Test: 0.8183, Best time: 85.0000
Epoch: 022/100, Runtime 4.095611, Loss 0.546354, forward nfe 10904, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 102.2628
Epoch: 023/100, Runtime 3.939384, Loss 0.463747, forward nfe 11286, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 024/100, Runtime 3.818492, Loss 0.526636, forward nfe 11656, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 025/100, Runtime 3.749211, Loss 0.438653, forward nfe 12020, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 026/100, Runtime 3.724318, Loss 0.518730, forward nfe 12384, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 027/100, Runtime 3.652580, Loss 0.427108, forward nfe 12736, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 028/100, Runtime 3.530604, Loss 0.482077, forward nfe 13076, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 029/100, Runtime 3.504490, Loss 0.361899, forward nfe 13404, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 030/100, Runtime 3.474815, Loss 0.452996, forward nfe 13732, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 031/100, Runtime 3.307021, Loss 0.381903, forward nfe 14060, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 032/100, Runtime 3.302152, Loss 0.358612, forward nfe 14376, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 033/100, Runtime 3.043583, Loss 0.384434, forward nfe 14692, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 034/100, Runtime 3.290702, Loss 0.381223, forward nfe 14996, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 035/100, Runtime 3.130202, Loss 0.306020, forward nfe 15294, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 036/100, Runtime 3.148342, Loss 0.390689, forward nfe 15586, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 037/100, Runtime 2.916662, Loss 0.289803, forward nfe 15872, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 038/100, Runtime 2.816530, Loss 0.287932, forward nfe 16152, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 039/100, Runtime 2.753878, Loss 0.300162, forward nfe 16426, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 040/100, Runtime 2.741350, Loss 0.255459, forward nfe 16700, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 041/100, Runtime 2.815240, Loss 0.255495, forward nfe 16968, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 042/100, Runtime 2.800163, Loss 0.246673, forward nfe 17236, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 043/100, Runtime 2.730445, Loss 0.214080, forward nfe 17510, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 044/100, Runtime 2.726119, Loss 0.242830, forward nfe 17772, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 045/100, Runtime 2.664807, Loss 0.166125, forward nfe 18028, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 046/100, Runtime 2.604403, Loss 0.148246, forward nfe 18284, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 047/100, Runtime 2.727485, Loss 0.153701, forward nfe 18528, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 048/100, Runtime 2.695142, Loss 0.146154, forward nfe 18784, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 049/100, Runtime 3.143219, Loss 0.143957, forward nfe 19046, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 050/100, Runtime 3.632740, Loss 0.146096, forward nfe 19308, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 051/100, Runtime 3.465191, Loss 0.148211, forward nfe 19570, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 052/100, Runtime 3.444957, Loss 0.145774, forward nfe 19820, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 053/100, Runtime 3.556257, Loss 0.119742, forward nfe 20070, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 054/100, Runtime 3.548612, Loss 0.152022, forward nfe 20326, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 055/100, Runtime 3.619622, Loss 0.122174, forward nfe 20582, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 056/100, Runtime 3.534286, Loss 0.096475, forward nfe 20838, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 057/100, Runtime 3.513710, Loss 0.126243, forward nfe 21094, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 058/100, Runtime 3.453481, Loss 0.061595, forward nfe 21350, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 059/100, Runtime 3.552422, Loss 0.095084, forward nfe 21600, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 060/100, Runtime 3.393360, Loss 0.049391, forward nfe 21850, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 061/100, Runtime 3.507253, Loss 0.115438, forward nfe 22100, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 062/100, Runtime 2.519943, Loss 0.068295, forward nfe 22350, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 063/100, Runtime 2.600520, Loss 0.095172, forward nfe 22600, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 064/100, Runtime 2.616855, Loss 0.078513, forward nfe 22850, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 065/100, Runtime 2.765678, Loss 0.102038, forward nfe 23100, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 066/100, Runtime 2.502689, Loss 0.166655, forward nfe 23350, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 067/100, Runtime 2.792164, Loss 0.066382, forward nfe 23600, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 068/100, Runtime 2.722725, Loss 0.071838, forward nfe 23850, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 069/100, Runtime 2.528914, Loss 0.120962, forward nfe 24100, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 070/100, Runtime 2.518621, Loss 0.100964, forward nfe 24338, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 071/100, Runtime 2.567561, Loss 0.068911, forward nfe 24576, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 072/100, Runtime 2.676004, Loss 0.074807, forward nfe 24814, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 073/100, Runtime 2.413636, Loss 0.081118, forward nfe 25052, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 074/100, Runtime 2.598304, Loss 0.074612, forward nfe 25290, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 075/100, Runtime 2.650843, Loss 0.075533, forward nfe 25528, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 076/100, Runtime 2.855251, Loss 0.064463, forward nfe 25772, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 077/100, Runtime 2.716109, Loss 0.068756, forward nfe 26022, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 078/100, Runtime 2.519325, Loss 0.059849, forward nfe 26272, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 079/100, Runtime 2.760833, Loss 0.123872, forward nfe 26510, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 080/100, Runtime 2.787028, Loss 0.070915, forward nfe 26760, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 081/100, Runtime 2.697979, Loss 0.044459, forward nfe 27010, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 082/100, Runtime 2.585186, Loss 0.087608, forward nfe 27260, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 083/100, Runtime 2.773097, Loss 0.051051, forward nfe 27510, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 084/100, Runtime 2.767946, Loss 0.052383, forward nfe 27760, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 085/100, Runtime 2.635838, Loss 0.063524, forward nfe 28010, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 086/100, Runtime 2.815510, Loss 0.079873, forward nfe 28260, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 087/100, Runtime 2.703962, Loss 0.063439, forward nfe 28516, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 088/100, Runtime 2.679065, Loss 0.074441, forward nfe 28760, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 089/100, Runtime 2.660298, Loss 0.054296, forward nfe 29004, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 090/100, Runtime 2.597591, Loss 0.065373, forward nfe 29254, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 091/100, Runtime 2.514138, Loss 0.056264, forward nfe 29492, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 092/100, Runtime 2.701629, Loss 0.064528, forward nfe 29730, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 093/100, Runtime 2.646433, Loss 0.036885, forward nfe 29974, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 094/100, Runtime 2.631238, Loss 0.063374, forward nfe 30218, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 095/100, Runtime 2.753104, Loss 0.048704, forward nfe 30462, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 096/100, Runtime 2.575240, Loss 0.084608, forward nfe 30706, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 097/100, Runtime 2.801756, Loss 0.043263, forward nfe 30950, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 098/100, Runtime 2.702799, Loss 0.083588, forward nfe 31200, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
Epoch: 099/100, Runtime 2.520894, Loss 0.050002, forward nfe 31444, backward nfe 0, Train: 0.8714, Val: 0.8257, Test: 0.8426, Best time: 85.0000
best val accuracy 0.825735 with test accuracy 0.842640 at epoch 22 and best time 85.000000