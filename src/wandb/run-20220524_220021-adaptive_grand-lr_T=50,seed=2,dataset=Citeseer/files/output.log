/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.634667, Loss 1.795853, forward nfe 158, backward nfe 0, Train: 0.2667, Val: 0.3254, Test: 0.3129, Best time: 0.0408
Epoch: 002/100, Runtime 0.563446, Loss 1.785138, forward nfe 642, backward nfe 0, Train: 0.4250, Val: 0.4514, Test: 0.4532, Best time: 0.0393
Epoch: 003/100, Runtime 0.570218, Loss 1.763082, forward nfe 1138, backward nfe 0, Train: 0.5333, Val: 0.5254, Test: 0.5532, Best time: 1.4340
Epoch: 004/100, Runtime 0.552827, Loss 1.718252, forward nfe 1628, backward nfe 0, Train: 0.5833, Val: 0.5986, Test: 0.6048, Best time: 98.6577
Epoch: 005/100, Runtime 0.553293, Loss 1.712041, forward nfe 2112, backward nfe 0, Train: 0.5667, Val: 0.6014, Test: 0.6129, Best time: 50.0000
Epoch: 006/100, Runtime 0.540158, Loss 1.657502, forward nfe 2596, backward nfe 0, Train: 0.5917, Val: 0.6391, Test: 0.6468, Best time: 83.6078
Epoch: 007/100, Runtime 0.511059, Loss 1.657202, forward nfe 3062, backward nfe 0, Train: 0.6417, Val: 0.6862, Test: 0.6984, Best time: 62.3418
Epoch: 008/100, Runtime 0.540120, Loss 1.622393, forward nfe 3528, backward nfe 0, Train: 0.6583, Val: 0.7355, Test: 0.7177, Best time: 27.8658
Epoch: 009/100, Runtime 0.534544, Loss 1.577133, forward nfe 3994, backward nfe 0, Train: 0.6667, Val: 0.7399, Test: 0.7113, Best time: 15.2317
Epoch: 010/100, Runtime 0.528080, Loss 1.580424, forward nfe 4448, backward nfe 0, Train: 0.6667, Val: 0.7399, Test: 0.7113, Best time: 50.0000
Epoch: 011/100, Runtime 0.501181, Loss 1.587627, forward nfe 4890, backward nfe 0, Train: 0.6667, Val: 0.7399, Test: 0.7113, Best time: 50.0000
Epoch: 012/100, Runtime 0.491393, Loss 1.542421, forward nfe 5332, backward nfe 0, Train: 0.6583, Val: 0.7435, Test: 0.6887, Best time: 23.8921
Epoch: 013/100, Runtime 0.489728, Loss 1.528822, forward nfe 5774, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 20.7504
Epoch: 014/100, Runtime 0.494745, Loss 1.453529, forward nfe 6198, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 015/100, Runtime 0.481775, Loss 1.434587, forward nfe 6616, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 016/100, Runtime 0.489068, Loss 1.410050, forward nfe 7034, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 017/100, Runtime 0.493232, Loss 1.324627, forward nfe 7458, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 018/100, Runtime 0.383336, Loss 1.324297, forward nfe 7882, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 019/100, Runtime 0.372953, Loss 1.307368, forward nfe 8288, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 020/100, Runtime 0.371379, Loss 1.274282, forward nfe 8682, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 021/100, Runtime 0.382360, Loss 1.236863, forward nfe 9070, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 022/100, Runtime 0.359767, Loss 1.282920, forward nfe 9458, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 023/100, Runtime 0.349899, Loss 1.218707, forward nfe 9846, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 024/100, Runtime 0.348567, Loss 1.130684, forward nfe 10234, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 025/100, Runtime 0.351618, Loss 1.090541, forward nfe 10604, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 026/100, Runtime 0.333473, Loss 1.212479, forward nfe 10974, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 027/100, Runtime 0.348061, Loss 1.167005, forward nfe 11338, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 028/100, Runtime 0.408648, Loss 1.195714, forward nfe 11696, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 029/100, Runtime 0.357131, Loss 1.285695, forward nfe 12036, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 030/100, Runtime 0.314073, Loss 1.176041, forward nfe 12376, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 031/100, Runtime 0.328294, Loss 1.137572, forward nfe 12710, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 032/100, Runtime 0.332044, Loss 1.108660, forward nfe 13044, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 033/100, Runtime 0.378812, Loss 1.175920, forward nfe 13378, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 034/100, Runtime 0.393747, Loss 1.057261, forward nfe 13706, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 035/100, Runtime 0.388734, Loss 1.066952, forward nfe 14022, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 036/100, Runtime 0.384137, Loss 1.127474, forward nfe 14344, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 037/100, Runtime 0.381451, Loss 1.168458, forward nfe 14654, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 038/100, Runtime 0.385250, Loss 1.086602, forward nfe 14970, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 039/100, Runtime 0.369150, Loss 1.210996, forward nfe 15280, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 040/100, Runtime 0.360782, Loss 1.107640, forward nfe 15590, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 041/100, Runtime 0.370305, Loss 1.077915, forward nfe 15894, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 042/100, Runtime 0.372130, Loss 1.145432, forward nfe 16198, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 043/100, Runtime 0.378574, Loss 1.045433, forward nfe 16490, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 044/100, Runtime 0.353702, Loss 1.121046, forward nfe 16788, backward nfe 0, Train: 0.6667, Val: 0.7486, Test: 0.7048, Best time: 50.0000
Epoch: 045/100, Runtime 0.356096, Loss 1.139858, forward nfe 17080, backward nfe 0, Train: 0.7833, Val: 0.7580, Test: 0.7290, Best time: 59.0491
Epoch: 046/100, Runtime 0.337261, Loss 1.093220, forward nfe 17372, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 52.2505
Epoch: 047/100, Runtime 0.353938, Loss 1.154456, forward nfe 17652, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 048/100, Runtime 0.336612, Loss 1.117234, forward nfe 17938, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 049/100, Runtime 0.331653, Loss 1.107126, forward nfe 18212, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 050/100, Runtime 0.335609, Loss 1.200421, forward nfe 18480, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 051/100, Runtime 0.337200, Loss 1.213073, forward nfe 18754, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 052/100, Runtime 0.325902, Loss 1.094959, forward nfe 19028, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 053/100, Runtime 0.308731, Loss 1.247883, forward nfe 19296, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 054/100, Runtime 0.319645, Loss 1.198358, forward nfe 19558, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 055/100, Runtime 0.311461, Loss 1.102092, forward nfe 19820, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 056/100, Runtime 0.324752, Loss 1.235080, forward nfe 20082, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 057/100, Runtime 0.313140, Loss 1.060681, forward nfe 20344, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 058/100, Runtime 0.319698, Loss 1.152741, forward nfe 20606, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 059/100, Runtime 0.331347, Loss 1.113507, forward nfe 20868, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 060/100, Runtime 0.327927, Loss 1.179083, forward nfe 21130, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 061/100, Runtime 0.325118, Loss 1.172224, forward nfe 21392, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 062/100, Runtime 0.335631, Loss 1.087130, forward nfe 21654, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 063/100, Runtime 0.312495, Loss 1.158602, forward nfe 21916, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 064/100, Runtime 0.308786, Loss 1.202278, forward nfe 22178, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 065/100, Runtime 0.464275, Loss 1.124427, forward nfe 22440, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 066/100, Runtime 0.342754, Loss 1.137094, forward nfe 22708, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 067/100, Runtime 0.348128, Loss 1.105295, forward nfe 22976, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 068/100, Runtime 0.330280, Loss 1.059286, forward nfe 23244, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 069/100, Runtime 0.325320, Loss 1.195584, forward nfe 23512, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 070/100, Runtime 0.330026, Loss 1.045050, forward nfe 23780, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 071/100, Runtime 0.352418, Loss 1.048445, forward nfe 24048, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 072/100, Runtime 0.331740, Loss 1.077653, forward nfe 24316, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 073/100, Runtime 0.329600, Loss 1.112087, forward nfe 24584, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 074/100, Runtime 0.329509, Loss 1.250394, forward nfe 24852, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 075/100, Runtime 0.327574, Loss 1.125258, forward nfe 25120, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 076/100, Runtime 0.327378, Loss 1.111668, forward nfe 25388, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 077/100, Runtime 0.332365, Loss 1.286505, forward nfe 25656, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 078/100, Runtime 0.328285, Loss 1.083160, forward nfe 25924, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 079/100, Runtime 0.338582, Loss 1.166108, forward nfe 26192, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 080/100, Runtime 0.334303, Loss 1.053280, forward nfe 26460, backward nfe 0, Train: 0.7667, Val: 0.7623, Test: 0.7419, Best time: 50.0000
Epoch: 081/100, Runtime 0.326012, Loss 1.125730, forward nfe 26728, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 44.8464
Epoch: 082/100, Runtime 0.325670, Loss 1.209026, forward nfe 26990, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 083/100, Runtime 0.336088, Loss 1.051252, forward nfe 27252, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 084/100, Runtime 0.323057, Loss 1.180440, forward nfe 27514, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 085/100, Runtime 0.322155, Loss 1.145681, forward nfe 27776, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 086/100, Runtime 0.309713, Loss 1.173902, forward nfe 28038, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 087/100, Runtime 0.315790, Loss 1.073374, forward nfe 28294, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 088/100, Runtime 0.316670, Loss 1.089057, forward nfe 28550, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 089/100, Runtime 0.307792, Loss 1.006625, forward nfe 28806, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 090/100, Runtime 0.321991, Loss 1.098189, forward nfe 29062, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 091/100, Runtime 0.322948, Loss 1.094144, forward nfe 29318, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 092/100, Runtime 0.326509, Loss 1.187581, forward nfe 29574, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 093/100, Runtime 0.317815, Loss 1.149529, forward nfe 29830, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 094/100, Runtime 0.318696, Loss 1.119569, forward nfe 30086, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 095/100, Runtime 0.323980, Loss 1.002045, forward nfe 30342, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 096/100, Runtime 0.324151, Loss 1.198041, forward nfe 30598, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 097/100, Runtime 0.311877, Loss 1.064524, forward nfe 30854, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 098/100, Runtime 0.314412, Loss 1.084700, forward nfe 31110, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
Epoch: 099/100, Runtime 0.317063, Loss 1.137108, forward nfe 31366, backward nfe 0, Train: 0.7917, Val: 0.7681, Test: 0.7371, Best time: 50.0000
best val accuracy 0.768116 with test accuracy 0.737097 at epoch 81 and best time 50.000000