****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 1.375805, Loss 1.948985, forward nfe 98, backward nfe 0, Train: 0.1143, Val: 0.2860, Test: 0.2721, Best time: 136.9322
Epoch: 002/100, Runtime 1.314007, Loss 1.965607, forward nfe 462, backward nfe 0, Train: 0.3286, Val: 0.2875, Test: 0.3107, Best time: 9.4446
Epoch: 003/100, Runtime 1.334218, Loss 1.931947, forward nfe 814, backward nfe 0, Train: 0.3286, Val: 0.2875, Test: 0.3107, Best time: 45.0000
Epoch: 004/100, Runtime 1.273127, Loss 1.865858, forward nfe 1160, backward nfe 0, Train: 0.3286, Val: 0.2875, Test: 0.3107, Best time: 45.0000
Epoch: 005/100, Runtime 1.263381, Loss 1.757181, forward nfe 1500, backward nfe 0, Train: 0.5929, Val: 0.4551, Test: 0.4690, Best time: 3.7621
Epoch: 006/100, Runtime 1.150758, Loss 1.630260, forward nfe 1834, backward nfe 0, Train: 0.7714, Val: 0.7397, Test: 0.7330, Best time: 13.6937
Epoch: 007/100, Runtime 1.143477, Loss 1.430188, forward nfe 2144, backward nfe 0, Train: 0.8143, Val: 0.7956, Test: 0.8051, Best time: 32.1426
Epoch: 008/100, Runtime 1.215591, Loss 1.248946, forward nfe 2460, backward nfe 0, Train: 0.8500, Val: 0.8191, Test: 0.8234, Best time: 8.3942
Epoch: 009/100, Runtime 1.121489, Loss 1.046836, forward nfe 2770, backward nfe 0, Train: 0.8714, Val: 0.8265, Test: 0.8294, Best time: 20.3239
Epoch: 010/100, Runtime 1.122599, Loss 0.895714, forward nfe 3080, backward nfe 0, Train: 0.8786, Val: 0.8331, Test: 0.8315, Best time: 8.9841
Epoch: 011/100, Runtime 1.090452, Loss 0.691450, forward nfe 3384, backward nfe 0, Train: 0.8786, Val: 0.8331, Test: 0.8315, Best time: 45.0000
Epoch: 012/100, Runtime 1.183538, Loss 0.585591, forward nfe 3682, backward nfe 0, Train: 0.8786, Val: 0.8331, Test: 0.8315, Best time: 45.0000
Epoch: 013/100, Runtime 1.068699, Loss 0.536521, forward nfe 3980, backward nfe 0, Train: 0.8786, Val: 0.8331, Test: 0.8315, Best time: 45.0000
Epoch: 014/100, Runtime 0.981732, Loss 0.427319, forward nfe 4260, backward nfe 0, Train: 0.9214, Val: 0.8360, Test: 0.8162, Best time: 25.4691
Epoch: 015/100, Runtime 0.991978, Loss 0.447367, forward nfe 4528, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 36.1227
Epoch: 016/100, Runtime 1.023417, Loss 0.368950, forward nfe 4790, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 017/100, Runtime 1.028148, Loss 0.341029, forward nfe 5052, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 018/100, Runtime 0.899231, Loss 0.429082, forward nfe 5302, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 019/100, Runtime 0.965853, Loss 0.430242, forward nfe 5558, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 020/100, Runtime 0.869898, Loss 0.345792, forward nfe 5802, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 021/100, Runtime 0.847663, Loss 0.309862, forward nfe 6040, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 022/100, Runtime 0.953594, Loss 0.299572, forward nfe 6260, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 023/100, Runtime 0.827982, Loss 0.260140, forward nfe 6492, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 024/100, Runtime 0.822261, Loss 0.288294, forward nfe 6724, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 025/100, Runtime 0.828602, Loss 0.237330, forward nfe 6950, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 026/100, Runtime 0.799720, Loss 0.227557, forward nfe 7158, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 027/100, Runtime 0.781685, Loss 0.328304, forward nfe 7360, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 028/100, Runtime 0.803166, Loss 0.246343, forward nfe 7556, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 029/100, Runtime 0.777838, Loss 0.243215, forward nfe 7758, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 030/100, Runtime 0.780439, Loss 0.211905, forward nfe 7960, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 031/100, Runtime 0.741090, Loss 0.209425, forward nfe 8150, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 032/100, Runtime 0.657455, Loss 0.183021, forward nfe 8340, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 033/100, Runtime 0.733190, Loss 0.189840, forward nfe 8518, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 034/100, Runtime 0.733754, Loss 0.217905, forward nfe 8696, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 035/100, Runtime 0.657221, Loss 0.223513, forward nfe 8874, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 036/100, Runtime 0.738068, Loss 0.191811, forward nfe 9052, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 037/100, Runtime 0.745593, Loss 0.178771, forward nfe 9236, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 038/100, Runtime 0.750254, Loss 0.137170, forward nfe 9420, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 039/100, Runtime 0.678583, Loss 0.199383, forward nfe 9604, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 040/100, Runtime 0.732126, Loss 0.152862, forward nfe 9788, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 041/100, Runtime 0.724012, Loss 0.126599, forward nfe 9966, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 042/100, Runtime 0.662764, Loss 0.137780, forward nfe 10144, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 043/100, Runtime 0.727245, Loss 0.145690, forward nfe 10322, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 044/100, Runtime 0.610542, Loss 0.135208, forward nfe 10494, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 045/100, Runtime 0.725194, Loss 0.104979, forward nfe 10666, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 046/100, Runtime 0.609863, Loss 0.148036, forward nfe 10838, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 047/100, Runtime 0.730319, Loss 0.139248, forward nfe 11010, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 048/100, Runtime 0.629529, Loss 0.130713, forward nfe 11182, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 049/100, Runtime 0.710254, Loss 0.124715, forward nfe 11354, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 050/100, Runtime 0.640531, Loss 0.129775, forward nfe 11526, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 051/100, Runtime 0.704663, Loss 0.112972, forward nfe 11698, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8376, Best time: 45.0000
Epoch: 052/100, Runtime 0.655179, Loss 0.146927, forward nfe 11870, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 64.4264
Epoch: 053/100, Runtime 0.677487, Loss 0.169954, forward nfe 12042, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 054/100, Runtime 0.579498, Loss 0.090010, forward nfe 12214, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 055/100, Runtime 0.587196, Loss 0.153754, forward nfe 12374, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 056/100, Runtime 0.684186, Loss 0.115248, forward nfe 12534, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 057/100, Runtime 0.587080, Loss 0.104752, forward nfe 12694, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 058/100, Runtime 0.600254, Loss 0.114443, forward nfe 12854, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 059/100, Runtime 0.676015, Loss 0.101705, forward nfe 13014, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 060/100, Runtime 0.596230, Loss 0.082847, forward nfe 13174, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 061/100, Runtime 0.624863, Loss 0.122035, forward nfe 13334, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 062/100, Runtime 0.660251, Loss 0.097755, forward nfe 13494, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 063/100, Runtime 0.610694, Loss 0.115692, forward nfe 13654, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 064/100, Runtime 0.662390, Loss 0.088731, forward nfe 13814, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 065/100, Runtime 0.615779, Loss 0.078092, forward nfe 13974, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 066/100, Runtime 0.578004, Loss 0.088934, forward nfe 14134, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 067/100, Runtime 0.583664, Loss 0.062824, forward nfe 14294, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 068/100, Runtime 0.690099, Loss 0.084472, forward nfe 14454, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 069/100, Runtime 0.595882, Loss 0.076141, forward nfe 14614, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 070/100, Runtime 0.679847, Loss 0.085494, forward nfe 14774, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 071/100, Runtime 0.611380, Loss 0.118704, forward nfe 14934, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 072/100, Runtime 0.579592, Loss 0.078196, forward nfe 15094, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 073/100, Runtime 0.682929, Loss 0.078074, forward nfe 15254, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 074/100, Runtime 0.626605, Loss 0.118857, forward nfe 15420, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 075/100, Runtime 0.599876, Loss 0.105435, forward nfe 15586, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 076/100, Runtime 0.705766, Loss 0.104934, forward nfe 15752, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 077/100, Runtime 0.591973, Loss 0.043594, forward nfe 15918, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 078/100, Runtime 0.590605, Loss 0.048017, forward nfe 16084, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 079/100, Runtime 0.719992, Loss 0.138637, forward nfe 16250, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 080/100, Runtime 0.601368, Loss 0.059648, forward nfe 16416, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 081/100, Runtime 0.722737, Loss 0.089308, forward nfe 16582, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 082/100, Runtime 0.597141, Loss 0.041770, forward nfe 16748, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 083/100, Runtime 0.724772, Loss 0.099415, forward nfe 16914, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 084/100, Runtime 0.598001, Loss 0.075044, forward nfe 17080, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 085/100, Runtime 0.698013, Loss 0.084078, forward nfe 17246, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 086/100, Runtime 0.591555, Loss 0.077004, forward nfe 17412, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 087/100, Runtime 0.596475, Loss 0.139300, forward nfe 17572, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 088/100, Runtime 0.692380, Loss 0.138036, forward nfe 17732, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 089/100, Runtime 0.590364, Loss 0.035492, forward nfe 17892, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 090/100, Runtime 0.596559, Loss 0.031414, forward nfe 18052, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 091/100, Runtime 0.722195, Loss 0.111872, forward nfe 18212, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 092/100, Runtime 0.678392, Loss 0.121127, forward nfe 18384, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 093/100, Runtime 0.710986, Loss 0.121252, forward nfe 18562, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 094/100, Runtime 0.747434, Loss 0.055564, forward nfe 18746, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 095/100, Runtime 0.753513, Loss 0.085421, forward nfe 18930, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 096/100, Runtime 0.746876, Loss 0.045596, forward nfe 19114, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 097/100, Runtime 0.775812, Loss 0.034404, forward nfe 19304, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 098/100, Runtime 0.710793, Loss 0.050532, forward nfe 19500, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
Epoch: 099/100, Runtime 0.768313, Loss 0.087054, forward nfe 19696, backward nfe 0, Train: 0.9929, Val: 0.8397, Test: 0.8193, Best time: 45.0000
best val accuracy 0.839706 with test accuracy 0.819289 at epoch 52 and best time 45.000000