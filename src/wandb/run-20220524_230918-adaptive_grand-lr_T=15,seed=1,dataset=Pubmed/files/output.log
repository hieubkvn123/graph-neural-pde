/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
Epoch: 001/100, Runtime 1.366828, Loss 1.100030, forward nfe 44, backward nfe 91, Train: 0.6167, Val: 0.5597, Test: 0.5504, Best time: 0.2358
Epoch: 002/100, Runtime 0.896015, Loss 1.091008, forward nfe 234, backward nfe 131, Train: 0.6167, Val: 0.5597, Test: 0.5504, Best time: 15.0000
Epoch: 003/100, Runtime 1.347283, Loss 1.078797, forward nfe 424, backward nfe 222, Train: 0.6167, Val: 0.5597, Test: 0.5504, Best time: 15.0000
Epoch: 004/100, Runtime 1.168804, Loss 1.059659, forward nfe 608, backward nfe 292, Train: 0.7333, Val: 0.5764, Test: 0.5854, Best time: 0.2284
Epoch: 005/100, Runtime 0.933882, Loss 1.029883, forward nfe 798, backward nfe 338, Train: 0.8167, Val: 0.6292, Test: 0.6393, Best time: 0.2222
Epoch: 006/100, Runtime 0.947741, Loss 1.002231, forward nfe 988, backward nfe 385, Train: 0.8667, Val: 0.6694, Test: 0.6704, Best time: 5.6801
Epoch: 007/100, Runtime 1.034089, Loss 0.963047, forward nfe 1172, backward nfe 445, Train: 0.8667, Val: 0.6778, Test: 0.6827, Best time: 5.6398
Epoch: 008/100, Runtime 0.989575, Loss 0.918446, forward nfe 1350, backward nfe 500, Train: 0.8833, Val: 0.6931, Test: 0.6923, Best time: 5.6176
Epoch: 009/100, Runtime 0.955646, Loss 0.859596, forward nfe 1528, backward nfe 552, Train: 0.9000, Val: 0.6958, Test: 0.7030, Best time: 2.2658
Epoch: 010/100, Runtime 0.886921, Loss 0.803727, forward nfe 1700, backward nfe 598, Train: 0.9000, Val: 0.7035, Test: 0.7083, Best time: 2.2308
Epoch: 011/100, Runtime 0.853423, Loss 0.749034, forward nfe 1866, backward nfe 642, Train: 0.8833, Val: 0.7181, Test: 0.7197, Best time: 32.0478
Epoch: 012/100, Runtime 0.765433, Loss 0.678300, forward nfe 2026, backward nfe 677, Train: 0.8833, Val: 0.7243, Test: 0.7240, Best time: 32.6085
Epoch: 013/100, Runtime 0.714832, Loss 0.627957, forward nfe 2186, backward nfe 705, Train: 0.9000, Val: 0.7368, Test: 0.7362, Best time: 48.7781
Epoch: 014/100, Runtime 0.705408, Loss 0.561108, forward nfe 2346, backward nfe 735, Train: 0.8833, Val: 0.7444, Test: 0.7444, Best time: 15.0000
Epoch: 015/100, Runtime 0.695271, Loss 0.509729, forward nfe 2500, backward nfe 764, Train: 0.8833, Val: 0.7569, Test: 0.7587, Best time: 56.0662
Epoch: 016/100, Runtime 0.701240, Loss 0.467088, forward nfe 2654, backward nfe 794, Train: 0.9000, Val: 0.7667, Test: 0.7697, Best time: 51.5550
Epoch: 017/100, Runtime 0.674711, Loss 0.448384, forward nfe 2802, backward nfe 824, Train: 0.9167, Val: 0.7771, Test: 0.7787, Best time: 41.8901
Epoch: 018/100, Runtime 0.660472, Loss 0.379680, forward nfe 2950, backward nfe 853, Train: 0.9333, Val: 0.7840, Test: 0.7843, Best time: 30.6139
Epoch: 019/100, Runtime 0.644589, Loss 0.345012, forward nfe 3092, backward nfe 880, Train: 0.9333, Val: 0.7875, Test: 0.7855, Best time: 36.9816
Epoch: 020/100, Runtime 0.622877, Loss 0.341857, forward nfe 3234, backward nfe 905, Train: 0.9333, Val: 0.7875, Test: 0.7855, Best time: 15.0000
Epoch: 021/100, Runtime 0.573287, Loss 0.300717, forward nfe 3376, backward nfe 923, Train: 0.9333, Val: 0.7889, Test: 0.7894, Best time: 57.1411
Epoch: 022/100, Runtime 0.575301, Loss 0.259410, forward nfe 3518, backward nfe 943, Train: 0.9500, Val: 0.7965, Test: 0.7963, Best time: 64.7013
Epoch: 023/100, Runtime 0.600669, Loss 0.275438, forward nfe 3654, backward nfe 964, Train: 0.9500, Val: 0.8007, Test: 0.7994, Best time: 58.8030
Epoch: 024/100, Runtime 0.564896, Loss 0.257015, forward nfe 3796, backward nfe 982, Train: 0.9667, Val: 0.8042, Test: 0.8016, Best time: 54.0259
Epoch: 025/100, Runtime 0.544922, Loss 0.249038, forward nfe 3938, backward nfe 998, Train: 0.9667, Val: 0.8042, Test: 0.8016, Best time: 15.0000
Epoch: 026/100, Runtime 0.550254, Loss 0.250147, forward nfe 4080, backward nfe 1018, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 56.3337
Epoch: 027/100, Runtime 0.542656, Loss 0.209225, forward nfe 4210, backward nfe 1038, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 028/100, Runtime 0.531842, Loss 0.207949, forward nfe 4340, backward nfe 1057, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 029/100, Runtime 0.543829, Loss 0.198941, forward nfe 4470, backward nfe 1076, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 030/100, Runtime 0.491348, Loss 0.160285, forward nfe 4600, backward nfe 1092, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 031/100, Runtime 0.485545, Loss 0.172660, forward nfe 4724, backward nfe 1106, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 032/100, Runtime 0.508047, Loss 0.170037, forward nfe 4848, backward nfe 1124, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 033/100, Runtime 0.491189, Loss 0.174260, forward nfe 4966, backward nfe 1141, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 034/100, Runtime 0.464577, Loss 0.116902, forward nfe 5084, backward nfe 1156, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 035/100, Runtime 0.454748, Loss 0.137153, forward nfe 5196, backward nfe 1173, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 036/100, Runtime 0.449044, Loss 0.192089, forward nfe 5302, backward nfe 1189, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 037/100, Runtime 0.444558, Loss 0.149271, forward nfe 5408, backward nfe 1204, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 038/100, Runtime 0.437213, Loss 0.120985, forward nfe 5514, backward nfe 1217, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 039/100, Runtime 0.440734, Loss 0.154336, forward nfe 5626, backward nfe 1231, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 040/100, Runtime 0.468936, Loss 0.147660, forward nfe 5738, backward nfe 1248, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 041/100, Runtime 0.414429, Loss 0.121445, forward nfe 5850, backward nfe 1263, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 042/100, Runtime 0.415345, Loss 0.156917, forward nfe 5950, backward nfe 1278, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 043/100, Runtime 0.421454, Loss 0.092510, forward nfe 6050, backward nfe 1292, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 044/100, Runtime 0.415359, Loss 0.154521, forward nfe 6150, backward nfe 1307, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 045/100, Runtime 0.432011, Loss 0.103341, forward nfe 6250, backward nfe 1321, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 046/100, Runtime 0.442108, Loss 0.136200, forward nfe 6356, backward nfe 1335, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 047/100, Runtime 0.403030, Loss 0.120193, forward nfe 6462, backward nfe 1348, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 048/100, Runtime 0.400427, Loss 0.102092, forward nfe 6562, backward nfe 1361, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 049/100, Runtime 0.446646, Loss 0.167623, forward nfe 6662, backward nfe 1378, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 050/100, Runtime 0.392558, Loss 0.092296, forward nfe 6762, backward nfe 1390, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 051/100, Runtime 0.422532, Loss 0.135319, forward nfe 6862, backward nfe 1404, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 052/100, Runtime 0.400960, Loss 0.120893, forward nfe 6962, backward nfe 1417, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 053/100, Runtime 0.390954, Loss 0.087113, forward nfe 7062, backward nfe 1429, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 054/100, Runtime 0.413640, Loss 0.142498, forward nfe 7162, backward nfe 1443, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 055/100, Runtime 0.405597, Loss 0.086055, forward nfe 7262, backward nfe 1456, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 056/100, Runtime 0.401717, Loss 0.061169, forward nfe 7362, backward nfe 1469, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 057/100, Runtime 0.420084, Loss 0.107345, forward nfe 7462, backward nfe 1483, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 058/100, Runtime 0.397008, Loss 0.080380, forward nfe 7562, backward nfe 1495, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 059/100, Runtime 0.397050, Loss 0.084194, forward nfe 7662, backward nfe 1508, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 060/100, Runtime 0.390374, Loss 0.097361, forward nfe 7762, backward nfe 1520, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 061/100, Runtime 0.394423, Loss 0.081852, forward nfe 7862, backward nfe 1532, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 062/100, Runtime 0.410059, Loss 0.086180, forward nfe 7962, backward nfe 1546, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 063/100, Runtime 0.361002, Loss 0.076735, forward nfe 8062, backward nfe 1558, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 064/100, Runtime 0.341374, Loss 0.082613, forward nfe 8150, backward nfe 1568, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 065/100, Runtime 0.352248, Loss 0.055669, forward nfe 8238, backward nfe 1579, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 066/100, Runtime 0.342612, Loss 0.074772, forward nfe 8326, backward nfe 1589, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 067/100, Runtime 0.358215, Loss 0.110593, forward nfe 8414, backward nfe 1601, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 068/100, Runtime 0.357910, Loss 0.112773, forward nfe 8502, backward nfe 1613, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 069/100, Runtime 0.355523, Loss 0.097637, forward nfe 8590, backward nfe 1625, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 070/100, Runtime 0.336428, Loss 0.102787, forward nfe 8678, backward nfe 1636, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 071/100, Runtime 0.334885, Loss 0.106970, forward nfe 8760, backward nfe 1647, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 072/100, Runtime 0.341124, Loss 0.052509, forward nfe 8842, backward nfe 1658, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 073/100, Runtime 0.353989, Loss 0.066076, forward nfe 8924, backward nfe 1670, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 074/100, Runtime 0.339614, Loss 0.078186, forward nfe 9006, backward nfe 1682, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 075/100, Runtime 0.324068, Loss 0.100148, forward nfe 9088, backward nfe 1692, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 076/100, Runtime 0.343924, Loss 0.067356, forward nfe 9170, backward nfe 1704, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 077/100, Runtime 0.338587, Loss 0.081566, forward nfe 9252, backward nfe 1716, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 078/100, Runtime 0.354075, Loss 0.078306, forward nfe 9334, backward nfe 1729, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 079/100, Runtime 0.339746, Loss 0.066106, forward nfe 9416, backward nfe 1740, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 080/100, Runtime 0.345614, Loss 0.051439, forward nfe 9498, backward nfe 1752, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 081/100, Runtime 0.328824, Loss 0.066716, forward nfe 9580, backward nfe 1762, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 082/100, Runtime 0.337362, Loss 0.108248, forward nfe 9662, backward nfe 1774, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 083/100, Runtime 0.331098, Loss 0.038411, forward nfe 9744, backward nfe 1785, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 084/100, Runtime 0.334717, Loss 0.034570, forward nfe 9826, backward nfe 1795, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 085/100, Runtime 0.337061, Loss 0.066273, forward nfe 9908, backward nfe 1806, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 086/100, Runtime 0.338305, Loss 0.093765, forward nfe 9990, backward nfe 1816, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 087/100, Runtime 0.324734, Loss 0.057475, forward nfe 10072, backward nfe 1826, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 088/100, Runtime 0.328899, Loss 0.074643, forward nfe 10154, backward nfe 1836, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 089/100, Runtime 0.343064, Loss 0.068477, forward nfe 10236, backward nfe 1848, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 090/100, Runtime 0.337111, Loss 0.075038, forward nfe 10318, backward nfe 1860, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 091/100, Runtime 0.329242, Loss 0.078909, forward nfe 10394, backward nfe 1872, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 092/100, Runtime 0.331991, Loss 0.084689, forward nfe 10470, backward nfe 1884, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 093/100, Runtime 0.323936, Loss 0.064792, forward nfe 10546, backward nfe 1895, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 094/100, Runtime 0.312891, Loss 0.073612, forward nfe 10622, backward nfe 1905, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 095/100, Runtime 0.318258, Loss 0.075278, forward nfe 10698, backward nfe 1916, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 096/100, Runtime 0.308412, Loss 0.059870, forward nfe 10774, backward nfe 1926, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 097/100, Runtime 0.313644, Loss 0.039313, forward nfe 10850, backward nfe 1936, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 098/100, Runtime 0.316517, Loss 0.076924, forward nfe 10926, backward nfe 1946, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
Epoch: 099/100, Runtime 0.332374, Loss 0.064174, forward nfe 11002, backward nfe 1957, Train: 0.9667, Val: 0.8056, Test: 0.8023, Best time: 15.0000
best val accuracy 0.805556 with test accuracy 0.802273 at epoch 26 and best time 15.000000