/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 3.135225, Loss 1.947430, forward nfe 56, backward nfe 0, Train: 0.8000, Val: 0.6301, Test: 0.6558, Best time: 18.4088
Epoch: 002/100, Runtime 3.221176, Loss 1.755586, forward nfe 288, backward nfe 0, Train: 0.8857, Val: 0.7169, Test: 0.7279, Best time: 5.3379
Epoch: 003/100, Runtime 3.140419, Loss 1.385307, forward nfe 514, backward nfe 0, Train: 0.9143, Val: 0.7632, Test: 0.7563, Best time: 5.2464
Epoch: 004/100, Runtime 2.976211, Loss 1.039957, forward nfe 728, backward nfe 0, Train: 0.9143, Val: 0.7816, Test: 0.7736, Best time: 12.5359
Epoch: 005/100, Runtime 2.956091, Loss 0.684446, forward nfe 942, backward nfe 0, Train: 0.9643, Val: 0.8059, Test: 0.7909, Best time: 9.7669
Epoch: 006/100, Runtime 3.024952, Loss 0.503677, forward nfe 1156, backward nfe 0, Train: 0.9714, Val: 0.8162, Test: 0.8091, Best time: 10.0617
Epoch: 007/100, Runtime 2.985133, Loss 0.360583, forward nfe 1364, backward nfe 0, Train: 0.9714, Val: 0.8324, Test: 0.8183, Best time: 17.8735
Epoch: 008/100, Runtime 2.794642, Loss 0.279380, forward nfe 1572, backward nfe 0, Train: 0.9714, Val: 0.8353, Test: 0.8274, Best time: 14.2580
Epoch: 009/100, Runtime 2.781527, Loss 0.194312, forward nfe 1768, backward nfe 0, Train: 0.9643, Val: 0.8382, Test: 0.8315, Best time: 25.9162
Epoch: 010/100, Runtime 2.782113, Loss 0.189814, forward nfe 1964, backward nfe 0, Train: 0.9786, Val: 0.8412, Test: 0.8325, Best time: 27.3511
Epoch: 011/100, Runtime 2.755001, Loss 0.182755, forward nfe 2154, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8447, Best time: 28.8921
Epoch: 012/100, Runtime 2.591480, Loss 0.162146, forward nfe 2344, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8447, Best time: 25.0000
Epoch: 013/100, Runtime 2.519377, Loss 0.158301, forward nfe 2528, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8447, Best time: 25.0000
Epoch: 014/100, Runtime 2.510486, Loss 0.178998, forward nfe 2712, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8447, Best time: 25.0000
Epoch: 015/100, Runtime 2.354518, Loss 0.155874, forward nfe 2884, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8447, Best time: 25.0000
Epoch: 016/100, Runtime 2.330459, Loss 0.192399, forward nfe 3050, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8447, Best time: 25.0000
Epoch: 017/100, Runtime 2.431000, Loss 0.215380, forward nfe 3216, backward nfe 0, Train: 0.9786, Val: 0.8463, Test: 0.8426, Best time: 45.4909
Epoch: 018/100, Runtime 2.041255, Loss 0.163583, forward nfe 3388, backward nfe 0, Train: 0.9786, Val: 0.8463, Test: 0.8426, Best time: 25.0000
Epoch: 019/100, Runtime 1.684757, Loss 0.173825, forward nfe 3560, backward nfe 0, Train: 0.9786, Val: 0.8463, Test: 0.8426, Best time: 25.0000
Epoch: 020/100, Runtime 1.660110, Loss 0.193039, forward nfe 3726, backward nfe 0, Train: 0.9786, Val: 0.8463, Test: 0.8426, Best time: 25.0000
Epoch: 021/100, Runtime 1.590859, Loss 0.194005, forward nfe 3892, backward nfe 0, Train: 0.9786, Val: 0.8463, Test: 0.8426, Best time: 25.0000
Epoch: 022/100, Runtime 1.540299, Loss 0.145685, forward nfe 4046, backward nfe 0, Train: 0.9786, Val: 0.8463, Test: 0.8426, Best time: 25.0000
Epoch: 023/100, Runtime 1.490359, Loss 0.159736, forward nfe 4200, backward nfe 0, Train: 0.9857, Val: 0.8537, Test: 0.8447, Best time: 45.6892
Epoch: 024/100, Runtime 1.537626, Loss 0.129314, forward nfe 4348, backward nfe 0, Train: 0.9857, Val: 0.8537, Test: 0.8447, Best time: 25.0000
Epoch: 025/100, Runtime 1.497534, Loss 0.144392, forward nfe 4496, backward nfe 0, Train: 0.9857, Val: 0.8537, Test: 0.8447, Best time: 25.0000
Epoch: 026/100, Runtime 1.513055, Loss 0.146041, forward nfe 4644, backward nfe 0, Train: 0.9857, Val: 0.8537, Test: 0.8447, Best time: 25.0000
Epoch: 027/100, Runtime 1.581936, Loss 0.133429, forward nfe 4792, backward nfe 0, Train: 0.9857, Val: 0.8537, Test: 0.8447, Best time: 25.0000
Epoch: 028/100, Runtime 1.590231, Loss 0.101310, forward nfe 4946, backward nfe 0, Train: 0.9857, Val: 0.8537, Test: 0.8447, Best time: 25.0000
Epoch: 029/100, Runtime 1.512800, Loss 0.079825, forward nfe 5100, backward nfe 0, Train: 0.9857, Val: 0.8537, Test: 0.8447, Best time: 25.0000
Epoch: 030/100, Runtime 1.527666, Loss 0.103150, forward nfe 5248, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 68.3993
Epoch: 031/100, Runtime 1.554990, Loss 0.095076, forward nfe 5396, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 032/100, Runtime 1.491383, Loss 0.122533, forward nfe 5544, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 033/100, Runtime 1.374429, Loss 0.109341, forward nfe 5686, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 034/100, Runtime 1.366106, Loss 0.084591, forward nfe 5822, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 035/100, Runtime 1.340794, Loss 0.091990, forward nfe 5958, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 036/100, Runtime 1.364261, Loss 0.115851, forward nfe 6094, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 037/100, Runtime 1.384633, Loss 0.128298, forward nfe 6230, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 038/100, Runtime 1.422382, Loss 0.095479, forward nfe 6360, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 039/100, Runtime 1.356757, Loss 0.098467, forward nfe 6490, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 040/100, Runtime 1.291978, Loss 0.076697, forward nfe 6620, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 041/100, Runtime 1.279230, Loss 0.081502, forward nfe 6750, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 042/100, Runtime 1.360016, Loss 0.084532, forward nfe 6880, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 043/100, Runtime 1.418302, Loss 0.054316, forward nfe 7010, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 044/100, Runtime 1.445664, Loss 0.104153, forward nfe 7146, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 045/100, Runtime 1.461257, Loss 0.075058, forward nfe 7282, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 046/100, Runtime 1.233906, Loss 0.081062, forward nfe 7418, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 047/100, Runtime 1.238319, Loss 0.083123, forward nfe 7542, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 048/100, Runtime 1.212951, Loss 0.071536, forward nfe 7660, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 049/100, Runtime 1.303114, Loss 0.060607, forward nfe 7778, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 050/100, Runtime 1.269996, Loss 0.068482, forward nfe 7896, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 051/100, Runtime 1.167473, Loss 0.060581, forward nfe 8014, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 052/100, Runtime 1.149409, Loss 0.066256, forward nfe 8132, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 053/100, Runtime 1.294791, Loss 0.084074, forward nfe 8250, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 054/100, Runtime 1.348545, Loss 0.068470, forward nfe 8368, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 055/100, Runtime 1.193137, Loss 0.064906, forward nfe 8486, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 056/100, Runtime 1.159080, Loss 0.057958, forward nfe 8604, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 057/100, Runtime 1.266250, Loss 0.049145, forward nfe 8722, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 058/100, Runtime 1.268812, Loss 0.066528, forward nfe 8840, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 059/100, Runtime 1.166003, Loss 0.065676, forward nfe 8958, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 060/100, Runtime 1.077091, Loss 0.082481, forward nfe 9070, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 061/100, Runtime 1.203131, Loss 0.043988, forward nfe 9182, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 062/100, Runtime 1.195192, Loss 0.074022, forward nfe 9294, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 063/100, Runtime 1.018380, Loss 0.062156, forward nfe 9400, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 064/100, Runtime 1.106170, Loss 0.066738, forward nfe 9506, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 065/100, Runtime 1.187386, Loss 0.050409, forward nfe 9612, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 066/100, Runtime 1.042583, Loss 0.061115, forward nfe 9718, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 067/100, Runtime 1.043693, Loss 0.041901, forward nfe 9824, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 068/100, Runtime 1.192290, Loss 0.033130, forward nfe 9930, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 069/100, Runtime 1.089328, Loss 0.061562, forward nfe 10036, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 070/100, Runtime 1.074688, Loss 0.062870, forward nfe 10142, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 071/100, Runtime 1.232888, Loss 0.040670, forward nfe 10254, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 072/100, Runtime 1.257640, Loss 0.085960, forward nfe 10366, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 073/100, Runtime 1.103284, Loss 0.069602, forward nfe 10478, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 074/100, Runtime 1.102782, Loss 0.054496, forward nfe 10590, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 075/100, Runtime 1.256225, Loss 0.074793, forward nfe 10702, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 076/100, Runtime 1.198901, Loss 0.062653, forward nfe 10814, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 077/100, Runtime 1.083112, Loss 0.051804, forward nfe 10926, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 078/100, Runtime 1.120214, Loss 0.032689, forward nfe 11038, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 079/100, Runtime 1.208855, Loss 0.045928, forward nfe 11144, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 080/100, Runtime 0.999966, Loss 0.063542, forward nfe 11250, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 081/100, Runtime 1.131140, Loss 0.057013, forward nfe 11356, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 082/100, Runtime 1.302589, Loss 0.066539, forward nfe 11468, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 083/100, Runtime 1.296622, Loss 0.050872, forward nfe 11586, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 084/100, Runtime 1.172051, Loss 0.125041, forward nfe 11704, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 085/100, Runtime 1.243888, Loss 0.040767, forward nfe 11822, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 086/100, Runtime 1.415052, Loss 0.039182, forward nfe 11946, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 087/100, Runtime 1.387257, Loss 0.055691, forward nfe 12076, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 088/100, Runtime 1.506773, Loss 0.021074, forward nfe 12206, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 089/100, Runtime 1.526279, Loss 0.069814, forward nfe 12348, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 090/100, Runtime 1.542862, Loss 0.076602, forward nfe 12490, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 091/100, Runtime 1.555921, Loss 0.059072, forward nfe 12638, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 092/100, Runtime 1.537621, Loss 0.032028, forward nfe 12786, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 093/100, Runtime 1.726535, Loss 0.051862, forward nfe 12934, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 094/100, Runtime 1.676541, Loss 0.058484, forward nfe 13094, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 095/100, Runtime 1.664011, Loss 0.048439, forward nfe 13254, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 096/100, Runtime 1.698728, Loss 0.053395, forward nfe 13414, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 097/100, Runtime 1.661966, Loss 0.035228, forward nfe 13574, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 098/100, Runtime 1.686742, Loss 0.039560, forward nfe 13734, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
Epoch: 099/100, Runtime 1.680830, Loss 0.051002, forward nfe 13894, backward nfe 0, Train: 0.9857, Val: 0.8603, Test: 0.8437, Best time: 25.0000
best val accuracy 0.860294 with test accuracy 0.843655 at epoch 30 and best time 25.000000