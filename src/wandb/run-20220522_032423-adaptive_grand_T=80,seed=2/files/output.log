/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 4.637115, Loss 1.946556, forward nfe 158, backward nfe 0, Train: 0.2929, Val: 0.1500, Test: 0.1838, Best time: 0.0928
Epoch: 002/100, Runtime 4.163226, Loss 1.817314, forward nfe 756, backward nfe 0, Train: 0.6071, Val: 0.5706, Test: 0.5777, Best time: 3.6923
Epoch: 003/100, Runtime 4.383625, Loss 1.615068, forward nfe 1342, backward nfe 0, Train: 0.7643, Val: 0.7669, Test: 0.7584, Best time: 13.2653
Epoch: 004/100, Runtime 4.308107, Loss 1.352352, forward nfe 1916, backward nfe 0, Train: 0.7643, Val: 0.7669, Test: 0.7584, Best time: 80.0000
Epoch: 005/100, Runtime 4.312582, Loss 1.190823, forward nfe 2472, backward nfe 0, Train: 0.8286, Val: 0.7868, Test: 0.7827, Best time: 10.8570
Epoch: 006/100, Runtime 4.323117, Loss 0.961992, forward nfe 3016, backward nfe 0, Train: 0.8143, Val: 0.8044, Test: 0.7980, Best time: 26.5673
Epoch: 007/100, Runtime 4.204875, Loss 0.846039, forward nfe 3548, backward nfe 0, Train: 0.8571, Val: 0.8125, Test: 0.8142, Best time: 21.1280
Epoch: 008/100, Runtime 3.976733, Loss 0.729498, forward nfe 4056, backward nfe 0, Train: 0.8571, Val: 0.8125, Test: 0.8142, Best time: 80.0000
Epoch: 009/100, Runtime 3.986765, Loss 0.695943, forward nfe 4552, backward nfe 0, Train: 0.8571, Val: 0.8125, Test: 0.8142, Best time: 80.0000
Epoch: 010/100, Runtime 3.765098, Loss 0.593070, forward nfe 5036, backward nfe 0, Train: 0.8786, Val: 0.8272, Test: 0.8264, Best time: 18.6351
Epoch: 011/100, Runtime 3.606317, Loss 0.579682, forward nfe 5508, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 52.5617
Epoch: 012/100, Runtime 3.642326, Loss 0.565474, forward nfe 5968, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 013/100, Runtime 3.481292, Loss 0.521963, forward nfe 6428, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 014/100, Runtime 3.353952, Loss 0.511011, forward nfe 6864, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 015/100, Runtime 3.427854, Loss 0.456743, forward nfe 7294, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 016/100, Runtime 3.226186, Loss 0.521474, forward nfe 7718, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 017/100, Runtime 2.869992, Loss 0.457618, forward nfe 8118, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 018/100, Runtime 3.077583, Loss 0.513686, forward nfe 8518, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 019/100, Runtime 3.087031, Loss 0.457118, forward nfe 8912, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 020/100, Runtime 3.122821, Loss 0.464383, forward nfe 9306, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 021/100, Runtime 2.963311, Loss 0.396536, forward nfe 9694, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 022/100, Runtime 2.874725, Loss 0.393343, forward nfe 10064, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 023/100, Runtime 2.668485, Loss 0.397227, forward nfe 10416, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 024/100, Runtime 2.800227, Loss 0.367446, forward nfe 10762, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 025/100, Runtime 2.817562, Loss 0.327871, forward nfe 11102, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 026/100, Runtime 2.758324, Loss 0.312062, forward nfe 11448, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 027/100, Runtime 2.619581, Loss 0.340214, forward nfe 11788, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 028/100, Runtime 2.712346, Loss 0.269030, forward nfe 12122, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 029/100, Runtime 2.514857, Loss 0.388373, forward nfe 12444, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 030/100, Runtime 2.513791, Loss 0.267826, forward nfe 12748, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 031/100, Runtime 2.504491, Loss 0.313672, forward nfe 13052, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 032/100, Runtime 3.080526, Loss 0.322067, forward nfe 13350, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 033/100, Runtime 2.627115, Loss 0.229642, forward nfe 13642, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 034/100, Runtime 2.859837, Loss 0.255310, forward nfe 13934, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 035/100, Runtime 2.711608, Loss 0.301741, forward nfe 14220, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 036/100, Runtime 2.837216, Loss 0.227494, forward nfe 14500, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 037/100, Runtime 2.706050, Loss 0.223351, forward nfe 14774, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 038/100, Runtime 2.749929, Loss 0.189236, forward nfe 15042, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 039/100, Runtime 2.881742, Loss 0.201820, forward nfe 15298, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 040/100, Runtime 2.833648, Loss 0.232829, forward nfe 15554, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 041/100, Runtime 2.448662, Loss 0.212878, forward nfe 15816, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 042/100, Runtime 2.198840, Loss 0.230844, forward nfe 16072, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 043/100, Runtime 1.875633, Loss 0.249710, forward nfe 16328, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 044/100, Runtime 1.982522, Loss 0.149610, forward nfe 16584, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 045/100, Runtime 1.738958, Loss 0.220176, forward nfe 16840, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 046/100, Runtime 1.851851, Loss 0.181939, forward nfe 17084, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 047/100, Runtime 1.980119, Loss 0.100617, forward nfe 17328, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 048/100, Runtime 1.808339, Loss 0.152512, forward nfe 17572, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 049/100, Runtime 1.873668, Loss 0.140527, forward nfe 17816, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 050/100, Runtime 1.946521, Loss 0.145963, forward nfe 18060, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 051/100, Runtime 1.923042, Loss 0.121152, forward nfe 18292, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 052/100, Runtime 1.777941, Loss 0.159299, forward nfe 18518, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 053/100, Runtime 1.882837, Loss 0.136042, forward nfe 18744, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 054/100, Runtime 1.900950, Loss 0.104268, forward nfe 18970, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 055/100, Runtime 1.904757, Loss 0.140039, forward nfe 19196, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 056/100, Runtime 1.826295, Loss 0.148803, forward nfe 19422, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 057/100, Runtime 1.765894, Loss 0.144043, forward nfe 19642, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 058/100, Runtime 1.883029, Loss 0.151853, forward nfe 19862, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 059/100, Runtime 1.736929, Loss 0.135428, forward nfe 20082, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 060/100, Runtime 1.844534, Loss 0.208306, forward nfe 20302, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 061/100, Runtime 1.859015, Loss 0.042161, forward nfe 20522, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 062/100, Runtime 1.801380, Loss 0.136829, forward nfe 20742, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 063/100, Runtime 1.817803, Loss 0.109234, forward nfe 20962, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 064/100, Runtime 1.751292, Loss 0.064012, forward nfe 21182, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 065/100, Runtime 1.835321, Loss 0.058534, forward nfe 21402, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 066/100, Runtime 1.797959, Loss 0.073673, forward nfe 21622, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 067/100, Runtime 1.824981, Loss 0.105515, forward nfe 21842, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 068/100, Runtime 1.762299, Loss 0.066368, forward nfe 22062, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 069/100, Runtime 1.702322, Loss 0.059652, forward nfe 22282, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 070/100, Runtime 1.642163, Loss 0.063592, forward nfe 22502, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 071/100, Runtime 1.860397, Loss 0.050375, forward nfe 22722, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 072/100, Runtime 1.786707, Loss 0.082255, forward nfe 22942, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 073/100, Runtime 1.532876, Loss 0.103417, forward nfe 23162, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 074/100, Runtime 1.675670, Loss 0.054707, forward nfe 23382, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 075/100, Runtime 1.606905, Loss 0.064350, forward nfe 23602, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 076/100, Runtime 1.721955, Loss 0.057492, forward nfe 23810, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 077/100, Runtime 1.640812, Loss 0.044649, forward nfe 24030, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 078/100, Runtime 1.548902, Loss 0.079374, forward nfe 24244, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 079/100, Runtime 1.538870, Loss 0.077784, forward nfe 24452, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 080/100, Runtime 1.553867, Loss 0.060103, forward nfe 24660, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 081/100, Runtime 1.657467, Loss 0.142472, forward nfe 24868, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 082/100, Runtime 1.621866, Loss 0.022627, forward nfe 25076, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 083/100, Runtime 1.582454, Loss 0.053870, forward nfe 25284, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 084/100, Runtime 1.709889, Loss 0.083791, forward nfe 25492, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 085/100, Runtime 1.766351, Loss 0.138081, forward nfe 25700, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 086/100, Runtime 1.753697, Loss 0.094436, forward nfe 25914, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 087/100, Runtime 1.757529, Loss 0.039356, forward nfe 26128, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 088/100, Runtime 1.747429, Loss 0.098682, forward nfe 26336, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 089/100, Runtime 1.684929, Loss 0.091470, forward nfe 26544, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 090/100, Runtime 1.692689, Loss 0.082035, forward nfe 26746, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 091/100, Runtime 1.677349, Loss 0.061512, forward nfe 26948, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 092/100, Runtime 1.709293, Loss 0.051338, forward nfe 27150, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 093/100, Runtime 1.815318, Loss 0.089982, forward nfe 27352, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 094/100, Runtime 1.668621, Loss 0.031925, forward nfe 27554, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 095/100, Runtime 1.686344, Loss 0.057074, forward nfe 27756, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 096/100, Runtime 1.519914, Loss 0.037902, forward nfe 27958, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 097/100, Runtime 1.666210, Loss 0.069879, forward nfe 28154, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 098/100, Runtime 1.521886, Loss 0.051332, forward nfe 28350, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
Epoch: 099/100, Runtime 1.650315, Loss 0.048456, forward nfe 28546, backward nfe 0, Train: 0.8714, Val: 0.8397, Test: 0.8426, Best time: 80.0000
best val accuracy 0.839706 with test accuracy 0.842640 at epoch 11 and best time 80.000000