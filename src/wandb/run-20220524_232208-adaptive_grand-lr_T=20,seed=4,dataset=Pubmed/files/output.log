/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 3.364258, Loss 1.101782, forward nfe 56, backward nfe 275, Train: 0.6167, Val: 0.5312, Test: 0.5443, Best time: 5.8587
Epoch: 002/100, Runtime 3.254167, Loss 1.093505, forward nfe 306, backward nfe 542, Train: 0.7833, Val: 0.6597, Test: 0.6763, Best time: 20.4566
Epoch: 003/100, Runtime 4.765207, Loss 1.084171, forward nfe 556, backward nfe 962, Train: 0.7833, Val: 0.6597, Test: 0.6763, Best time: 20.0000
Epoch: 004/100, Runtime 4.901867, Loss 1.070289, forward nfe 788, backward nfe 1398, Train: 0.7833, Val: 0.6597, Test: 0.6763, Best time: 20.0000
Epoch: 005/100, Runtime 4.951193, Loss 1.047733, forward nfe 1020, backward nfe 1838, Train: 0.7833, Val: 0.6597, Test: 0.6763, Best time: 20.0000
Epoch: 006/100, Runtime 4.592193, Loss 1.021678, forward nfe 1258, backward nfe 2245, Train: 0.8667, Val: 0.7257, Test: 0.7293, Best time: 0.2221
Epoch: 007/100, Runtime 4.929020, Loss 0.982237, forward nfe 1478, backward nfe 2688, Train: 0.8667, Val: 0.7396, Test: 0.7491, Best time: 2.3954
Epoch: 008/100, Runtime 4.253848, Loss 0.943035, forward nfe 1698, backward nfe 3063, Train: 0.8667, Val: 0.7444, Test: 0.7552, Best time: 2.3526
Epoch: 009/100, Runtime 3.666052, Loss 0.895760, forward nfe 1918, backward nfe 3380, Train: 0.8667, Val: 0.7472, Test: 0.7559, Best time: 2.3131
Epoch: 010/100, Runtime 3.475918, Loss 0.835442, forward nfe 2132, backward nfe 3678, Train: 0.8667, Val: 0.7472, Test: 0.7559, Best time: 20.0000
Epoch: 011/100, Runtime 2.974003, Loss 0.776573, forward nfe 2346, backward nfe 3924, Train: 0.8667, Val: 0.7472, Test: 0.7559, Best time: 20.0000
Epoch: 012/100, Runtime 2.442883, Loss 0.718576, forward nfe 2554, backward nfe 4122, Train: 0.8667, Val: 0.7472, Test: 0.7559, Best time: 20.0000
Epoch: 013/100, Runtime 2.274043, Loss 0.642780, forward nfe 2756, backward nfe 4301, Train: 0.8667, Val: 0.7472, Test: 0.7559, Best time: 20.0000
Epoch: 014/100, Runtime 1.933934, Loss 0.565087, forward nfe 2958, backward nfe 4450, Train: 0.9000, Val: 0.7486, Test: 0.7666, Best time: 5.7840
Epoch: 015/100, Runtime 1.475175, Loss 0.500646, forward nfe 3148, backward nfe 4552, Train: 0.8667, Val: 0.7521, Test: 0.7690, Best time: 61.4855
Epoch: 016/100, Runtime 0.939846, Loss 0.459899, forward nfe 3338, backward nfe 4597, Train: 0.8667, Val: 0.7556, Test: 0.7776, Best time: 24.2322
Epoch: 017/100, Runtime 1.016026, Loss 0.412613, forward nfe 3528, backward nfe 4653, Train: 0.8833, Val: 0.7625, Test: 0.7824, Best time: 16.6077
Epoch: 018/100, Runtime 1.345687, Loss 0.356440, forward nfe 3712, backward nfe 4742, Train: 0.8833, Val: 0.7625, Test: 0.7824, Best time: 20.0000
Epoch: 019/100, Runtime 1.459795, Loss 0.310902, forward nfe 3896, backward nfe 4844, Train: 0.9500, Val: 0.7646, Test: 0.7856, Best time: 17.3277
Epoch: 020/100, Runtime 1.451787, Loss 0.272102, forward nfe 4080, backward nfe 4946, Train: 0.9500, Val: 0.7674, Test: 0.7870, Best time: 17.7533
Epoch: 021/100, Runtime 1.494015, Loss 0.236777, forward nfe 4258, backward nfe 5051, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 18.2200
Epoch: 022/100, Runtime 1.440691, Loss 0.240623, forward nfe 4442, backward nfe 5151, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 023/100, Runtime 1.354636, Loss 0.215903, forward nfe 4626, backward nfe 5245, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 024/100, Runtime 1.286787, Loss 0.205107, forward nfe 4804, backward nfe 5331, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 025/100, Runtime 0.963609, Loss 0.179059, forward nfe 4982, backward nfe 5384, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 026/100, Runtime 0.784834, Loss 0.178682, forward nfe 5160, backward nfe 5420, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 027/100, Runtime 0.802346, Loss 0.192196, forward nfe 5326, backward nfe 5458, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 028/100, Runtime 0.764796, Loss 0.202043, forward nfe 5486, backward nfe 5495, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 029/100, Runtime 0.727115, Loss 0.184587, forward nfe 5646, backward nfe 5529, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 030/100, Runtime 0.720357, Loss 0.166188, forward nfe 5800, backward nfe 5561, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 031/100, Runtime 0.584959, Loss 0.147085, forward nfe 5954, backward nfe 5577, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 032/100, Runtime 0.642116, Loss 0.142100, forward nfe 6108, backward nfe 5604, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 033/100, Runtime 0.669650, Loss 0.152250, forward nfe 6250, backward nfe 5634, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 034/100, Runtime 0.652733, Loss 0.226031, forward nfe 6392, backward nfe 5663, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 035/100, Runtime 0.642560, Loss 0.174003, forward nfe 6534, backward nfe 5690, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 036/100, Runtime 0.583785, Loss 0.138354, forward nfe 6676, backward nfe 5713, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 037/100, Runtime 0.593055, Loss 0.163308, forward nfe 6812, backward nfe 5736, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 038/100, Runtime 0.681897, Loss 0.129975, forward nfe 6942, backward nfe 5771, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 039/100, Runtime 0.681850, Loss 0.109474, forward nfe 7072, backward nfe 5806, Train: 0.9500, Val: 0.7701, Test: 0.7863, Best time: 20.0000
Epoch: 040/100, Runtime 0.616442, Loss 0.178740, forward nfe 7202, backward nfe 5836, Train: 1.0000, Val: 0.7722, Test: 0.7808, Best time: 40.7185
Epoch: 041/100, Runtime 0.569934, Loss 0.116579, forward nfe 7326, backward nfe 5861, Train: 1.0000, Val: 0.7722, Test: 0.7808, Best time: 20.0000
Epoch: 042/100, Runtime 0.557027, Loss 0.095383, forward nfe 7450, backward nfe 5884, Train: 1.0000, Val: 0.7722, Test: 0.7808, Best time: 20.0000
Epoch: 043/100, Runtime 0.497435, Loss 0.098678, forward nfe 7574, backward nfe 5900, Train: 1.0000, Val: 0.7722, Test: 0.7808, Best time: 20.0000
Epoch: 044/100, Runtime 0.483029, Loss 0.139175, forward nfe 7698, backward nfe 5916, Train: 1.0000, Val: 0.7722, Test: 0.7808, Best time: 20.0000
Epoch: 045/100, Runtime 0.446293, Loss 0.089132, forward nfe 7816, backward nfe 5929, Train: 1.0000, Val: 0.7722, Test: 0.7808, Best time: 20.0000
Epoch: 046/100, Runtime 0.470559, Loss 0.100653, forward nfe 7928, backward nfe 5944, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 65.4791
Epoch: 047/100, Runtime 0.464010, Loss 0.099550, forward nfe 8046, backward nfe 5958, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 048/100, Runtime 0.460819, Loss 0.097001, forward nfe 8164, backward nfe 5972, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 049/100, Runtime 0.494908, Loss 0.125620, forward nfe 8282, backward nfe 5988, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 050/100, Runtime 0.435301, Loss 0.084514, forward nfe 8400, backward nfe 6001, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 051/100, Runtime 0.443971, Loss 0.078776, forward nfe 8512, backward nfe 6014, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 052/100, Runtime 0.458776, Loss 0.100546, forward nfe 8624, backward nfe 6030, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 053/100, Runtime 0.452895, Loss 0.104799, forward nfe 8736, backward nfe 6045, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 054/100, Runtime 0.443035, Loss 0.079224, forward nfe 8848, backward nfe 6058, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 055/100, Runtime 0.463884, Loss 0.111297, forward nfe 8960, backward nfe 6073, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 056/100, Runtime 0.445453, Loss 0.099281, forward nfe 9072, backward nfe 6087, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 057/100, Runtime 0.452590, Loss 0.059713, forward nfe 9184, backward nfe 6100, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 058/100, Runtime 0.421355, Loss 0.084610, forward nfe 9296, backward nfe 6111, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 059/100, Runtime 0.416724, Loss 0.105995, forward nfe 9408, backward nfe 6124, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 060/100, Runtime 0.415413, Loss 0.087617, forward nfe 9514, backward nfe 6137, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 061/100, Runtime 0.428815, Loss 0.055242, forward nfe 9620, backward nfe 6150, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 062/100, Runtime 0.408880, Loss 0.074308, forward nfe 9726, backward nfe 6161, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 063/100, Runtime 0.390607, Loss 0.039494, forward nfe 9832, backward nfe 6173, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 064/100, Runtime 0.397217, Loss 0.080519, forward nfe 9932, backward nfe 6185, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 065/100, Runtime 0.410423, Loss 0.099736, forward nfe 10032, backward nfe 6198, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 066/100, Runtime 0.398972, Loss 0.048649, forward nfe 10132, backward nfe 6210, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 067/100, Runtime 0.406678, Loss 0.042503, forward nfe 10232, backward nfe 6223, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 068/100, Runtime 0.402431, Loss 0.044930, forward nfe 10332, backward nfe 6235, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 069/100, Runtime 0.381507, Loss 0.062015, forward nfe 10432, backward nfe 6246, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 070/100, Runtime 0.396919, Loss 0.068335, forward nfe 10532, backward nfe 6258, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 071/100, Runtime 0.383539, Loss 0.055805, forward nfe 10632, backward nfe 6268, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 072/100, Runtime 0.383975, Loss 0.060965, forward nfe 10732, backward nfe 6279, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 073/100, Runtime 0.402052, Loss 0.048576, forward nfe 10832, backward nfe 6291, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 074/100, Runtime 0.390094, Loss 0.057030, forward nfe 10932, backward nfe 6303, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 075/100, Runtime 0.390074, Loss 0.041357, forward nfe 11032, backward nfe 6315, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 076/100, Runtime 0.359138, Loss 0.043532, forward nfe 11132, backward nfe 6327, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 077/100, Runtime 0.360573, Loss 0.100489, forward nfe 11220, backward nfe 6339, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 078/100, Runtime 0.354017, Loss 0.080522, forward nfe 11308, backward nfe 6350, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 079/100, Runtime 0.364512, Loss 0.069005, forward nfe 11396, backward nfe 6362, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 080/100, Runtime 0.353752, Loss 0.096979, forward nfe 11484, backward nfe 6374, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 081/100, Runtime 0.363093, Loss 0.069726, forward nfe 11572, backward nfe 6386, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 082/100, Runtime 0.361449, Loss 0.062434, forward nfe 11660, backward nfe 6398, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 083/100, Runtime 0.354748, Loss 0.077666, forward nfe 11748, backward nfe 6409, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 084/100, Runtime 0.356115, Loss 0.075935, forward nfe 11836, backward nfe 6420, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 085/100, Runtime 0.351932, Loss 0.038119, forward nfe 11924, backward nfe 6431, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 086/100, Runtime 0.355098, Loss 0.051746, forward nfe 12012, backward nfe 6442, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 087/100, Runtime 0.357538, Loss 0.046068, forward nfe 12100, backward nfe 6454, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 088/100, Runtime 0.358835, Loss 0.037864, forward nfe 12188, backward nfe 6466, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 089/100, Runtime 0.353553, Loss 0.056350, forward nfe 12276, backward nfe 6477, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 090/100, Runtime 0.373583, Loss 0.048397, forward nfe 12364, backward nfe 6489, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 091/100, Runtime 0.370795, Loss 0.086194, forward nfe 12452, backward nfe 6501, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 092/100, Runtime 0.375740, Loss 0.080080, forward nfe 12540, backward nfe 6514, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 093/100, Runtime 0.351422, Loss 0.048659, forward nfe 12628, backward nfe 6525, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 094/100, Runtime 0.348489, Loss 0.052086, forward nfe 12716, backward nfe 6536, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 095/100, Runtime 0.366366, Loss 0.053681, forward nfe 12804, backward nfe 6548, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 096/100, Runtime 0.350868, Loss 0.052892, forward nfe 12892, backward nfe 6559, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 097/100, Runtime 0.354300, Loss 0.037236, forward nfe 12980, backward nfe 6570, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 098/100, Runtime 0.341750, Loss 0.033282, forward nfe 13068, backward nfe 6580, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
Epoch: 099/100, Runtime 0.359203, Loss 0.061265, forward nfe 13156, backward nfe 6592, Train: 0.9833, Val: 0.7750, Test: 0.7800, Best time: 20.0000
best val accuracy 0.775000 with test accuracy 0.780041 at epoch 46 and best time 20.000000