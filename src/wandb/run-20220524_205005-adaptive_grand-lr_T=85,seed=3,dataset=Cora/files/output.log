/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 6.612354, Loss 1.948900, forward nfe 164, backward nfe 0, Train: 0.1071, Val: 0.3029, Test: 0.2741, Best time: 85.0000
Epoch: 002/100, Runtime 6.513049, Loss 2.039770, forward nfe 798, backward nfe 0, Train: 0.1071, Val: 0.3029, Test: 0.2741, Best time: 85.0000
Epoch: 003/100, Runtime 6.511579, Loss 1.958216, forward nfe 1414, backward nfe 0, Train: 0.1071, Val: 0.3029, Test: 0.2741, Best time: 85.0000
Epoch: 004/100, Runtime 8.053227, Loss 1.900478, forward nfe 2036, backward nfe 0, Train: 0.1071, Val: 0.3029, Test: 0.2741, Best time: 85.0000
Epoch: 005/100, Runtime 7.828677, Loss 1.855033, forward nfe 2646, backward nfe 0, Train: 0.3571, Val: 0.3243, Test: 0.3157, Best time: 0.9236
Epoch: 006/100, Runtime 9.002957, Loss 1.749439, forward nfe 3226, backward nfe 0, Train: 0.6714, Val: 0.5794, Test: 0.6102, Best time: 16.4519
Epoch: 007/100, Runtime 9.810410, Loss 1.629087, forward nfe 3800, backward nfe 0, Train: 0.6786, Val: 0.6581, Test: 0.6721, Best time: 40.4077
Epoch: 008/100, Runtime 9.519609, Loss 1.460343, forward nfe 4362, backward nfe 0, Train: 0.7143, Val: 0.7132, Test: 0.7157, Best time: 18.0635
Epoch: 009/100, Runtime 7.653248, Loss 1.266271, forward nfe 4900, backward nfe 0, Train: 0.8000, Val: 0.7272, Test: 0.7340, Best time: 24.9186
Epoch: 010/100, Runtime 7.086595, Loss 1.093547, forward nfe 5432, backward nfe 0, Train: 0.8000, Val: 0.7272, Test: 0.7340, Best time: 85.0000
Epoch: 011/100, Runtime 7.210325, Loss 0.983711, forward nfe 5952, backward nfe 0, Train: 0.8000, Val: 0.7272, Test: 0.7340, Best time: 85.0000
Epoch: 012/100, Runtime 6.891361, Loss 0.877712, forward nfe 6460, backward nfe 0, Train: 0.8000, Val: 0.7787, Test: 0.7929, Best time: 119.0197
Epoch: 013/100, Runtime 6.840004, Loss 0.793776, forward nfe 6968, backward nfe 0, Train: 0.8000, Val: 0.7787, Test: 0.7929, Best time: 85.0000
Epoch: 014/100, Runtime 6.607722, Loss 0.741287, forward nfe 7464, backward nfe 0, Train: 0.8000, Val: 0.7787, Test: 0.7929, Best time: 85.0000
Epoch: 015/100, Runtime 6.413458, Loss 0.690738, forward nfe 7948, backward nfe 0, Train: 0.8000, Val: 0.7787, Test: 0.7929, Best time: 85.0000
Epoch: 016/100, Runtime 6.130149, Loss 0.617949, forward nfe 8402, backward nfe 0, Train: 0.8286, Val: 0.8029, Test: 0.7990, Best time: 95.9726
Epoch: 017/100, Runtime 5.390340, Loss 0.605546, forward nfe 8850, backward nfe 0, Train: 0.8286, Val: 0.8029, Test: 0.7990, Best time: 85.0000
Epoch: 018/100, Runtime 4.358600, Loss 0.568618, forward nfe 9280, backward nfe 0, Train: 0.8286, Val: 0.8029, Test: 0.7990, Best time: 85.0000
Epoch: 019/100, Runtime 4.447371, Loss 0.556280, forward nfe 9716, backward nfe 0, Train: 0.8286, Val: 0.8029, Test: 0.7990, Best time: 85.0000
Epoch: 020/100, Runtime 4.339849, Loss 0.516334, forward nfe 10140, backward nfe 0, Train: 0.8286, Val: 0.8029, Test: 0.7990, Best time: 85.0000
Epoch: 021/100, Runtime 4.246562, Loss 0.512554, forward nfe 10552, backward nfe 0, Train: 0.8571, Val: 0.8096, Test: 0.8112, Best time: 119.5350
Epoch: 022/100, Runtime 4.213475, Loss 0.504906, forward nfe 10952, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 115.6068
Epoch: 023/100, Runtime 3.734005, Loss 0.487308, forward nfe 11334, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 024/100, Runtime 3.647826, Loss 0.470200, forward nfe 11704, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 025/100, Runtime 3.736028, Loss 0.456762, forward nfe 12074, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 026/100, Runtime 3.800670, Loss 0.533346, forward nfe 12438, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 027/100, Runtime 3.728584, Loss 0.531972, forward nfe 12802, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 028/100, Runtime 3.688401, Loss 0.411939, forward nfe 13154, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 029/100, Runtime 3.413415, Loss 0.476278, forward nfe 13488, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 030/100, Runtime 3.469731, Loss 0.380211, forward nfe 13810, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 031/100, Runtime 3.397737, Loss 0.406792, forward nfe 14138, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 032/100, Runtime 3.242096, Loss 0.385600, forward nfe 14460, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 033/100, Runtime 3.212958, Loss 0.458953, forward nfe 14776, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 034/100, Runtime 3.368602, Loss 0.339866, forward nfe 15092, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 035/100, Runtime 3.207987, Loss 0.360514, forward nfe 15408, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 036/100, Runtime 3.222157, Loss 0.333967, forward nfe 15706, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 037/100, Runtime 3.099795, Loss 0.352215, forward nfe 16010, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 038/100, Runtime 3.123235, Loss 0.331129, forward nfe 16302, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 039/100, Runtime 3.014811, Loss 0.266327, forward nfe 16594, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 040/100, Runtime 2.782900, Loss 0.365043, forward nfe 16868, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 041/100, Runtime 2.856433, Loss 0.295857, forward nfe 17142, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 042/100, Runtime 2.710755, Loss 0.340135, forward nfe 17416, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 043/100, Runtime 2.654455, Loss 0.264112, forward nfe 17672, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 044/100, Runtime 2.689148, Loss 0.331094, forward nfe 17934, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 045/100, Runtime 2.768979, Loss 0.283514, forward nfe 18196, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 046/100, Runtime 2.825212, Loss 0.246186, forward nfe 18464, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 047/100, Runtime 2.814461, Loss 0.254023, forward nfe 18726, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 048/100, Runtime 2.727286, Loss 0.198211, forward nfe 18988, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 049/100, Runtime 2.580567, Loss 0.198416, forward nfe 19238, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 050/100, Runtime 2.693543, Loss 0.245162, forward nfe 19488, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 051/100, Runtime 2.685720, Loss 0.211270, forward nfe 19732, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 052/100, Runtime 2.574342, Loss 0.196907, forward nfe 19982, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 053/100, Runtime 2.724753, Loss 0.263216, forward nfe 20232, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 054/100, Runtime 2.657395, Loss 0.192008, forward nfe 20482, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 055/100, Runtime 2.638028, Loss 0.238392, forward nfe 20732, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 056/100, Runtime 2.748491, Loss 0.159766, forward nfe 20982, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 057/100, Runtime 2.747645, Loss 0.188365, forward nfe 21232, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 058/100, Runtime 2.539185, Loss 0.193649, forward nfe 21488, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 059/100, Runtime 2.683725, Loss 0.228660, forward nfe 21732, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 060/100, Runtime 2.593051, Loss 0.158523, forward nfe 21976, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 061/100, Runtime 2.655069, Loss 0.164692, forward nfe 22220, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 062/100, Runtime 2.636573, Loss 0.168541, forward nfe 22464, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 063/100, Runtime 2.538235, Loss 0.120279, forward nfe 22708, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 064/100, Runtime 2.576154, Loss 0.102990, forward nfe 22952, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 065/100, Runtime 2.576710, Loss 0.108434, forward nfe 23196, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 066/100, Runtime 2.704885, Loss 0.080560, forward nfe 23440, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 067/100, Runtime 2.473438, Loss 0.098158, forward nfe 23684, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 068/100, Runtime 2.695627, Loss 0.098425, forward nfe 23928, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 069/100, Runtime 2.612252, Loss 0.056777, forward nfe 24172, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 070/100, Runtime 2.634703, Loss 0.096758, forward nfe 24416, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 071/100, Runtime 2.599579, Loss 0.054310, forward nfe 24660, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 072/100, Runtime 2.566022, Loss 0.112512, forward nfe 24904, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 073/100, Runtime 2.632505, Loss 0.067097, forward nfe 25148, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 074/100, Runtime 2.575588, Loss 0.074187, forward nfe 25392, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 075/100, Runtime 2.514508, Loss 0.056163, forward nfe 25636, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 076/100, Runtime 2.433697, Loss 0.080984, forward nfe 25868, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 077/100, Runtime 2.382857, Loss 0.051837, forward nfe 26100, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 078/100, Runtime 2.688780, Loss 0.112092, forward nfe 26332, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 079/100, Runtime 2.575962, Loss 0.115005, forward nfe 26576, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 080/100, Runtime 2.506445, Loss 0.051373, forward nfe 26820, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 081/100, Runtime 2.475641, Loss 0.062101, forward nfe 27052, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 082/100, Runtime 2.551513, Loss 0.120636, forward nfe 27284, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 083/100, Runtime 2.484722, Loss 0.053970, forward nfe 27522, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 084/100, Runtime 2.615523, Loss 0.047695, forward nfe 27760, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 085/100, Runtime 2.416264, Loss 0.067554, forward nfe 27998, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 086/100, Runtime 2.392121, Loss 0.069881, forward nfe 28236, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 087/100, Runtime 2.529777, Loss 0.110871, forward nfe 28474, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 088/100, Runtime 2.440423, Loss 0.076953, forward nfe 28712, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 089/100, Runtime 2.423759, Loss 0.095827, forward nfe 28950, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 090/100, Runtime 2.385126, Loss 0.047910, forward nfe 29188, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 091/100, Runtime 2.533325, Loss 0.068449, forward nfe 29426, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 092/100, Runtime 2.492004, Loss 0.061446, forward nfe 29664, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 093/100, Runtime 2.588512, Loss 0.028421, forward nfe 29902, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 094/100, Runtime 2.455021, Loss 0.062098, forward nfe 30128, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 095/100, Runtime 2.472306, Loss 0.061611, forward nfe 30354, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 096/100, Runtime 2.475783, Loss 0.046963, forward nfe 30580, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 097/100, Runtime 2.500299, Loss 0.112043, forward nfe 30818, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 098/100, Runtime 2.477620, Loss 0.084137, forward nfe 31056, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
Epoch: 099/100, Runtime 2.435567, Loss 0.043484, forward nfe 31282, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8122, Best time: 85.0000
best val accuracy 0.819118 with test accuracy 0.812183 at epoch 22 and best time 85.000000