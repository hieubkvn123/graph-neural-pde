/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.965516, Loss 1.792271, forward nfe 230, backward nfe 0, Train: 0.3083, Val: 0.3007, Test: 0.3065, Best time: 22.3820
Epoch: 002/100, Runtime 0.864024, Loss 1.778984, forward nfe 1014, backward nfe 0, Train: 0.5167, Val: 0.5616, Test: 0.5597, Best time: 95.0000
Epoch: 003/100, Runtime 0.838474, Loss 1.750625, forward nfe 1786, backward nfe 0, Train: 0.5750, Val: 0.6993, Test: 0.6629, Best time: 95.0000
Epoch: 004/100, Runtime 0.862183, Loss 1.715700, forward nfe 2558, backward nfe 0, Train: 0.5750, Val: 0.6993, Test: 0.6629, Best time: 95.0000
Epoch: 005/100, Runtime 0.850054, Loss 1.631813, forward nfe 3324, backward nfe 0, Train: 0.5750, Val: 0.6993, Test: 0.6629, Best time: 95.0000
Epoch: 006/100, Runtime 0.798784, Loss 1.592148, forward nfe 4078, backward nfe 0, Train: 0.5750, Val: 0.6993, Test: 0.6629, Best time: 95.0000
Epoch: 007/100, Runtime 0.813344, Loss 1.577491, forward nfe 4820, backward nfe 0, Train: 0.5750, Val: 0.6993, Test: 0.6629, Best time: 95.0000
Epoch: 008/100, Runtime 0.822086, Loss 1.528880, forward nfe 5544, backward nfe 0, Train: 0.5750, Val: 0.6993, Test: 0.6629, Best time: 95.0000
Epoch: 009/100, Runtime 0.805980, Loss 1.532265, forward nfe 6268, backward nfe 0, Train: 0.6917, Val: 0.7290, Test: 0.6952, Best time: 65.5257
Epoch: 010/100, Runtime 0.764187, Loss 1.505092, forward nfe 6974, backward nfe 0, Train: 0.6917, Val: 0.7290, Test: 0.6952, Best time: 95.0000
Epoch: 011/100, Runtime 0.756068, Loss 1.550511, forward nfe 7668, backward nfe 0, Train: 0.6917, Val: 0.7290, Test: 0.6952, Best time: 95.0000
Epoch: 012/100, Runtime 0.761540, Loss 1.497156, forward nfe 8362, backward nfe 0, Train: 0.6917, Val: 0.7290, Test: 0.6952, Best time: 95.0000
Epoch: 013/100, Runtime 0.748224, Loss 1.452292, forward nfe 9038, backward nfe 0, Train: 0.6917, Val: 0.7290, Test: 0.6952, Best time: 95.0000
Epoch: 014/100, Runtime 0.735395, Loss 1.444423, forward nfe 9714, backward nfe 0, Train: 0.6917, Val: 0.7290, Test: 0.6952, Best time: 95.0000
Epoch: 015/100, Runtime 0.730080, Loss 1.397108, forward nfe 10366, backward nfe 0, Train: 0.6917, Val: 0.7290, Test: 0.6952, Best time: 95.0000
Epoch: 016/100, Runtime 0.721520, Loss 1.388193, forward nfe 11024, backward nfe 0, Train: 0.6917, Val: 0.7290, Test: 0.6952, Best time: 95.0000
Epoch: 017/100, Runtime 0.712930, Loss 1.366289, forward nfe 11664, backward nfe 0, Train: 0.6917, Val: 0.7290, Test: 0.6952, Best time: 95.0000
Epoch: 018/100, Runtime 0.690043, Loss 1.399618, forward nfe 12292, backward nfe 0, Train: 0.6917, Val: 0.7290, Test: 0.6952, Best time: 95.0000
Epoch: 019/100, Runtime 0.672620, Loss 1.405004, forward nfe 12908, backward nfe 0, Train: 0.7000, Val: 0.7391, Test: 0.6984, Best time: 184.3913
Epoch: 020/100, Runtime 0.658869, Loss 1.324221, forward nfe 13512, backward nfe 0, Train: 0.7000, Val: 0.7391, Test: 0.6984, Best time: 95.0000
Epoch: 021/100, Runtime 0.666143, Loss 1.334994, forward nfe 14110, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 120.9631
Epoch: 022/100, Runtime 0.661515, Loss 1.351538, forward nfe 14702, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 023/100, Runtime 0.639380, Loss 1.327794, forward nfe 15288, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 024/100, Runtime 0.638835, Loss 1.256467, forward nfe 15856, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 025/100, Runtime 0.659153, Loss 1.343541, forward nfe 16418, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 026/100, Runtime 0.629489, Loss 1.256772, forward nfe 16974, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 027/100, Runtime 0.622848, Loss 1.437102, forward nfe 17524, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 028/100, Runtime 0.620558, Loss 1.348242, forward nfe 18068, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 029/100, Runtime 0.598456, Loss 1.385566, forward nfe 18600, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 030/100, Runtime 0.598999, Loss 1.312146, forward nfe 19120, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 031/100, Runtime 0.588815, Loss 1.398266, forward nfe 19640, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 032/100, Runtime 0.577659, Loss 1.378411, forward nfe 20148, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 033/100, Runtime 0.558742, Loss 1.399176, forward nfe 20656, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 034/100, Runtime 0.550945, Loss 1.279392, forward nfe 21146, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 035/100, Runtime 0.568188, Loss 1.315232, forward nfe 21636, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 036/100, Runtime 0.550666, Loss 1.434882, forward nfe 22114, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 037/100, Runtime 0.548079, Loss 1.406844, forward nfe 22598, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 038/100, Runtime 0.531750, Loss 1.448142, forward nfe 23058, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 039/100, Runtime 0.533655, Loss 1.342490, forward nfe 23512, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 040/100, Runtime 0.540746, Loss 1.378775, forward nfe 23966, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 041/100, Runtime 0.530808, Loss 1.280176, forward nfe 24420, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.6823, Best time: 95.0000
Epoch: 042/100, Runtime 0.532451, Loss 1.346871, forward nfe 24868, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 178.7264
Epoch: 043/100, Runtime 0.653285, Loss 1.318165, forward nfe 25310, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 044/100, Runtime 0.493440, Loss 1.317944, forward nfe 25746, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 045/100, Runtime 0.511490, Loss 1.396769, forward nfe 26176, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 046/100, Runtime 0.496666, Loss 1.317923, forward nfe 26606, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 047/100, Runtime 0.491623, Loss 1.415184, forward nfe 27024, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 048/100, Runtime 0.491721, Loss 1.365154, forward nfe 27442, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 049/100, Runtime 0.490068, Loss 1.384484, forward nfe 27854, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 050/100, Runtime 0.486104, Loss 1.298024, forward nfe 28260, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 051/100, Runtime 0.461550, Loss 1.385767, forward nfe 28660, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 052/100, Runtime 0.453014, Loss 1.261685, forward nfe 29054, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 053/100, Runtime 0.452123, Loss 1.453744, forward nfe 29448, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 054/100, Runtime 0.446185, Loss 1.171750, forward nfe 29830, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 055/100, Runtime 0.462897, Loss 1.354174, forward nfe 30212, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 056/100, Runtime 0.455853, Loss 1.348974, forward nfe 30600, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 057/100, Runtime 0.440968, Loss 1.336504, forward nfe 30976, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 058/100, Runtime 0.437662, Loss 1.304292, forward nfe 31352, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 059/100, Runtime 0.419889, Loss 1.313117, forward nfe 31716, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 060/100, Runtime 0.430487, Loss 1.286712, forward nfe 32086, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 061/100, Runtime 0.420990, Loss 1.381452, forward nfe 32450, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 062/100, Runtime 0.430015, Loss 1.397945, forward nfe 32814, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 063/100, Runtime 0.424933, Loss 1.356472, forward nfe 33172, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 064/100, Runtime 0.415035, Loss 1.382476, forward nfe 33530, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 065/100, Runtime 0.415430, Loss 1.305609, forward nfe 33888, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 066/100, Runtime 0.407915, Loss 1.261947, forward nfe 34240, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 067/100, Runtime 0.426422, Loss 1.346094, forward nfe 34598, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 068/100, Runtime 0.418644, Loss 1.223198, forward nfe 34956, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 069/100, Runtime 0.417109, Loss 1.324554, forward nfe 35314, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 070/100, Runtime 0.402094, Loss 1.292351, forward nfe 35660, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 071/100, Runtime 0.416272, Loss 1.247193, forward nfe 36012, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 072/100, Runtime 0.430290, Loss 1.273088, forward nfe 36364, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 073/100, Runtime 0.415645, Loss 1.363459, forward nfe 36716, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 074/100, Runtime 0.414072, Loss 1.283637, forward nfe 37068, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 075/100, Runtime 0.413541, Loss 1.303170, forward nfe 37420, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 076/100, Runtime 0.411260, Loss 1.179618, forward nfe 37772, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 077/100, Runtime 0.426658, Loss 1.261787, forward nfe 38124, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 078/100, Runtime 0.418986, Loss 1.430980, forward nfe 38470, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 079/100, Runtime 0.410885, Loss 1.225262, forward nfe 38816, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 080/100, Runtime 0.412497, Loss 1.216436, forward nfe 39156, backward nfe 0, Train: 0.6667, Val: 0.7507, Test: 0.7145, Best time: 95.0000
Epoch: 081/100, Runtime 0.422694, Loss 1.260370, forward nfe 39502, backward nfe 0, Train: 0.7167, Val: 0.7529, Test: 0.7194, Best time: 220.2054
Epoch: 082/100, Runtime 0.419988, Loss 1.259598, forward nfe 39842, backward nfe 0, Train: 0.7167, Val: 0.7529, Test: 0.7194, Best time: 95.0000
Epoch: 083/100, Runtime 0.410515, Loss 1.251270, forward nfe 40182, backward nfe 0, Train: 0.7167, Val: 0.7529, Test: 0.7194, Best time: 95.0000
Epoch: 084/100, Runtime 0.411769, Loss 1.224741, forward nfe 40522, backward nfe 0, Train: 0.7667, Val: 0.7638, Test: 0.7306, Best time: 95.7844
Epoch: 085/100, Runtime 0.400894, Loss 1.139010, forward nfe 40856, backward nfe 0, Train: 0.7667, Val: 0.7638, Test: 0.7306, Best time: 95.0000
Epoch: 086/100, Runtime 0.404409, Loss 1.270603, forward nfe 41190, backward nfe 0, Train: 0.7667, Val: 0.7638, Test: 0.7306, Best time: 95.0000
Epoch: 087/100, Runtime 0.397397, Loss 1.458855, forward nfe 41518, backward nfe 0, Train: 0.7667, Val: 0.7638, Test: 0.7306, Best time: 95.0000
Epoch: 088/100, Runtime 0.396406, Loss 1.406574, forward nfe 41846, backward nfe 0, Train: 0.7667, Val: 0.7638, Test: 0.7306, Best time: 95.0000
Epoch: 089/100, Runtime 0.386539, Loss 1.289325, forward nfe 42174, backward nfe 0, Train: 0.7667, Val: 0.7638, Test: 0.7306, Best time: 95.0000
Epoch: 090/100, Runtime 0.394143, Loss 1.217610, forward nfe 42502, backward nfe 0, Train: 0.7667, Val: 0.7638, Test: 0.7306, Best time: 95.0000
Epoch: 091/100, Runtime 0.402060, Loss 1.367708, forward nfe 42836, backward nfe 0, Train: 0.7667, Val: 0.7638, Test: 0.7306, Best time: 95.0000
Epoch: 092/100, Runtime 0.394916, Loss 1.270862, forward nfe 43164, backward nfe 0, Train: 0.7667, Val: 0.7638, Test: 0.7306, Best time: 95.0000
Epoch: 093/100, Runtime 0.397756, Loss 1.202460, forward nfe 43492, backward nfe 0, Train: 0.7667, Val: 0.7638, Test: 0.7306, Best time: 95.0000
Epoch: 094/100, Runtime 0.396322, Loss 1.219679, forward nfe 43820, backward nfe 0, Train: 0.7667, Val: 0.7638, Test: 0.7306, Best time: 95.0000
Epoch: 095/100, Runtime 0.386531, Loss 1.169173, forward nfe 44148, backward nfe 0, Train: 0.7667, Val: 0.7638, Test: 0.7306, Best time: 95.0000
Epoch: 096/100, Runtime 0.425550, Loss 1.230326, forward nfe 44470, backward nfe 0, Train: 0.7667, Val: 0.7638, Test: 0.7306, Best time: 95.0000
Epoch: 097/100, Runtime 0.385475, Loss 1.219224, forward nfe 44792, backward nfe 0, Train: 0.7667, Val: 0.7638, Test: 0.7306, Best time: 95.0000
Epoch: 098/100, Runtime 0.391181, Loss 1.243547, forward nfe 45114, backward nfe 0, Train: 0.7667, Val: 0.7638, Test: 0.7306, Best time: 95.0000
Epoch: 099/100, Runtime 0.385994, Loss 1.306330, forward nfe 45436, backward nfe 0, Train: 0.7667, Val: 0.7638, Test: 0.7306, Best time: 95.0000
best val accuracy 0.763768 with test accuracy 0.730645 at epoch 84 and best time 95.000000