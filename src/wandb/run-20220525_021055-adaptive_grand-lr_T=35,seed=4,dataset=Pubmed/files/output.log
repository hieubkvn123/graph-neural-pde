/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 33.388913, Loss 1.098822, forward nfe 80, backward nfe 3310, Train: 0.5167, Val: 0.4257, Test: 0.4583, Best time: 175.8766
Epoch: 002/100, Runtime 23.866756, Loss 1.089231, forward nfe 498, backward nfe 5665, Train: 0.7000, Val: 0.5819, Test: 0.5897, Best time: 0.2493
Epoch: 003/100, Runtime 24.931249, Loss 1.072813, forward nfe 904, backward nfe 8095, Train: 0.8000, Val: 0.7354, Test: 0.7408, Best time: 2.6844
Epoch: 004/100, Runtime 22.619081, Loss 1.050678, forward nfe 1322, backward nfe 10317, Train: 0.8000, Val: 0.7354, Test: 0.7408, Best time: 35.0000
Epoch: 005/100, Runtime 17.780678, Loss 1.019619, forward nfe 1746, backward nfe 12038, Train: 0.8000, Val: 0.7354, Test: 0.7408, Best time: 35.0000
Epoch: 006/100, Runtime 22.261217, Loss 0.981890, forward nfe 2170, backward nfe 14221, Train: 0.8000, Val: 0.7354, Test: 0.7408, Best time: 35.0000
Epoch: 007/100, Runtime 19.968539, Loss 0.939877, forward nfe 2594, backward nfe 16169, Train: 0.8000, Val: 0.7354, Test: 0.7408, Best time: 35.0000
Epoch: 008/100, Runtime 25.308874, Loss 0.887468, forward nfe 3018, backward nfe 18645, Train: 0.8333, Val: 0.7444, Test: 0.7434, Best time: 9.6748
Epoch: 009/100, Runtime 23.678915, Loss 0.823698, forward nfe 3448, backward nfe 20978, Train: 0.8000, Val: 0.7500, Test: 0.7510, Best time: 5.5449
Epoch: 010/100, Runtime 22.514962, Loss 0.775238, forward nfe 3878, backward nfe 23206, Train: 0.8333, Val: 0.7535, Test: 0.7610, Best time: 19.6000
Epoch: 011/100, Runtime 23.791294, Loss 0.703098, forward nfe 4308, backward nfe 25560, Train: 0.8333, Val: 0.7590, Test: 0.7661, Best time: 23.8241
Epoch: 012/100, Runtime 23.022420, Loss 0.643238, forward nfe 4732, backward nfe 27828, Train: 0.8500, Val: 0.7667, Test: 0.7722, Best time: 28.1313
Epoch: 013/100, Runtime 22.164591, Loss 0.579391, forward nfe 5156, backward nfe 30000, Train: 0.8667, Val: 0.7743, Test: 0.7840, Best time: 35.7825
Epoch: 014/100, Runtime 21.603281, Loss 0.525324, forward nfe 5574, backward nfe 32113, Train: 0.8500, Val: 0.7854, Test: 0.7875, Best time: 9.5898
Epoch: 015/100, Runtime 21.526521, Loss 0.502917, forward nfe 5992, backward nfe 34236, Train: 0.8833, Val: 0.7903, Test: 0.7910, Best time: 19.4064
Epoch: 016/100, Runtime 23.194336, Loss 0.503833, forward nfe 6410, backward nfe 36549, Train: 0.8833, Val: 0.8000, Test: 0.8058, Best time: 51.5474
Epoch: 017/100, Runtime 22.569838, Loss 0.417692, forward nfe 6834, backward nfe 38804, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 15.2656
Epoch: 018/100, Runtime 21.298146, Loss 0.412817, forward nfe 7258, backward nfe 40917, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 019/100, Runtime 21.093760, Loss 0.345533, forward nfe 7682, backward nfe 43014, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 020/100, Runtime 20.739222, Loss 0.364803, forward nfe 8094, backward nfe 45070, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 021/100, Runtime 20.906669, Loss 0.336523, forward nfe 8506, backward nfe 47147, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 022/100, Runtime 19.933844, Loss 0.307788, forward nfe 8918, backward nfe 49125, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 023/100, Runtime 19.584052, Loss 0.285980, forward nfe 9324, backward nfe 51049, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 024/100, Runtime 18.417587, Loss 0.296576, forward nfe 9736, backward nfe 52846, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 025/100, Runtime 17.684480, Loss 0.294596, forward nfe 10148, backward nfe 54553, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 026/100, Runtime 16.620712, Loss 0.259920, forward nfe 10560, backward nfe 56165, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 027/100, Runtime 17.177503, Loss 0.309623, forward nfe 10972, backward nfe 57795, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 028/100, Runtime 16.918066, Loss 0.278755, forward nfe 11384, backward nfe 59419, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 029/100, Runtime 15.867173, Loss 0.242637, forward nfe 11802, backward nfe 60955, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 030/100, Runtime 16.081247, Loss 0.246622, forward nfe 12220, backward nfe 62476, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 031/100, Runtime 14.394555, Loss 0.237830, forward nfe 12638, backward nfe 63853, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 032/100, Runtime 12.921396, Loss 0.257007, forward nfe 13056, backward nfe 65044, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 033/100, Runtime 13.682022, Loss 0.209434, forward nfe 13468, backward nfe 66343, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 034/100, Runtime 13.350501, Loss 0.250942, forward nfe 13880, backward nfe 67607, Train: 0.8833, Val: 0.8097, Test: 0.8086, Best time: 35.0000
Epoch: 035/100, Runtime 14.493787, Loss 0.177509, forward nfe 14292, backward nfe 68994, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 92.5624
Epoch: 036/100, Runtime 11.411472, Loss 0.189563, forward nfe 14710, backward nfe 70053, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 037/100, Runtime 16.816350, Loss 0.268330, forward nfe 15122, backward nfe 71670, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 038/100, Runtime 11.802995, Loss 0.188716, forward nfe 15540, backward nfe 72749, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 039/100, Runtime 12.222306, Loss 0.163823, forward nfe 15958, backward nfe 73895, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 040/100, Runtime 12.977680, Loss 0.190085, forward nfe 16376, backward nfe 75122, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 041/100, Runtime 14.880546, Loss 0.169487, forward nfe 16794, backward nfe 76532, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 042/100, Runtime 13.764809, Loss 0.157145, forward nfe 17212, backward nfe 77829, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 043/100, Runtime 12.745852, Loss 0.165963, forward nfe 17624, backward nfe 79031, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 044/100, Runtime 13.147377, Loss 0.160110, forward nfe 18042, backward nfe 80280, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 045/100, Runtime 16.447525, Loss 0.146553, forward nfe 18454, backward nfe 81871, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 046/100, Runtime 15.736129, Loss 0.137931, forward nfe 18866, backward nfe 83376, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 047/100, Runtime 16.041683, Loss 0.142816, forward nfe 19284, backward nfe 84932, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 048/100, Runtime 15.784694, Loss 0.132709, forward nfe 19702, backward nfe 86428, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 049/100, Runtime 16.584440, Loss 0.150450, forward nfe 20120, backward nfe 88014, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 050/100, Runtime 15.959565, Loss 0.129019, forward nfe 20538, backward nfe 89538, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 051/100, Runtime 16.387551, Loss 0.128963, forward nfe 20956, backward nfe 91123, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 052/100, Runtime 15.352882, Loss 0.122054, forward nfe 21374, backward nfe 92606, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 053/100, Runtime 15.521501, Loss 0.103552, forward nfe 21792, backward nfe 94089, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 054/100, Runtime 14.585869, Loss 0.104328, forward nfe 22210, backward nfe 95478, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 055/100, Runtime 15.287273, Loss 0.092277, forward nfe 22628, backward nfe 96924, Train: 0.9833, Val: 0.8111, Test: 0.8111, Best time: 35.0000
Epoch: 056/100, Runtime 14.837434, Loss 0.118033, forward nfe 23046, backward nfe 98322, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 41.3802
Epoch: 057/100, Runtime 15.049750, Loss 0.142313, forward nfe 23464, backward nfe 99773, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 058/100, Runtime 14.990580, Loss 0.089410, forward nfe 23882, backward nfe 101224, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 059/100, Runtime 14.691265, Loss 0.150000, forward nfe 24300, backward nfe 102606, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 060/100, Runtime 14.980146, Loss 0.096903, forward nfe 24718, backward nfe 104029, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 061/100, Runtime 13.709038, Loss 0.099236, forward nfe 25136, backward nfe 105303, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 062/100, Runtime 14.363136, Loss 0.090491, forward nfe 25554, backward nfe 106671, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 063/100, Runtime 15.034537, Loss 0.138889, forward nfe 25972, backward nfe 108090, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 064/100, Runtime 14.067643, Loss 0.082792, forward nfe 26390, backward nfe 109438, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 065/100, Runtime 14.498150, Loss 0.119737, forward nfe 26808, backward nfe 110795, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 066/100, Runtime 12.621655, Loss 0.130556, forward nfe 27226, backward nfe 111984, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 067/100, Runtime 12.623671, Loss 0.080440, forward nfe 27644, backward nfe 113165, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 068/100, Runtime 14.138274, Loss 0.057061, forward nfe 28062, backward nfe 114513, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 069/100, Runtime 14.831257, Loss 0.057304, forward nfe 28480, backward nfe 115893, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 070/100, Runtime 12.978103, Loss 0.088251, forward nfe 28892, backward nfe 117089, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 071/100, Runtime 14.117076, Loss 0.094548, forward nfe 29304, backward nfe 118429, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 072/100, Runtime 13.506872, Loss 0.049747, forward nfe 29716, backward nfe 119693, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 073/100, Runtime 12.657678, Loss 0.056268, forward nfe 30128, backward nfe 120871, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 074/100, Runtime 13.288671, Loss 0.120123, forward nfe 30540, backward nfe 122106, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 075/100, Runtime 12.949574, Loss 0.057355, forward nfe 30952, backward nfe 123323, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 076/100, Runtime 12.868132, Loss 0.088974, forward nfe 31364, backward nfe 124530, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 077/100, Runtime 11.186625, Loss 0.046657, forward nfe 31776, backward nfe 125577, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 078/100, Runtime 13.128089, Loss 0.074808, forward nfe 32188, backward nfe 126831, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 079/100, Runtime 12.125197, Loss 0.062611, forward nfe 32600, backward nfe 127970, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 080/100, Runtime 13.474265, Loss 0.075903, forward nfe 33012, backward nfe 129250, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 081/100, Runtime 11.487144, Loss 0.076617, forward nfe 33424, backward nfe 130317, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 082/100, Runtime 10.757028, Loss 0.053317, forward nfe 33842, backward nfe 131310, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 083/100, Runtime 12.501987, Loss 0.089606, forward nfe 34254, backward nfe 132462, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 084/100, Runtime 14.298548, Loss 0.048199, forward nfe 34666, backward nfe 133819, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 085/100, Runtime 11.516461, Loss 0.060544, forward nfe 35084, backward nfe 134873, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 086/100, Runtime 18.185292, Loss 0.043221, forward nfe 35484, backward nfe 136658, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 087/100, Runtime 13.184518, Loss 0.043752, forward nfe 35896, backward nfe 137906, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 088/100, Runtime 17.637707, Loss 0.049755, forward nfe 36296, backward nfe 139639, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 089/100, Runtime 17.453264, Loss 0.041486, forward nfe 36696, backward nfe 141327, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 090/100, Runtime 16.735798, Loss 0.036095, forward nfe 37096, backward nfe 142935, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 091/100, Runtime 17.281737, Loss 0.069472, forward nfe 37496, backward nfe 144638, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 092/100, Runtime 17.826445, Loss 0.050995, forward nfe 37896, backward nfe 146364, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 093/100, Runtime 16.330125, Loss 0.047180, forward nfe 38296, backward nfe 147966, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 094/100, Runtime 17.448898, Loss 0.045712, forward nfe 38690, backward nfe 149671, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 095/100, Runtime 16.482334, Loss 0.077065, forward nfe 39084, backward nfe 151272, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 096/100, Runtime 17.513368, Loss 0.039973, forward nfe 39478, backward nfe 153001, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 097/100, Runtime 17.043954, Loss 0.100601, forward nfe 39872, backward nfe 154676, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 098/100, Runtime 15.351993, Loss 0.064980, forward nfe 40266, backward nfe 156162, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
Epoch: 099/100, Runtime 15.234947, Loss 0.043759, forward nfe 40660, backward nfe 157631, Train: 1.0000, Val: 0.8160, Test: 0.8135, Best time: 35.0000
best val accuracy 0.815972 with test accuracy 0.813471 at epoch 56 and best time 35.000000