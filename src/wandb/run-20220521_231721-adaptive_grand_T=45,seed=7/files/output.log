/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 2.901239, Loss 1.947471, forward nfe 98, backward nfe 0, Train: 0.2714, Val: 0.4397, Test: 0.4152, Best time: 7.5718
Epoch: 002/100, Runtime 2.910319, Loss 1.870188, forward nfe 456, backward nfe 0, Train: 0.5357, Val: 0.5625, Test: 0.5878, Best time: 3.7694
Epoch: 003/100, Runtime 2.832958, Loss 1.705611, forward nfe 808, backward nfe 0, Train: 0.6643, Val: 0.6426, Test: 0.6386, Best time: 5.5974
Epoch: 004/100, Runtime 2.786362, Loss 1.453683, forward nfe 1154, backward nfe 0, Train: 0.7286, Val: 0.7346, Test: 0.7228, Best time: 18.2964
Epoch: 005/100, Runtime 2.542391, Loss 1.242760, forward nfe 1482, backward nfe 0, Train: 0.7786, Val: 0.7662, Test: 0.7635, Best time: 36.3882
Epoch: 006/100, Runtime 2.455855, Loss 1.044978, forward nfe 1804, backward nfe 0, Train: 0.8000, Val: 0.7963, Test: 0.7685, Best time: 101.9108
Epoch: 007/100, Runtime 2.397730, Loss 0.842019, forward nfe 2126, backward nfe 0, Train: 0.8000, Val: 0.7963, Test: 0.7685, Best time: 45.0000
Epoch: 008/100, Runtime 2.362857, Loss 0.725436, forward nfe 2442, backward nfe 0, Train: 0.8000, Val: 0.7963, Test: 0.7685, Best time: 45.0000
Epoch: 009/100, Runtime 2.314835, Loss 0.629312, forward nfe 2746, backward nfe 0, Train: 0.8571, Val: 0.8066, Test: 0.7888, Best time: 59.9920
Epoch: 010/100, Runtime 2.376275, Loss 0.519214, forward nfe 3038, backward nfe 0, Train: 0.8714, Val: 0.8279, Test: 0.8112, Best time: 37.8825
Epoch: 011/100, Runtime 2.407141, Loss 0.488219, forward nfe 3330, backward nfe 0, Train: 0.8714, Val: 0.8279, Test: 0.8112, Best time: 45.0000
Epoch: 012/100, Runtime 2.243893, Loss 0.464146, forward nfe 3604, backward nfe 0, Train: 0.8714, Val: 0.8279, Test: 0.8112, Best time: 45.0000
Epoch: 013/100, Runtime 2.159766, Loss 0.389692, forward nfe 3866, backward nfe 0, Train: 0.8714, Val: 0.8279, Test: 0.8112, Best time: 45.0000
Epoch: 014/100, Runtime 2.137351, Loss 0.420769, forward nfe 4128, backward nfe 0, Train: 0.8714, Val: 0.8279, Test: 0.8112, Best time: 45.0000
Epoch: 015/100, Runtime 2.099665, Loss 0.414833, forward nfe 4390, backward nfe 0, Train: 0.8714, Val: 0.8279, Test: 0.8112, Best time: 45.0000
Epoch: 016/100, Runtime 2.044523, Loss 0.366524, forward nfe 4646, backward nfe 0, Train: 0.8714, Val: 0.8279, Test: 0.8112, Best time: 45.0000
Epoch: 017/100, Runtime 2.018011, Loss 0.373011, forward nfe 4902, backward nfe 0, Train: 0.8714, Val: 0.8279, Test: 0.8112, Best time: 45.0000
Epoch: 018/100, Runtime 1.966570, Loss 0.332261, forward nfe 5140, backward nfe 0, Train: 0.8714, Val: 0.8279, Test: 0.8112, Best time: 45.0000
Epoch: 019/100, Runtime 1.868789, Loss 0.359609, forward nfe 5372, backward nfe 0, Train: 0.8714, Val: 0.8279, Test: 0.8112, Best time: 45.0000
Epoch: 020/100, Runtime 1.907469, Loss 0.315563, forward nfe 5598, backward nfe 0, Train: 0.9143, Val: 0.8287, Test: 0.8142, Best time: 101.6179
Epoch: 021/100, Runtime 1.949986, Loss 0.341335, forward nfe 5830, backward nfe 0, Train: 0.9500, Val: 0.8397, Test: 0.8244, Best time: 58.6669
Epoch: 022/100, Runtime 1.813067, Loss 0.324834, forward nfe 6068, backward nfe 0, Train: 0.8857, Val: 0.8471, Test: 0.8010, Best time: 98.9476
Epoch: 023/100, Runtime 1.710679, Loss 0.315126, forward nfe 6300, backward nfe 0, Train: 0.8857, Val: 0.8471, Test: 0.8010, Best time: 45.0000
Epoch: 024/100, Runtime 1.659307, Loss 0.292396, forward nfe 6514, backward nfe 0, Train: 0.8857, Val: 0.8471, Test: 0.8010, Best time: 45.0000
Epoch: 025/100, Runtime 1.684597, Loss 0.245190, forward nfe 6722, backward nfe 0, Train: 0.8857, Val: 0.8471, Test: 0.8010, Best time: 45.0000
Epoch: 026/100, Runtime 1.689427, Loss 0.258879, forward nfe 6924, backward nfe 0, Train: 0.8857, Val: 0.8471, Test: 0.8010, Best time: 45.0000
Epoch: 027/100, Runtime 1.553789, Loss 0.260884, forward nfe 7132, backward nfe 0, Train: 0.9429, Val: 0.8493, Test: 0.8132, Best time: 102.5126
Epoch: 028/100, Runtime 1.621408, Loss 0.212689, forward nfe 7334, backward nfe 0, Train: 0.9429, Val: 0.8493, Test: 0.8132, Best time: 45.0000
Epoch: 029/100, Runtime 1.580971, Loss 0.270469, forward nfe 7542, backward nfe 0, Train: 0.9429, Val: 0.8493, Test: 0.8132, Best time: 45.0000
Epoch: 030/100, Runtime 1.528852, Loss 0.195407, forward nfe 7738, backward nfe 0, Train: 0.9429, Val: 0.8493, Test: 0.8132, Best time: 45.0000
Epoch: 031/100, Runtime 1.452184, Loss 0.259650, forward nfe 7928, backward nfe 0, Train: 0.9429, Val: 0.8493, Test: 0.8132, Best time: 45.0000
Epoch: 032/100, Runtime 1.466262, Loss 0.274931, forward nfe 8118, backward nfe 0, Train: 0.9429, Val: 0.8493, Test: 0.8132, Best time: 45.0000
Epoch: 033/100, Runtime 1.418209, Loss 0.244535, forward nfe 8308, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8244, Best time: 95.7788
Epoch: 034/100, Runtime 1.483374, Loss 0.177570, forward nfe 8498, backward nfe 0, Train: 0.9357, Val: 0.8529, Test: 0.8244, Best time: 45.0000
Epoch: 035/100, Runtime 1.407251, Loss 0.234758, forward nfe 8682, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 036/100, Runtime 1.473073, Loss 0.164700, forward nfe 8860, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 037/100, Runtime 1.426131, Loss 0.180616, forward nfe 9038, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 038/100, Runtime 1.392967, Loss 0.141208, forward nfe 9216, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 039/100, Runtime 1.320614, Loss 0.200059, forward nfe 9388, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 040/100, Runtime 1.425182, Loss 0.126436, forward nfe 9560, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 041/100, Runtime 1.452972, Loss 0.147558, forward nfe 9732, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 042/100, Runtime 1.389438, Loss 0.172837, forward nfe 9904, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 043/100, Runtime 1.387155, Loss 0.159443, forward nfe 10076, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 044/100, Runtime 1.424266, Loss 0.145695, forward nfe 10248, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 045/100, Runtime 1.338736, Loss 0.123534, forward nfe 10420, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 046/100, Runtime 1.315405, Loss 0.192574, forward nfe 10586, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 047/100, Runtime 1.445850, Loss 0.088061, forward nfe 10752, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 048/100, Runtime 1.422153, Loss 0.113690, forward nfe 10918, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 049/100, Runtime 1.313285, Loss 0.172818, forward nfe 11084, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 050/100, Runtime 1.450750, Loss 0.152538, forward nfe 11244, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 051/100, Runtime 1.447847, Loss 0.138436, forward nfe 11410, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 052/100, Runtime 1.406430, Loss 0.145090, forward nfe 11576, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 053/100, Runtime 1.376504, Loss 0.123825, forward nfe 11742, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 054/100, Runtime 1.425622, Loss 0.124145, forward nfe 11908, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 055/100, Runtime 1.442353, Loss 0.163028, forward nfe 12074, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 056/100, Runtime 1.356324, Loss 0.107092, forward nfe 12240, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 057/100, Runtime 1.434038, Loss 0.121339, forward nfe 12406, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 058/100, Runtime 1.458775, Loss 0.076035, forward nfe 12572, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 059/100, Runtime 1.425899, Loss 0.107793, forward nfe 12738, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 060/100, Runtime 1.397074, Loss 0.089322, forward nfe 12904, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 061/100, Runtime 1.440976, Loss 0.082119, forward nfe 13070, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 062/100, Runtime 1.428748, Loss 0.096319, forward nfe 13242, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 063/100, Runtime 1.471615, Loss 0.140921, forward nfe 13414, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 064/100, Runtime 1.465751, Loss 0.098545, forward nfe 13586, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 065/100, Runtime 1.393214, Loss 0.134000, forward nfe 13758, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 066/100, Runtime 1.431893, Loss 0.124386, forward nfe 13924, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 067/100, Runtime 1.475656, Loss 0.080935, forward nfe 14096, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 068/100, Runtime 1.477526, Loss 0.100116, forward nfe 14268, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 069/100, Runtime 1.480253, Loss 0.097609, forward nfe 14440, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 070/100, Runtime 1.377870, Loss 0.078688, forward nfe 14612, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 071/100, Runtime 1.455791, Loss 0.061799, forward nfe 14784, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 072/100, Runtime 1.472476, Loss 0.101188, forward nfe 14956, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 073/100, Runtime 1.471128, Loss 0.099521, forward nfe 15128, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 074/100, Runtime 1.394871, Loss 0.039653, forward nfe 15300, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 075/100, Runtime 1.482980, Loss 0.075017, forward nfe 15472, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 076/100, Runtime 1.477335, Loss 0.086239, forward nfe 15644, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 077/100, Runtime 1.478644, Loss 0.082261, forward nfe 15816, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 078/100, Runtime 1.400810, Loss 0.050212, forward nfe 15988, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 079/100, Runtime 1.428177, Loss 0.056818, forward nfe 16154, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 080/100, Runtime 1.417939, Loss 0.065833, forward nfe 16320, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 081/100, Runtime 1.353581, Loss 0.057654, forward nfe 16486, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 082/100, Runtime 1.474132, Loss 0.057904, forward nfe 16652, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 083/100, Runtime 1.501449, Loss 0.049846, forward nfe 16824, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 084/100, Runtime 1.520887, Loss 0.047331, forward nfe 17002, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 085/100, Runtime 1.554942, Loss 0.053786, forward nfe 17180, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 086/100, Runtime 1.506423, Loss 0.057864, forward nfe 17364, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 087/100, Runtime 1.516777, Loss 0.070152, forward nfe 17542, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 088/100, Runtime 1.466484, Loss 0.029586, forward nfe 17720, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 089/100, Runtime 1.698067, Loss 0.035157, forward nfe 17892, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 090/100, Runtime 1.582903, Loss 0.065339, forward nfe 18064, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 091/100, Runtime 1.848152, Loss 0.047053, forward nfe 18236, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 092/100, Runtime 1.772889, Loss 0.026092, forward nfe 18408, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 093/100, Runtime 1.864830, Loss 0.046579, forward nfe 18580, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 094/100, Runtime 1.943803, Loss 0.032296, forward nfe 18758, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 095/100, Runtime 1.881876, Loss 0.043424, forward nfe 18936, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 096/100, Runtime 2.043781, Loss 0.046674, forward nfe 19114, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 097/100, Runtime 1.951042, Loss 0.061118, forward nfe 19298, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 098/100, Runtime 1.978241, Loss 0.023703, forward nfe 19482, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
Epoch: 099/100, Runtime 2.033686, Loss 0.043098, forward nfe 19666, backward nfe 0, Train: 0.9643, Val: 0.8544, Test: 0.8274, Best time: 45.0000
best val accuracy 0.854412 with test accuracy 0.827411 at epoch 35 and best time 45.000000