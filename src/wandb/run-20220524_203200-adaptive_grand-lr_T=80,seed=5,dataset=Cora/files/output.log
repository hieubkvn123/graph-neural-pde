/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 6.156169, Loss 1.946035, forward nfe 152, backward nfe 0, Train: 0.3143, Val: 0.2434, Test: 0.2873, Best time: 10.3021
Epoch: 002/100, Runtime 5.913437, Loss 1.832304, forward nfe 732, backward nfe 0, Train: 0.6714, Val: 0.5515, Test: 0.5868, Best time: 3.8049
Epoch: 003/100, Runtime 5.982226, Loss 1.598985, forward nfe 1306, backward nfe 0, Train: 0.7643, Val: 0.7074, Test: 0.7391, Best time: 10.3398
Epoch: 004/100, Runtime 5.821405, Loss 1.350345, forward nfe 1862, backward nfe 0, Train: 0.7714, Val: 0.7346, Test: 0.7635, Best time: 10.5936
Epoch: 005/100, Runtime 5.694404, Loss 1.152289, forward nfe 2406, backward nfe 0, Train: 0.7714, Val: 0.7412, Test: 0.7574, Best time: 124.5018
Epoch: 006/100, Runtime 7.061523, Loss 0.952510, forward nfe 2944, backward nfe 0, Train: 0.7929, Val: 0.7522, Test: 0.7635, Best time: 26.7914
Epoch: 007/100, Runtime 6.682622, Loss 0.838414, forward nfe 3470, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.8102, Best time: 8.9053
Epoch: 008/100, Runtime 6.557875, Loss 0.744178, forward nfe 3972, backward nfe 0, Train: 0.8000, Val: 0.7985, Test: 0.8203, Best time: 109.0295
Epoch: 009/100, Runtime 6.358400, Loss 0.695361, forward nfe 4456, backward nfe 0, Train: 0.8000, Val: 0.7985, Test: 0.8203, Best time: 80.0000
Epoch: 010/100, Runtime 6.383492, Loss 0.594756, forward nfe 4922, backward nfe 0, Train: 0.8000, Val: 0.7985, Test: 0.8203, Best time: 80.0000
Epoch: 011/100, Runtime 6.199387, Loss 0.591338, forward nfe 5376, backward nfe 0, Train: 0.8714, Val: 0.8118, Test: 0.8284, Best time: 20.0247
Epoch: 012/100, Runtime 5.123568, Loss 0.588962, forward nfe 5830, backward nfe 0, Train: 0.8714, Val: 0.8118, Test: 0.8284, Best time: 80.0000
Epoch: 013/100, Runtime 4.633539, Loss 0.564726, forward nfe 6272, backward nfe 0, Train: 0.8714, Val: 0.8118, Test: 0.8284, Best time: 80.0000
Epoch: 014/100, Runtime 4.385923, Loss 0.492837, forward nfe 6702, backward nfe 0, Train: 0.8714, Val: 0.8118, Test: 0.8284, Best time: 80.0000
Epoch: 015/100, Runtime 4.191768, Loss 0.518724, forward nfe 7114, backward nfe 0, Train: 0.8857, Val: 0.8132, Test: 0.8518, Best time: 83.9742
Epoch: 016/100, Runtime 4.167690, Loss 0.482410, forward nfe 7514, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 72.1597
Epoch: 017/100, Runtime 4.138772, Loss 0.483512, forward nfe 7902, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 018/100, Runtime 3.930475, Loss 0.474399, forward nfe 8278, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 019/100, Runtime 3.956023, Loss 0.500669, forward nfe 8648, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 020/100, Runtime 4.025406, Loss 0.435683, forward nfe 9024, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 021/100, Runtime 3.669224, Loss 0.490319, forward nfe 9388, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 022/100, Runtime 3.508078, Loss 0.431088, forward nfe 9746, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 023/100, Runtime 3.549007, Loss 0.497162, forward nfe 10086, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 024/100, Runtime 3.421817, Loss 0.470404, forward nfe 10414, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 025/100, Runtime 3.089715, Loss 0.425154, forward nfe 10730, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 026/100, Runtime 3.159909, Loss 0.436448, forward nfe 11046, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 027/100, Runtime 3.162480, Loss 0.458058, forward nfe 11356, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 028/100, Runtime 3.146514, Loss 0.336007, forward nfe 11666, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 029/100, Runtime 3.059722, Loss 0.419892, forward nfe 11952, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 030/100, Runtime 3.083975, Loss 0.341407, forward nfe 12238, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 031/100, Runtime 2.851022, Loss 0.311705, forward nfe 12518, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 032/100, Runtime 2.831177, Loss 0.356258, forward nfe 12786, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 033/100, Runtime 2.821865, Loss 0.301818, forward nfe 13054, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 034/100, Runtime 2.883467, Loss 0.242236, forward nfe 13310, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 035/100, Runtime 2.801338, Loss 0.261435, forward nfe 13566, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 036/100, Runtime 2.559131, Loss 0.242285, forward nfe 13816, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 037/100, Runtime 2.730737, Loss 0.264678, forward nfe 14060, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 038/100, Runtime 2.700825, Loss 0.271417, forward nfe 14310, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 039/100, Runtime 2.556485, Loss 0.302953, forward nfe 14554, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 040/100, Runtime 2.715373, Loss 0.233268, forward nfe 14798, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 041/100, Runtime 2.670697, Loss 0.260183, forward nfe 15042, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 042/100, Runtime 2.581583, Loss 0.284018, forward nfe 15286, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 043/100, Runtime 2.461082, Loss 0.200854, forward nfe 15512, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 044/100, Runtime 2.474559, Loss 0.261036, forward nfe 15732, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 045/100, Runtime 2.258130, Loss 0.202313, forward nfe 15952, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 046/100, Runtime 2.276412, Loss 0.157238, forward nfe 16172, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 047/100, Runtime 2.251269, Loss 0.178424, forward nfe 16386, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 048/100, Runtime 2.303038, Loss 0.172486, forward nfe 16600, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 049/100, Runtime 2.350129, Loss 0.183082, forward nfe 16814, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 050/100, Runtime 2.416101, Loss 0.135484, forward nfe 17028, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 051/100, Runtime 2.391171, Loss 0.154803, forward nfe 17242, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 052/100, Runtime 2.378803, Loss 0.169500, forward nfe 17456, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 053/100, Runtime 2.205217, Loss 0.109980, forward nfe 17670, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 054/100, Runtime 2.260418, Loss 0.127532, forward nfe 17872, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 055/100, Runtime 2.189162, Loss 0.138846, forward nfe 18074, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 056/100, Runtime 2.182086, Loss 0.113876, forward nfe 18276, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 057/100, Runtime 2.359404, Loss 0.147910, forward nfe 18478, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 058/100, Runtime 2.971446, Loss 0.118050, forward nfe 18680, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 059/100, Runtime 2.937831, Loss 0.103491, forward nfe 18882, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 060/100, Runtime 2.904836, Loss 0.177902, forward nfe 19084, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 061/100, Runtime 2.898734, Loss 0.089041, forward nfe 19286, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 062/100, Runtime 2.926745, Loss 0.115161, forward nfe 19488, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 063/100, Runtime 2.898723, Loss 0.133793, forward nfe 19690, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 064/100, Runtime 2.881088, Loss 0.074385, forward nfe 19892, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 065/100, Runtime 2.902851, Loss 0.102944, forward nfe 20094, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 066/100, Runtime 2.922623, Loss 0.112529, forward nfe 20296, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 067/100, Runtime 2.923185, Loss 0.076834, forward nfe 20498, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 068/100, Runtime 2.957146, Loss 0.085813, forward nfe 20700, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 069/100, Runtime 2.961504, Loss 0.091844, forward nfe 20902, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 070/100, Runtime 3.009130, Loss 0.110825, forward nfe 21104, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 071/100, Runtime 2.935637, Loss 0.099019, forward nfe 21306, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 072/100, Runtime 2.964995, Loss 0.082108, forward nfe 21508, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 073/100, Runtime 2.918252, Loss 0.051828, forward nfe 21710, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 074/100, Runtime 2.957706, Loss 0.145069, forward nfe 21912, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 075/100, Runtime 2.893800, Loss 0.081469, forward nfe 22114, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 076/100, Runtime 2.903018, Loss 0.081726, forward nfe 22316, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 077/100, Runtime 2.806586, Loss 0.083736, forward nfe 22518, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 078/100, Runtime 2.854064, Loss 0.097149, forward nfe 22714, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 079/100, Runtime 2.731367, Loss 0.088717, forward nfe 22910, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 080/100, Runtime 2.842501, Loss 0.092420, forward nfe 23100, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 081/100, Runtime 2.885540, Loss 0.069563, forward nfe 23296, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 082/100, Runtime 2.830217, Loss 0.057613, forward nfe 23492, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 083/100, Runtime 2.704512, Loss 0.091424, forward nfe 23688, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 084/100, Runtime 2.719703, Loss 0.073932, forward nfe 23878, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 085/100, Runtime 2.271559, Loss 0.045281, forward nfe 24068, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 086/100, Runtime 1.859712, Loss 0.101899, forward nfe 24258, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 087/100, Runtime 1.994012, Loss 0.089014, forward nfe 24442, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 088/100, Runtime 1.990662, Loss 0.039196, forward nfe 24632, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 089/100, Runtime 2.089128, Loss 0.051925, forward nfe 24816, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 090/100, Runtime 1.957491, Loss 0.072179, forward nfe 25000, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 091/100, Runtime 2.123552, Loss 0.083096, forward nfe 25184, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 092/100, Runtime 1.979089, Loss 0.032724, forward nfe 25374, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 093/100, Runtime 2.066764, Loss 0.073484, forward nfe 25558, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 094/100, Runtime 2.216055, Loss 0.060420, forward nfe 25742, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 095/100, Runtime 2.146362, Loss 0.081455, forward nfe 25932, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 096/100, Runtime 2.464712, Loss 0.087941, forward nfe 26122, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 097/100, Runtime 2.051656, Loss 0.027938, forward nfe 26324, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 098/100, Runtime 2.242519, Loss 0.049594, forward nfe 26526, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
Epoch: 099/100, Runtime 2.394628, Loss 0.067591, forward nfe 26734, backward nfe 0, Train: 0.8929, Val: 0.8162, Test: 0.8406, Best time: 80.0000
best val accuracy 0.816176 with test accuracy 0.840609 at epoch 16 and best time 80.000000