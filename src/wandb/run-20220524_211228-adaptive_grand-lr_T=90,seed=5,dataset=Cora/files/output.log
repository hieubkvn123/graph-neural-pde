/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.813848, Loss 1.949859, forward nfe 170, backward nfe 0, Train: 0.1357, Val: 0.2868, Test: 0.3147, Best time: 204.8538
Epoch: 002/100, Runtime 0.721807, Loss 2.014598, forward nfe 834, backward nfe 0, Train: 0.1429, Val: 0.2897, Test: 0.3168, Best time: 90.0000
Epoch: 003/100, Runtime 0.725122, Loss 1.960750, forward nfe 1480, backward nfe 0, Train: 0.1429, Val: 0.2897, Test: 0.3168, Best time: 90.0000
Epoch: 004/100, Runtime 0.694686, Loss 1.925289, forward nfe 2126, backward nfe 0, Train: 0.1429, Val: 0.2897, Test: 0.3168, Best time: 90.0000
Epoch: 005/100, Runtime 0.672782, Loss 1.908337, forward nfe 2766, backward nfe 0, Train: 0.1429, Val: 0.2897, Test: 0.3168, Best time: 90.0000
Epoch: 006/100, Runtime 0.661496, Loss 1.866092, forward nfe 3376, backward nfe 0, Train: 0.4929, Val: 0.4316, Test: 0.4020, Best time: 7.1209
Epoch: 007/100, Runtime 0.646163, Loss 1.816377, forward nfe 3980, backward nfe 0, Train: 0.6571, Val: 0.6287, Test: 0.6071, Best time: 21.7313
Epoch: 008/100, Runtime 0.622360, Loss 1.745531, forward nfe 4560, backward nfe 0, Train: 0.6714, Val: 0.6574, Test: 0.6335, Best time: 7.7588
Epoch: 009/100, Runtime 0.620021, Loss 1.638498, forward nfe 5134, backward nfe 0, Train: 0.6714, Val: 0.6574, Test: 0.6335, Best time: 90.0000
Epoch: 010/100, Runtime 0.583092, Loss 1.539806, forward nfe 5684, backward nfe 0, Train: 0.7143, Val: 0.7029, Test: 0.7086, Best time: 6.1449
Epoch: 011/100, Runtime 0.597011, Loss 1.395585, forward nfe 6228, backward nfe 0, Train: 0.8143, Val: 0.7610, Test: 0.7726, Best time: 8.8258
Epoch: 012/100, Runtime 0.580823, Loss 1.262808, forward nfe 6760, backward nfe 0, Train: 0.8143, Val: 0.7610, Test: 0.7726, Best time: 90.0000
Epoch: 013/100, Runtime 0.560117, Loss 1.114574, forward nfe 7280, backward nfe 0, Train: 0.8143, Val: 0.7610, Test: 0.7726, Best time: 90.0000
Epoch: 014/100, Runtime 0.559232, Loss 1.103786, forward nfe 7794, backward nfe 0, Train: 0.8143, Val: 0.7706, Test: 0.7807, Best time: 13.3626
Epoch: 015/100, Runtime 0.537798, Loss 0.893683, forward nfe 8302, backward nfe 0, Train: 0.8714, Val: 0.8125, Test: 0.8254, Best time: 32.6881
Epoch: 016/100, Runtime 0.525823, Loss 0.851653, forward nfe 8792, backward nfe 0, Train: 0.8571, Val: 0.8199, Test: 0.8152, Best time: 25.7799
Epoch: 017/100, Runtime 0.507457, Loss 0.749967, forward nfe 9270, backward nfe 0, Train: 0.8571, Val: 0.8199, Test: 0.8152, Best time: 90.0000
Epoch: 018/100, Runtime 0.500501, Loss 0.721309, forward nfe 9724, backward nfe 0, Train: 0.8571, Val: 0.8199, Test: 0.8152, Best time: 90.0000
Epoch: 019/100, Runtime 0.498660, Loss 0.638603, forward nfe 10172, backward nfe 0, Train: 0.8571, Val: 0.8199, Test: 0.8152, Best time: 90.0000
Epoch: 020/100, Runtime 0.485527, Loss 0.612832, forward nfe 10602, backward nfe 0, Train: 0.8571, Val: 0.8199, Test: 0.8152, Best time: 90.0000
Epoch: 021/100, Runtime 0.460012, Loss 0.641246, forward nfe 11026, backward nfe 0, Train: 0.8571, Val: 0.8199, Test: 0.8152, Best time: 90.0000
Epoch: 022/100, Runtime 0.456101, Loss 0.517783, forward nfe 11438, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 26.3335
Epoch: 023/100, Runtime 0.449081, Loss 0.495415, forward nfe 11850, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 024/100, Runtime 0.444996, Loss 0.481225, forward nfe 12256, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 025/100, Runtime 0.429713, Loss 0.481006, forward nfe 12650, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 026/100, Runtime 0.410834, Loss 0.413106, forward nfe 13026, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 027/100, Runtime 0.412925, Loss 0.449851, forward nfe 13390, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 028/100, Runtime 0.410401, Loss 0.377268, forward nfe 13742, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 029/100, Runtime 0.400734, Loss 0.376053, forward nfe 14100, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 030/100, Runtime 0.411976, Loss 0.368997, forward nfe 14458, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 031/100, Runtime 0.398775, Loss 0.352493, forward nfe 14816, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 032/100, Runtime 0.387880, Loss 0.309151, forward nfe 15150, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 033/100, Runtime 0.379595, Loss 0.303168, forward nfe 15484, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 034/100, Runtime 0.384016, Loss 0.309494, forward nfe 15818, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 035/100, Runtime 0.377598, Loss 0.287065, forward nfe 16158, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 036/100, Runtime 0.378463, Loss 0.313748, forward nfe 16486, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 037/100, Runtime 0.350955, Loss 0.273162, forward nfe 16808, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 038/100, Runtime 0.343875, Loss 0.229156, forward nfe 17118, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 039/100, Runtime 0.345833, Loss 0.224503, forward nfe 17422, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 040/100, Runtime 0.347583, Loss 0.274534, forward nfe 17726, backward nfe 0, Train: 0.8857, Val: 0.8279, Test: 0.8437, Best time: 90.0000
Epoch: 041/100, Runtime 0.341195, Loss 0.234877, forward nfe 18030, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 97.5023
Epoch: 042/100, Runtime 0.339569, Loss 0.235909, forward nfe 18334, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 043/100, Runtime 0.364182, Loss 0.182608, forward nfe 18632, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 044/100, Runtime 0.346284, Loss 0.156651, forward nfe 18930, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 045/100, Runtime 0.341487, Loss 0.242963, forward nfe 19228, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 046/100, Runtime 0.324986, Loss 0.152807, forward nfe 19520, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 047/100, Runtime 0.315522, Loss 0.130323, forward nfe 19812, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 048/100, Runtime 0.325543, Loss 0.182324, forward nfe 20098, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 049/100, Runtime 0.338605, Loss 0.174014, forward nfe 20384, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 050/100, Runtime 0.316116, Loss 0.109348, forward nfe 20670, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 051/100, Runtime 0.313481, Loss 0.149968, forward nfe 20944, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 052/100, Runtime 0.317577, Loss 0.139012, forward nfe 21218, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 053/100, Runtime 0.310712, Loss 0.106751, forward nfe 21492, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 054/100, Runtime 0.307002, Loss 0.124050, forward nfe 21766, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 055/100, Runtime 0.314668, Loss 0.115722, forward nfe 22040, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 056/100, Runtime 0.316129, Loss 0.147284, forward nfe 22314, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 057/100, Runtime 0.316283, Loss 0.122729, forward nfe 22588, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 058/100, Runtime 0.332817, Loss 0.093072, forward nfe 22862, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 059/100, Runtime 0.315926, Loss 0.105565, forward nfe 23136, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 060/100, Runtime 0.311277, Loss 0.128919, forward nfe 23410, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 061/100, Runtime 0.309563, Loss 0.110706, forward nfe 23672, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 062/100, Runtime 0.302258, Loss 0.098928, forward nfe 23934, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 063/100, Runtime 0.298976, Loss 0.138878, forward nfe 24196, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 064/100, Runtime 0.311298, Loss 0.085986, forward nfe 24458, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 065/100, Runtime 0.299057, Loss 0.098792, forward nfe 24720, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 066/100, Runtime 0.301169, Loss 0.088231, forward nfe 24982, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 067/100, Runtime 0.307271, Loss 0.108638, forward nfe 25250, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 068/100, Runtime 0.299872, Loss 0.119521, forward nfe 25518, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 069/100, Runtime 0.295723, Loss 0.097710, forward nfe 25786, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 070/100, Runtime 0.302541, Loss 0.073767, forward nfe 26054, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 071/100, Runtime 0.315498, Loss 0.046332, forward nfe 26322, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 072/100, Runtime 0.308281, Loss 0.068360, forward nfe 26590, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 073/100, Runtime 0.297041, Loss 0.080578, forward nfe 26858, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 074/100, Runtime 0.298883, Loss 0.091447, forward nfe 27126, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 075/100, Runtime 0.305975, Loss 0.098557, forward nfe 27394, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 076/100, Runtime 0.307842, Loss 0.056618, forward nfe 27662, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 077/100, Runtime 0.313755, Loss 0.113010, forward nfe 27930, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 078/100, Runtime 0.308161, Loss 0.093403, forward nfe 28198, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 079/100, Runtime 0.298301, Loss 0.115768, forward nfe 28466, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 080/100, Runtime 0.297988, Loss 0.068420, forward nfe 28734, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 081/100, Runtime 0.303149, Loss 0.058097, forward nfe 29002, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 082/100, Runtime 0.301133, Loss 0.046788, forward nfe 29270, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 083/100, Runtime 0.298614, Loss 0.074178, forward nfe 29538, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 084/100, Runtime 0.309322, Loss 0.080327, forward nfe 29806, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 085/100, Runtime 0.287414, Loss 0.048276, forward nfe 30068, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 086/100, Runtime 0.298301, Loss 0.064291, forward nfe 30324, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 087/100, Runtime 0.285465, Loss 0.059640, forward nfe 30580, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 088/100, Runtime 0.419997, Loss 0.048731, forward nfe 30836, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 089/100, Runtime 0.289237, Loss 0.077336, forward nfe 31092, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 090/100, Runtime 0.287797, Loss 0.069435, forward nfe 31348, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 091/100, Runtime 0.298926, Loss 0.060284, forward nfe 31604, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 092/100, Runtime 0.288924, Loss 0.055397, forward nfe 31860, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 093/100, Runtime 0.288864, Loss 0.076282, forward nfe 32116, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 094/100, Runtime 0.287874, Loss 0.052116, forward nfe 32372, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 095/100, Runtime 0.299240, Loss 0.065070, forward nfe 32628, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 096/100, Runtime 0.295938, Loss 0.049389, forward nfe 32890, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 097/100, Runtime 0.296570, Loss 0.048934, forward nfe 33152, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 098/100, Runtime 0.304623, Loss 0.037927, forward nfe 33414, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
Epoch: 099/100, Runtime 0.297698, Loss 0.038151, forward nfe 33676, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8467, Best time: 90.0000
best val accuracy 0.847794 with test accuracy 0.846701 at epoch 41 and best time 90.000000