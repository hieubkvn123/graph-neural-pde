****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.596195, Loss 1.793920, forward nfe 146, backward nfe 0, Train: 0.2083, Val: 0.1630, Test: 0.1597, Best time: 6.0660
Epoch: 002/100, Runtime 0.541552, Loss 1.778608, forward nfe 606, backward nfe 0, Train: 0.4583, Val: 0.3971, Test: 0.4452, Best time: 0.0371
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 003/100, Runtime 0.538489, Loss 1.745572, forward nfe 1072, backward nfe 0, Train: 0.4833, Val: 0.4101, Test: 0.4435, Best time: 0.2795
Epoch: 004/100, Runtime 0.550806, Loss 1.741508, forward nfe 1532, backward nfe 0, Train: 0.5167, Val: 0.4536, Test: 0.4968, Best time: 0.0367
Epoch: 005/100, Runtime 0.522430, Loss 1.685858, forward nfe 1992, backward nfe 0, Train: 0.5250, Val: 0.5290, Test: 0.5435, Best time: 52.4988
Epoch: 006/100, Runtime 0.518571, Loss 1.659349, forward nfe 2440, backward nfe 0, Train: 0.6500, Val: 0.5725, Test: 0.6000, Best time: 33.6762
Epoch: 007/100, Runtime 0.509992, Loss 1.680912, forward nfe 2882, backward nfe 0, Train: 0.7000, Val: 0.6428, Test: 0.6484, Best time: 47.5836
Epoch: 008/100, Runtime 0.499357, Loss 1.615425, forward nfe 3318, backward nfe 0, Train: 0.7500, Val: 0.7217, Test: 0.7484, Best time: 16.8690
Epoch: 009/100, Runtime 0.495968, Loss 1.622705, forward nfe 3748, backward nfe 0, Train: 0.7500, Val: 0.7217, Test: 0.7484, Best time: 45.0000
Epoch: 010/100, Runtime 0.482887, Loss 1.588830, forward nfe 4178, backward nfe 0, Train: 0.7500, Val: 0.7217, Test: 0.7484, Best time: 45.0000
Epoch: 011/100, Runtime 0.484180, Loss 1.583028, forward nfe 4596, backward nfe 0, Train: 0.7500, Val: 0.7217, Test: 0.7484, Best time: 45.0000
Epoch: 012/100, Runtime 0.460216, Loss 1.574199, forward nfe 4996, backward nfe 0, Train: 0.7500, Val: 0.7217, Test: 0.7484, Best time: 45.0000
Epoch: 013/100, Runtime 0.456911, Loss 1.529587, forward nfe 5408, backward nfe 0, Train: 0.7500, Val: 0.7217, Test: 0.7484, Best time: 45.0000
Epoch: 014/100, Runtime 0.466669, Loss 1.558970, forward nfe 5808, backward nfe 0, Train: 0.7500, Val: 0.7217, Test: 0.7484, Best time: 45.0000
Epoch: 015/100, Runtime 0.443154, Loss 1.489088, forward nfe 6190, backward nfe 0, Train: 0.7500, Val: 0.7217, Test: 0.7484, Best time: 45.0000
Epoch: 016/100, Runtime 0.451716, Loss 1.471917, forward nfe 6566, backward nfe 0, Train: 0.7083, Val: 0.7370, Test: 0.7371, Best time: 31.2565
Epoch: 017/100, Runtime 0.438678, Loss 1.443157, forward nfe 6942, backward nfe 0, Train: 0.6917, Val: 0.7428, Test: 0.7403, Best time: 44.7204
Epoch: 018/100, Runtime 0.453771, Loss 1.348026, forward nfe 7330, backward nfe 0, Train: 0.6917, Val: 0.7435, Test: 0.7500, Best time: 62.4846
Epoch: 019/100, Runtime 0.442045, Loss 1.333103, forward nfe 7718, backward nfe 0, Train: 0.6917, Val: 0.7435, Test: 0.7500, Best time: 45.0000
Epoch: 020/100, Runtime 0.434871, Loss 1.252125, forward nfe 8094, backward nfe 0, Train: 0.6917, Val: 0.7435, Test: 0.7500, Best time: 45.0000
Epoch: 021/100, Runtime 0.422840, Loss 1.423704, forward nfe 8470, backward nfe 0, Train: 0.6917, Val: 0.7435, Test: 0.7500, Best time: 45.0000
Epoch: 022/100, Runtime 0.409722, Loss 1.331639, forward nfe 8828, backward nfe 0, Train: 0.6917, Val: 0.7435, Test: 0.7500, Best time: 45.0000
Epoch: 023/100, Runtime 0.418977, Loss 1.314982, forward nfe 9180, backward nfe 0, Train: 0.6917, Val: 0.7435, Test: 0.7500, Best time: 45.0000
Epoch: 024/100, Runtime 0.414295, Loss 1.394808, forward nfe 9532, backward nfe 0, Train: 0.6917, Val: 0.7435, Test: 0.7500, Best time: 45.0000
Epoch: 025/100, Runtime 0.417973, Loss 1.238458, forward nfe 9878, backward nfe 0, Train: 0.6917, Val: 0.7435, Test: 0.7500, Best time: 45.0000
Epoch: 026/100, Runtime 0.413711, Loss 1.257329, forward nfe 10224, backward nfe 0, Train: 0.6917, Val: 0.7435, Test: 0.7500, Best time: 45.0000
Epoch: 027/100, Runtime 0.410126, Loss 1.216726, forward nfe 10570, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 54.3857
Epoch: 028/100, Runtime 0.395149, Loss 1.180392, forward nfe 10910, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 029/100, Runtime 0.381240, Loss 1.291631, forward nfe 11238, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 030/100, Runtime 0.397121, Loss 1.153121, forward nfe 11560, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 031/100, Runtime 0.390786, Loss 1.218834, forward nfe 11882, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 032/100, Runtime 0.377836, Loss 1.229157, forward nfe 12198, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 033/100, Runtime 0.369601, Loss 1.317209, forward nfe 12514, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 034/100, Runtime 0.367896, Loss 1.214302, forward nfe 12830, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 035/100, Runtime 0.359970, Loss 1.312775, forward nfe 13140, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 036/100, Runtime 0.374123, Loss 1.188161, forward nfe 13444, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 037/100, Runtime 0.380032, Loss 1.326911, forward nfe 13742, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 038/100, Runtime 0.362761, Loss 1.168740, forward nfe 14040, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 039/100, Runtime 0.321655, Loss 1.106122, forward nfe 14332, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 040/100, Runtime 0.342908, Loss 1.075176, forward nfe 14618, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 041/100, Runtime 0.366552, Loss 1.101827, forward nfe 14904, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 042/100, Runtime 0.336801, Loss 1.213840, forward nfe 15190, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 043/100, Runtime 0.333204, Loss 1.130507, forward nfe 15464, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 044/100, Runtime 0.335882, Loss 1.267500, forward nfe 15738, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 045/100, Runtime 0.313653, Loss 1.310318, forward nfe 16006, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 046/100, Runtime 0.331594, Loss 1.217533, forward nfe 16280, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 047/100, Runtime 0.342716, Loss 1.192159, forward nfe 16554, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 048/100, Runtime 0.327175, Loss 1.090424, forward nfe 16822, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 049/100, Runtime 0.323249, Loss 1.169758, forward nfe 17090, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 050/100, Runtime 0.336184, Loss 1.216904, forward nfe 17358, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 051/100, Runtime 0.319461, Loss 1.435970, forward nfe 17626, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 052/100, Runtime 0.324461, Loss 1.221591, forward nfe 17894, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 053/100, Runtime 0.325373, Loss 1.163851, forward nfe 18156, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 054/100, Runtime 0.329562, Loss 1.226519, forward nfe 18418, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 055/100, Runtime 0.323072, Loss 1.178356, forward nfe 18680, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 056/100, Runtime 0.320646, Loss 1.235451, forward nfe 18942, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 057/100, Runtime 0.310341, Loss 1.173391, forward nfe 19198, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 058/100, Runtime 0.307673, Loss 1.173933, forward nfe 19454, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 059/100, Runtime 0.308300, Loss 1.203528, forward nfe 19710, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 060/100, Runtime 0.327414, Loss 1.198480, forward nfe 19966, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 061/100, Runtime 0.313166, Loss 1.155247, forward nfe 20222, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 062/100, Runtime 0.312387, Loss 1.197851, forward nfe 20478, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 063/100, Runtime 0.312280, Loss 1.154563, forward nfe 20734, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 064/100, Runtime 0.310565, Loss 1.076072, forward nfe 20990, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 065/100, Runtime 0.310520, Loss 1.026240, forward nfe 21246, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 066/100, Runtime 0.327787, Loss 1.225108, forward nfe 21502, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 067/100, Runtime 0.450835, Loss 1.038279, forward nfe 21758, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 068/100, Runtime 0.303118, Loss 1.249136, forward nfe 22014, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 069/100, Runtime 0.313930, Loss 1.157519, forward nfe 22264, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 070/100, Runtime 0.313031, Loss 1.129250, forward nfe 22514, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 071/100, Runtime 0.313029, Loss 1.171926, forward nfe 22770, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 072/100, Runtime 0.322939, Loss 1.242902, forward nfe 23026, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 073/100, Runtime 0.323216, Loss 1.137938, forward nfe 23288, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 074/100, Runtime 0.321773, Loss 1.099005, forward nfe 23544, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 075/100, Runtime 0.333277, Loss 1.050863, forward nfe 23800, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 076/100, Runtime 0.316803, Loss 1.032531, forward nfe 24062, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 077/100, Runtime 0.318113, Loss 1.159947, forward nfe 24318, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 078/100, Runtime 0.353061, Loss 1.141674, forward nfe 24574, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 079/100, Runtime 0.303506, Loss 1.138764, forward nfe 24824, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 080/100, Runtime 0.303218, Loss 1.123953, forward nfe 25074, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 081/100, Runtime 0.315921, Loss 1.131118, forward nfe 25324, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 082/100, Runtime 0.327176, Loss 1.104063, forward nfe 25574, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 083/100, Runtime 0.323331, Loss 1.169674, forward nfe 25824, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 084/100, Runtime 0.337090, Loss 1.061390, forward nfe 26080, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 085/100, Runtime 0.316101, Loss 1.192503, forward nfe 26336, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 086/100, Runtime 0.317966, Loss 1.142916, forward nfe 26592, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 087/100, Runtime 0.322612, Loss 1.057574, forward nfe 26848, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 088/100, Runtime 0.344033, Loss 1.110814, forward nfe 27104, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 089/100, Runtime 0.318132, Loss 1.071493, forward nfe 27360, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 090/100, Runtime 0.310213, Loss 1.097524, forward nfe 27616, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 091/100, Runtime 0.331126, Loss 1.058025, forward nfe 27872, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 092/100, Runtime 0.323310, Loss 0.999957, forward nfe 28128, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 093/100, Runtime 0.331725, Loss 1.260881, forward nfe 28384, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 094/100, Runtime 0.334600, Loss 1.092902, forward nfe 28640, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 095/100, Runtime 0.319354, Loss 1.094545, forward nfe 28896, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 096/100, Runtime 0.315863, Loss 1.048748, forward nfe 29152, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 097/100, Runtime 0.331987, Loss 1.152297, forward nfe 29408, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 098/100, Runtime 0.320799, Loss 1.133823, forward nfe 29664, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
Epoch: 099/100, Runtime 0.313970, Loss 0.988843, forward nfe 29920, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7661, Best time: 45.0000
best val accuracy 0.752899 with test accuracy 0.766129 at epoch 27 and best time 45.000000