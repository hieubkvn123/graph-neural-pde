/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.407281, Loss 1.791511, forward nfe 116, backward nfe 0, Train: 0.3833, Val: 0.3812, Test: 0.3484, Best time: 63.2271
Epoch: 002/100, Runtime 0.339167, Loss 1.752524, forward nfe 396, backward nfe 0, Train: 0.6417, Val: 0.5428, Test: 0.4984, Best time: 1.4746
Epoch: 003/100, Runtime 0.360200, Loss 1.717775, forward nfe 688, backward nfe 0, Train: 0.6667, Val: 0.6275, Test: 0.6145, Best time: 1.4398
Epoch: 004/100, Runtime 0.341376, Loss 1.675272, forward nfe 980, backward nfe 0, Train: 0.7333, Val: 0.6891, Test: 0.6581, Best time: 4.1924
Epoch: 005/100, Runtime 0.376609, Loss 1.616634, forward nfe 1266, backward nfe 0, Train: 0.7333, Val: 0.6891, Test: 0.6581, Best time: 20.0000
Epoch: 006/100, Runtime 0.378778, Loss 1.577571, forward nfe 1552, backward nfe 0, Train: 0.8000, Val: 0.7022, Test: 0.6790, Best time: 4.3079
Epoch: 007/100, Runtime 0.348605, Loss 1.598898, forward nfe 1850, backward nfe 0, Train: 0.8250, Val: 0.7304, Test: 0.7097, Best time: 4.4428
Epoch: 008/100, Runtime 0.352121, Loss 1.586364, forward nfe 2136, backward nfe 0, Train: 0.8250, Val: 0.7377, Test: 0.7323, Best time: 3.7401
Epoch: 009/100, Runtime 0.342189, Loss 1.522594, forward nfe 2410, backward nfe 0, Train: 0.8333, Val: 0.7500, Test: 0.7355, Best time: 6.8153
Epoch: 010/100, Runtime 0.348853, Loss 1.497127, forward nfe 2684, backward nfe 0, Train: 0.8333, Val: 0.7500, Test: 0.7355, Best time: 20.0000
Epoch: 011/100, Runtime 0.338842, Loss 1.442835, forward nfe 2958, backward nfe 0, Train: 0.8333, Val: 0.7500, Test: 0.7355, Best time: 20.0000
Epoch: 012/100, Runtime 0.349939, Loss 1.467220, forward nfe 3226, backward nfe 0, Train: 0.8333, Val: 0.7500, Test: 0.7355, Best time: 20.0000
Epoch: 013/100, Runtime 0.343409, Loss 1.461853, forward nfe 3488, backward nfe 0, Train: 0.8333, Val: 0.7500, Test: 0.7355, Best time: 20.0000
Epoch: 014/100, Runtime 0.330876, Loss 1.411037, forward nfe 3762, backward nfe 0, Train: 0.8333, Val: 0.7500, Test: 0.7355, Best time: 20.0000
Epoch: 015/100, Runtime 0.325487, Loss 1.382747, forward nfe 4024, backward nfe 0, Train: 0.8333, Val: 0.7500, Test: 0.7355, Best time: 20.0000
Epoch: 016/100, Runtime 0.318048, Loss 1.319579, forward nfe 4286, backward nfe 0, Train: 0.8333, Val: 0.7500, Test: 0.7355, Best time: 20.0000
Epoch: 017/100, Runtime 0.316052, Loss 1.317634, forward nfe 4548, backward nfe 0, Train: 0.8750, Val: 0.7565, Test: 0.7290, Best time: 14.8612
Epoch: 018/100, Runtime 0.306104, Loss 1.277233, forward nfe 4804, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 18.0324
Epoch: 019/100, Runtime 0.303037, Loss 1.256902, forward nfe 5054, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 020/100, Runtime 0.307467, Loss 1.173144, forward nfe 5298, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 021/100, Runtime 0.300046, Loss 1.174725, forward nfe 5548, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 022/100, Runtime 0.297510, Loss 1.088444, forward nfe 5798, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 023/100, Runtime 0.298546, Loss 1.116985, forward nfe 6042, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 024/100, Runtime 0.301881, Loss 1.116584, forward nfe 6280, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 025/100, Runtime 0.301723, Loss 1.086968, forward nfe 6518, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 026/100, Runtime 0.286810, Loss 1.110264, forward nfe 6750, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 027/100, Runtime 0.284823, Loss 1.132298, forward nfe 6982, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 028/100, Runtime 0.282397, Loss 1.076007, forward nfe 7208, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 029/100, Runtime 0.285273, Loss 1.019497, forward nfe 7434, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 030/100, Runtime 0.287578, Loss 0.967793, forward nfe 7654, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 031/100, Runtime 0.271116, Loss 1.041666, forward nfe 7874, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 032/100, Runtime 0.277611, Loss 1.070082, forward nfe 8088, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 033/100, Runtime 0.269724, Loss 0.999884, forward nfe 8302, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 034/100, Runtime 0.268255, Loss 0.943359, forward nfe 8516, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 035/100, Runtime 0.267348, Loss 0.951342, forward nfe 8724, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 036/100, Runtime 0.270209, Loss 0.914934, forward nfe 8926, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 037/100, Runtime 0.245205, Loss 0.971948, forward nfe 9134, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 038/100, Runtime 0.258770, Loss 0.940938, forward nfe 9330, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 039/100, Runtime 0.248108, Loss 0.889429, forward nfe 9526, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 040/100, Runtime 0.256246, Loss 0.862993, forward nfe 9722, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 041/100, Runtime 0.247726, Loss 0.934475, forward nfe 9918, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 042/100, Runtime 0.241153, Loss 0.939935, forward nfe 10108, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 043/100, Runtime 0.244337, Loss 0.854933, forward nfe 10298, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 044/100, Runtime 0.244897, Loss 0.962382, forward nfe 10482, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 045/100, Runtime 0.237791, Loss 0.888484, forward nfe 10666, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 046/100, Runtime 0.247795, Loss 0.874405, forward nfe 10850, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 047/100, Runtime 0.228802, Loss 0.853539, forward nfe 11034, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 048/100, Runtime 0.233288, Loss 0.912105, forward nfe 11212, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 049/100, Runtime 0.216169, Loss 0.967607, forward nfe 11390, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 050/100, Runtime 0.217178, Loss 0.951697, forward nfe 11568, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 051/100, Runtime 0.219809, Loss 0.961867, forward nfe 11746, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 052/100, Runtime 0.233208, Loss 0.927928, forward nfe 11930, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 053/100, Runtime 0.229452, Loss 1.025579, forward nfe 12114, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 054/100, Runtime 0.235797, Loss 0.973500, forward nfe 12298, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 055/100, Runtime 0.237426, Loss 0.882680, forward nfe 12482, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 056/100, Runtime 0.231277, Loss 0.952300, forward nfe 12666, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 057/100, Runtime 0.239751, Loss 0.903946, forward nfe 12850, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 058/100, Runtime 0.241759, Loss 0.987037, forward nfe 13034, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 059/100, Runtime 0.235996, Loss 0.881724, forward nfe 13224, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 060/100, Runtime 0.235603, Loss 0.860958, forward nfe 13414, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 061/100, Runtime 0.243408, Loss 1.031838, forward nfe 13604, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 062/100, Runtime 0.239846, Loss 0.955523, forward nfe 13794, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 063/100, Runtime 0.258139, Loss 0.886530, forward nfe 13984, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 064/100, Runtime 0.246471, Loss 0.962569, forward nfe 14174, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 065/100, Runtime 0.239264, Loss 0.887649, forward nfe 14364, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 066/100, Runtime 0.240105, Loss 0.963539, forward nfe 14554, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 067/100, Runtime 0.240940, Loss 0.895676, forward nfe 14744, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 068/100, Runtime 0.245770, Loss 0.977898, forward nfe 14934, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 069/100, Runtime 0.246208, Loss 1.013292, forward nfe 15124, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 070/100, Runtime 0.234507, Loss 1.117663, forward nfe 15314, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 071/100, Runtime 0.262396, Loss 0.996009, forward nfe 15504, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 072/100, Runtime 0.238023, Loss 1.037754, forward nfe 15694, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 073/100, Runtime 0.240438, Loss 0.883965, forward nfe 15884, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 074/100, Runtime 0.246109, Loss 0.996322, forward nfe 16074, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 075/100, Runtime 0.242079, Loss 1.063484, forward nfe 16264, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 076/100, Runtime 0.239967, Loss 0.977341, forward nfe 16454, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 077/100, Runtime 0.241411, Loss 0.851713, forward nfe 16644, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 078/100, Runtime 0.240787, Loss 0.900462, forward nfe 16840, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 079/100, Runtime 0.239990, Loss 0.856485, forward nfe 17030, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 080/100, Runtime 0.235529, Loss 0.869625, forward nfe 17220, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 081/100, Runtime 0.230317, Loss 1.034224, forward nfe 17410, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 082/100, Runtime 0.253712, Loss 0.974723, forward nfe 17600, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 083/100, Runtime 0.238595, Loss 0.939801, forward nfe 17790, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 084/100, Runtime 0.236145, Loss 0.835458, forward nfe 17980, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 085/100, Runtime 0.233867, Loss 0.975536, forward nfe 18170, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 086/100, Runtime 0.238255, Loss 0.966935, forward nfe 18360, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 087/100, Runtime 0.233838, Loss 0.844214, forward nfe 18550, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 088/100, Runtime 0.240377, Loss 0.899403, forward nfe 18740, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 089/100, Runtime 0.236844, Loss 1.000953, forward nfe 18930, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 090/100, Runtime 0.243010, Loss 0.851816, forward nfe 19120, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 091/100, Runtime 0.233043, Loss 0.901734, forward nfe 19310, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 092/100, Runtime 0.239084, Loss 0.797900, forward nfe 19500, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 093/100, Runtime 0.237032, Loss 0.852917, forward nfe 19690, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 094/100, Runtime 0.240584, Loss 0.998188, forward nfe 19880, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 095/100, Runtime 0.368791, Loss 0.875435, forward nfe 20070, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 096/100, Runtime 0.251005, Loss 0.926204, forward nfe 20260, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 097/100, Runtime 0.236156, Loss 0.886201, forward nfe 20450, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 098/100, Runtime 0.242320, Loss 0.955058, forward nfe 20640, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
Epoch: 099/100, Runtime 0.245357, Loss 0.822869, forward nfe 20830, backward nfe 0, Train: 0.8833, Val: 0.7674, Test: 0.7452, Best time: 20.0000
best val accuracy 0.767391 with test accuracy 0.745161 at epoch 18 and best time 20.000000