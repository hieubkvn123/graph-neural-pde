/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
Epoch: 001/100, Runtime 0.295124, Loss 1.100056, forward nfe 20, backward nfe 8, Train: 0.8667, Val: 0.5917, Test: 0.6081, Best time: 2.5647
Epoch: 002/100, Runtime 0.284554, Loss 1.085759, forward nfe 102, backward nfe 15, Train: 0.7333, Val: 0.5938, Test: 0.6075, Best time: 5.8973
Epoch: 003/100, Runtime 0.302659, Loss 1.069669, forward nfe 178, backward nfe 25, Train: 0.8667, Val: 0.6118, Test: 0.6334, Best time: 2.5579
Epoch: 004/100, Runtime 0.298272, Loss 1.045402, forward nfe 260, backward nfe 36, Train: 0.9000, Val: 0.6326, Test: 0.6512, Best time: 2.4931
Epoch: 005/100, Runtime 0.332542, Loss 1.012681, forward nfe 330, backward nfe 48, Train: 0.9500, Val: 0.6389, Test: 0.6639, Best time: 2.4298
Epoch: 006/100, Runtime 0.316173, Loss 0.980352, forward nfe 412, backward nfe 60, Train: 0.9667, Val: 0.6500, Test: 0.6681, Best time: 2.3752
Epoch: 007/100, Runtime 0.337974, Loss 0.946569, forward nfe 488, backward nfe 73, Train: 0.9667, Val: 0.6500, Test: 0.6681, Best time: 5.0000
Epoch: 008/100, Runtime 0.329492, Loss 0.894926, forward nfe 564, backward nfe 86, Train: 0.9667, Val: 0.6500, Test: 0.6681, Best time: 5.0000
Epoch: 009/100, Runtime 0.349070, Loss 0.840723, forward nfe 640, backward nfe 101, Train: 0.9667, Val: 0.6507, Test: 0.6701, Best time: 2.2420
Epoch: 010/100, Runtime 0.316520, Loss 0.806336, forward nfe 716, backward nfe 114, Train: 0.9667, Val: 0.6521, Test: 0.6714, Best time: 2.2006
Epoch: 011/100, Runtime 0.334058, Loss 0.745752, forward nfe 786, backward nfe 129, Train: 0.9667, Val: 0.6549, Test: 0.6748, Best time: 2.1595
Epoch: 012/100, Runtime 0.332080, Loss 0.656488, forward nfe 856, backward nfe 144, Train: 0.9667, Val: 0.6549, Test: 0.6748, Best time: 5.0000
Epoch: 013/100, Runtime 0.344717, Loss 0.608900, forward nfe 926, backward nfe 159, Train: 0.9500, Val: 0.6597, Test: 0.6825, Best time: 5.5455
Epoch: 014/100, Runtime 0.338358, Loss 0.548927, forward nfe 996, backward nfe 174, Train: 0.9833, Val: 0.6674, Test: 0.6897, Best time: 5.5701
Epoch: 015/100, Runtime 0.346901, Loss 0.499840, forward nfe 1066, backward nfe 189, Train: 0.9833, Val: 0.6708, Test: 0.6925, Best time: 1.9966
Epoch: 016/100, Runtime 0.346540, Loss 0.440683, forward nfe 1136, backward nfe 204, Train: 0.9333, Val: 0.6750, Test: 0.6863, Best time: 15.5819
Epoch: 017/100, Runtime 0.345209, Loss 0.392968, forward nfe 1206, backward nfe 219, Train: 0.9833, Val: 0.6757, Test: 0.6950, Best time: 5.7200
Epoch: 018/100, Runtime 0.327696, Loss 0.395912, forward nfe 1276, backward nfe 233, Train: 0.9833, Val: 0.6757, Test: 0.6950, Best time: 5.0000
Epoch: 019/100, Runtime 0.369263, Loss 0.294191, forward nfe 1346, backward nfe 249, Train: 0.9333, Val: 0.6813, Test: 0.6959, Best time: 16.4116
Epoch: 020/100, Runtime 0.297555, Loss 0.240014, forward nfe 1416, backward nfe 262, Train: 0.9333, Val: 0.6896, Test: 0.7014, Best time: 5.0000
Epoch: 021/100, Runtime 0.290877, Loss 0.262591, forward nfe 1474, backward nfe 275, Train: 0.9500, Val: 0.6951, Test: 0.7054, Best time: 5.0000
Epoch: 022/100, Runtime 0.291614, Loss 0.247262, forward nfe 1532, backward nfe 288, Train: 0.9500, Val: 0.6979, Test: 0.7081, Best time: 5.0000
Epoch: 023/100, Runtime 0.280303, Loss 0.198851, forward nfe 1590, backward nfe 299, Train: 0.9500, Val: 0.6979, Test: 0.7081, Best time: 5.0000
Epoch: 024/100, Runtime 0.287343, Loss 0.218042, forward nfe 1648, backward nfe 312, Train: 0.9500, Val: 0.6979, Test: 0.7081, Best time: 5.0000
Epoch: 025/100, Runtime 0.289278, Loss 0.150439, forward nfe 1706, backward nfe 323, Train: 0.9500, Val: 0.6979, Test: 0.7081, Best time: 5.0000
Epoch: 026/100, Runtime 0.272128, Loss 0.130618, forward nfe 1764, backward nfe 335, Train: 0.9500, Val: 0.6979, Test: 0.7081, Best time: 5.0000
Epoch: 027/100, Runtime 0.289133, Loss 0.155411, forward nfe 1822, backward nfe 346, Train: 1.0000, Val: 0.7049, Test: 0.7189, Best time: 7.1272
Epoch: 028/100, Runtime 0.297764, Loss 0.135495, forward nfe 1886, backward nfe 359, Train: 1.0000, Val: 0.7146, Test: 0.7234, Best time: 7.3532
Epoch: 029/100, Runtime 0.285060, Loss 0.149897, forward nfe 1950, backward nfe 370, Train: 1.0000, Val: 0.7160, Test: 0.7243, Best time: 7.5965
Epoch: 030/100, Runtime 0.278353, Loss 0.113983, forward nfe 2014, backward nfe 380, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 031/100, Runtime 0.268317, Loss 0.162788, forward nfe 2078, backward nfe 389, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 032/100, Runtime 0.266917, Loss 0.109441, forward nfe 2142, backward nfe 398, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 033/100, Runtime 0.287601, Loss 0.136155, forward nfe 2206, backward nfe 408, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 034/100, Runtime 0.225125, Loss 0.141282, forward nfe 2270, backward nfe 416, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 035/100, Runtime 0.260810, Loss 0.157982, forward nfe 2322, backward nfe 427, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 036/100, Runtime 0.264456, Loss 0.166586, forward nfe 2374, backward nfe 438, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 037/100, Runtime 0.226029, Loss 0.127358, forward nfe 2426, backward nfe 446, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 038/100, Runtime 0.237491, Loss 0.142297, forward nfe 2478, backward nfe 453, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 039/100, Runtime 0.249801, Loss 0.111309, forward nfe 2536, backward nfe 462, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 040/100, Runtime 0.243848, Loss 0.125428, forward nfe 2594, backward nfe 471, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 041/100, Runtime 0.255938, Loss 0.150564, forward nfe 2652, backward nfe 481, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 042/100, Runtime 0.233198, Loss 0.095393, forward nfe 2704, backward nfe 490, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 043/100, Runtime 0.238703, Loss 0.105863, forward nfe 2756, backward nfe 499, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 044/100, Runtime 0.255645, Loss 0.214809, forward nfe 2808, backward nfe 510, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 045/100, Runtime 0.245733, Loss 0.121794, forward nfe 2860, backward nfe 519, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 046/100, Runtime 0.221836, Loss 0.102268, forward nfe 2912, backward nfe 526, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 047/100, Runtime 0.243833, Loss 0.134262, forward nfe 2964, backward nfe 536, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 048/100, Runtime 0.243245, Loss 0.105792, forward nfe 3016, backward nfe 546, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 049/100, Runtime 0.243615, Loss 0.124935, forward nfe 3068, backward nfe 555, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 050/100, Runtime 0.232535, Loss 0.079709, forward nfe 3120, backward nfe 564, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 051/100, Runtime 0.227044, Loss 0.087185, forward nfe 3172, backward nfe 572, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 052/100, Runtime 0.215507, Loss 0.110302, forward nfe 3224, backward nfe 579, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 053/100, Runtime 0.228252, Loss 0.096600, forward nfe 3276, backward nfe 587, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 054/100, Runtime 0.217558, Loss 0.117804, forward nfe 3328, backward nfe 594, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 055/100, Runtime 0.226691, Loss 0.109361, forward nfe 3380, backward nfe 602, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 056/100, Runtime 0.222508, Loss 0.078769, forward nfe 3432, backward nfe 609, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 057/100, Runtime 0.227634, Loss 0.074493, forward nfe 3484, backward nfe 617, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 058/100, Runtime 0.237874, Loss 0.100943, forward nfe 3536, backward nfe 625, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 059/100, Runtime 0.220673, Loss 0.091336, forward nfe 3588, backward nfe 632, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 060/100, Runtime 0.227378, Loss 0.081895, forward nfe 3640, backward nfe 640, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 061/100, Runtime 0.229031, Loss 0.090280, forward nfe 3692, backward nfe 648, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 062/100, Runtime 0.234761, Loss 0.065728, forward nfe 3744, backward nfe 656, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 063/100, Runtime 0.225049, Loss 0.066585, forward nfe 3796, backward nfe 664, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 064/100, Runtime 0.226620, Loss 0.086385, forward nfe 3848, backward nfe 672, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 065/100, Runtime 0.232582, Loss 0.120164, forward nfe 3900, backward nfe 680, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 066/100, Runtime 0.235234, Loss 0.062336, forward nfe 3952, backward nfe 688, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 067/100, Runtime 0.246195, Loss 0.124851, forward nfe 4004, backward nfe 697, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 068/100, Runtime 0.222947, Loss 0.062680, forward nfe 4056, backward nfe 705, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 069/100, Runtime 0.226429, Loss 0.103554, forward nfe 4108, backward nfe 714, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 070/100, Runtime 0.234854, Loss 0.068918, forward nfe 4160, backward nfe 723, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 071/100, Runtime 0.220321, Loss 0.064179, forward nfe 4212, backward nfe 730, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 072/100, Runtime 0.221183, Loss 0.072191, forward nfe 4264, backward nfe 737, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 073/100, Runtime 0.231344, Loss 0.106254, forward nfe 4316, backward nfe 745, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 074/100, Runtime 0.230140, Loss 0.089782, forward nfe 4368, backward nfe 753, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 075/100, Runtime 0.226627, Loss 0.088359, forward nfe 4420, backward nfe 760, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 076/100, Runtime 0.231890, Loss 0.054220, forward nfe 4472, backward nfe 769, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 077/100, Runtime 0.223366, Loss 0.084169, forward nfe 4524, backward nfe 777, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 078/100, Runtime 0.226599, Loss 0.080423, forward nfe 4576, backward nfe 785, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 079/100, Runtime 0.230791, Loss 0.054459, forward nfe 4628, backward nfe 794, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 080/100, Runtime 0.236088, Loss 0.059591, forward nfe 4680, backward nfe 803, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 081/100, Runtime 0.228523, Loss 0.081298, forward nfe 4732, backward nfe 811, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 082/100, Runtime 0.219582, Loss 0.063585, forward nfe 4784, backward nfe 818, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 083/100, Runtime 0.232804, Loss 0.060116, forward nfe 4836, backward nfe 827, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 084/100, Runtime 0.240501, Loss 0.095876, forward nfe 4888, backward nfe 835, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 085/100, Runtime 0.239854, Loss 0.157445, forward nfe 4940, backward nfe 844, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 086/100, Runtime 0.228193, Loss 0.083523, forward nfe 4992, backward nfe 852, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 087/100, Runtime 0.227088, Loss 0.080195, forward nfe 5044, backward nfe 860, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 088/100, Runtime 0.229394, Loss 0.058412, forward nfe 5096, backward nfe 868, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 089/100, Runtime 0.222029, Loss 0.116106, forward nfe 5148, backward nfe 875, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 090/100, Runtime 0.222778, Loss 0.082917, forward nfe 5200, backward nfe 883, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 091/100, Runtime 0.205830, Loss 0.052171, forward nfe 5252, backward nfe 890, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 092/100, Runtime 0.227493, Loss 0.097713, forward nfe 5298, backward nfe 899, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 093/100, Runtime 0.226993, Loss 0.060611, forward nfe 5344, backward nfe 908, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 094/100, Runtime 0.205567, Loss 0.091205, forward nfe 5390, backward nfe 915, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 095/100, Runtime 0.209831, Loss 0.060376, forward nfe 5436, backward nfe 923, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 096/100, Runtime 0.207221, Loss 0.051939, forward nfe 5482, backward nfe 930, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 097/100, Runtime 0.211993, Loss 0.044429, forward nfe 5528, backward nfe 939, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 098/100, Runtime 0.213951, Loss 0.080635, forward nfe 5574, backward nfe 947, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
Epoch: 099/100, Runtime 0.193257, Loss 0.070501, forward nfe 5620, backward nfe 953, Train: 1.0000, Val: 0.7229, Test: 0.7348, Best time: 5.0000
best val accuracy 0.722917 with test accuracy 0.734808 at epoch 30 and best time 5.000000