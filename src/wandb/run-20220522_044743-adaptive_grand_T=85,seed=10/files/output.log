/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 5.137213, Loss 1.947027, forward nfe 164, backward nfe 0, Train: 0.3286, Val: 0.2529, Test: 0.2315, Best time: 2.2818
Epoch: 002/100, Runtime 5.063425, Loss 1.985525, forward nfe 798, backward nfe 0, Train: 0.3286, Val: 0.2529, Test: 0.2315, Best time: 85.0000
Epoch: 003/100, Runtime 5.056663, Loss 1.961247, forward nfe 1414, backward nfe 0, Train: 0.3286, Val: 0.2529, Test: 0.2315, Best time: 85.0000
Epoch: 004/100, Runtime 4.678184, Loss 1.912500, forward nfe 2024, backward nfe 0, Train: 0.3286, Val: 0.2529, Test: 0.2315, Best time: 85.0000
Epoch: 005/100, Runtime 4.503335, Loss 1.852508, forward nfe 2610, backward nfe 0, Train: 0.6643, Val: 0.7118, Test: 0.7046, Best time: 5.3286
Epoch: 006/100, Runtime 4.500211, Loss 1.741521, forward nfe 3190, backward nfe 0, Train: 0.7286, Val: 0.7507, Test: 0.7249, Best time: 7.5735
Epoch: 007/100, Runtime 4.261060, Loss 1.578439, forward nfe 3752, backward nfe 0, Train: 0.8286, Val: 0.7743, Test: 0.7574, Best time: 18.0689
Epoch: 008/100, Runtime 4.016962, Loss 1.390195, forward nfe 4302, backward nfe 0, Train: 0.8357, Val: 0.7860, Test: 0.7553, Best time: 24.9517
Epoch: 009/100, Runtime 3.878569, Loss 1.201905, forward nfe 4834, backward nfe 0, Train: 0.8357, Val: 0.7860, Test: 0.7553, Best time: 85.0000
Epoch: 010/100, Runtime 4.186163, Loss 1.000904, forward nfe 5372, backward nfe 0, Train: 0.8357, Val: 0.7860, Test: 0.7553, Best time: 85.0000
Epoch: 011/100, Runtime 4.047456, Loss 0.867276, forward nfe 5904, backward nfe 0, Train: 0.8357, Val: 0.7860, Test: 0.7553, Best time: 85.0000
Epoch: 012/100, Runtime 3.622239, Loss 0.749007, forward nfe 6418, backward nfe 0, Train: 0.8714, Val: 0.8074, Test: 0.8010, Best time: 54.7371
Epoch: 013/100, Runtime 3.649497, Loss 0.666343, forward nfe 6914, backward nfe 0, Train: 0.8714, Val: 0.8074, Test: 0.8010, Best time: 85.0000
Epoch: 014/100, Runtime 3.435724, Loss 0.682170, forward nfe 7392, backward nfe 0, Train: 0.8714, Val: 0.8074, Test: 0.8010, Best time: 85.0000
Epoch: 015/100, Runtime 3.508120, Loss 0.575212, forward nfe 7858, backward nfe 0, Train: 0.8500, Val: 0.8096, Test: 0.8000, Best time: 68.7277
Epoch: 016/100, Runtime 3.161950, Loss 0.597393, forward nfe 8306, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8081, Best time: 77.7013
Epoch: 017/100, Runtime 3.426584, Loss 0.560281, forward nfe 8754, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8081, Best time: 85.0000
Epoch: 018/100, Runtime 3.321011, Loss 0.577581, forward nfe 9190, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8081, Best time: 85.0000
Epoch: 019/100, Runtime 3.283966, Loss 0.501574, forward nfe 9614, backward nfe 0, Train: 0.8643, Val: 0.8191, Test: 0.8081, Best time: 85.0000
Epoch: 020/100, Runtime 3.255827, Loss 0.503688, forward nfe 10020, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 104.9676
Epoch: 021/100, Runtime 3.284577, Loss 0.443378, forward nfe 10414, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 022/100, Runtime 3.075055, Loss 0.493297, forward nfe 10796, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 023/100, Runtime 2.999913, Loss 0.491824, forward nfe 11172, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 024/100, Runtime 2.990295, Loss 0.441857, forward nfe 11548, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 025/100, Runtime 2.996425, Loss 0.480180, forward nfe 11912, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 026/100, Runtime 2.894606, Loss 0.486678, forward nfe 12264, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 027/100, Runtime 3.057474, Loss 0.432455, forward nfe 12610, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 028/100, Runtime 3.206248, Loss 0.536447, forward nfe 12944, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 029/100, Runtime 3.176113, Loss 0.351655, forward nfe 13284, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 030/100, Runtime 3.452983, Loss 0.469364, forward nfe 13612, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 031/100, Runtime 3.511506, Loss 0.374264, forward nfe 13952, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 032/100, Runtime 2.946348, Loss 0.360752, forward nfe 14292, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 033/100, Runtime 2.451096, Loss 0.372780, forward nfe 14608, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 034/100, Runtime 2.525552, Loss 0.308172, forward nfe 14924, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 035/100, Runtime 2.459601, Loss 0.385758, forward nfe 15234, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 036/100, Runtime 2.454447, Loss 0.306815, forward nfe 15544, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 037/100, Runtime 2.459327, Loss 0.316451, forward nfe 15854, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 038/100, Runtime 2.430966, Loss 0.294588, forward nfe 16158, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 039/100, Runtime 2.309606, Loss 0.284142, forward nfe 16450, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 040/100, Runtime 2.263221, Loss 0.249375, forward nfe 16736, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 041/100, Runtime 2.185140, Loss 0.283680, forward nfe 17016, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 042/100, Runtime 1.977892, Loss 0.229199, forward nfe 17302, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 043/100, Runtime 2.261692, Loss 0.248163, forward nfe 17582, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 044/100, Runtime 2.355015, Loss 0.207408, forward nfe 17862, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 045/100, Runtime 2.373899, Loss 0.246685, forward nfe 18142, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 046/100, Runtime 2.351994, Loss 0.228361, forward nfe 18416, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 047/100, Runtime 2.333969, Loss 0.297286, forward nfe 18690, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 048/100, Runtime 2.286391, Loss 0.242749, forward nfe 18964, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 049/100, Runtime 2.323932, Loss 0.178228, forward nfe 19238, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 050/100, Runtime 2.266677, Loss 0.331025, forward nfe 19512, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 051/100, Runtime 2.242148, Loss 0.201923, forward nfe 19786, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 052/100, Runtime 2.328372, Loss 0.221804, forward nfe 20060, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 053/100, Runtime 2.219326, Loss 0.191391, forward nfe 20328, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 054/100, Runtime 2.216146, Loss 0.149793, forward nfe 20584, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 055/100, Runtime 2.172171, Loss 0.188182, forward nfe 20840, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 056/100, Runtime 2.109335, Loss 0.133688, forward nfe 21096, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 057/100, Runtime 1.993675, Loss 0.152452, forward nfe 21352, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 058/100, Runtime 2.121910, Loss 0.130756, forward nfe 21596, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 059/100, Runtime 1.946188, Loss 0.072547, forward nfe 21840, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 060/100, Runtime 1.884932, Loss 0.272340, forward nfe 22084, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 061/100, Runtime 1.906797, Loss 0.151797, forward nfe 22328, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 062/100, Runtime 1.822926, Loss 0.162095, forward nfe 22572, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 063/100, Runtime 1.895138, Loss 0.207816, forward nfe 22816, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 064/100, Runtime 1.853050, Loss 0.129130, forward nfe 23060, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 065/100, Runtime 1.868236, Loss 0.148907, forward nfe 23304, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 066/100, Runtime 1.971481, Loss 0.198886, forward nfe 23548, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 067/100, Runtime 1.933498, Loss 0.137162, forward nfe 23792, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 068/100, Runtime 2.022781, Loss 0.196664, forward nfe 24036, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 069/100, Runtime 2.131441, Loss 0.125690, forward nfe 24280, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 070/100, Runtime 1.957483, Loss 0.093884, forward nfe 24524, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 071/100, Runtime 1.804083, Loss 0.101149, forward nfe 24762, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 072/100, Runtime 1.928663, Loss 0.108686, forward nfe 25000, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 073/100, Runtime 1.920020, Loss 0.067967, forward nfe 25238, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 074/100, Runtime 1.931207, Loss 0.085812, forward nfe 25476, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 075/100, Runtime 2.022738, Loss 0.072845, forward nfe 25714, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 076/100, Runtime 2.060267, Loss 0.133096, forward nfe 25952, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 077/100, Runtime 2.013460, Loss 0.082032, forward nfe 26190, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 078/100, Runtime 2.097715, Loss 0.067051, forward nfe 26428, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 079/100, Runtime 2.107355, Loss 0.087407, forward nfe 26666, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 080/100, Runtime 1.809175, Loss 0.070249, forward nfe 26904, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 081/100, Runtime 1.861133, Loss 0.069163, forward nfe 27142, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 082/100, Runtime 2.081074, Loss 0.040484, forward nfe 27380, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 083/100, Runtime 1.817050, Loss 0.109631, forward nfe 27618, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 084/100, Runtime 2.039419, Loss 0.078574, forward nfe 27856, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 085/100, Runtime 2.051191, Loss 0.066424, forward nfe 28094, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 086/100, Runtime 1.903891, Loss 0.062714, forward nfe 28332, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 087/100, Runtime 1.998187, Loss 0.082313, forward nfe 28570, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 088/100, Runtime 1.994991, Loss 0.068955, forward nfe 28808, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 089/100, Runtime 1.950299, Loss 0.059845, forward nfe 29046, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 090/100, Runtime 1.968990, Loss 0.057718, forward nfe 29284, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 091/100, Runtime 2.078030, Loss 0.091235, forward nfe 29522, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 092/100, Runtime 2.037239, Loss 0.081248, forward nfe 29760, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 093/100, Runtime 1.869964, Loss 0.122115, forward nfe 29998, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 094/100, Runtime 1.994312, Loss 0.072895, forward nfe 30236, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 095/100, Runtime 2.011950, Loss 0.087172, forward nfe 30474, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 096/100, Runtime 2.094344, Loss 0.219613, forward nfe 30712, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 097/100, Runtime 2.066574, Loss 0.030401, forward nfe 30950, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 098/100, Runtime 1.912724, Loss 0.106373, forward nfe 31188, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
Epoch: 099/100, Runtime 2.036360, Loss 0.099965, forward nfe 31426, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8264, Best time: 85.0000
best val accuracy 0.838235 with test accuracy 0.826396 at epoch 20 and best time 85.000000