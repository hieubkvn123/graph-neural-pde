/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.891864, Loss 1.947467, forward nfe 182, backward nfe 0, Train: 0.3000, Val: 0.3184, Test: 0.2873, Best time: 0.0965
Epoch: 002/100, Runtime 0.747820, Loss 1.881952, forward nfe 888, backward nfe 0, Train: 0.5786, Val: 0.5713, Test: 0.5736, Best time: 68.0828
Epoch: 003/100, Runtime 0.766469, Loss 1.667500, forward nfe 1576, backward nfe 0, Train: 0.6714, Val: 0.6853, Test: 0.6853, Best time: 138.0632
Epoch: 004/100, Runtime 0.728693, Loss 1.438139, forward nfe 2258, backward nfe 0, Train: 0.7714, Val: 0.7765, Test: 0.7827, Best time: 55.8735
Epoch: 005/100, Runtime 0.713232, Loss 1.189950, forward nfe 2922, backward nfe 0, Train: 0.7714, Val: 0.7765, Test: 0.7827, Best time: 100.0000
Epoch: 006/100, Runtime 0.689981, Loss 1.018695, forward nfe 3580, backward nfe 0, Train: 0.7714, Val: 0.7765, Test: 0.7827, Best time: 100.0000
Epoch: 007/100, Runtime 0.674333, Loss 0.897679, forward nfe 4214, backward nfe 0, Train: 0.8143, Val: 0.8022, Test: 0.7858, Best time: 39.9747
Epoch: 008/100, Runtime 0.666092, Loss 0.776432, forward nfe 4830, backward nfe 0, Train: 0.8143, Val: 0.8022, Test: 0.7858, Best time: 100.0000
Epoch: 009/100, Runtime 0.650584, Loss 0.798243, forward nfe 5428, backward nfe 0, Train: 0.8143, Val: 0.8022, Test: 0.7858, Best time: 100.0000
Epoch: 010/100, Runtime 0.634574, Loss 0.714687, forward nfe 6008, backward nfe 0, Train: 0.8143, Val: 0.8022, Test: 0.7858, Best time: 100.0000
Epoch: 011/100, Runtime 0.618390, Loss 0.701178, forward nfe 6570, backward nfe 0, Train: 0.8143, Val: 0.8022, Test: 0.7858, Best time: 100.0000
Epoch: 012/100, Runtime 0.605057, Loss 0.696689, forward nfe 7132, backward nfe 0, Train: 0.8143, Val: 0.8022, Test: 0.7858, Best time: 100.0000
Epoch: 013/100, Runtime 0.616147, Loss 0.671847, forward nfe 7688, backward nfe 0, Train: 0.8714, Val: 0.8118, Test: 0.7970, Best time: 69.4557
Epoch: 014/100, Runtime 0.580667, Loss 0.585363, forward nfe 8232, backward nfe 0, Train: 0.8714, Val: 0.8118, Test: 0.7970, Best time: 100.0000
Epoch: 015/100, Runtime 0.570149, Loss 0.666100, forward nfe 8758, backward nfe 0, Train: 0.8714, Val: 0.8118, Test: 0.7970, Best time: 100.0000
Epoch: 016/100, Runtime 0.573265, Loss 0.606912, forward nfe 9278, backward nfe 0, Train: 0.8714, Val: 0.8118, Test: 0.7970, Best time: 100.0000
Epoch: 017/100, Runtime 0.543969, Loss 0.586573, forward nfe 9780, backward nfe 0, Train: 0.8714, Val: 0.8118, Test: 0.7970, Best time: 100.0000
Epoch: 018/100, Runtime 0.556598, Loss 0.630140, forward nfe 10276, backward nfe 0, Train: 0.8500, Val: 0.8147, Test: 0.7939, Best time: 92.8695
Epoch: 019/100, Runtime 0.554628, Loss 0.570558, forward nfe 10766, backward nfe 0, Train: 0.8500, Val: 0.8147, Test: 0.7939, Best time: 100.0000
Epoch: 020/100, Runtime 0.526069, Loss 0.584425, forward nfe 11250, backward nfe 0, Train: 0.8500, Val: 0.8147, Test: 0.7939, Best time: 100.0000
Epoch: 021/100, Runtime 0.514740, Loss 0.719345, forward nfe 11728, backward nfe 0, Train: 0.8500, Val: 0.8147, Test: 0.7939, Best time: 100.0000
Epoch: 022/100, Runtime 0.553495, Loss 0.518894, forward nfe 12200, backward nfe 0, Train: 0.8500, Val: 0.8147, Test: 0.7939, Best time: 100.0000
Epoch: 023/100, Runtime 0.482586, Loss 0.543018, forward nfe 12660, backward nfe 0, Train: 0.8500, Val: 0.8147, Test: 0.7939, Best time: 100.0000
Epoch: 024/100, Runtime 0.481143, Loss 0.576699, forward nfe 13108, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 128.5353
Epoch: 025/100, Runtime 0.481609, Loss 0.458787, forward nfe 13544, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 026/100, Runtime 0.474405, Loss 0.467941, forward nfe 13968, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 027/100, Runtime 0.457999, Loss 0.462547, forward nfe 14386, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 028/100, Runtime 0.464401, Loss 0.491692, forward nfe 14804, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 029/100, Runtime 0.463129, Loss 0.418554, forward nfe 15222, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 030/100, Runtime 0.447041, Loss 0.539422, forward nfe 15622, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 031/100, Runtime 0.433602, Loss 0.477391, forward nfe 16022, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 032/100, Runtime 0.424356, Loss 0.423133, forward nfe 16416, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 033/100, Runtime 0.430814, Loss 0.370941, forward nfe 16798, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 034/100, Runtime 0.407427, Loss 0.400175, forward nfe 17174, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 035/100, Runtime 0.417811, Loss 0.390112, forward nfe 17550, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 036/100, Runtime 0.417881, Loss 0.359180, forward nfe 17920, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 037/100, Runtime 0.393324, Loss 0.357950, forward nfe 18290, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 038/100, Runtime 0.405312, Loss 0.345844, forward nfe 18648, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 039/100, Runtime 0.394601, Loss 0.369557, forward nfe 18994, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 040/100, Runtime 0.385953, Loss 0.333102, forward nfe 19340, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 041/100, Runtime 0.391564, Loss 0.328640, forward nfe 19686, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 042/100, Runtime 0.390380, Loss 0.313623, forward nfe 20032, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 043/100, Runtime 0.388389, Loss 0.303988, forward nfe 20378, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 044/100, Runtime 0.382068, Loss 0.308834, forward nfe 20718, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 045/100, Runtime 0.395154, Loss 0.350689, forward nfe 21058, backward nfe 0, Train: 0.9071, Val: 0.8287, Test: 0.8193, Best time: 100.0000
Epoch: 046/100, Runtime 0.389671, Loss 0.237791, forward nfe 21404, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 107.7906
Epoch: 047/100, Runtime 0.384007, Loss 0.397940, forward nfe 21750, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 048/100, Runtime 0.355331, Loss 0.292248, forward nfe 22078, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 049/100, Runtime 0.364345, Loss 0.281172, forward nfe 22400, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 050/100, Runtime 0.345958, Loss 0.237473, forward nfe 22722, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 051/100, Runtime 0.345753, Loss 0.242708, forward nfe 23038, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 052/100, Runtime 0.351382, Loss 0.247622, forward nfe 23354, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 053/100, Runtime 0.352864, Loss 0.229740, forward nfe 23664, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 054/100, Runtime 0.346927, Loss 0.235954, forward nfe 23974, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 055/100, Runtime 0.345148, Loss 0.242577, forward nfe 24284, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 056/100, Runtime 0.349887, Loss 0.193294, forward nfe 24588, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 057/100, Runtime 0.347359, Loss 0.176067, forward nfe 24892, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 058/100, Runtime 0.342324, Loss 0.137840, forward nfe 25196, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 059/100, Runtime 0.343712, Loss 0.149177, forward nfe 25500, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 060/100, Runtime 0.331140, Loss 0.163472, forward nfe 25798, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 061/100, Runtime 0.333977, Loss 0.160292, forward nfe 26096, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 062/100, Runtime 0.329970, Loss 0.133247, forward nfe 26394, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 063/100, Runtime 0.346167, Loss 0.180404, forward nfe 26692, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 064/100, Runtime 0.344372, Loss 0.125689, forward nfe 26990, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 065/100, Runtime 0.321515, Loss 0.117574, forward nfe 27288, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 066/100, Runtime 0.333966, Loss 0.076754, forward nfe 27574, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 067/100, Runtime 0.335546, Loss 0.091071, forward nfe 27860, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 068/100, Runtime 0.324145, Loss 0.080791, forward nfe 28146, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 069/100, Runtime 0.333206, Loss 0.100767, forward nfe 28432, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 070/100, Runtime 0.325907, Loss 0.065235, forward nfe 28718, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 071/100, Runtime 0.314303, Loss 0.061709, forward nfe 28998, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 072/100, Runtime 0.316086, Loss 0.068530, forward nfe 29278, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 073/100, Runtime 0.321410, Loss 0.057476, forward nfe 29558, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 074/100, Runtime 0.318856, Loss 0.080672, forward nfe 29838, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 075/100, Runtime 0.333154, Loss 0.046643, forward nfe 30118, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 076/100, Runtime 0.327287, Loss 0.105792, forward nfe 30398, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 077/100, Runtime 0.319367, Loss 0.058285, forward nfe 30672, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 078/100, Runtime 0.316222, Loss 0.094234, forward nfe 30946, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 079/100, Runtime 0.448178, Loss 0.068926, forward nfe 31220, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 080/100, Runtime 0.315159, Loss 0.045748, forward nfe 31494, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 081/100, Runtime 0.311749, Loss 0.123042, forward nfe 31768, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 082/100, Runtime 0.320030, Loss 0.048586, forward nfe 32042, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 083/100, Runtime 0.318834, Loss 0.066938, forward nfe 32316, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 084/100, Runtime 0.304920, Loss 0.061588, forward nfe 32590, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 085/100, Runtime 0.300606, Loss 0.104125, forward nfe 32864, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 086/100, Runtime 0.303740, Loss 0.059960, forward nfe 33138, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 087/100, Runtime 0.311069, Loss 0.066358, forward nfe 33406, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 088/100, Runtime 0.300149, Loss 0.077745, forward nfe 33674, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 089/100, Runtime 0.312245, Loss 0.068135, forward nfe 33942, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 090/100, Runtime 0.309928, Loss 0.094802, forward nfe 34210, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 091/100, Runtime 0.299612, Loss 0.054732, forward nfe 34478, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 092/100, Runtime 0.303516, Loss 0.117128, forward nfe 34746, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 093/100, Runtime 0.299933, Loss 0.063754, forward nfe 35014, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 094/100, Runtime 0.307015, Loss 0.089668, forward nfe 35282, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 095/100, Runtime 0.307524, Loss 0.072473, forward nfe 35550, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 096/100, Runtime 0.311669, Loss 0.060478, forward nfe 35818, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 097/100, Runtime 0.304866, Loss 0.047767, forward nfe 36086, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 098/100, Runtime 0.292717, Loss 0.061080, forward nfe 36354, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
Epoch: 099/100, Runtime 0.297405, Loss 0.086950, forward nfe 36616, backward nfe 0, Train: 0.9000, Val: 0.8309, Test: 0.8152, Best time: 100.0000
best val accuracy 0.830882 with test accuracy 0.815228 at epoch 46 and best time 100.000000