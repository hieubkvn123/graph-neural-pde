/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 6.380332, Loss 1.948204, forward nfe 164, backward nfe 0, Train: 0.2929, Val: 0.2199, Test: 0.2213, Best time: 7.5445
Epoch: 002/100, Runtime 6.449191, Loss 2.000173, forward nfe 798, backward nfe 0, Train: 0.2929, Val: 0.2199, Test: 0.2213, Best time: 85.0000
Epoch: 003/100, Runtime 5.941289, Loss 1.957638, forward nfe 1408, backward nfe 0, Train: 0.2929, Val: 0.2199, Test: 0.2213, Best time: 85.0000
Epoch: 004/100, Runtime 6.144086, Loss 1.922086, forward nfe 2018, backward nfe 0, Train: 0.2929, Val: 0.2199, Test: 0.2213, Best time: 85.0000
Epoch: 005/100, Runtime 4.442430, Loss 1.874666, forward nfe 2622, backward nfe 0, Train: 0.4571, Val: 0.3500, Test: 0.3635, Best time: 2.2026
Epoch: 006/100, Runtime 4.202294, Loss 1.793418, forward nfe 3202, backward nfe 0, Train: 0.6143, Val: 0.5103, Test: 0.4924, Best time: 12.8246
Epoch: 007/100, Runtime 4.289351, Loss 1.680295, forward nfe 3776, backward nfe 0, Train: 0.6214, Val: 0.5493, Test: 0.5289, Best time: 10.2291
Epoch: 008/100, Runtime 4.220116, Loss 1.555691, forward nfe 4320, backward nfe 0, Train: 0.7000, Val: 0.6404, Test: 0.6173, Best time: 10.6945
Epoch: 009/100, Runtime 4.328811, Loss 1.406610, forward nfe 4858, backward nfe 0, Train: 0.8357, Val: 0.7566, Test: 0.7431, Best time: 6.0703
Epoch: 010/100, Runtime 4.207692, Loss 1.262228, forward nfe 5384, backward nfe 0, Train: 0.8786, Val: 0.8096, Test: 0.7929, Best time: 39.6168
Epoch: 011/100, Runtime 4.183137, Loss 1.029732, forward nfe 5910, backward nfe 0, Train: 0.8714, Val: 0.8154, Test: 0.7970, Best time: 16.2154
Epoch: 012/100, Runtime 3.849032, Loss 0.884167, forward nfe 6424, backward nfe 0, Train: 0.8857, Val: 0.8257, Test: 0.8071, Best time: 30.0555
Epoch: 013/100, Runtime 3.631122, Loss 0.741533, forward nfe 6932, backward nfe 0, Train: 0.9071, Val: 0.8272, Test: 0.8213, Best time: 9.8973
Epoch: 014/100, Runtime 3.700150, Loss 0.645905, forward nfe 7422, backward nfe 0, Train: 0.9071, Val: 0.8272, Test: 0.8213, Best time: 85.0000
Epoch: 015/100, Runtime 3.495444, Loss 0.597361, forward nfe 7894, backward nfe 0, Train: 0.9071, Val: 0.8272, Test: 0.8213, Best time: 85.0000
Epoch: 016/100, Runtime 3.466459, Loss 0.477503, forward nfe 8348, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 102.9048
Epoch: 017/100, Runtime 3.514452, Loss 0.425092, forward nfe 8790, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 018/100, Runtime 3.342678, Loss 0.410445, forward nfe 9232, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 019/100, Runtime 3.171134, Loss 0.411165, forward nfe 9668, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 020/100, Runtime 3.132083, Loss 0.414693, forward nfe 10098, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 021/100, Runtime 2.993031, Loss 0.450377, forward nfe 10510, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 022/100, Runtime 2.794543, Loss 0.390928, forward nfe 10904, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 023/100, Runtime 3.079079, Loss 0.396691, forward nfe 11286, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 024/100, Runtime 2.922111, Loss 0.422439, forward nfe 11668, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 025/100, Runtime 2.962066, Loss 0.325807, forward nfe 12044, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 026/100, Runtime 2.841247, Loss 0.365803, forward nfe 12408, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 027/100, Runtime 2.897650, Loss 0.319101, forward nfe 12754, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 028/100, Runtime 2.781696, Loss 0.354215, forward nfe 13100, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 029/100, Runtime 2.621917, Loss 0.321566, forward nfe 13434, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 030/100, Runtime 2.602136, Loss 0.248754, forward nfe 13762, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 031/100, Runtime 2.715969, Loss 0.319012, forward nfe 14096, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 032/100, Runtime 2.686091, Loss 0.322250, forward nfe 14424, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 033/100, Runtime 2.541499, Loss 0.263139, forward nfe 14740, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 034/100, Runtime 2.497795, Loss 0.262441, forward nfe 15050, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 035/100, Runtime 2.418686, Loss 0.235240, forward nfe 15360, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 036/100, Runtime 2.537158, Loss 0.262555, forward nfe 15670, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 037/100, Runtime 2.514913, Loss 0.205167, forward nfe 15974, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 038/100, Runtime 2.395622, Loss 0.205259, forward nfe 16278, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 039/100, Runtime 2.270247, Loss 0.177376, forward nfe 16558, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 040/100, Runtime 2.267044, Loss 0.210734, forward nfe 16844, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 041/100, Runtime 2.981143, Loss 0.192491, forward nfe 17118, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 042/100, Runtime 2.722030, Loss 0.220475, forward nfe 17398, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 043/100, Runtime 3.018942, Loss 0.173566, forward nfe 17678, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 044/100, Runtime 3.150314, Loss 0.156049, forward nfe 17958, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 045/100, Runtime 3.060253, Loss 0.198194, forward nfe 18232, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 046/100, Runtime 3.140123, Loss 0.146527, forward nfe 18506, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 047/100, Runtime 3.145676, Loss 0.165964, forward nfe 18780, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 048/100, Runtime 3.138745, Loss 0.148258, forward nfe 19054, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 049/100, Runtime 3.164617, Loss 0.151568, forward nfe 19328, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 050/100, Runtime 3.123156, Loss 0.158464, forward nfe 19602, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 051/100, Runtime 1.174560, Loss 0.110638, forward nfe 19870, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 052/100, Runtime 0.882523, Loss 0.152234, forward nfe 20138, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 053/100, Runtime 0.925562, Loss 0.125460, forward nfe 20400, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 054/100, Runtime 0.879147, Loss 0.187757, forward nfe 20662, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 055/100, Runtime 0.855856, Loss 0.131909, forward nfe 20924, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 056/100, Runtime 0.860324, Loss 0.150383, forward nfe 21186, backward nfe 0, Train: 0.8929, Val: 0.8559, Test: 0.8254, Best time: 85.0000
Epoch: 057/100, Runtime 0.892312, Loss 0.150853, forward nfe 21448, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 265.7521
Epoch: 058/100, Runtime 0.939852, Loss 0.092002, forward nfe 21710, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 059/100, Runtime 0.907736, Loss 0.131500, forward nfe 21966, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 060/100, Runtime 0.978738, Loss 0.089765, forward nfe 22222, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 061/100, Runtime 0.969437, Loss 0.120835, forward nfe 22478, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 062/100, Runtime 0.907404, Loss 0.106338, forward nfe 22734, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 063/100, Runtime 0.915218, Loss 0.092356, forward nfe 22990, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 064/100, Runtime 0.973625, Loss 0.092550, forward nfe 23246, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 065/100, Runtime 0.899096, Loss 0.107792, forward nfe 23502, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 066/100, Runtime 0.756190, Loss 0.087772, forward nfe 23746, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 067/100, Runtime 0.798674, Loss 0.064661, forward nfe 23990, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 068/100, Runtime 0.789478, Loss 0.129732, forward nfe 24234, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 069/100, Runtime 0.825642, Loss 0.077750, forward nfe 24478, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 070/100, Runtime 0.866598, Loss 0.060324, forward nfe 24722, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 071/100, Runtime 0.859418, Loss 0.087265, forward nfe 24966, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 072/100, Runtime 0.874991, Loss 0.047116, forward nfe 25210, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 073/100, Runtime 0.983650, Loss 0.116420, forward nfe 25454, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 074/100, Runtime 0.939745, Loss 0.077555, forward nfe 25698, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 075/100, Runtime 0.919376, Loss 0.095118, forward nfe 25942, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 076/100, Runtime 1.780054, Loss 0.081438, forward nfe 26186, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 077/100, Runtime 2.102426, Loss 0.092827, forward nfe 26430, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 078/100, Runtime 2.127914, Loss 0.066307, forward nfe 26674, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 079/100, Runtime 1.985216, Loss 0.075526, forward nfe 26918, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 080/100, Runtime 1.981402, Loss 0.077970, forward nfe 27156, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 081/100, Runtime 1.948067, Loss 0.072360, forward nfe 27394, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 082/100, Runtime 1.989602, Loss 0.065091, forward nfe 27632, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 083/100, Runtime 1.969116, Loss 0.126669, forward nfe 27870, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 084/100, Runtime 1.974969, Loss 0.063314, forward nfe 28108, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 085/100, Runtime 1.754615, Loss 0.022133, forward nfe 28352, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 086/100, Runtime 1.854400, Loss 0.089217, forward nfe 28596, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 087/100, Runtime 1.886915, Loss 0.055741, forward nfe 28840, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 088/100, Runtime 1.788575, Loss 0.065236, forward nfe 29084, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 089/100, Runtime 1.776897, Loss 0.053696, forward nfe 29322, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 090/100, Runtime 1.969159, Loss 0.096602, forward nfe 29554, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 091/100, Runtime 1.992372, Loss 0.072530, forward nfe 29792, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 092/100, Runtime 2.013871, Loss 0.068881, forward nfe 30030, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 093/100, Runtime 1.999441, Loss 0.088115, forward nfe 30268, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 094/100, Runtime 1.961288, Loss 0.059143, forward nfe 30500, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 095/100, Runtime 1.979128, Loss 0.076026, forward nfe 30732, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 096/100, Runtime 1.923653, Loss 0.037857, forward nfe 30970, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 097/100, Runtime 1.904805, Loss 0.053855, forward nfe 31208, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 098/100, Runtime 2.036370, Loss 0.080581, forward nfe 31434, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
Epoch: 099/100, Runtime 1.898257, Loss 0.095608, forward nfe 31660, backward nfe 0, Train: 0.9857, Val: 0.8625, Test: 0.8467, Best time: 85.0000
best val accuracy 0.862500 with test accuracy 0.846701 at epoch 57 and best time 85.000000