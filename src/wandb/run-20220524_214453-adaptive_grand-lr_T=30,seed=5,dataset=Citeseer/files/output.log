/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.492489, Loss 1.791565, forward nfe 128, backward nfe 0, Train: 0.4833, Val: 0.4442, Test: 0.4710, Best time: 0.3285
Epoch: 002/100, Runtime 0.433681, Loss 1.749901, forward nfe 480, backward nfe 0, Train: 0.5250, Val: 0.5370, Test: 0.5484, Best time: 2.0070
Epoch: 003/100, Runtime 0.421180, Loss 1.708645, forward nfe 844, backward nfe 0, Train: 0.6000, Val: 0.6036, Test: 0.6161, Best time: 1.3951
Epoch: 004/100, Runtime 0.444961, Loss 1.671236, forward nfe 1202, backward nfe 0, Train: 0.5833, Val: 0.6268, Test: 0.6468, Best time: 2.0063
Epoch: 005/100, Runtime 0.414793, Loss 1.638409, forward nfe 1560, backward nfe 0, Train: 0.6333, Val: 0.6529, Test: 0.6468, Best time: 1.4341
Epoch: 006/100, Runtime 0.426670, Loss 1.599756, forward nfe 1912, backward nfe 0, Train: 0.7167, Val: 0.7014, Test: 0.6984, Best time: 2.1074
Epoch: 007/100, Runtime 0.400531, Loss 1.557841, forward nfe 2264, backward nfe 0, Train: 0.7917, Val: 0.7290, Test: 0.7452, Best time: 6.4166
Epoch: 008/100, Runtime 0.421604, Loss 1.542259, forward nfe 2604, backward nfe 0, Train: 0.7750, Val: 0.7399, Test: 0.7403, Best time: 7.8060
Epoch: 009/100, Runtime 0.405119, Loss 1.572354, forward nfe 2950, backward nfe 0, Train: 0.7500, Val: 0.7507, Test: 0.7581, Best time: 17.5457
Epoch: 010/100, Runtime 0.391411, Loss 1.492556, forward nfe 3278, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 21.2580
Epoch: 011/100, Runtime 0.388914, Loss 1.475400, forward nfe 3606, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 012/100, Runtime 0.400653, Loss 1.453131, forward nfe 3934, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 013/100, Runtime 0.389597, Loss 1.474470, forward nfe 4262, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 014/100, Runtime 0.380072, Loss 1.423693, forward nfe 4584, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 015/100, Runtime 0.374664, Loss 1.390447, forward nfe 4888, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 016/100, Runtime 0.370953, Loss 1.396762, forward nfe 5198, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 017/100, Runtime 0.373328, Loss 1.343260, forward nfe 5508, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 018/100, Runtime 0.370595, Loss 1.285309, forward nfe 5818, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 019/100, Runtime 0.379902, Loss 1.287837, forward nfe 6128, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 020/100, Runtime 0.363555, Loss 1.253769, forward nfe 6432, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 021/100, Runtime 0.398683, Loss 1.221035, forward nfe 6730, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 022/100, Runtime 0.349709, Loss 1.145986, forward nfe 7022, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 023/100, Runtime 0.347288, Loss 1.142401, forward nfe 7314, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 024/100, Runtime 0.338941, Loss 1.113146, forward nfe 7600, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 025/100, Runtime 0.351089, Loss 1.179823, forward nfe 7886, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 026/100, Runtime 0.346209, Loss 1.098192, forward nfe 8172, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 027/100, Runtime 0.349780, Loss 1.023035, forward nfe 8446, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 028/100, Runtime 0.339222, Loss 1.033622, forward nfe 8720, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 029/100, Runtime 0.336970, Loss 1.080919, forward nfe 8994, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 030/100, Runtime 0.339639, Loss 1.133185, forward nfe 9268, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 031/100, Runtime 0.357392, Loss 1.158064, forward nfe 9542, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 032/100, Runtime 0.323824, Loss 1.153462, forward nfe 9804, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 033/100, Runtime 0.319013, Loss 1.115572, forward nfe 10066, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 034/100, Runtime 0.320917, Loss 1.051017, forward nfe 10328, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 035/100, Runtime 0.311269, Loss 1.136486, forward nfe 10584, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 036/100, Runtime 0.313643, Loss 1.051659, forward nfe 10834, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 037/100, Runtime 0.314443, Loss 1.050224, forward nfe 11084, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 038/100, Runtime 0.300477, Loss 1.020810, forward nfe 11334, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 039/100, Runtime 0.292573, Loss 1.038414, forward nfe 11578, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 040/100, Runtime 0.291519, Loss 1.007082, forward nfe 11816, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 041/100, Runtime 0.294780, Loss 1.053591, forward nfe 12054, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 042/100, Runtime 0.297522, Loss 0.934531, forward nfe 12292, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 043/100, Runtime 0.285886, Loss 1.063199, forward nfe 12524, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 044/100, Runtime 0.285951, Loss 1.069822, forward nfe 12750, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 045/100, Runtime 0.277225, Loss 1.027067, forward nfe 12976, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 046/100, Runtime 0.281765, Loss 1.059246, forward nfe 13202, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 047/100, Runtime 0.273438, Loss 1.123997, forward nfe 13422, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 048/100, Runtime 0.276603, Loss 1.034241, forward nfe 13642, backward nfe 0, Train: 0.7167, Val: 0.7551, Test: 0.7548, Best time: 30.0000
Epoch: 049/100, Runtime 0.281136, Loss 1.044677, forward nfe 13862, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 80.0058
Epoch: 050/100, Runtime 0.272446, Loss 1.076997, forward nfe 14082, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 051/100, Runtime 0.280212, Loss 1.091923, forward nfe 14302, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 052/100, Runtime 0.263807, Loss 1.092984, forward nfe 14522, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 053/100, Runtime 0.264828, Loss 0.989482, forward nfe 14742, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 054/100, Runtime 0.279354, Loss 1.016260, forward nfe 14962, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 055/100, Runtime 0.262388, Loss 1.008528, forward nfe 15182, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 056/100, Runtime 0.274308, Loss 0.973202, forward nfe 15402, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 057/100, Runtime 0.265527, Loss 1.078844, forward nfe 15622, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 058/100, Runtime 0.268738, Loss 0.912614, forward nfe 15836, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 059/100, Runtime 0.264953, Loss 1.112764, forward nfe 16050, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 060/100, Runtime 0.271032, Loss 1.117502, forward nfe 16270, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 061/100, Runtime 0.273229, Loss 1.032496, forward nfe 16496, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 062/100, Runtime 0.282246, Loss 1.096681, forward nfe 16722, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 063/100, Runtime 0.284754, Loss 1.148449, forward nfe 16948, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 064/100, Runtime 0.284047, Loss 1.111633, forward nfe 17180, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 065/100, Runtime 0.299733, Loss 1.033659, forward nfe 17412, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 066/100, Runtime 0.299249, Loss 1.090238, forward nfe 17644, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 067/100, Runtime 0.286652, Loss 1.057751, forward nfe 17876, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 068/100, Runtime 0.297951, Loss 1.087071, forward nfe 18108, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 069/100, Runtime 0.298275, Loss 0.970373, forward nfe 18340, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 070/100, Runtime 0.279468, Loss 1.064014, forward nfe 18572, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 071/100, Runtime 0.283283, Loss 1.098107, forward nfe 18798, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 072/100, Runtime 0.292307, Loss 1.103463, forward nfe 19024, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 073/100, Runtime 0.298473, Loss 1.004422, forward nfe 19250, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 074/100, Runtime 0.284860, Loss 1.066829, forward nfe 19476, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 075/100, Runtime 0.291275, Loss 0.902620, forward nfe 19702, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 076/100, Runtime 0.277119, Loss 1.074372, forward nfe 19928, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 077/100, Runtime 0.287479, Loss 1.077126, forward nfe 20154, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 078/100, Runtime 0.277411, Loss 1.073126, forward nfe 20380, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 079/100, Runtime 0.297264, Loss 0.999786, forward nfe 20606, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 080/100, Runtime 0.283555, Loss 0.978476, forward nfe 20832, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 081/100, Runtime 0.288313, Loss 0.882233, forward nfe 21058, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 082/100, Runtime 0.281353, Loss 1.018058, forward nfe 21284, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 083/100, Runtime 0.277515, Loss 1.012414, forward nfe 21510, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 084/100, Runtime 0.278612, Loss 1.055460, forward nfe 21736, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 085/100, Runtime 0.284336, Loss 0.994828, forward nfe 21962, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 086/100, Runtime 0.302113, Loss 0.988597, forward nfe 22188, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 087/100, Runtime 0.296352, Loss 1.086001, forward nfe 22414, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 088/100, Runtime 0.286254, Loss 1.114336, forward nfe 22646, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 089/100, Runtime 0.289381, Loss 1.108581, forward nfe 22878, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 090/100, Runtime 0.289836, Loss 1.006552, forward nfe 23110, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 091/100, Runtime 0.420212, Loss 0.995594, forward nfe 23342, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 092/100, Runtime 0.284770, Loss 1.020706, forward nfe 23574, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 093/100, Runtime 0.309479, Loss 1.036366, forward nfe 23806, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 094/100, Runtime 0.289232, Loss 1.138470, forward nfe 24038, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 095/100, Runtime 0.287822, Loss 1.092350, forward nfe 24270, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 096/100, Runtime 0.293648, Loss 1.075451, forward nfe 24496, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 097/100, Runtime 0.281959, Loss 1.041818, forward nfe 24722, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 098/100, Runtime 0.291931, Loss 1.097386, forward nfe 24948, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
Epoch: 099/100, Runtime 0.285183, Loss 1.151731, forward nfe 25168, backward nfe 0, Train: 0.7833, Val: 0.7558, Test: 0.7548, Best time: 30.0000
best val accuracy 0.755797 with test accuracy 0.754839 at epoch 49 and best time 30.000000