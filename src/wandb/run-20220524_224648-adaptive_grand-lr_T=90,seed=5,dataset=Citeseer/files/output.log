/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.905225, Loss 1.795134, forward nfe 224, backward nfe 0, Train: 0.3000, Val: 0.2304, Test: 0.2339, Best time: 2.0789
Epoch: 002/100, Runtime 0.820709, Loss 1.790452, forward nfe 984, backward nfe 0, Train: 0.4417, Val: 0.4616, Test: 0.4677, Best time: 0.8436
Epoch: 003/100, Runtime 0.857999, Loss 1.767785, forward nfe 1744, backward nfe 0, Train: 0.5000, Val: 0.5486, Test: 0.5532, Best time: 1.3698
Epoch: 004/100, Runtime 0.833862, Loss 1.710643, forward nfe 2510, backward nfe 0, Train: 0.5167, Val: 0.5580, Test: 0.5742, Best time: 2.6066
Epoch: 005/100, Runtime 0.829573, Loss 1.689411, forward nfe 3264, backward nfe 0, Train: 0.5083, Val: 0.5587, Test: 0.5677, Best time: 2.0143
Epoch: 006/100, Runtime 0.801881, Loss 1.639715, forward nfe 3994, backward nfe 0, Train: 0.5083, Val: 0.5616, Test: 0.5726, Best time: 2.1094
Epoch: 007/100, Runtime 0.801306, Loss 1.612105, forward nfe 4712, backward nfe 0, Train: 0.5833, Val: 0.5790, Test: 0.5806, Best time: 6.5208
Epoch: 008/100, Runtime 0.790050, Loss 1.586009, forward nfe 5424, backward nfe 0, Train: 0.6000, Val: 0.6196, Test: 0.6290, Best time: 46.4684
Epoch: 009/100, Runtime 0.757586, Loss 1.540360, forward nfe 6124, backward nfe 0, Train: 0.6417, Val: 0.6739, Test: 0.6984, Best time: 53.6678
Epoch: 010/100, Runtime 0.755595, Loss 1.511783, forward nfe 6806, backward nfe 0, Train: 0.7000, Val: 0.7014, Test: 0.7081, Best time: 33.2824
Epoch: 011/100, Runtime 0.748119, Loss 1.488033, forward nfe 7494, backward nfe 0, Train: 0.7000, Val: 0.7014, Test: 0.7081, Best time: 90.0000
Epoch: 012/100, Runtime 0.733570, Loss 1.510485, forward nfe 8164, backward nfe 0, Train: 0.7000, Val: 0.7014, Test: 0.7081, Best time: 90.0000
Epoch: 013/100, Runtime 0.718280, Loss 1.473404, forward nfe 8822, backward nfe 0, Train: 0.7000, Val: 0.7014, Test: 0.7081, Best time: 90.0000
Epoch: 014/100, Runtime 0.707958, Loss 1.443164, forward nfe 9462, backward nfe 0, Train: 0.7000, Val: 0.7014, Test: 0.7081, Best time: 90.0000
Epoch: 015/100, Runtime 0.704980, Loss 1.298911, forward nfe 10108, backward nfe 0, Train: 0.7000, Val: 0.7014, Test: 0.7081, Best time: 90.0000
Epoch: 016/100, Runtime 0.714456, Loss 1.380018, forward nfe 10742, backward nfe 0, Train: 0.7167, Val: 0.7210, Test: 0.7387, Best time: 63.1964
Epoch: 017/100, Runtime 0.677609, Loss 1.316599, forward nfe 11364, backward nfe 0, Train: 0.7167, Val: 0.7217, Test: 0.7323, Best time: 59.7289
Epoch: 018/100, Runtime 0.681865, Loss 1.323683, forward nfe 11974, backward nfe 0, Train: 0.7583, Val: 0.7304, Test: 0.7339, Best time: 49.1134
Epoch: 019/100, Runtime 0.673844, Loss 1.329787, forward nfe 12572, backward nfe 0, Train: 0.7583, Val: 0.7304, Test: 0.7339, Best time: 90.0000
Epoch: 020/100, Runtime 0.665894, Loss 1.295101, forward nfe 13170, backward nfe 0, Train: 0.7583, Val: 0.7304, Test: 0.7339, Best time: 90.0000
Epoch: 021/100, Runtime 0.651081, Loss 1.369768, forward nfe 13762, backward nfe 0, Train: 0.7583, Val: 0.7304, Test: 0.7339, Best time: 90.0000
Epoch: 022/100, Runtime 0.627253, Loss 1.202172, forward nfe 14342, backward nfe 0, Train: 0.7583, Val: 0.7304, Test: 0.7339, Best time: 90.0000
Epoch: 023/100, Runtime 0.608824, Loss 1.338275, forward nfe 14904, backward nfe 0, Train: 0.7750, Val: 0.7348, Test: 0.7323, Best time: 80.2109
Epoch: 024/100, Runtime 0.606354, Loss 1.297778, forward nfe 15454, backward nfe 0, Train: 0.7750, Val: 0.7348, Test: 0.7323, Best time: 90.0000
Epoch: 025/100, Runtime 0.617730, Loss 1.226207, forward nfe 15998, backward nfe 0, Train: 0.7750, Val: 0.7348, Test: 0.7323, Best time: 90.0000
Epoch: 026/100, Runtime 0.599790, Loss 1.171695, forward nfe 16536, backward nfe 0, Train: 0.7750, Val: 0.7348, Test: 0.7323, Best time: 90.0000
Epoch: 027/100, Runtime 0.599792, Loss 1.186234, forward nfe 17068, backward nfe 0, Train: 0.7750, Val: 0.7348, Test: 0.7323, Best time: 90.0000
Epoch: 028/100, Runtime 0.610612, Loss 1.190727, forward nfe 17594, backward nfe 0, Train: 0.7750, Val: 0.7348, Test: 0.7323, Best time: 90.0000
Epoch: 029/100, Runtime 0.579458, Loss 1.201945, forward nfe 18108, backward nfe 0, Train: 0.7750, Val: 0.7348, Test: 0.7323, Best time: 90.0000
Epoch: 030/100, Runtime 0.581938, Loss 1.189465, forward nfe 18616, backward nfe 0, Train: 0.7750, Val: 0.7348, Test: 0.7323, Best time: 90.0000
Epoch: 031/100, Runtime 0.562413, Loss 1.364540, forward nfe 19118, backward nfe 0, Train: 0.7750, Val: 0.7348, Test: 0.7323, Best time: 90.0000
Epoch: 032/100, Runtime 0.551235, Loss 1.219302, forward nfe 19608, backward nfe 0, Train: 0.7750, Val: 0.7348, Test: 0.7323, Best time: 90.0000
Epoch: 033/100, Runtime 0.571747, Loss 1.149968, forward nfe 20092, backward nfe 0, Train: 0.7750, Val: 0.7377, Test: 0.7371, Best time: 68.8502
Epoch: 034/100, Runtime 0.556988, Loss 1.124899, forward nfe 20576, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 92.1991
Epoch: 035/100, Runtime 0.538780, Loss 1.131584, forward nfe 21048, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 036/100, Runtime 0.523607, Loss 1.185760, forward nfe 21508, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 037/100, Runtime 0.521116, Loss 1.123364, forward nfe 21956, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 038/100, Runtime 0.520834, Loss 1.217386, forward nfe 22404, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 039/100, Runtime 0.513683, Loss 1.251191, forward nfe 22846, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 040/100, Runtime 0.492402, Loss 1.236828, forward nfe 23282, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 041/100, Runtime 0.495000, Loss 1.145621, forward nfe 23712, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 042/100, Runtime 0.499371, Loss 1.108190, forward nfe 24136, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 043/100, Runtime 0.476968, Loss 1.186369, forward nfe 24560, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 044/100, Runtime 0.473207, Loss 1.233478, forward nfe 24972, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 045/100, Runtime 0.469772, Loss 1.155355, forward nfe 25384, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 046/100, Runtime 0.449128, Loss 1.129740, forward nfe 25790, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 047/100, Runtime 0.479739, Loss 1.162621, forward nfe 26190, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 048/100, Runtime 0.442317, Loss 1.097086, forward nfe 26590, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 049/100, Runtime 0.570837, Loss 1.128363, forward nfe 26978, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 050/100, Runtime 0.443074, Loss 1.207693, forward nfe 27366, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 051/100, Runtime 0.459251, Loss 1.112330, forward nfe 27748, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 052/100, Runtime 0.438636, Loss 1.194881, forward nfe 28130, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 053/100, Runtime 0.422809, Loss 1.150636, forward nfe 28500, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 054/100, Runtime 0.427077, Loss 1.203982, forward nfe 28858, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 055/100, Runtime 0.427938, Loss 1.194680, forward nfe 29222, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 056/100, Runtime 0.427025, Loss 1.197245, forward nfe 29580, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 057/100, Runtime 0.409346, Loss 1.182039, forward nfe 29932, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 058/100, Runtime 0.422465, Loss 1.115446, forward nfe 30284, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 059/100, Runtime 0.441615, Loss 1.195674, forward nfe 30636, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 060/100, Runtime 0.408349, Loss 1.177539, forward nfe 30982, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 061/100, Runtime 0.417659, Loss 1.205018, forward nfe 31328, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 062/100, Runtime 0.406291, Loss 1.159679, forward nfe 31668, backward nfe 0, Train: 0.7667, Val: 0.7384, Test: 0.7484, Best time: 90.0000
Epoch: 063/100, Runtime 0.434320, Loss 1.164802, forward nfe 32008, backward nfe 0, Train: 0.7917, Val: 0.7406, Test: 0.7468, Best time: 88.9046
Epoch: 064/100, Runtime 0.416921, Loss 1.249183, forward nfe 32348, backward nfe 0, Train: 0.7917, Val: 0.7406, Test: 0.7468, Best time: 90.0000
Epoch: 065/100, Runtime 0.416802, Loss 1.112055, forward nfe 32694, backward nfe 0, Train: 0.7917, Val: 0.7406, Test: 0.7468, Best time: 90.0000
Epoch: 066/100, Runtime 0.412296, Loss 1.165539, forward nfe 33034, backward nfe 0, Train: 0.7917, Val: 0.7406, Test: 0.7468, Best time: 90.0000
Epoch: 067/100, Runtime 0.411455, Loss 1.119915, forward nfe 33374, backward nfe 0, Train: 0.7917, Val: 0.7406, Test: 0.7468, Best time: 90.0000
Epoch: 068/100, Runtime 0.404843, Loss 1.146390, forward nfe 33714, backward nfe 0, Train: 0.7917, Val: 0.7406, Test: 0.7468, Best time: 90.0000
Epoch: 069/100, Runtime 0.404711, Loss 1.031940, forward nfe 34054, backward nfe 0, Train: 0.7917, Val: 0.7406, Test: 0.7468, Best time: 90.0000
Epoch: 070/100, Runtime 0.404696, Loss 1.045825, forward nfe 34388, backward nfe 0, Train: 0.7917, Val: 0.7406, Test: 0.7468, Best time: 90.0000
Epoch: 071/100, Runtime 0.398873, Loss 1.132747, forward nfe 34722, backward nfe 0, Train: 0.7917, Val: 0.7406, Test: 0.7468, Best time: 90.0000
Epoch: 072/100, Runtime 0.392275, Loss 1.079353, forward nfe 35056, backward nfe 0, Train: 0.7917, Val: 0.7406, Test: 0.7468, Best time: 90.0000
Epoch: 073/100, Runtime 0.386647, Loss 1.083557, forward nfe 35390, backward nfe 0, Train: 0.7917, Val: 0.7420, Test: 0.7565, Best time: 126.1295
Epoch: 074/100, Runtime 0.396172, Loss 1.055502, forward nfe 35730, backward nfe 0, Train: 0.7917, Val: 0.7420, Test: 0.7565, Best time: 90.0000
Epoch: 075/100, Runtime 0.398265, Loss 1.021199, forward nfe 36070, backward nfe 0, Train: 0.7917, Val: 0.7420, Test: 0.7565, Best time: 90.0000
Epoch: 076/100, Runtime 0.395977, Loss 1.173309, forward nfe 36404, backward nfe 0, Train: 0.7917, Val: 0.7420, Test: 0.7565, Best time: 90.0000
Epoch: 077/100, Runtime 0.389654, Loss 1.116332, forward nfe 36738, backward nfe 0, Train: 0.7917, Val: 0.7420, Test: 0.7565, Best time: 90.0000
Epoch: 078/100, Runtime 0.394726, Loss 1.095464, forward nfe 37066, backward nfe 0, Train: 0.7917, Val: 0.7420, Test: 0.7565, Best time: 90.0000
Epoch: 079/100, Runtime 0.388432, Loss 1.158697, forward nfe 37394, backward nfe 0, Train: 0.7917, Val: 0.7420, Test: 0.7565, Best time: 90.0000
Epoch: 080/100, Runtime 0.396334, Loss 0.991554, forward nfe 37728, backward nfe 0, Train: 0.7917, Val: 0.7420, Test: 0.7565, Best time: 90.0000
Epoch: 081/100, Runtime 0.396272, Loss 1.249902, forward nfe 38056, backward nfe 0, Train: 0.7917, Val: 0.7420, Test: 0.7565, Best time: 90.0000
Epoch: 082/100, Runtime 0.411779, Loss 1.123380, forward nfe 38384, backward nfe 0, Train: 0.7917, Val: 0.7420, Test: 0.7565, Best time: 90.0000
Epoch: 083/100, Runtime 0.397727, Loss 1.155097, forward nfe 38712, backward nfe 0, Train: 0.7917, Val: 0.7420, Test: 0.7565, Best time: 90.0000
Epoch: 084/100, Runtime 0.384300, Loss 1.121048, forward nfe 39040, backward nfe 0, Train: 0.7917, Val: 0.7420, Test: 0.7565, Best time: 90.0000
Epoch: 085/100, Runtime 0.388547, Loss 1.115652, forward nfe 39368, backward nfe 0, Train: 0.7917, Val: 0.7420, Test: 0.7565, Best time: 90.0000
Epoch: 086/100, Runtime 0.418281, Loss 1.073469, forward nfe 39696, backward nfe 0, Train: 0.8000, Val: 0.7442, Test: 0.7387, Best time: 90.7361
Epoch: 087/100, Runtime 0.390557, Loss 1.044978, forward nfe 40030, backward nfe 0, Train: 0.8000, Val: 0.7442, Test: 0.7387, Best time: 90.0000
Epoch: 088/100, Runtime 0.371678, Loss 1.028674, forward nfe 40358, backward nfe 0, Train: 0.8000, Val: 0.7442, Test: 0.7387, Best time: 90.0000
Epoch: 089/100, Runtime 0.386646, Loss 1.090147, forward nfe 40680, backward nfe 0, Train: 0.8000, Val: 0.7442, Test: 0.7387, Best time: 90.0000
Epoch: 090/100, Runtime 0.374474, Loss 1.093019, forward nfe 41002, backward nfe 0, Train: 0.8000, Val: 0.7442, Test: 0.7387, Best time: 90.0000
Epoch: 091/100, Runtime 0.394586, Loss 1.054182, forward nfe 41318, backward nfe 0, Train: 0.8000, Val: 0.7442, Test: 0.7387, Best time: 90.0000
Epoch: 092/100, Runtime 0.382121, Loss 1.106143, forward nfe 41634, backward nfe 0, Train: 0.8000, Val: 0.7442, Test: 0.7387, Best time: 90.0000
Epoch: 093/100, Runtime 0.377843, Loss 1.001298, forward nfe 41950, backward nfe 0, Train: 0.8000, Val: 0.7442, Test: 0.7387, Best time: 90.0000
Epoch: 094/100, Runtime 0.390673, Loss 1.115377, forward nfe 42266, backward nfe 0, Train: 0.8000, Val: 0.7442, Test: 0.7387, Best time: 90.0000
Epoch: 095/100, Runtime 0.393313, Loss 1.053833, forward nfe 42582, backward nfe 0, Train: 0.8000, Val: 0.7442, Test: 0.7387, Best time: 90.0000
Epoch: 096/100, Runtime 0.398110, Loss 1.030852, forward nfe 42898, backward nfe 0, Train: 0.8000, Val: 0.7442, Test: 0.7387, Best time: 90.0000
Epoch: 097/100, Runtime 0.387650, Loss 1.202790, forward nfe 43214, backward nfe 0, Train: 0.8000, Val: 0.7442, Test: 0.7387, Best time: 90.0000
Epoch: 098/100, Runtime 0.378802, Loss 1.088297, forward nfe 43530, backward nfe 0, Train: 0.8000, Val: 0.7442, Test: 0.7387, Best time: 90.0000
Epoch: 099/100, Runtime 0.369843, Loss 1.046340, forward nfe 43846, backward nfe 0, Train: 0.8000, Val: 0.7442, Test: 0.7387, Best time: 90.0000
best val accuracy 0.744203 with test accuracy 0.738710 at epoch 86 and best time 90.000000