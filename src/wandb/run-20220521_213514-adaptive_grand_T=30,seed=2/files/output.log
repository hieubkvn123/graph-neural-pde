/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 2.194723, Loss 1.948048, forward nfe 74, backward nfe 0, Train: 0.3857, Val: 0.3368, Test: 0.3340, Best time: 0.0949
Epoch: 002/100, Runtime 2.244958, Loss 1.938647, forward nfe 342, backward nfe 0, Train: 0.3857, Val: 0.3368, Test: 0.3340, Best time: 30.0000
Epoch: 003/100, Runtime 2.027951, Loss 1.863317, forward nfe 604, backward nfe 0, Train: 0.5286, Val: 0.4132, Test: 0.3898, Best time: 2.2589
Epoch: 004/100, Runtime 2.030167, Loss 1.712214, forward nfe 848, backward nfe 0, Train: 0.7357, Val: 0.6515, Test: 0.6396, Best time: 7.4592
Epoch: 005/100, Runtime 2.023091, Loss 1.500049, forward nfe 1098, backward nfe 0, Train: 0.7929, Val: 0.7235, Test: 0.7188, Best time: 10.0735
Epoch: 006/100, Runtime 2.026907, Loss 1.230225, forward nfe 1336, backward nfe 0, Train: 0.8429, Val: 0.8037, Test: 0.7848, Best time: 29.7020
Epoch: 007/100, Runtime 1.976063, Loss 0.979379, forward nfe 1580, backward nfe 0, Train: 0.8714, Val: 0.8162, Test: 0.8061, Best time: 17.5696
Epoch: 008/100, Runtime 1.967709, Loss 0.735586, forward nfe 1824, backward nfe 0, Train: 0.8643, Val: 0.8309, Test: 0.8244, Best time: 13.7469
Epoch: 009/100, Runtime 1.839992, Loss 0.604179, forward nfe 2044, backward nfe 0, Train: 0.8786, Val: 0.8375, Test: 0.8264, Best time: 31.7911
Epoch: 010/100, Runtime 1.825722, Loss 0.512787, forward nfe 2264, backward nfe 0, Train: 0.8786, Val: 0.8375, Test: 0.8264, Best time: 30.0000
Epoch: 011/100, Runtime 1.816625, Loss 0.471776, forward nfe 2478, backward nfe 0, Train: 0.8786, Val: 0.8382, Test: 0.8244, Best time: 77.8074
Epoch: 012/100, Runtime 1.687020, Loss 0.366628, forward nfe 2692, backward nfe 0, Train: 0.8786, Val: 0.8382, Test: 0.8244, Best time: 30.0000
Epoch: 013/100, Runtime 1.814898, Loss 0.363530, forward nfe 2900, backward nfe 0, Train: 0.9143, Val: 0.8426, Test: 0.8355, Best time: 29.7420
Epoch: 014/100, Runtime 1.714036, Loss 0.341461, forward nfe 3114, backward nfe 0, Train: 0.9000, Val: 0.8441, Test: 0.8386, Best time: 53.1893
Epoch: 015/100, Runtime 1.712886, Loss 0.283058, forward nfe 3316, backward nfe 0, Train: 0.9000, Val: 0.8441, Test: 0.8386, Best time: 30.0000
Epoch: 016/100, Runtime 1.654788, Loss 0.264768, forward nfe 3518, backward nfe 0, Train: 0.9000, Val: 0.8441, Test: 0.8386, Best time: 30.0000
Epoch: 017/100, Runtime 1.633135, Loss 0.299691, forward nfe 3708, backward nfe 0, Train: 0.9000, Val: 0.8441, Test: 0.8386, Best time: 30.0000
Epoch: 018/100, Runtime 1.538079, Loss 0.256684, forward nfe 3898, backward nfe 0, Train: 0.9000, Val: 0.8441, Test: 0.8386, Best time: 30.0000
Epoch: 019/100, Runtime 1.439201, Loss 0.265248, forward nfe 4076, backward nfe 0, Train: 0.9000, Val: 0.8441, Test: 0.8386, Best time: 30.0000
Epoch: 020/100, Runtime 1.529705, Loss 0.319241, forward nfe 4248, backward nfe 0, Train: 0.9000, Val: 0.8441, Test: 0.8386, Best time: 30.0000
Epoch: 021/100, Runtime 1.534477, Loss 0.198365, forward nfe 4426, backward nfe 0, Train: 0.9000, Val: 0.8441, Test: 0.8386, Best time: 30.0000
Epoch: 022/100, Runtime 1.459545, Loss 0.211964, forward nfe 4604, backward nfe 0, Train: 0.9000, Val: 0.8441, Test: 0.8386, Best time: 30.0000
Epoch: 023/100, Runtime 1.436531, Loss 0.237881, forward nfe 4776, backward nfe 0, Train: 0.9000, Val: 0.8441, Test: 0.8386, Best time: 30.0000
Epoch: 024/100, Runtime 1.407764, Loss 0.171099, forward nfe 4948, backward nfe 0, Train: 0.9000, Val: 0.8441, Test: 0.8386, Best time: 30.0000
Epoch: 025/100, Runtime 1.415556, Loss 0.169925, forward nfe 5114, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 96.9217
Epoch: 026/100, Runtime 1.319149, Loss 0.161990, forward nfe 5274, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 027/100, Runtime 1.374699, Loss 0.159334, forward nfe 5428, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 028/100, Runtime 1.415741, Loss 0.208483, forward nfe 5588, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 029/100, Runtime 1.353129, Loss 0.191445, forward nfe 5748, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 030/100, Runtime 1.425210, Loss 0.179395, forward nfe 5908, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 031/100, Runtime 1.378155, Loss 0.168652, forward nfe 6068, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 032/100, Runtime 1.181591, Loss 0.168437, forward nfe 6228, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 033/100, Runtime 1.271802, Loss 0.191673, forward nfe 6376, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 034/100, Runtime 1.299198, Loss 0.178038, forward nfe 6524, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 035/100, Runtime 1.243663, Loss 0.158325, forward nfe 6672, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 036/100, Runtime 1.269615, Loss 0.136522, forward nfe 6820, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 037/100, Runtime 1.244839, Loss 0.156674, forward nfe 6962, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 038/100, Runtime 1.289685, Loss 0.185596, forward nfe 7104, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 039/100, Runtime 1.313342, Loss 0.120738, forward nfe 7252, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 040/100, Runtime 1.220635, Loss 0.114126, forward nfe 7400, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 041/100, Runtime 1.235651, Loss 0.128893, forward nfe 7548, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 042/100, Runtime 1.209773, Loss 0.148082, forward nfe 7696, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 043/100, Runtime 1.204768, Loss 0.090245, forward nfe 7844, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 044/100, Runtime 1.205370, Loss 0.125197, forward nfe 7992, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 045/100, Runtime 1.282895, Loss 0.130096, forward nfe 8140, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 046/100, Runtime 1.283797, Loss 0.077966, forward nfe 8288, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 047/100, Runtime 1.296161, Loss 0.061938, forward nfe 8436, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 048/100, Runtime 1.296552, Loss 0.118511, forward nfe 8584, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 049/100, Runtime 1.276789, Loss 0.103712, forward nfe 8732, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 050/100, Runtime 1.310959, Loss 0.099829, forward nfe 8880, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 051/100, Runtime 1.296776, Loss 0.120095, forward nfe 9028, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 052/100, Runtime 1.286032, Loss 0.075883, forward nfe 9176, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 053/100, Runtime 1.272619, Loss 0.122394, forward nfe 9324, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 054/100, Runtime 1.269882, Loss 0.121423, forward nfe 9472, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 055/100, Runtime 1.205809, Loss 0.077473, forward nfe 9620, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 056/100, Runtime 1.165369, Loss 0.073758, forward nfe 9756, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 057/100, Runtime 1.145925, Loss 0.089569, forward nfe 9892, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 058/100, Runtime 1.219452, Loss 0.072901, forward nfe 10028, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 059/100, Runtime 1.174024, Loss 0.076756, forward nfe 10164, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 060/100, Runtime 1.160385, Loss 0.085168, forward nfe 10300, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 061/100, Runtime 1.208743, Loss 0.119500, forward nfe 10436, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 062/100, Runtime 1.140585, Loss 0.064973, forward nfe 10572, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 063/100, Runtime 1.170999, Loss 0.108888, forward nfe 10708, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 064/100, Runtime 1.210654, Loss 0.085170, forward nfe 10844, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 065/100, Runtime 1.151270, Loss 0.091357, forward nfe 10980, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 066/100, Runtime 1.174761, Loss 0.051882, forward nfe 11116, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 067/100, Runtime 1.201609, Loss 0.065309, forward nfe 11252, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 068/100, Runtime 1.134727, Loss 0.080149, forward nfe 11388, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 069/100, Runtime 1.182201, Loss 0.069538, forward nfe 11524, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 070/100, Runtime 0.982116, Loss 0.040403, forward nfe 11660, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 071/100, Runtime 1.514172, Loss 0.079000, forward nfe 11796, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 072/100, Runtime 1.542881, Loss 0.106888, forward nfe 11932, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 073/100, Runtime 1.551465, Loss 0.061465, forward nfe 12068, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 074/100, Runtime 1.332979, Loss 0.045836, forward nfe 12204, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 075/100, Runtime 1.505437, Loss 0.052860, forward nfe 12340, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 076/100, Runtime 1.469692, Loss 0.071664, forward nfe 12476, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 077/100, Runtime 1.476677, Loss 0.048416, forward nfe 12612, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 078/100, Runtime 1.410403, Loss 0.092667, forward nfe 12748, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 079/100, Runtime 1.482412, Loss 0.048244, forward nfe 12884, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 080/100, Runtime 1.457915, Loss 0.058139, forward nfe 13020, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 081/100, Runtime 1.485996, Loss 0.067747, forward nfe 13156, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 082/100, Runtime 1.475718, Loss 0.076557, forward nfe 13292, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 083/100, Runtime 1.602589, Loss 0.059498, forward nfe 13428, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 084/100, Runtime 1.566190, Loss 0.043176, forward nfe 13564, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 085/100, Runtime 1.647880, Loss 0.093326, forward nfe 13700, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 086/100, Runtime 1.555393, Loss 0.028080, forward nfe 13836, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 087/100, Runtime 1.558679, Loss 0.062837, forward nfe 13960, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 088/100, Runtime 1.522067, Loss 0.045425, forward nfe 14090, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 089/100, Runtime 1.625710, Loss 0.064329, forward nfe 14220, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 090/100, Runtime 1.605735, Loss 0.058134, forward nfe 14356, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 091/100, Runtime 1.174770, Loss 0.052473, forward nfe 14492, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 092/100, Runtime 0.475901, Loss 0.032874, forward nfe 14634, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 093/100, Runtime 0.486588, Loss 0.051461, forward nfe 14776, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 094/100, Runtime 0.568308, Loss 0.024061, forward nfe 14924, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 095/100, Runtime 0.540169, Loss 0.054839, forward nfe 15072, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 096/100, Runtime 0.627950, Loss 0.081592, forward nfe 15226, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 097/100, Runtime 0.546988, Loss 0.041581, forward nfe 15398, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 098/100, Runtime 0.559059, Loss 0.049262, forward nfe 15564, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
Epoch: 099/100, Runtime 0.686838, Loss 0.066124, forward nfe 15754, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8447, Best time: 30.0000
best val accuracy 0.847059 with test accuracy 0.844670 at epoch 25 and best time 30.000000