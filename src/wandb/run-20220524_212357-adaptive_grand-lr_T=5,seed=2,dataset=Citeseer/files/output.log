/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.227369, Loss 1.792244, forward nfe 56, backward nfe 0, Train: 0.3500, Val: 0.2580, Test: 0.2500, Best time: 0.0415
Epoch: 002/100, Runtime 0.194667, Loss 1.765465, forward nfe 210, backward nfe 0, Train: 0.6000, Val: 0.3290, Test: 0.3032, Best time: 0.9199
Epoch: 003/100, Runtime 0.199821, Loss 1.728549, forward nfe 364, backward nfe 0, Train: 0.7083, Val: 0.3478, Test: 0.3242, Best time: 0.3180
Epoch: 004/100, Runtime 0.225862, Loss 1.697945, forward nfe 524, backward nfe 0, Train: 0.8000, Val: 0.4333, Test: 0.4306, Best time: 1.4453
Epoch: 005/100, Runtime 0.223066, Loss 1.674054, forward nfe 690, backward nfe 0, Train: 0.8500, Val: 0.5377, Test: 0.5532, Best time: 3.4583
Epoch: 006/100, Runtime 0.214797, Loss 1.650588, forward nfe 856, backward nfe 0, Train: 0.8667, Val: 0.5870, Test: 0.6177, Best time: 5.1512
Epoch: 007/100, Runtime 0.209505, Loss 1.619149, forward nfe 1022, backward nfe 0, Train: 0.8750, Val: 0.6152, Test: 0.6387, Best time: 4.3309
Epoch: 008/100, Runtime 0.196481, Loss 1.602549, forward nfe 1176, backward nfe 0, Train: 0.8750, Val: 0.6152, Test: 0.6387, Best time: 5.0000
Epoch: 009/100, Runtime 0.220033, Loss 1.592019, forward nfe 1330, backward nfe 0, Train: 0.8750, Val: 0.6152, Test: 0.6387, Best time: 5.0000
Epoch: 010/100, Runtime 0.201920, Loss 1.580289, forward nfe 1484, backward nfe 0, Train: 0.8750, Val: 0.6152, Test: 0.6387, Best time: 5.0000
Epoch: 011/100, Runtime 0.205059, Loss 1.562640, forward nfe 1638, backward nfe 0, Train: 0.8750, Val: 0.6152, Test: 0.6387, Best time: 5.0000
Epoch: 012/100, Runtime 0.206376, Loss 1.522789, forward nfe 1792, backward nfe 0, Train: 0.8417, Val: 0.6268, Test: 0.6387, Best time: 3.8910
Epoch: 013/100, Runtime 0.195753, Loss 1.509209, forward nfe 1946, backward nfe 0, Train: 0.8500, Val: 0.6304, Test: 0.6306, Best time: 1.6203
Epoch: 014/100, Runtime 0.194487, Loss 1.468329, forward nfe 2100, backward nfe 0, Train: 0.8333, Val: 0.6413, Test: 0.6290, Best time: 2.3742
Epoch: 015/100, Runtime 0.191983, Loss 1.433505, forward nfe 2248, backward nfe 0, Train: 0.8417, Val: 0.6587, Test: 0.6661, Best time: 4.0416
Epoch: 016/100, Runtime 0.195250, Loss 1.447306, forward nfe 2396, backward nfe 0, Train: 0.8583, Val: 0.6710, Test: 0.6694, Best time: 2.4279
Epoch: 017/100, Runtime 0.190926, Loss 1.366231, forward nfe 2544, backward nfe 0, Train: 0.8667, Val: 0.6833, Test: 0.6871, Best time: 2.4629
Epoch: 018/100, Runtime 0.190773, Loss 1.375247, forward nfe 2692, backward nfe 0, Train: 0.8750, Val: 0.6993, Test: 0.6984, Best time: 3.3537
Epoch: 019/100, Runtime 0.197325, Loss 1.281975, forward nfe 2834, backward nfe 0, Train: 0.8917, Val: 0.7051, Test: 0.6919, Best time: 5.3639
Epoch: 020/100, Runtime 0.185594, Loss 1.274975, forward nfe 2976, backward nfe 0, Train: 0.8917, Val: 0.7116, Test: 0.7145, Best time: 3.4871
Epoch: 021/100, Runtime 0.181599, Loss 1.269686, forward nfe 3118, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.5753
Epoch: 022/100, Runtime 0.180035, Loss 1.196645, forward nfe 3254, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 023/100, Runtime 0.177219, Loss 1.195438, forward nfe 3390, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 024/100, Runtime 0.185107, Loss 1.084666, forward nfe 3526, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 025/100, Runtime 0.177867, Loss 1.105075, forward nfe 3662, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 026/100, Runtime 0.178252, Loss 1.139618, forward nfe 3798, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 027/100, Runtime 0.178566, Loss 1.088530, forward nfe 3934, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 028/100, Runtime 0.164223, Loss 1.098851, forward nfe 4058, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 029/100, Runtime 0.162645, Loss 1.040119, forward nfe 4182, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 030/100, Runtime 0.176801, Loss 0.966873, forward nfe 4306, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 031/100, Runtime 0.160491, Loss 1.000529, forward nfe 4430, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 032/100, Runtime 0.160504, Loss 1.022688, forward nfe 4548, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 033/100, Runtime 0.164482, Loss 0.960681, forward nfe 4666, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 034/100, Runtime 0.156055, Loss 0.980705, forward nfe 4784, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 035/100, Runtime 0.151802, Loss 0.977838, forward nfe 4902, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 036/100, Runtime 0.139704, Loss 0.985778, forward nfe 5008, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 037/100, Runtime 0.149825, Loss 0.964862, forward nfe 5114, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 038/100, Runtime 0.143448, Loss 1.019366, forward nfe 5220, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 039/100, Runtime 0.132736, Loss 0.950632, forward nfe 5326, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 040/100, Runtime 0.135440, Loss 0.914548, forward nfe 5426, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 041/100, Runtime 0.129843, Loss 0.991180, forward nfe 5526, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 042/100, Runtime 0.138178, Loss 0.952686, forward nfe 5626, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 043/100, Runtime 0.134742, Loss 0.936203, forward nfe 5726, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 044/100, Runtime 0.149720, Loss 1.007225, forward nfe 5826, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 045/100, Runtime 0.136698, Loss 0.933222, forward nfe 5926, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 046/100, Runtime 0.142941, Loss 0.919152, forward nfe 6026, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 047/100, Runtime 0.146468, Loss 0.969894, forward nfe 6126, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 048/100, Runtime 0.134799, Loss 0.833597, forward nfe 6226, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 049/100, Runtime 0.148624, Loss 0.936741, forward nfe 6326, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 050/100, Runtime 0.145391, Loss 1.014320, forward nfe 6432, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 051/100, Runtime 0.148670, Loss 0.952919, forward nfe 6538, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 052/100, Runtime 0.145699, Loss 0.903551, forward nfe 6644, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 053/100, Runtime 0.143736, Loss 0.989691, forward nfe 6750, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 054/100, Runtime 0.158989, Loss 0.869650, forward nfe 6856, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 055/100, Runtime 0.145073, Loss 0.988896, forward nfe 6962, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 056/100, Runtime 0.141648, Loss 0.840825, forward nfe 7068, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 057/100, Runtime 0.149165, Loss 0.939243, forward nfe 7174, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 058/100, Runtime 0.158838, Loss 0.946931, forward nfe 7280, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 059/100, Runtime 0.145173, Loss 0.901530, forward nfe 7386, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 060/100, Runtime 0.141908, Loss 0.869478, forward nfe 7492, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 061/100, Runtime 0.150755, Loss 0.969852, forward nfe 7598, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 062/100, Runtime 0.146548, Loss 0.953032, forward nfe 7704, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 063/100, Runtime 0.139582, Loss 0.890467, forward nfe 7810, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 064/100, Runtime 0.148390, Loss 0.863364, forward nfe 7916, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 065/100, Runtime 0.139500, Loss 0.944514, forward nfe 8022, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 066/100, Runtime 0.140362, Loss 0.939120, forward nfe 8128, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 067/100, Runtime 0.140395, Loss 0.913068, forward nfe 8234, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 068/100, Runtime 0.143970, Loss 0.847688, forward nfe 8340, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 069/100, Runtime 0.137105, Loss 0.858955, forward nfe 8446, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 070/100, Runtime 0.139173, Loss 0.934947, forward nfe 8552, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 071/100, Runtime 0.161413, Loss 0.967304, forward nfe 8658, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 072/100, Runtime 0.140052, Loss 0.893246, forward nfe 8764, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 073/100, Runtime 0.135949, Loss 0.798395, forward nfe 8870, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 074/100, Runtime 0.141240, Loss 0.907486, forward nfe 8976, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 075/100, Runtime 0.148084, Loss 0.876830, forward nfe 9082, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 076/100, Runtime 0.139079, Loss 0.846615, forward nfe 9188, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 077/100, Runtime 0.141137, Loss 0.971275, forward nfe 9294, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 078/100, Runtime 0.145783, Loss 0.886771, forward nfe 9400, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 079/100, Runtime 0.152216, Loss 0.849914, forward nfe 9506, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 080/100, Runtime 0.139917, Loss 0.875384, forward nfe 9612, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 081/100, Runtime 0.141609, Loss 0.921285, forward nfe 9718, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 082/100, Runtime 0.143657, Loss 0.820232, forward nfe 9824, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 083/100, Runtime 0.142496, Loss 0.919942, forward nfe 9930, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 084/100, Runtime 0.145949, Loss 0.999587, forward nfe 10036, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 085/100, Runtime 0.159869, Loss 0.890768, forward nfe 10142, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 086/100, Runtime 0.144025, Loss 0.924588, forward nfe 10248, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 087/100, Runtime 0.141944, Loss 0.786226, forward nfe 10354, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 088/100, Runtime 0.148147, Loss 0.870092, forward nfe 10460, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 089/100, Runtime 0.146864, Loss 0.822730, forward nfe 10566, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 090/100, Runtime 0.140510, Loss 0.861385, forward nfe 10672, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 091/100, Runtime 0.140715, Loss 0.858749, forward nfe 10778, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 092/100, Runtime 0.147758, Loss 0.854872, forward nfe 10884, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 093/100, Runtime 0.152218, Loss 0.881262, forward nfe 10990, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 094/100, Runtime 0.138319, Loss 0.923850, forward nfe 11096, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 095/100, Runtime 0.137805, Loss 0.904384, forward nfe 11196, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 096/100, Runtime 0.140767, Loss 0.857269, forward nfe 11296, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 097/100, Runtime 0.137557, Loss 0.851450, forward nfe 11396, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 098/100, Runtime 0.138556, Loss 0.924450, forward nfe 11496, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
Epoch: 099/100, Runtime 0.162582, Loss 0.897787, forward nfe 11596, backward nfe 0, Train: 0.9083, Val: 0.7203, Test: 0.7145, Best time: 5.0000
best val accuracy 0.720290 with test accuracy 0.714516 at epoch 21 and best time 5.000000