/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.864684, Loss 1.796706, forward nfe 212, backward nfe 0, Train: 0.3250, Val: 0.2754, Test: 0.2952, Best time: 0.0403
Epoch: 002/100, Runtime 0.776936, Loss 1.790749, forward nfe 906, backward nfe 0, Train: 0.3833, Val: 0.3210, Test: 0.3516, Best time: 0.0384
Epoch: 003/100, Runtime 0.784460, Loss 1.766137, forward nfe 1594, backward nfe 0, Train: 0.4083, Val: 0.4130, Test: 0.4403, Best time: 14.2864
Epoch: 004/100, Runtime 0.761319, Loss 1.720451, forward nfe 2276, backward nfe 0, Train: 0.4750, Val: 0.4587, Test: 0.4806, Best time: 98.2779
Epoch: 005/100, Runtime 0.747097, Loss 1.684946, forward nfe 2952, backward nfe 0, Train: 0.5167, Val: 0.5275, Test: 0.5387, Best time: 80.0000
Epoch: 006/100, Runtime 0.747213, Loss 1.603546, forward nfe 3610, backward nfe 0, Train: 0.5500, Val: 0.5478, Test: 0.5774, Best time: 80.0000
Epoch: 007/100, Runtime 0.728617, Loss 1.567762, forward nfe 4268, backward nfe 0, Train: 0.6250, Val: 0.6703, Test: 0.6790, Best time: 80.0000
Epoch: 008/100, Runtime 0.759913, Loss 1.571716, forward nfe 4908, backward nfe 0, Train: 0.6250, Val: 0.6703, Test: 0.6790, Best time: 80.0000
Epoch: 009/100, Runtime 0.742933, Loss 1.520982, forward nfe 5542, backward nfe 0, Train: 0.6250, Val: 0.6703, Test: 0.6790, Best time: 80.0000
Epoch: 010/100, Runtime 0.703550, Loss 1.527082, forward nfe 6170, backward nfe 0, Train: 0.6250, Val: 0.6703, Test: 0.6790, Best time: 80.0000
Epoch: 011/100, Runtime 0.709153, Loss 1.495104, forward nfe 6780, backward nfe 0, Train: 0.6250, Val: 0.6703, Test: 0.6790, Best time: 80.0000
Epoch: 012/100, Runtime 0.679353, Loss 1.527329, forward nfe 7390, backward nfe 0, Train: 0.6500, Val: 0.7058, Test: 0.6726, Best time: 11.0139
Epoch: 013/100, Runtime 0.662213, Loss 1.466422, forward nfe 7982, backward nfe 0, Train: 0.6500, Val: 0.7058, Test: 0.6726, Best time: 80.0000
Epoch: 014/100, Runtime 0.681705, Loss 1.477519, forward nfe 8574, backward nfe 0, Train: 0.7167, Val: 0.7101, Test: 0.6903, Best time: 13.6723
Epoch: 015/100, Runtime 0.644735, Loss 1.425924, forward nfe 9166, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 16.5192
Epoch: 016/100, Runtime 0.674642, Loss 1.360134, forward nfe 9746, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 017/100, Runtime 0.637621, Loss 1.361961, forward nfe 10308, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 018/100, Runtime 0.630144, Loss 1.237285, forward nfe 10858, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 019/100, Runtime 0.618590, Loss 1.338304, forward nfe 11408, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 020/100, Runtime 0.603737, Loss 1.329440, forward nfe 11952, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 021/100, Runtime 0.596358, Loss 1.250328, forward nfe 12490, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 022/100, Runtime 0.570639, Loss 1.282525, forward nfe 13016, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 023/100, Runtime 0.570628, Loss 1.280674, forward nfe 13536, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 024/100, Runtime 0.574151, Loss 1.252464, forward nfe 14044, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 025/100, Runtime 0.556660, Loss 1.196953, forward nfe 14546, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 026/100, Runtime 0.538877, Loss 1.220437, forward nfe 15030, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 027/100, Runtime 0.549063, Loss 1.331426, forward nfe 15514, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 028/100, Runtime 0.543073, Loss 1.263304, forward nfe 15992, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 029/100, Runtime 0.538518, Loss 1.155198, forward nfe 16458, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 030/100, Runtime 0.547726, Loss 1.135446, forward nfe 16930, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 031/100, Runtime 0.519124, Loss 1.255667, forward nfe 17384, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 032/100, Runtime 0.516503, Loss 1.254754, forward nfe 17832, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 033/100, Runtime 0.514267, Loss 1.179902, forward nfe 18274, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 034/100, Runtime 0.487990, Loss 1.241839, forward nfe 18710, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 035/100, Runtime 0.502231, Loss 1.237875, forward nfe 19140, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 036/100, Runtime 0.479281, Loss 1.276928, forward nfe 19570, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 037/100, Runtime 0.486519, Loss 1.250437, forward nfe 19988, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 038/100, Runtime 0.471267, Loss 1.194419, forward nfe 20400, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 039/100, Runtime 0.480481, Loss 1.162850, forward nfe 20806, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 040/100, Runtime 0.471063, Loss 1.213366, forward nfe 21206, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 041/100, Runtime 0.470279, Loss 1.259037, forward nfe 21606, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 042/100, Runtime 0.446355, Loss 1.073423, forward nfe 22000, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 043/100, Runtime 0.452388, Loss 1.150664, forward nfe 22388, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 044/100, Runtime 0.443177, Loss 1.344333, forward nfe 22770, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 045/100, Runtime 0.433048, Loss 1.292183, forward nfe 23152, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 046/100, Runtime 0.437184, Loss 1.223002, forward nfe 23528, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 047/100, Runtime 0.429199, Loss 1.272995, forward nfe 23904, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 048/100, Runtime 0.414770, Loss 1.386188, forward nfe 24256, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 049/100, Runtime 0.420441, Loss 1.269274, forward nfe 24608, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 050/100, Runtime 0.435700, Loss 1.229788, forward nfe 24960, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 051/100, Runtime 0.409593, Loss 1.233595, forward nfe 25312, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 052/100, Runtime 0.424423, Loss 1.338474, forward nfe 25658, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 053/100, Runtime 0.417149, Loss 1.171283, forward nfe 26004, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 054/100, Runtime 0.400609, Loss 1.257919, forward nfe 26344, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 055/100, Runtime 0.388162, Loss 1.155955, forward nfe 26678, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 056/100, Runtime 0.383933, Loss 1.129524, forward nfe 27012, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 057/100, Runtime 0.391858, Loss 1.199267, forward nfe 27340, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 058/100, Runtime 0.402424, Loss 1.236792, forward nfe 27668, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 059/100, Runtime 0.393998, Loss 1.181519, forward nfe 27990, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 060/100, Runtime 0.382061, Loss 1.248943, forward nfe 28312, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 061/100, Runtime 0.390802, Loss 1.282166, forward nfe 28634, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 062/100, Runtime 0.536344, Loss 1.223426, forward nfe 28956, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 063/100, Runtime 0.376688, Loss 1.066744, forward nfe 29278, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 064/100, Runtime 0.370364, Loss 1.133898, forward nfe 29594, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 065/100, Runtime 0.378708, Loss 1.266332, forward nfe 29910, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 066/100, Runtime 0.364529, Loss 1.125705, forward nfe 30226, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 067/100, Runtime 0.377028, Loss 1.297249, forward nfe 30542, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 068/100, Runtime 0.379494, Loss 1.249878, forward nfe 30858, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 069/100, Runtime 0.374222, Loss 1.196150, forward nfe 31174, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 070/100, Runtime 0.377492, Loss 1.220442, forward nfe 31490, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 071/100, Runtime 0.386059, Loss 1.148691, forward nfe 31806, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 072/100, Runtime 0.386200, Loss 1.182177, forward nfe 32122, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 073/100, Runtime 0.378973, Loss 1.081001, forward nfe 32438, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 074/100, Runtime 0.384750, Loss 1.184538, forward nfe 32754, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 075/100, Runtime 0.369176, Loss 1.168691, forward nfe 33076, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 076/100, Runtime 0.382034, Loss 1.103560, forward nfe 33392, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 077/100, Runtime 0.383533, Loss 1.205584, forward nfe 33702, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 078/100, Runtime 0.368783, Loss 1.056191, forward nfe 34018, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 079/100, Runtime 0.381448, Loss 1.092128, forward nfe 34328, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 080/100, Runtime 0.371467, Loss 1.199061, forward nfe 34638, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 081/100, Runtime 0.372895, Loss 1.136210, forward nfe 34948, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 082/100, Runtime 0.366272, Loss 1.053111, forward nfe 35258, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 083/100, Runtime 0.390444, Loss 1.169436, forward nfe 35568, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 084/100, Runtime 0.378034, Loss 1.078489, forward nfe 35878, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 085/100, Runtime 0.378500, Loss 1.017395, forward nfe 36188, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 086/100, Runtime 0.372569, Loss 1.071912, forward nfe 36498, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 087/100, Runtime 0.371269, Loss 1.226339, forward nfe 36802, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 088/100, Runtime 0.373439, Loss 1.004780, forward nfe 37106, backward nfe 0, Train: 0.7667, Val: 0.7362, Test: 0.7081, Best time: 80.0000
Epoch: 089/100, Runtime 0.384120, Loss 1.240196, forward nfe 37410, backward nfe 0, Train: 0.8583, Val: 0.7486, Test: 0.7355, Best time: 65.5723
Epoch: 090/100, Runtime 0.371535, Loss 0.935262, forward nfe 37708, backward nfe 0, Train: 0.8583, Val: 0.7486, Test: 0.7355, Best time: 80.0000
Epoch: 091/100, Runtime 0.364102, Loss 1.060166, forward nfe 38012, backward nfe 0, Train: 0.8583, Val: 0.7486, Test: 0.7355, Best time: 80.0000
Epoch: 092/100, Runtime 0.366001, Loss 1.186963, forward nfe 38316, backward nfe 0, Train: 0.8583, Val: 0.7486, Test: 0.7355, Best time: 80.0000
Epoch: 093/100, Runtime 0.365238, Loss 1.021471, forward nfe 38620, backward nfe 0, Train: 0.8583, Val: 0.7486, Test: 0.7355, Best time: 80.0000
Epoch: 094/100, Runtime 0.370602, Loss 1.182534, forward nfe 38924, backward nfe 0, Train: 0.8583, Val: 0.7486, Test: 0.7355, Best time: 80.0000
Epoch: 095/100, Runtime 0.360119, Loss 1.044951, forward nfe 39228, backward nfe 0, Train: 0.8583, Val: 0.7486, Test: 0.7355, Best time: 80.0000
Epoch: 096/100, Runtime 0.376178, Loss 1.204585, forward nfe 39532, backward nfe 0, Train: 0.8583, Val: 0.7486, Test: 0.7355, Best time: 80.0000
Epoch: 097/100, Runtime 0.351258, Loss 1.090691, forward nfe 39836, backward nfe 0, Train: 0.8583, Val: 0.7486, Test: 0.7355, Best time: 80.0000
Epoch: 098/100, Runtime 0.371650, Loss 1.028214, forward nfe 40134, backward nfe 0, Train: 0.8583, Val: 0.7486, Test: 0.7355, Best time: 80.0000
Epoch: 099/100, Runtime 0.351805, Loss 1.053809, forward nfe 40432, backward nfe 0, Train: 0.8583, Val: 0.7486, Test: 0.7355, Best time: 80.0000
best val accuracy 0.748551 with test accuracy 0.735484 at epoch 89 and best time 80.000000