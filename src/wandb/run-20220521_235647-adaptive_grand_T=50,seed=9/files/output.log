/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 3.083842, Loss 1.946593, forward nfe 104, backward nfe 0, Train: 0.1643, Val: 0.1897, Test: 0.1838, Best time: 0.0904
Epoch: 002/100, Runtime 2.808057, Loss 1.920239, forward nfe 498, backward nfe 0, Train: 0.4857, Val: 0.2801, Test: 0.3107, Best time: 0.0884
Epoch: 003/100, Runtime 2.941081, Loss 1.871065, forward nfe 874, backward nfe 0, Train: 0.5643, Val: 0.4184, Test: 0.4772, Best time: 0.9746
Epoch: 004/100, Runtime 2.824464, Loss 1.736722, forward nfe 1244, backward nfe 0, Train: 0.6357, Val: 0.5471, Test: 0.5797, Best time: 7.5935
Epoch: 005/100, Runtime 2.842890, Loss 1.594563, forward nfe 1602, backward nfe 0, Train: 0.7143, Val: 0.6125, Test: 0.6467, Best time: 7.8045
Epoch: 006/100, Runtime 2.762331, Loss 1.430444, forward nfe 1948, backward nfe 0, Train: 0.8071, Val: 0.7213, Test: 0.7269, Best time: 10.7063
Epoch: 007/100, Runtime 2.758866, Loss 1.189241, forward nfe 2294, backward nfe 0, Train: 0.8857, Val: 0.7654, Test: 0.7777, Best time: 14.5043
Epoch: 008/100, Runtime 2.669237, Loss 1.002458, forward nfe 2634, backward nfe 0, Train: 0.8857, Val: 0.7654, Test: 0.7777, Best time: 50.0000
Epoch: 009/100, Runtime 2.604468, Loss 0.835867, forward nfe 2956, backward nfe 0, Train: 0.8857, Val: 0.7654, Test: 0.7777, Best time: 50.0000
Epoch: 010/100, Runtime 2.601307, Loss 0.699823, forward nfe 3272, backward nfe 0, Train: 0.8357, Val: 0.8000, Test: 0.8030, Best time: 125.3659
Epoch: 011/100, Runtime 2.489667, Loss 0.587042, forward nfe 3594, backward nfe 0, Train: 0.8357, Val: 0.8088, Test: 0.8203, Best time: 116.5527
Epoch: 012/100, Runtime 2.492909, Loss 0.557615, forward nfe 3910, backward nfe 0, Train: 0.8714, Val: 0.8118, Test: 0.8244, Best time: 64.2016
Epoch: 013/100, Runtime 2.458816, Loss 0.480723, forward nfe 4214, backward nfe 0, Train: 0.8714, Val: 0.8118, Test: 0.8244, Best time: 50.0000
Epoch: 014/100, Runtime 2.366683, Loss 0.437275, forward nfe 4518, backward nfe 0, Train: 0.8714, Val: 0.8118, Test: 0.8244, Best time: 50.0000
Epoch: 015/100, Runtime 2.265611, Loss 0.416635, forward nfe 4810, backward nfe 0, Train: 0.8714, Val: 0.8118, Test: 0.8244, Best time: 50.0000
Epoch: 016/100, Runtime 2.221499, Loss 0.441882, forward nfe 5084, backward nfe 0, Train: 0.8714, Val: 0.8118, Test: 0.8244, Best time: 50.0000
Epoch: 017/100, Runtime 2.134624, Loss 0.407190, forward nfe 5358, backward nfe 0, Train: 0.8714, Val: 0.8118, Test: 0.8244, Best time: 50.0000
Epoch: 018/100, Runtime 2.135042, Loss 0.401888, forward nfe 5620, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 122.4300
Epoch: 019/100, Runtime 2.141068, Loss 0.323224, forward nfe 5882, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 020/100, Runtime 2.018424, Loss 0.385036, forward nfe 6144, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 021/100, Runtime 2.095931, Loss 0.342348, forward nfe 6400, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 022/100, Runtime 2.006404, Loss 0.304883, forward nfe 6656, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 023/100, Runtime 1.935618, Loss 0.334509, forward nfe 6900, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 024/100, Runtime 1.831901, Loss 0.295374, forward nfe 7138, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 025/100, Runtime 1.906340, Loss 0.333356, forward nfe 7376, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 026/100, Runtime 1.932161, Loss 0.283895, forward nfe 7614, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 027/100, Runtime 1.822811, Loss 0.261033, forward nfe 7858, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 028/100, Runtime 1.798584, Loss 0.344450, forward nfe 8096, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 029/100, Runtime 1.848694, Loss 0.264079, forward nfe 8334, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 030/100, Runtime 1.786263, Loss 0.280749, forward nfe 8566, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 031/100, Runtime 1.838046, Loss 0.282317, forward nfe 8792, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 032/100, Runtime 1.817182, Loss 0.299066, forward nfe 9018, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 033/100, Runtime 1.875024, Loss 0.233872, forward nfe 9244, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 034/100, Runtime 1.776670, Loss 0.226298, forward nfe 9470, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 035/100, Runtime 1.806226, Loss 0.205792, forward nfe 9690, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 036/100, Runtime 2.078465, Loss 0.218370, forward nfe 9904, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 037/100, Runtime 2.323261, Loss 0.181116, forward nfe 10118, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 038/100, Runtime 2.358932, Loss 0.195430, forward nfe 10338, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 039/100, Runtime 2.323080, Loss 0.190558, forward nfe 10558, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 040/100, Runtime 2.349762, Loss 0.182311, forward nfe 10778, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 041/100, Runtime 2.376564, Loss 0.178050, forward nfe 10998, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 042/100, Runtime 2.320445, Loss 0.237910, forward nfe 11218, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 043/100, Runtime 2.364250, Loss 0.227740, forward nfe 11438, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 044/100, Runtime 2.519006, Loss 0.222063, forward nfe 11664, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 045/100, Runtime 2.522940, Loss 0.180418, forward nfe 11884, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 046/100, Runtime 2.356006, Loss 0.202168, forward nfe 12104, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 047/100, Runtime 2.327917, Loss 0.210103, forward nfe 12324, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 048/100, Runtime 2.423230, Loss 0.155368, forward nfe 12544, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 049/100, Runtime 2.533308, Loss 0.162384, forward nfe 12764, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 050/100, Runtime 0.691987, Loss 0.177045, forward nfe 12984, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 051/100, Runtime 0.689787, Loss 0.137329, forward nfe 13204, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 052/100, Runtime 0.731200, Loss 0.169182, forward nfe 13418, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 053/100, Runtime 0.753121, Loss 0.123282, forward nfe 13632, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 054/100, Runtime 0.689491, Loss 0.122495, forward nfe 13846, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 055/100, Runtime 0.677285, Loss 0.160971, forward nfe 14060, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 056/100, Runtime 0.711132, Loss 0.122670, forward nfe 14268, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 057/100, Runtime 0.727503, Loss 0.114278, forward nfe 14464, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 058/100, Runtime 0.711846, Loss 0.117577, forward nfe 14660, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 059/100, Runtime 0.681832, Loss 0.182523, forward nfe 14856, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 060/100, Runtime 0.738001, Loss 0.181218, forward nfe 15052, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 061/100, Runtime 0.724026, Loss 0.107446, forward nfe 15248, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 062/100, Runtime 0.721086, Loss 0.123820, forward nfe 15444, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 063/100, Runtime 0.733279, Loss 0.103164, forward nfe 15640, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 064/100, Runtime 0.701428, Loss 0.124939, forward nfe 15836, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 065/100, Runtime 0.653065, Loss 0.099045, forward nfe 16032, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 066/100, Runtime 0.738648, Loss 0.100630, forward nfe 16228, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 067/100, Runtime 0.709069, Loss 0.106757, forward nfe 16424, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 068/100, Runtime 0.719576, Loss 0.164095, forward nfe 16620, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 069/100, Runtime 0.652029, Loss 0.113224, forward nfe 16816, backward nfe 0, Train: 0.9214, Val: 0.8243, Test: 0.8538, Best time: 50.0000
Epoch: 070/100, Runtime 0.733865, Loss 0.081766, forward nfe 17000, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 140.6943
Epoch: 071/100, Runtime 0.731727, Loss 0.068795, forward nfe 17196, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 072/100, Runtime 0.693050, Loss 0.107037, forward nfe 17386, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 073/100, Runtime 0.645980, Loss 0.058484, forward nfe 17576, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 074/100, Runtime 0.746354, Loss 0.088095, forward nfe 17766, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 075/100, Runtime 0.758395, Loss 0.074017, forward nfe 17956, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 076/100, Runtime 0.749307, Loss 0.059095, forward nfe 18146, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 077/100, Runtime 0.755699, Loss 0.051897, forward nfe 18336, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 078/100, Runtime 0.743076, Loss 0.058437, forward nfe 18526, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 079/100, Runtime 0.754926, Loss 0.059454, forward nfe 18716, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 080/100, Runtime 0.693459, Loss 0.032502, forward nfe 18906, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 081/100, Runtime 0.677625, Loss 0.080163, forward nfe 19096, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 082/100, Runtime 1.401981, Loss 0.042094, forward nfe 19274, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 083/100, Runtime 1.532043, Loss 0.045752, forward nfe 19458, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 084/100, Runtime 1.478726, Loss 0.063032, forward nfe 19642, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 085/100, Runtime 1.461489, Loss 0.040189, forward nfe 19826, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 086/100, Runtime 1.374139, Loss 0.052836, forward nfe 20004, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 087/100, Runtime 1.393833, Loss 0.055938, forward nfe 20182, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 088/100, Runtime 1.475971, Loss 0.084770, forward nfe 20372, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 089/100, Runtime 1.577718, Loss 0.029399, forward nfe 20562, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 090/100, Runtime 1.517298, Loss 0.044395, forward nfe 20752, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 091/100, Runtime 1.552045, Loss 0.061075, forward nfe 20942, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 092/100, Runtime 1.514547, Loss 0.066938, forward nfe 21132, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 093/100, Runtime 1.633904, Loss 0.044424, forward nfe 21322, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 094/100, Runtime 1.966746, Loss 0.026997, forward nfe 21512, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 095/100, Runtime 2.386151, Loss 0.054617, forward nfe 21702, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 096/100, Runtime 2.340005, Loss 0.067831, forward nfe 21904, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 097/100, Runtime 2.402549, Loss 0.055185, forward nfe 22106, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 098/100, Runtime 2.351023, Loss 0.019966, forward nfe 22308, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
Epoch: 099/100, Runtime 2.228809, Loss 0.057932, forward nfe 22510, backward nfe 0, Train: 1.0000, Val: 0.8265, Test: 0.8376, Best time: 50.0000
best val accuracy 0.826471 with test accuracy 0.837563 at epoch 70 and best time 50.000000