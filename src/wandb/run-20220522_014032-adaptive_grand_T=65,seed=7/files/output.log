/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 3.807052, Loss 1.947114, forward nfe 122, backward nfe 0, Train: 0.2143, Val: 0.1390, Test: 0.1523, Best time: 22.1942
Epoch: 002/100, Runtime 5.069028, Loss 1.986959, forward nfe 624, backward nfe 0, Train: 0.2143, Val: 0.1390, Test: 0.1523, Best time: 65.0000
Epoch: 003/100, Runtime 4.912708, Loss 1.934840, forward nfe 1114, backward nfe 0, Train: 0.2143, Val: 0.1390, Test: 0.1523, Best time: 65.0000
Epoch: 004/100, Runtime 5.179001, Loss 1.929098, forward nfe 1598, backward nfe 0, Train: 0.2714, Val: 0.1713, Test: 0.1888, Best time: 0.0852
Epoch: 005/100, Runtime 4.454048, Loss 1.838152, forward nfe 2070, backward nfe 0, Train: 0.6286, Val: 0.6051, Test: 0.6264, Best time: 9.6551
Epoch: 006/100, Runtime 4.893200, Loss 1.724424, forward nfe 2530, backward nfe 0, Train: 0.7357, Val: 0.6941, Test: 0.7046, Best time: 10.0895
Epoch: 007/100, Runtime 4.906146, Loss 1.605917, forward nfe 2972, backward nfe 0, Train: 0.7714, Val: 0.7147, Test: 0.7096, Best time: 35.8591
Epoch: 008/100, Runtime 4.072998, Loss 1.441391, forward nfe 3402, backward nfe 0, Train: 0.7857, Val: 0.7206, Test: 0.7503, Best time: 14.5225
Epoch: 009/100, Runtime 3.183525, Loss 1.202463, forward nfe 3832, backward nfe 0, Train: 0.7857, Val: 0.7206, Test: 0.7503, Best time: 65.0000
Epoch: 010/100, Runtime 3.056572, Loss 1.016147, forward nfe 4250, backward nfe 0, Train: 0.8571, Val: 0.7272, Test: 0.7452, Best time: 6.3762
Epoch: 011/100, Runtime 3.400369, Loss 0.848871, forward nfe 4668, backward nfe 0, Train: 0.8500, Val: 0.7801, Test: 0.7959, Best time: 12.2470
Epoch: 012/100, Runtime 3.170164, Loss 0.652138, forward nfe 5080, backward nfe 0, Train: 0.8786, Val: 0.8059, Test: 0.8203, Best time: 79.0015
Epoch: 013/100, Runtime 3.188721, Loss 0.561042, forward nfe 5474, backward nfe 0, Train: 0.8786, Val: 0.8059, Test: 0.8203, Best time: 65.0000
Epoch: 014/100, Runtime 3.064353, Loss 0.545063, forward nfe 5862, backward nfe 0, Train: 0.8714, Val: 0.8088, Test: 0.8193, Best time: 52.2112
Epoch: 015/100, Runtime 3.076071, Loss 0.446740, forward nfe 6238, backward nfe 0, Train: 0.8714, Val: 0.8088, Test: 0.8193, Best time: 65.0000
Epoch: 016/100, Runtime 2.738629, Loss 0.413057, forward nfe 6602, backward nfe 0, Train: 0.8714, Val: 0.8088, Test: 0.8193, Best time: 65.0000
Epoch: 017/100, Runtime 2.685911, Loss 0.421238, forward nfe 6960, backward nfe 0, Train: 0.8714, Val: 0.8088, Test: 0.8193, Best time: 65.0000
Epoch: 018/100, Runtime 2.741055, Loss 0.425459, forward nfe 7300, backward nfe 0, Train: 0.8714, Val: 0.8088, Test: 0.8193, Best time: 65.0000
Epoch: 019/100, Runtime 2.711195, Loss 0.369409, forward nfe 7640, backward nfe 0, Train: 0.8714, Val: 0.8088, Test: 0.8193, Best time: 65.0000
Epoch: 020/100, Runtime 2.814843, Loss 0.328234, forward nfe 7986, backward nfe 0, Train: 0.9214, Val: 0.8118, Test: 0.8315, Best time: 50.3446
Epoch: 021/100, Runtime 2.551121, Loss 0.361964, forward nfe 8314, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 102.6325
Epoch: 022/100, Runtime 2.566452, Loss 0.296810, forward nfe 8642, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 023/100, Runtime 2.357572, Loss 0.339153, forward nfe 8958, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 024/100, Runtime 2.463741, Loss 0.305828, forward nfe 9268, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 025/100, Runtime 2.500340, Loss 0.282729, forward nfe 9560, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 026/100, Runtime 2.381832, Loss 0.373514, forward nfe 9864, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 027/100, Runtime 2.479866, Loss 0.266737, forward nfe 10156, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 028/100, Runtime 2.266791, Loss 0.311076, forward nfe 10454, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 029/100, Runtime 2.229535, Loss 0.281708, forward nfe 10728, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 030/100, Runtime 2.210300, Loss 0.190448, forward nfe 10996, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 031/100, Runtime 2.209935, Loss 0.261303, forward nfe 11258, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 032/100, Runtime 2.106206, Loss 0.235900, forward nfe 11526, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 033/100, Runtime 2.145520, Loss 0.188609, forward nfe 11800, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 034/100, Runtime 2.067775, Loss 0.210459, forward nfe 12074, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 035/100, Runtime 2.042745, Loss 0.208976, forward nfe 12330, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 036/100, Runtime 1.983388, Loss 0.221361, forward nfe 12586, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 037/100, Runtime 1.997185, Loss 0.254659, forward nfe 12842, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 038/100, Runtime 1.935442, Loss 0.222482, forward nfe 13092, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 039/100, Runtime 1.878158, Loss 0.216358, forward nfe 13342, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 040/100, Runtime 1.932215, Loss 0.237959, forward nfe 13592, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 041/100, Runtime 1.782425, Loss 0.169084, forward nfe 13842, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 042/100, Runtime 1.958982, Loss 0.194699, forward nfe 14086, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 043/100, Runtime 1.931613, Loss 0.154166, forward nfe 14330, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 044/100, Runtime 1.983471, Loss 0.117656, forward nfe 14574, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 045/100, Runtime 1.923767, Loss 0.115901, forward nfe 14812, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 046/100, Runtime 1.936754, Loss 0.126243, forward nfe 15044, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 047/100, Runtime 1.951283, Loss 0.155680, forward nfe 15276, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 048/100, Runtime 1.977495, Loss 0.123710, forward nfe 15508, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 049/100, Runtime 1.960809, Loss 0.112001, forward nfe 15740, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 050/100, Runtime 1.924324, Loss 0.106930, forward nfe 15972, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 051/100, Runtime 1.951914, Loss 0.113289, forward nfe 16204, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 052/100, Runtime 1.843831, Loss 0.142865, forward nfe 16436, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 053/100, Runtime 1.807386, Loss 0.141968, forward nfe 16668, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 054/100, Runtime 1.853341, Loss 0.148177, forward nfe 16894, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 055/100, Runtime 1.882024, Loss 0.118670, forward nfe 17120, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 056/100, Runtime 1.845714, Loss 0.102485, forward nfe 17340, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 057/100, Runtime 1.811309, Loss 0.089705, forward nfe 17560, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 058/100, Runtime 1.810062, Loss 0.132351, forward nfe 17780, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 059/100, Runtime 1.796970, Loss 0.113779, forward nfe 17994, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 060/100, Runtime 1.735807, Loss 0.118608, forward nfe 18208, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 061/100, Runtime 1.659952, Loss 0.098849, forward nfe 18410, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 062/100, Runtime 1.784179, Loss 0.081285, forward nfe 18612, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 063/100, Runtime 1.723975, Loss 0.095208, forward nfe 18820, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 064/100, Runtime 1.790961, Loss 0.109425, forward nfe 19028, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 065/100, Runtime 1.748311, Loss 0.080250, forward nfe 19236, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 066/100, Runtime 1.765681, Loss 0.076511, forward nfe 19444, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 067/100, Runtime 1.687538, Loss 0.086573, forward nfe 19652, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 068/100, Runtime 1.704566, Loss 0.079372, forward nfe 19860, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 069/100, Runtime 1.660068, Loss 0.118997, forward nfe 20068, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 070/100, Runtime 1.644588, Loss 0.051905, forward nfe 20276, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 071/100, Runtime 1.688166, Loss 0.054347, forward nfe 20484, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 072/100, Runtime 1.692025, Loss 0.051106, forward nfe 20686, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 073/100, Runtime 1.667787, Loss 0.058856, forward nfe 20888, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 074/100, Runtime 1.719727, Loss 0.061015, forward nfe 21090, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 075/100, Runtime 1.648664, Loss 0.049952, forward nfe 21292, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 076/100, Runtime 1.682339, Loss 0.071577, forward nfe 21494, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 077/100, Runtime 1.496030, Loss 0.046118, forward nfe 21702, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 078/100, Runtime 1.496177, Loss 0.040950, forward nfe 21898, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 079/100, Runtime 1.501858, Loss 0.059509, forward nfe 22094, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 080/100, Runtime 1.497188, Loss 0.035873, forward nfe 22290, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 081/100, Runtime 1.509733, Loss 0.052123, forward nfe 22486, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 082/100, Runtime 1.577179, Loss 0.079484, forward nfe 22682, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 083/100, Runtime 1.519788, Loss 0.079773, forward nfe 22878, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 084/100, Runtime 1.511239, Loss 0.103345, forward nfe 23074, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 085/100, Runtime 1.518609, Loss 0.055038, forward nfe 23270, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 086/100, Runtime 1.538591, Loss 0.064415, forward nfe 23466, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 087/100, Runtime 1.568861, Loss 0.034183, forward nfe 23662, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 088/100, Runtime 1.563087, Loss 0.030747, forward nfe 23858, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 089/100, Runtime 1.778517, Loss 0.064636, forward nfe 24054, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 090/100, Runtime 1.570975, Loss 0.054383, forward nfe 24250, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 091/100, Runtime 1.569056, Loss 0.076263, forward nfe 24446, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 092/100, Runtime 1.637307, Loss 0.058478, forward nfe 24642, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 093/100, Runtime 1.613710, Loss 0.048760, forward nfe 24838, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 094/100, Runtime 1.634155, Loss 0.041917, forward nfe 25034, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 095/100, Runtime 1.696138, Loss 0.095703, forward nfe 25230, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 096/100, Runtime 1.667774, Loss 0.041032, forward nfe 25426, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 097/100, Runtime 1.620950, Loss 0.051317, forward nfe 25610, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 098/100, Runtime 1.598976, Loss 0.069414, forward nfe 25794, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
Epoch: 099/100, Runtime 1.645607, Loss 0.053281, forward nfe 25978, backward nfe 0, Train: 0.8786, Val: 0.8265, Test: 0.8457, Best time: 65.0000
best val accuracy 0.826471 with test accuracy 0.845685 at epoch 21 and best time 65.000000