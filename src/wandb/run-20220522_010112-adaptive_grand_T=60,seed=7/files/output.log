/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 3.731477, Loss 1.950049, forward nfe 116, backward nfe 0, Train: 0.2429, Val: 0.1485, Test: 0.1574, Best time: 0.0929
Epoch: 002/100, Runtime 3.690050, Loss 1.988194, forward nfe 582, backward nfe 0, Train: 0.2429, Val: 0.1485, Test: 0.1574, Best time: 60.0000
Epoch: 003/100, Runtime 3.666724, Loss 1.943458, forward nfe 1036, backward nfe 0, Train: 0.2429, Val: 0.1485, Test: 0.1574, Best time: 60.0000
Epoch: 004/100, Runtime 3.473288, Loss 1.916389, forward nfe 1484, backward nfe 0, Train: 0.4571, Val: 0.4353, Test: 0.4467, Best time: 3.5870
Epoch: 005/100, Runtime 4.109599, Loss 1.858113, forward nfe 1914, backward nfe 0, Train: 0.6500, Val: 0.6647, Test: 0.6629, Best time: 5.4026
Epoch: 006/100, Runtime 4.477458, Loss 1.757236, forward nfe 2338, backward nfe 0, Train: 0.7929, Val: 0.7228, Test: 0.7208, Best time: 13.5041
Epoch: 007/100, Runtime 4.498200, Loss 1.630126, forward nfe 2744, backward nfe 0, Train: 0.7929, Val: 0.7228, Test: 0.7208, Best time: 60.0000
Epoch: 008/100, Runtime 4.160435, Loss 1.485340, forward nfe 3144, backward nfe 0, Train: 0.7929, Val: 0.7228, Test: 0.7208, Best time: 60.0000
Epoch: 009/100, Runtime 3.887649, Loss 1.300006, forward nfe 3538, backward nfe 0, Train: 0.8000, Val: 0.7309, Test: 0.7391, Best time: 26.7940
Epoch: 010/100, Runtime 3.774263, Loss 1.115866, forward nfe 3932, backward nfe 0, Train: 0.8429, Val: 0.7684, Test: 0.7838, Best time: 115.3137
Epoch: 011/100, Runtime 4.058561, Loss 0.940486, forward nfe 4320, backward nfe 0, Train: 0.8357, Val: 0.8022, Test: 0.8122, Best time: 60.0000
Epoch: 012/100, Runtime 3.716419, Loss 0.769962, forward nfe 4702, backward nfe 0, Train: 0.8143, Val: 0.8029, Test: 0.8081, Best time: 157.9773
Epoch: 013/100, Runtime 1.137815, Loss 0.690428, forward nfe 5072, backward nfe 0, Train: 0.8143, Val: 0.8029, Test: 0.8081, Best time: 60.0000
Epoch: 014/100, Runtime 1.074759, Loss 0.558940, forward nfe 5430, backward nfe 0, Train: 0.8143, Val: 0.8029, Test: 0.8081, Best time: 60.0000
Epoch: 015/100, Runtime 1.066554, Loss 0.574694, forward nfe 5770, backward nfe 0, Train: 0.8929, Val: 0.8081, Test: 0.8152, Best time: 26.9387
Epoch: 016/100, Runtime 1.130841, Loss 0.570734, forward nfe 6104, backward nfe 0, Train: 0.8786, Val: 0.8191, Test: 0.8203, Best time: 79.1587
Epoch: 017/100, Runtime 1.183535, Loss 0.500785, forward nfe 6432, backward nfe 0, Train: 0.8786, Val: 0.8191, Test: 0.8203, Best time: 60.0000
Epoch: 018/100, Runtime 1.157324, Loss 0.385364, forward nfe 6748, backward nfe 0, Train: 0.8786, Val: 0.8191, Test: 0.8203, Best time: 60.0000
Epoch: 019/100, Runtime 1.097792, Loss 0.485294, forward nfe 7064, backward nfe 0, Train: 0.8786, Val: 0.8191, Test: 0.8203, Best time: 60.0000
Epoch: 020/100, Runtime 1.091222, Loss 0.400636, forward nfe 7368, backward nfe 0, Train: 0.9000, Val: 0.8287, Test: 0.8294, Best time: 105.8648
Epoch: 021/100, Runtime 1.076889, Loss 0.359765, forward nfe 7660, backward nfe 0, Train: 0.9000, Val: 0.8287, Test: 0.8294, Best time: 60.0000
Epoch: 022/100, Runtime 1.024637, Loss 0.386047, forward nfe 7946, backward nfe 0, Train: 0.9000, Val: 0.8287, Test: 0.8294, Best time: 60.0000
Epoch: 023/100, Runtime 1.019397, Loss 0.414663, forward nfe 8220, backward nfe 0, Train: 0.9000, Val: 0.8287, Test: 0.8294, Best time: 60.0000
Epoch: 024/100, Runtime 0.992524, Loss 0.336578, forward nfe 8500, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 103.9481
Epoch: 025/100, Runtime 0.948380, Loss 0.308828, forward nfe 8774, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 026/100, Runtime 0.827637, Loss 0.393949, forward nfe 9036, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 027/100, Runtime 0.916292, Loss 0.301075, forward nfe 9298, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 028/100, Runtime 0.932106, Loss 0.263818, forward nfe 9536, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 029/100, Runtime 0.980783, Loss 0.319941, forward nfe 9780, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 030/100, Runtime 0.891076, Loss 0.234907, forward nfe 10018, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 031/100, Runtime 1.021817, Loss 0.264901, forward nfe 10256, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 032/100, Runtime 1.046178, Loss 0.291174, forward nfe 10488, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 033/100, Runtime 1.169472, Loss 0.274584, forward nfe 10714, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 034/100, Runtime 1.543527, Loss 0.245216, forward nfe 10940, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 035/100, Runtime 2.599509, Loss 0.289548, forward nfe 11154, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 036/100, Runtime 2.612303, Loss 0.203585, forward nfe 11368, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 037/100, Runtime 2.574696, Loss 0.215190, forward nfe 11582, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 038/100, Runtime 2.502074, Loss 0.221390, forward nfe 11790, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 039/100, Runtime 2.352931, Loss 0.196798, forward nfe 11992, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 040/100, Runtime 2.016734, Loss 0.205637, forward nfe 12188, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 041/100, Runtime 1.980099, Loss 0.219883, forward nfe 12378, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 042/100, Runtime 1.509187, Loss 0.193579, forward nfe 12568, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 043/100, Runtime 1.554205, Loss 0.186393, forward nfe 12758, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 044/100, Runtime 1.610431, Loss 0.237101, forward nfe 12948, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 045/100, Runtime 1.684242, Loss 0.157696, forward nfe 13138, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 046/100, Runtime 1.674806, Loss 0.171487, forward nfe 13334, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 047/100, Runtime 1.688906, Loss 0.188274, forward nfe 13530, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 048/100, Runtime 1.642411, Loss 0.123518, forward nfe 13726, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 049/100, Runtime 1.659101, Loss 0.152062, forward nfe 13916, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 050/100, Runtime 1.548216, Loss 0.172615, forward nfe 14112, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 051/100, Runtime 1.744386, Loss 0.168648, forward nfe 14308, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 052/100, Runtime 1.735803, Loss 0.124797, forward nfe 14510, backward nfe 0, Train: 0.9286, Val: 0.8316, Test: 0.8396, Best time: 60.0000
Epoch: 053/100, Runtime 1.723989, Loss 0.131913, forward nfe 14712, backward nfe 0, Train: 0.9643, Val: 0.8331, Test: 0.8335, Best time: 147.0821
Epoch: 054/100, Runtime 1.642341, Loss 0.152717, forward nfe 14914, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 124.0108
Epoch: 055/100, Runtime 1.549827, Loss 0.157220, forward nfe 15116, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 056/100, Runtime 1.444976, Loss 0.134754, forward nfe 15318, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 057/100, Runtime 1.610958, Loss 0.110358, forward nfe 15520, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 058/100, Runtime 1.520825, Loss 0.133311, forward nfe 15728, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 059/100, Runtime 1.591072, Loss 0.162995, forward nfe 15936, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 060/100, Runtime 1.835034, Loss 0.103382, forward nfe 16144, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 061/100, Runtime 1.757706, Loss 0.161164, forward nfe 16358, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 062/100, Runtime 1.864570, Loss 0.094276, forward nfe 16572, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 063/100, Runtime 1.729794, Loss 0.080303, forward nfe 16786, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 064/100, Runtime 1.793154, Loss 0.099867, forward nfe 16994, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 065/100, Runtime 1.860242, Loss 0.121262, forward nfe 17208, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 066/100, Runtime 1.837555, Loss 0.114396, forward nfe 17422, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 067/100, Runtime 1.839174, Loss 0.088140, forward nfe 17636, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 068/100, Runtime 1.794693, Loss 0.107751, forward nfe 17850, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 069/100, Runtime 1.808930, Loss 0.105460, forward nfe 18064, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 070/100, Runtime 1.814620, Loss 0.075876, forward nfe 18278, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 071/100, Runtime 1.706083, Loss 0.048496, forward nfe 18492, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 072/100, Runtime 1.763938, Loss 0.128998, forward nfe 18706, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 073/100, Runtime 1.707445, Loss 0.090700, forward nfe 18920, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 074/100, Runtime 1.707140, Loss 0.089798, forward nfe 19134, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 075/100, Runtime 1.785643, Loss 0.075650, forward nfe 19348, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 076/100, Runtime 1.812862, Loss 0.064974, forward nfe 19562, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 077/100, Runtime 1.795310, Loss 0.064019, forward nfe 19776, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 078/100, Runtime 1.818366, Loss 0.062286, forward nfe 19990, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 079/100, Runtime 1.757586, Loss 0.131578, forward nfe 20204, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 080/100, Runtime 1.785859, Loss 0.079156, forward nfe 20418, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 081/100, Runtime 1.838183, Loss 0.083088, forward nfe 20632, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 082/100, Runtime 1.775908, Loss 0.098715, forward nfe 20846, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 083/100, Runtime 1.796864, Loss 0.038451, forward nfe 21060, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 084/100, Runtime 1.793915, Loss 0.089113, forward nfe 21274, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 085/100, Runtime 1.772583, Loss 0.075161, forward nfe 21488, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 086/100, Runtime 1.788733, Loss 0.114871, forward nfe 21702, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 087/100, Runtime 1.828631, Loss 0.073739, forward nfe 21916, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 088/100, Runtime 1.815503, Loss 0.062596, forward nfe 22130, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 089/100, Runtime 1.752928, Loss 0.065611, forward nfe 22344, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 090/100, Runtime 1.767660, Loss 0.057701, forward nfe 22558, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 091/100, Runtime 1.750316, Loss 0.124894, forward nfe 22766, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 092/100, Runtime 1.731719, Loss 0.054327, forward nfe 22974, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 093/100, Runtime 1.863085, Loss 0.039572, forward nfe 23182, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 094/100, Runtime 1.764895, Loss 0.052977, forward nfe 23390, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 095/100, Runtime 1.731120, Loss 0.036964, forward nfe 23598, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 096/100, Runtime 1.769161, Loss 0.056716, forward nfe 23806, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 097/100, Runtime 1.575864, Loss 0.055396, forward nfe 24014, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 098/100, Runtime 1.622838, Loss 0.070819, forward nfe 24222, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
Epoch: 099/100, Runtime 1.624047, Loss 0.031531, forward nfe 24430, backward nfe 0, Train: 0.9714, Val: 0.8441, Test: 0.8609, Best time: 60.0000
best val accuracy 0.844118 with test accuracy 0.860914 at epoch 54 and best time 60.000000