/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 2.354326, Loss 1.946345, forward nfe 80, backward nfe 0, Train: 0.5929, Val: 0.4596, Test: 0.4741, Best time: 2.3419
Epoch: 002/100, Runtime 2.422134, Loss 1.812840, forward nfe 372, backward nfe 0, Train: 0.7071, Val: 0.6949, Test: 0.6822, Best time: 9.8513
Epoch: 003/100, Runtime 2.375975, Loss 1.517207, forward nfe 670, backward nfe 0, Train: 0.8714, Val: 0.7926, Test: 0.8132, Best time: 12.8585
Epoch: 004/100, Runtime 2.220682, Loss 1.226154, forward nfe 956, backward nfe 0, Train: 0.8714, Val: 0.8243, Test: 0.8376, Best time: 22.2962
Epoch: 005/100, Runtime 2.276458, Loss 0.959377, forward nfe 1230, backward nfe 0, Train: 0.9000, Val: 0.8287, Test: 0.8447, Best time: 10.0721
Epoch: 006/100, Runtime 2.173328, Loss 0.737817, forward nfe 1498, backward nfe 0, Train: 0.9000, Val: 0.8287, Test: 0.8447, Best time: 35.0000
Epoch: 007/100, Runtime 2.111881, Loss 0.577679, forward nfe 1760, backward nfe 0, Train: 0.9000, Val: 0.8287, Test: 0.8447, Best time: 35.0000
Epoch: 008/100, Runtime 2.140297, Loss 0.477782, forward nfe 2016, backward nfe 0, Train: 0.9000, Val: 0.8287, Test: 0.8447, Best time: 35.0000
Epoch: 009/100, Runtime 2.092123, Loss 0.457680, forward nfe 2278, backward nfe 0, Train: 0.9000, Val: 0.8287, Test: 0.8447, Best time: 35.0000
Epoch: 010/100, Runtime 2.080338, Loss 0.384681, forward nfe 2540, backward nfe 0, Train: 0.9000, Val: 0.8287, Test: 0.8447, Best time: 35.0000
Epoch: 011/100, Runtime 1.950541, Loss 0.330612, forward nfe 2784, backward nfe 0, Train: 0.9214, Val: 0.8368, Test: 0.8386, Best time: 30.7962
Epoch: 012/100, Runtime 1.911365, Loss 0.298362, forward nfe 3022, backward nfe 0, Train: 0.9500, Val: 0.8412, Test: 0.8447, Best time: 24.4746
Epoch: 013/100, Runtime 1.835172, Loss 0.269049, forward nfe 3254, backward nfe 0, Train: 0.9500, Val: 0.8412, Test: 0.8447, Best time: 35.0000
Epoch: 014/100, Runtime 1.914177, Loss 0.259515, forward nfe 3480, backward nfe 0, Train: 0.9500, Val: 0.8412, Test: 0.8447, Best time: 35.0000
Epoch: 015/100, Runtime 1.709156, Loss 0.312639, forward nfe 3694, backward nfe 0, Train: 0.9500, Val: 0.8412, Test: 0.8447, Best time: 35.0000
Epoch: 016/100, Runtime 1.728114, Loss 0.300487, forward nfe 3908, backward nfe 0, Train: 0.9500, Val: 0.8478, Test: 0.8538, Best time: 39.5234
Epoch: 017/100, Runtime 1.816212, Loss 0.257748, forward nfe 4122, backward nfe 0, Train: 0.9500, Val: 0.8478, Test: 0.8538, Best time: 35.0000
Epoch: 018/100, Runtime 1.659499, Loss 0.280206, forward nfe 4336, backward nfe 0, Train: 0.9500, Val: 0.8478, Test: 0.8538, Best time: 35.0000
Epoch: 019/100, Runtime 1.672790, Loss 0.313108, forward nfe 4538, backward nfe 0, Train: 0.9500, Val: 0.8478, Test: 0.8538, Best time: 35.0000
Epoch: 020/100, Runtime 1.569785, Loss 0.231720, forward nfe 4728, backward nfe 0, Train: 0.9500, Val: 0.8478, Test: 0.8538, Best time: 35.0000
Epoch: 021/100, Runtime 1.539592, Loss 0.237865, forward nfe 4912, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 86.3481
Epoch: 022/100, Runtime 1.550400, Loss 0.225232, forward nfe 5096, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 023/100, Runtime 1.674809, Loss 0.224547, forward nfe 5280, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 024/100, Runtime 1.545695, Loss 0.209674, forward nfe 5470, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 025/100, Runtime 1.553195, Loss 0.165238, forward nfe 5660, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 026/100, Runtime 1.522354, Loss 0.241319, forward nfe 5838, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 027/100, Runtime 1.488813, Loss 0.195641, forward nfe 6016, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 028/100, Runtime 1.445537, Loss 0.296024, forward nfe 6188, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 029/100, Runtime 1.455663, Loss 0.183717, forward nfe 6354, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 030/100, Runtime 1.396288, Loss 0.145702, forward nfe 6520, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 031/100, Runtime 1.350555, Loss 0.173654, forward nfe 6686, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 032/100, Runtime 1.384748, Loss 0.174739, forward nfe 6846, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 033/100, Runtime 1.341582, Loss 0.167631, forward nfe 7006, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 034/100, Runtime 1.403008, Loss 0.187541, forward nfe 7166, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 035/100, Runtime 1.317534, Loss 0.182733, forward nfe 7326, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 036/100, Runtime 1.389436, Loss 0.108159, forward nfe 7480, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 037/100, Runtime 1.279981, Loss 0.178935, forward nfe 7634, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 038/100, Runtime 1.306654, Loss 0.145561, forward nfe 7788, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 039/100, Runtime 1.351745, Loss 0.180597, forward nfe 7942, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 040/100, Runtime 1.356713, Loss 0.107399, forward nfe 8096, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 041/100, Runtime 1.374376, Loss 0.125652, forward nfe 8256, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 042/100, Runtime 1.269212, Loss 0.135318, forward nfe 8416, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 043/100, Runtime 1.339481, Loss 0.111610, forward nfe 8564, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 044/100, Runtime 1.268224, Loss 0.129603, forward nfe 8712, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 045/100, Runtime 1.268478, Loss 0.088130, forward nfe 8860, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 046/100, Runtime 1.246253, Loss 0.091196, forward nfe 9008, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 047/100, Runtime 1.298516, Loss 0.092206, forward nfe 9156, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 048/100, Runtime 1.243377, Loss 0.094972, forward nfe 9304, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 049/100, Runtime 1.247851, Loss 0.115946, forward nfe 9452, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 050/100, Runtime 1.258300, Loss 0.091592, forward nfe 9600, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 051/100, Runtime 1.322591, Loss 0.097829, forward nfe 9748, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 052/100, Runtime 1.267216, Loss 0.098745, forward nfe 9896, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 053/100, Runtime 1.271938, Loss 0.080522, forward nfe 10044, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 054/100, Runtime 1.252055, Loss 0.091336, forward nfe 10192, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 055/100, Runtime 1.326810, Loss 0.097893, forward nfe 10340, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 056/100, Runtime 1.273598, Loss 0.094512, forward nfe 10488, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 057/100, Runtime 1.206616, Loss 0.146434, forward nfe 10636, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 058/100, Runtime 1.249100, Loss 0.096239, forward nfe 10778, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 059/100, Runtime 1.292774, Loss 0.089935, forward nfe 10926, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 060/100, Runtime 1.288416, Loss 0.122569, forward nfe 11074, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 061/100, Runtime 1.036725, Loss 0.125988, forward nfe 11222, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 062/100, Runtime 1.061039, Loss 0.072270, forward nfe 11358, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 063/100, Runtime 1.102043, Loss 0.113940, forward nfe 11494, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 064/100, Runtime 1.119204, Loss 0.103700, forward nfe 11630, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 065/100, Runtime 1.114996, Loss 0.050771, forward nfe 11766, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 066/100, Runtime 1.127551, Loss 0.075980, forward nfe 11902, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 067/100, Runtime 1.250254, Loss 0.106345, forward nfe 12038, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 068/100, Runtime 1.235933, Loss 0.055803, forward nfe 12180, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 069/100, Runtime 1.243685, Loss 0.033795, forward nfe 12322, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 070/100, Runtime 1.235533, Loss 0.052252, forward nfe 12464, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 071/100, Runtime 1.239948, Loss 0.061509, forward nfe 12606, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 072/100, Runtime 1.232563, Loss 0.052987, forward nfe 12748, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 073/100, Runtime 1.216371, Loss 0.082996, forward nfe 12890, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 074/100, Runtime 1.237548, Loss 0.049463, forward nfe 13032, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 075/100, Runtime 1.267723, Loss 0.048669, forward nfe 13174, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 076/100, Runtime 1.218648, Loss 0.052300, forward nfe 13316, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 077/100, Runtime 1.243142, Loss 0.070935, forward nfe 13458, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 078/100, Runtime 1.209335, Loss 0.047812, forward nfe 13600, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 079/100, Runtime 1.105679, Loss 0.045001, forward nfe 13742, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 080/100, Runtime 1.203607, Loss 0.055388, forward nfe 13884, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 081/100, Runtime 1.253720, Loss 0.047510, forward nfe 14026, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 082/100, Runtime 1.263860, Loss 0.120983, forward nfe 14168, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 083/100, Runtime 1.231305, Loss 0.046004, forward nfe 14310, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 084/100, Runtime 1.228300, Loss 0.088246, forward nfe 14452, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 085/100, Runtime 1.246872, Loss 0.087662, forward nfe 14594, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 086/100, Runtime 1.212526, Loss 0.064888, forward nfe 14736, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 087/100, Runtime 1.200627, Loss 0.051557, forward nfe 14878, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 088/100, Runtime 1.165342, Loss 0.053509, forward nfe 15020, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 089/100, Runtime 1.248297, Loss 0.057636, forward nfe 15162, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 090/100, Runtime 1.193636, Loss 0.032357, forward nfe 15304, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 091/100, Runtime 1.200119, Loss 0.087184, forward nfe 15446, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 092/100, Runtime 1.229960, Loss 0.111040, forward nfe 15588, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 093/100, Runtime 1.116819, Loss 0.038154, forward nfe 15730, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 094/100, Runtime 1.159131, Loss 0.047671, forward nfe 15860, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 095/100, Runtime 1.210756, Loss 0.023530, forward nfe 16002, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 096/100, Runtime 1.176063, Loss 0.056001, forward nfe 16144, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 097/100, Runtime 0.974480, Loss 0.041625, forward nfe 16286, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 098/100, Runtime 1.104556, Loss 0.041382, forward nfe 16410, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
Epoch: 099/100, Runtime 1.123612, Loss 0.034776, forward nfe 16546, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8457, Best time: 35.0000
best val accuracy 0.850000 with test accuracy 0.845685 at epoch 21 and best time 35.000000