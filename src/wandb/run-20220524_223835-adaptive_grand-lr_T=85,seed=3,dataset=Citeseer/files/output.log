****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.886855, Loss 1.791400, forward nfe 218, backward nfe 0, Train: 0.2833, Val: 0.2913, Test: 0.2774, Best time: 0.0411
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 002/100, Runtime 0.786370, Loss 1.770967, forward nfe 936, backward nfe 0, Train: 0.4750, Val: 0.4645, Test: 0.4903, Best time: 0.3358
Epoch: 003/100, Runtime 0.801327, Loss 1.720915, forward nfe 1642, backward nfe 0, Train: 0.6667, Val: 0.6717, Test: 0.6952, Best time: 96.4545
Epoch: 004/100, Runtime 0.772773, Loss 1.700506, forward nfe 2348, backward nfe 0, Train: 0.6667, Val: 0.6717, Test: 0.6952, Best time: 85.0000
Epoch: 005/100, Runtime 0.810528, Loss 1.655826, forward nfe 3042, backward nfe 0, Train: 0.6667, Val: 0.6717, Test: 0.6952, Best time: 85.0000
Epoch: 006/100, Runtime 0.756452, Loss 1.604016, forward nfe 3736, backward nfe 0, Train: 0.6667, Val: 0.6725, Test: 0.6758, Best time: 23.6397
Epoch: 007/100, Runtime 0.732314, Loss 1.599151, forward nfe 4424, backward nfe 0, Train: 0.7250, Val: 0.7297, Test: 0.7290, Best time: 8.1623
Epoch: 008/100, Runtime 0.770333, Loss 1.561857, forward nfe 5088, backward nfe 0, Train: 0.7167, Val: 0.7333, Test: 0.7290, Best time: 4.9813
Epoch: 009/100, Runtime 0.739274, Loss 1.547957, forward nfe 5758, backward nfe 0, Train: 0.7167, Val: 0.7333, Test: 0.7290, Best time: 85.0000
Epoch: 010/100, Runtime 0.738451, Loss 1.543875, forward nfe 6410, backward nfe 0, Train: 0.7167, Val: 0.7333, Test: 0.7290, Best time: 85.0000
Epoch: 011/100, Runtime 0.717329, Loss 1.488961, forward nfe 7044, backward nfe 0, Train: 0.7167, Val: 0.7333, Test: 0.7290, Best time: 85.0000
Epoch: 012/100, Runtime 0.688552, Loss 1.525566, forward nfe 7678, backward nfe 0, Train: 0.7167, Val: 0.7333, Test: 0.7290, Best time: 85.0000
Epoch: 013/100, Runtime 0.697784, Loss 1.543742, forward nfe 8300, backward nfe 0, Train: 0.7167, Val: 0.7333, Test: 0.7290, Best time: 85.0000
Epoch: 014/100, Runtime 0.662313, Loss 1.456793, forward nfe 8904, backward nfe 0, Train: 0.7167, Val: 0.7333, Test: 0.7290, Best time: 85.0000
Epoch: 015/100, Runtime 0.672543, Loss 1.430938, forward nfe 9490, backward nfe 0, Train: 0.7167, Val: 0.7333, Test: 0.7290, Best time: 85.0000
Epoch: 016/100, Runtime 0.664108, Loss 1.452449, forward nfe 10070, backward nfe 0, Train: 0.7167, Val: 0.7333, Test: 0.7290, Best time: 85.0000
Epoch: 017/100, Runtime 0.669115, Loss 1.438504, forward nfe 10650, backward nfe 0, Train: 0.7167, Val: 0.7333, Test: 0.7290, Best time: 85.0000
Epoch: 018/100, Runtime 0.635072, Loss 1.351531, forward nfe 11236, backward nfe 0, Train: 0.7167, Val: 0.7333, Test: 0.7290, Best time: 85.0000
Epoch: 019/100, Runtime 0.641305, Loss 1.425084, forward nfe 11810, backward nfe 0, Train: 0.7167, Val: 0.7333, Test: 0.7290, Best time: 85.0000
Epoch: 020/100, Runtime 0.632958, Loss 1.339521, forward nfe 12372, backward nfe 0, Train: 0.7167, Val: 0.7333, Test: 0.7290, Best time: 85.0000
Epoch: 021/100, Runtime 0.594707, Loss 1.289660, forward nfe 12916, backward nfe 0, Train: 0.7167, Val: 0.7333, Test: 0.7290, Best time: 85.0000
Epoch: 022/100, Runtime 0.593800, Loss 1.246266, forward nfe 13454, backward nfe 0, Train: 0.7167, Val: 0.7333, Test: 0.7290, Best time: 85.0000
Epoch: 023/100, Runtime 0.620213, Loss 1.355975, forward nfe 13992, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.7306, Best time: 102.6267
Epoch: 024/100, Runtime 0.596910, Loss 1.295815, forward nfe 14524, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.7306, Best time: 85.0000
Epoch: 025/100, Runtime 0.579647, Loss 1.181650, forward nfe 15050, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.7306, Best time: 85.0000
Epoch: 026/100, Runtime 0.615012, Loss 1.284883, forward nfe 15564, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.7306, Best time: 85.0000
Epoch: 027/100, Runtime 0.598287, Loss 1.337539, forward nfe 16072, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.7306, Best time: 85.0000
Epoch: 028/100, Runtime 0.564512, Loss 1.215598, forward nfe 16568, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.7306, Best time: 85.0000
Epoch: 029/100, Runtime 0.578415, Loss 1.322795, forward nfe 17064, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.7306, Best time: 85.0000
Epoch: 030/100, Runtime 0.557228, Loss 1.333886, forward nfe 17554, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.7306, Best time: 85.0000
Epoch: 031/100, Runtime 0.578716, Loss 1.236734, forward nfe 18026, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.7306, Best time: 85.0000
Epoch: 032/100, Runtime 0.543330, Loss 1.308043, forward nfe 18498, backward nfe 0, Train: 0.7083, Val: 0.7399, Test: 0.7306, Best time: 85.0000
Epoch: 033/100, Runtime 0.534128, Loss 1.249723, forward nfe 18964, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 191.8109
Epoch: 034/100, Runtime 0.511214, Loss 1.295889, forward nfe 19418, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 035/100, Runtime 0.500085, Loss 1.218390, forward nfe 19866, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 036/100, Runtime 0.498928, Loss 1.191705, forward nfe 20314, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 037/100, Runtime 0.522765, Loss 1.389544, forward nfe 20750, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 038/100, Runtime 0.494124, Loss 1.254657, forward nfe 21186, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 039/100, Runtime 0.495897, Loss 1.302010, forward nfe 21610, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 040/100, Runtime 0.490340, Loss 1.193624, forward nfe 22034, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 041/100, Runtime 0.484554, Loss 1.292949, forward nfe 22458, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 042/100, Runtime 0.471370, Loss 1.292347, forward nfe 22864, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 043/100, Runtime 0.469697, Loss 1.249793, forward nfe 23270, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 044/100, Runtime 0.481389, Loss 1.280787, forward nfe 23670, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 045/100, Runtime 0.459981, Loss 1.216351, forward nfe 24064, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 046/100, Runtime 0.446881, Loss 1.257449, forward nfe 24452, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 047/100, Runtime 0.444579, Loss 1.347846, forward nfe 24840, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 048/100, Runtime 0.437999, Loss 1.380777, forward nfe 25222, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 049/100, Runtime 0.420583, Loss 1.445477, forward nfe 25598, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 050/100, Runtime 0.435243, Loss 1.312802, forward nfe 25968, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 051/100, Runtime 0.414514, Loss 1.279805, forward nfe 26326, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 052/100, Runtime 0.423324, Loss 1.340477, forward nfe 26684, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 053/100, Runtime 0.407564, Loss 1.264298, forward nfe 27036, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 054/100, Runtime 0.567750, Loss 1.295059, forward nfe 27388, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 055/100, Runtime 0.406690, Loss 1.229920, forward nfe 27752, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 056/100, Runtime 0.419024, Loss 1.214957, forward nfe 28098, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 057/100, Runtime 0.413645, Loss 1.239148, forward nfe 28444, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 058/100, Runtime 0.412724, Loss 1.151810, forward nfe 28790, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 059/100, Runtime 0.425442, Loss 1.273525, forward nfe 29136, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 060/100, Runtime 0.424076, Loss 1.192890, forward nfe 29482, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 061/100, Runtime 0.424597, Loss 1.202236, forward nfe 29828, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 062/100, Runtime 0.421042, Loss 1.189458, forward nfe 30174, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 063/100, Runtime 0.414912, Loss 1.298333, forward nfe 30520, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 064/100, Runtime 0.395712, Loss 1.277598, forward nfe 30866, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 065/100, Runtime 0.393062, Loss 1.193767, forward nfe 31206, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 066/100, Runtime 0.408157, Loss 1.193865, forward nfe 31546, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 067/100, Runtime 0.401053, Loss 1.167292, forward nfe 31886, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 068/100, Runtime 0.404476, Loss 1.325855, forward nfe 32232, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 069/100, Runtime 0.406320, Loss 1.281003, forward nfe 32566, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 070/100, Runtime 0.408123, Loss 1.119950, forward nfe 32900, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 071/100, Runtime 0.407108, Loss 1.339055, forward nfe 33246, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 072/100, Runtime 0.421483, Loss 1.310440, forward nfe 33586, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 073/100, Runtime 0.423651, Loss 1.268049, forward nfe 33932, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 074/100, Runtime 0.418018, Loss 1.222137, forward nfe 34278, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 075/100, Runtime 0.410688, Loss 1.242252, forward nfe 34618, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 076/100, Runtime 0.424292, Loss 1.126570, forward nfe 34964, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 077/100, Runtime 0.394947, Loss 1.157568, forward nfe 35304, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 078/100, Runtime 0.398214, Loss 1.472310, forward nfe 35638, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 079/100, Runtime 0.415503, Loss 1.250859, forward nfe 35972, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 080/100, Runtime 0.401639, Loss 1.245945, forward nfe 36306, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 081/100, Runtime 0.395801, Loss 1.214885, forward nfe 36640, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 082/100, Runtime 0.403030, Loss 1.221151, forward nfe 36974, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 083/100, Runtime 0.409547, Loss 1.198701, forward nfe 37308, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 084/100, Runtime 0.419960, Loss 1.218052, forward nfe 37642, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 085/100, Runtime 0.394666, Loss 1.289560, forward nfe 37970, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 086/100, Runtime 0.396689, Loss 1.145049, forward nfe 38298, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 087/100, Runtime 0.396840, Loss 1.067229, forward nfe 38626, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 088/100, Runtime 0.400061, Loss 1.121782, forward nfe 38954, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 089/100, Runtime 0.394305, Loss 1.196865, forward nfe 39282, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 090/100, Runtime 0.388908, Loss 1.108455, forward nfe 39604, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 091/100, Runtime 0.386736, Loss 1.105710, forward nfe 39926, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 092/100, Runtime 0.375425, Loss 1.273999, forward nfe 40242, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 093/100, Runtime 0.399102, Loss 1.115154, forward nfe 40558, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 094/100, Runtime 0.408481, Loss 1.226337, forward nfe 40880, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 095/100, Runtime 0.392925, Loss 1.167627, forward nfe 41196, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 096/100, Runtime 0.393314, Loss 1.252517, forward nfe 41512, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 097/100, Runtime 0.375965, Loss 1.165594, forward nfe 41828, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 098/100, Runtime 0.375623, Loss 1.224333, forward nfe 42144, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
Epoch: 099/100, Runtime 0.404550, Loss 1.150204, forward nfe 42460, backward nfe 0, Train: 0.6833, Val: 0.7449, Test: 0.7403, Best time: 85.0000
best val accuracy 0.744928 with test accuracy 0.740323 at epoch 33 and best time 85.000000