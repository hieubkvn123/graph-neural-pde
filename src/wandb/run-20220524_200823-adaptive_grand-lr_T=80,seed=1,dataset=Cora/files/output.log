/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 6.311777, Loss 1.949006, forward nfe 152, backward nfe 0, Train: 0.3429, Val: 0.4581, Test: 0.4548, Best time: 2.3546
Epoch: 002/100, Runtime 5.937177, Loss 1.992952, forward nfe 744, backward nfe 0, Train: 0.3429, Val: 0.4581, Test: 0.4548, Best time: 80.0000
Epoch: 003/100, Runtime 5.680276, Loss 1.954908, forward nfe 1336, backward nfe 0, Train: 0.3429, Val: 0.4581, Test: 0.4548, Best time: 80.0000
Epoch: 004/100, Runtime 5.883920, Loss 1.929419, forward nfe 1916, backward nfe 0, Train: 0.3429, Val: 0.4581, Test: 0.4548, Best time: 80.0000
Epoch: 005/100, Runtime 5.662679, Loss 1.897871, forward nfe 2484, backward nfe 0, Train: 0.3429, Val: 0.4581, Test: 0.4548, Best time: 80.0000
Epoch: 006/100, Runtime 5.456530, Loss 1.843251, forward nfe 3034, backward nfe 0, Train: 0.4143, Val: 0.4669, Test: 0.4650, Best time: 7.5221
Epoch: 007/100, Runtime 5.170100, Loss 1.757036, forward nfe 3566, backward nfe 0, Train: 0.4786, Val: 0.4721, Test: 0.4721, Best time: 7.8529
Epoch: 008/100, Runtime 5.256956, Loss 1.673177, forward nfe 4080, backward nfe 0, Train: 0.5786, Val: 0.5338, Test: 0.5310, Best time: 10.9903
Epoch: 009/100, Runtime 5.125625, Loss 1.564932, forward nfe 4594, backward nfe 0, Train: 0.6929, Val: 0.6382, Test: 0.6406, Best time: 11.5557
Epoch: 010/100, Runtime 5.028691, Loss 1.426798, forward nfe 5108, backward nfe 0, Train: 0.7571, Val: 0.6838, Test: 0.7025, Best time: 16.0879
Epoch: 011/100, Runtime 4.920801, Loss 1.294730, forward nfe 5598, backward nfe 0, Train: 0.7714, Val: 0.7235, Test: 0.7391, Best time: 16.8866
Epoch: 012/100, Runtime 4.920247, Loss 1.165939, forward nfe 6082, backward nfe 0, Train: 0.8214, Val: 0.7456, Test: 0.7563, Best time: 23.5617
Epoch: 013/100, Runtime 4.813548, Loss 1.016593, forward nfe 6554, backward nfe 0, Train: 0.8143, Val: 0.7581, Test: 0.7584, Best time: 51.8914
Epoch: 014/100, Runtime 4.760030, Loss 0.888477, forward nfe 7008, backward nfe 0, Train: 0.8143, Val: 0.7581, Test: 0.7584, Best time: 80.0000
Epoch: 015/100, Runtime 4.711194, Loss 0.815050, forward nfe 7456, backward nfe 0, Train: 0.8000, Val: 0.8022, Test: 0.7848, Best time: 68.2145
Epoch: 016/100, Runtime 4.569449, Loss 0.722112, forward nfe 7886, backward nfe 0, Train: 0.8071, Val: 0.8140, Test: 0.8112, Best time: 187.0731
Epoch: 017/100, Runtime 4.391991, Loss 0.637774, forward nfe 8310, backward nfe 0, Train: 0.8071, Val: 0.8140, Test: 0.8112, Best time: 80.0000
Epoch: 018/100, Runtime 4.458244, Loss 0.608124, forward nfe 8734, backward nfe 0, Train: 0.8643, Val: 0.8184, Test: 0.8112, Best time: 102.4809
Epoch: 019/100, Runtime 4.345333, Loss 0.557903, forward nfe 9146, backward nfe 0, Train: 0.8643, Val: 0.8184, Test: 0.8112, Best time: 80.0000
Epoch: 020/100, Runtime 4.180209, Loss 0.600682, forward nfe 9552, backward nfe 0, Train: 0.8643, Val: 0.8184, Test: 0.8112, Best time: 80.0000
Epoch: 021/100, Runtime 3.611102, Loss 0.556764, forward nfe 9928, backward nfe 0, Train: 0.8643, Val: 0.8184, Test: 0.8112, Best time: 80.0000
Epoch: 022/100, Runtime 3.873173, Loss 0.488805, forward nfe 10292, backward nfe 0, Train: 0.8643, Val: 0.8324, Test: 0.8274, Best time: 141.0574
Epoch: 023/100, Runtime 3.888234, Loss 0.457437, forward nfe 10650, backward nfe 0, Train: 0.8643, Val: 0.8324, Test: 0.8274, Best time: 80.0000
Epoch: 024/100, Runtime 3.753303, Loss 0.493818, forward nfe 11008, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 125.8736
Epoch: 025/100, Runtime 3.650809, Loss 0.472357, forward nfe 11366, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 026/100, Runtime 3.509525, Loss 0.413873, forward nfe 11712, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 027/100, Runtime 3.307706, Loss 0.403529, forward nfe 12040, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 028/100, Runtime 3.365154, Loss 0.354768, forward nfe 12356, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 029/100, Runtime 3.301705, Loss 0.406363, forward nfe 12672, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 030/100, Runtime 3.374429, Loss 0.403272, forward nfe 12982, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 031/100, Runtime 3.340321, Loss 0.315795, forward nfe 13298, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 032/100, Runtime 3.109128, Loss 0.342516, forward nfe 13608, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 033/100, Runtime 3.072029, Loss 0.306359, forward nfe 13900, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 034/100, Runtime 3.144027, Loss 0.360025, forward nfe 14192, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 035/100, Runtime 2.967368, Loss 0.324010, forward nfe 14478, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 036/100, Runtime 2.924131, Loss 0.352150, forward nfe 14752, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 037/100, Runtime 2.953621, Loss 0.310221, forward nfe 15026, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 038/100, Runtime 3.022980, Loss 0.281828, forward nfe 15300, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 039/100, Runtime 3.047008, Loss 0.247803, forward nfe 15580, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 040/100, Runtime 2.957508, Loss 0.229767, forward nfe 15860, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 041/100, Runtime 3.048870, Loss 0.239437, forward nfe 16140, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 042/100, Runtime 2.960842, Loss 0.272887, forward nfe 16420, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 043/100, Runtime 2.902013, Loss 0.209435, forward nfe 16688, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 044/100, Runtime 2.762524, Loss 0.238010, forward nfe 16950, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 045/100, Runtime 2.832733, Loss 0.193695, forward nfe 17212, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 046/100, Runtime 2.713040, Loss 0.217679, forward nfe 17480, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 047/100, Runtime 2.677236, Loss 0.199474, forward nfe 17742, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 048/100, Runtime 2.698169, Loss 0.169327, forward nfe 18004, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 049/100, Runtime 2.769319, Loss 0.169707, forward nfe 18266, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 050/100, Runtime 2.761007, Loss 0.168031, forward nfe 18528, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 051/100, Runtime 2.715059, Loss 0.151134, forward nfe 18790, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 052/100, Runtime 2.751194, Loss 0.143521, forward nfe 19052, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 053/100, Runtime 2.686028, Loss 0.101971, forward nfe 19314, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 054/100, Runtime 2.777147, Loss 0.200135, forward nfe 19570, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 055/100, Runtime 2.906270, Loss 0.141529, forward nfe 19826, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 056/100, Runtime 2.762269, Loss 0.150518, forward nfe 20088, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 057/100, Runtime 2.580157, Loss 0.136939, forward nfe 20344, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 058/100, Runtime 2.747834, Loss 0.126474, forward nfe 20594, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 059/100, Runtime 2.720208, Loss 0.179368, forward nfe 20844, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 060/100, Runtime 2.725158, Loss 0.074945, forward nfe 21094, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 061/100, Runtime 2.678122, Loss 0.188317, forward nfe 21344, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 062/100, Runtime 2.714428, Loss 0.149358, forward nfe 21594, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 063/100, Runtime 2.590749, Loss 0.096401, forward nfe 21844, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 064/100, Runtime 2.593106, Loss 0.138228, forward nfe 22094, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 065/100, Runtime 2.566813, Loss 0.173684, forward nfe 22344, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 066/100, Runtime 2.569633, Loss 0.152717, forward nfe 22594, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 067/100, Runtime 2.602507, Loss 0.121599, forward nfe 22844, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 068/100, Runtime 2.619645, Loss 0.132206, forward nfe 23094, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 069/100, Runtime 2.598866, Loss 0.075305, forward nfe 23344, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 070/100, Runtime 2.538280, Loss 0.115383, forward nfe 23594, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 071/100, Runtime 2.586724, Loss 0.190866, forward nfe 23844, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 072/100, Runtime 2.629614, Loss 0.058636, forward nfe 24088, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 073/100, Runtime 2.429604, Loss 0.134521, forward nfe 24338, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 074/100, Runtime 2.502448, Loss 0.118661, forward nfe 24576, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 075/100, Runtime 2.628125, Loss 0.086374, forward nfe 24814, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 076/100, Runtime 2.506939, Loss 0.090681, forward nfe 25052, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 077/100, Runtime 2.670634, Loss 0.053762, forward nfe 25290, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 078/100, Runtime 2.609781, Loss 0.085361, forward nfe 25528, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 079/100, Runtime 2.583493, Loss 0.077046, forward nfe 25766, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 080/100, Runtime 2.494053, Loss 0.052461, forward nfe 26004, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 081/100, Runtime 2.606027, Loss 0.038055, forward nfe 26242, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 082/100, Runtime 2.594021, Loss 0.085108, forward nfe 26480, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 083/100, Runtime 2.589786, Loss 0.066995, forward nfe 26718, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 084/100, Runtime 2.462540, Loss 0.055194, forward nfe 26956, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 085/100, Runtime 2.525924, Loss 0.079856, forward nfe 27194, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 086/100, Runtime 2.578994, Loss 0.062525, forward nfe 27432, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 087/100, Runtime 2.374940, Loss 0.053188, forward nfe 27670, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 088/100, Runtime 2.544878, Loss 0.078804, forward nfe 27902, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 089/100, Runtime 2.564857, Loss 0.043919, forward nfe 28134, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 090/100, Runtime 2.496931, Loss 0.060729, forward nfe 28366, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 091/100, Runtime 2.463428, Loss 0.079549, forward nfe 28598, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 092/100, Runtime 2.324501, Loss 0.048867, forward nfe 28818, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 093/100, Runtime 2.431827, Loss 0.090386, forward nfe 29038, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 094/100, Runtime 2.189330, Loss 0.087342, forward nfe 29258, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 095/100, Runtime 2.468233, Loss 0.058009, forward nfe 29478, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 096/100, Runtime 2.229632, Loss 0.060911, forward nfe 29704, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 097/100, Runtime 2.331959, Loss 0.077404, forward nfe 29924, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 098/100, Runtime 2.255720, Loss 0.060212, forward nfe 30144, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
Epoch: 099/100, Runtime 2.369965, Loss 0.066447, forward nfe 30358, backward nfe 0, Train: 0.8929, Val: 0.8426, Test: 0.8294, Best time: 80.0000
best val accuracy 0.842647 with test accuracy 0.829442 at epoch 24 and best time 80.000000