/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.594795, Loss 1.795490, forward nfe 140, backward nfe 0, Train: 0.2333, Val: 0.3029, Test: 0.3016, Best time: 0.0401
Epoch: 002/100, Runtime 0.481208, Loss 1.785668, forward nfe 552, backward nfe 0, Train: 0.3167, Val: 0.3652, Test: 0.3468, Best time: 0.0384
Epoch: 003/100, Runtime 0.503908, Loss 1.756598, forward nfe 988, backward nfe 0, Train: 0.3667, Val: 0.4667, Test: 0.4339, Best time: 6.8076
Epoch: 004/100, Runtime 0.502722, Loss 1.738322, forward nfe 1412, backward nfe 0, Train: 0.4000, Val: 0.4957, Test: 0.4565, Best time: 1.4140
Epoch: 005/100, Runtime 0.481733, Loss 1.712480, forward nfe 1830, backward nfe 0, Train: 0.4667, Val: 0.5210, Test: 0.4839, Best time: 14.8361
Epoch: 006/100, Runtime 0.480977, Loss 1.668407, forward nfe 2248, backward nfe 0, Train: 0.5000, Val: 0.5413, Test: 0.5145, Best time: 18.0207
Epoch: 007/100, Runtime 0.460840, Loss 1.635954, forward nfe 2654, backward nfe 0, Train: 0.5333, Val: 0.5601, Test: 0.5371, Best time: 30.4427
Epoch: 008/100, Runtime 0.459490, Loss 1.604144, forward nfe 3054, backward nfe 0, Train: 0.5417, Val: 0.5630, Test: 0.5145, Best time: 68.0363
Epoch: 009/100, Runtime 0.465789, Loss 1.596169, forward nfe 3454, backward nfe 0, Train: 0.5333, Val: 0.5667, Test: 0.5339, Best time: 32.7358
Epoch: 010/100, Runtime 0.452375, Loss 1.565446, forward nfe 3848, backward nfe 0, Train: 0.5667, Val: 0.5746, Test: 0.5387, Best time: 12.9806
Epoch: 011/100, Runtime 0.453661, Loss 1.568457, forward nfe 4230, backward nfe 0, Train: 0.6417, Val: 0.6312, Test: 0.6210, Best time: 25.7687
Epoch: 012/100, Runtime 0.451580, Loss 1.534580, forward nfe 4612, backward nfe 0, Train: 0.6917, Val: 0.6754, Test: 0.6758, Best time: 11.9504
Epoch: 013/100, Runtime 0.434393, Loss 1.461506, forward nfe 4994, backward nfe 0, Train: 0.7833, Val: 0.7000, Test: 0.7032, Best time: 1.7447
Epoch: 014/100, Runtime 0.427075, Loss 1.490213, forward nfe 5370, backward nfe 0, Train: 0.8000, Val: 0.7225, Test: 0.7129, Best time: 3.3884
Epoch: 015/100, Runtime 0.424685, Loss 1.463717, forward nfe 5734, backward nfe 0, Train: 0.7833, Val: 0.7406, Test: 0.7387, Best time: 5.4440
Epoch: 016/100, Runtime 0.427852, Loss 1.375019, forward nfe 6098, backward nfe 0, Train: 0.7500, Val: 0.7486, Test: 0.7290, Best time: 13.0504
Epoch: 017/100, Runtime 0.412326, Loss 1.370266, forward nfe 6462, backward nfe 0, Train: 0.7500, Val: 0.7507, Test: 0.7258, Best time: 21.6543
Epoch: 018/100, Runtime 0.334424, Loss 1.376759, forward nfe 6820, backward nfe 0, Train: 0.8000, Val: 0.7551, Test: 0.7419, Best time: 13.5948
Epoch: 019/100, Runtime 0.324600, Loss 1.246605, forward nfe 7172, backward nfe 0, Train: 0.8000, Val: 0.7551, Test: 0.7419, Best time: 40.0000
Epoch: 020/100, Runtime 0.329575, Loss 1.254056, forward nfe 7518, backward nfe 0, Train: 0.8000, Val: 0.7551, Test: 0.7419, Best time: 40.0000
Epoch: 021/100, Runtime 0.324823, Loss 1.161736, forward nfe 7864, backward nfe 0, Train: 0.8000, Val: 0.7551, Test: 0.7419, Best time: 40.0000
Epoch: 022/100, Runtime 0.323852, Loss 1.192526, forward nfe 8204, backward nfe 0, Train: 0.8000, Val: 0.7551, Test: 0.7419, Best time: 40.0000
Epoch: 023/100, Runtime 0.323456, Loss 1.200300, forward nfe 8532, backward nfe 0, Train: 0.8000, Val: 0.7551, Test: 0.7419, Best time: 40.0000
Epoch: 024/100, Runtime 0.307101, Loss 1.097157, forward nfe 8860, backward nfe 0, Train: 0.8000, Val: 0.7551, Test: 0.7419, Best time: 40.0000
Epoch: 025/100, Runtime 0.327243, Loss 1.140154, forward nfe 9182, backward nfe 0, Train: 0.8000, Val: 0.7551, Test: 0.7419, Best time: 40.0000
Epoch: 026/100, Runtime 0.308876, Loss 0.991300, forward nfe 9504, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 24.6868
Epoch: 027/100, Runtime 0.313734, Loss 1.120100, forward nfe 9820, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 028/100, Runtime 0.330526, Loss 1.215900, forward nfe 10130, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 029/100, Runtime 0.293647, Loss 1.140340, forward nfe 10440, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 030/100, Runtime 0.291429, Loss 1.130104, forward nfe 10738, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 031/100, Runtime 0.276433, Loss 1.102461, forward nfe 11036, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 032/100, Runtime 0.290906, Loss 1.163708, forward nfe 11328, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 033/100, Runtime 0.278832, Loss 1.036896, forward nfe 11620, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 034/100, Runtime 0.270930, Loss 0.939059, forward nfe 11906, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 035/100, Runtime 0.275473, Loss 1.100962, forward nfe 12192, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 036/100, Runtime 0.272923, Loss 1.101134, forward nfe 12472, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 037/100, Runtime 0.272643, Loss 1.039145, forward nfe 12752, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 038/100, Runtime 0.266380, Loss 1.094306, forward nfe 13020, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 039/100, Runtime 0.258753, Loss 1.020621, forward nfe 13288, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 040/100, Runtime 0.252843, Loss 1.155887, forward nfe 13550, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 041/100, Runtime 0.269049, Loss 1.072412, forward nfe 13806, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 042/100, Runtime 0.251271, Loss 1.039574, forward nfe 14068, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 043/100, Runtime 0.253175, Loss 1.105593, forward nfe 14318, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 044/100, Runtime 0.246553, Loss 1.002436, forward nfe 14562, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 045/100, Runtime 0.248966, Loss 0.990967, forward nfe 14806, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 046/100, Runtime 0.241600, Loss 0.981456, forward nfe 15050, backward nfe 0, Train: 0.8583, Val: 0.7587, Test: 0.7242, Best time: 40.0000
Epoch: 047/100, Runtime 0.238022, Loss 1.033662, forward nfe 15294, backward nfe 0, Train: 0.8667, Val: 0.7652, Test: 0.7323, Best time: 43.7610
Epoch: 048/100, Runtime 0.240932, Loss 1.065315, forward nfe 15532, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 44.8708
Epoch: 049/100, Runtime 0.251052, Loss 1.036982, forward nfe 15770, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 050/100, Runtime 0.243960, Loss 0.990787, forward nfe 16008, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 051/100, Runtime 0.264200, Loss 1.060026, forward nfe 16246, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 052/100, Runtime 0.303794, Loss 1.046418, forward nfe 16484, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 053/100, Runtime 0.264652, Loss 1.058343, forward nfe 16722, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 054/100, Runtime 0.235824, Loss 0.983765, forward nfe 16960, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 055/100, Runtime 0.237215, Loss 1.086335, forward nfe 17198, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 056/100, Runtime 0.238028, Loss 1.114915, forward nfe 17436, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 057/100, Runtime 0.252312, Loss 1.031426, forward nfe 17674, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 058/100, Runtime 0.237792, Loss 0.933533, forward nfe 17912, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 059/100, Runtime 0.234946, Loss 1.008450, forward nfe 18150, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 060/100, Runtime 0.231596, Loss 1.034741, forward nfe 18388, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 061/100, Runtime 0.233986, Loss 1.110484, forward nfe 18626, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 062/100, Runtime 0.233184, Loss 1.068720, forward nfe 18864, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 063/100, Runtime 0.237733, Loss 1.056091, forward nfe 19102, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 064/100, Runtime 0.253089, Loss 1.060664, forward nfe 19346, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 065/100, Runtime 0.295970, Loss 1.112976, forward nfe 19584, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 066/100, Runtime 0.293367, Loss 1.102485, forward nfe 19828, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 067/100, Runtime 0.309268, Loss 0.956004, forward nfe 20066, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 068/100, Runtime 0.325906, Loss 1.012528, forward nfe 20304, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 069/100, Runtime 0.295067, Loss 1.089089, forward nfe 20548, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 070/100, Runtime 0.304329, Loss 1.066716, forward nfe 20792, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 071/100, Runtime 0.307043, Loss 0.963541, forward nfe 21036, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 072/100, Runtime 0.297788, Loss 1.048304, forward nfe 21280, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 073/100, Runtime 0.298730, Loss 1.045901, forward nfe 21524, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 074/100, Runtime 0.295510, Loss 1.076609, forward nfe 21768, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 075/100, Runtime 0.306823, Loss 0.937621, forward nfe 22012, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 076/100, Runtime 0.290374, Loss 1.026750, forward nfe 22256, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 077/100, Runtime 0.293158, Loss 1.015368, forward nfe 22494, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 078/100, Runtime 0.294631, Loss 1.068996, forward nfe 22732, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 079/100, Runtime 0.295426, Loss 0.976079, forward nfe 22970, backward nfe 0, Train: 0.8583, Val: 0.7667, Test: 0.7355, Best time: 40.0000
Epoch: 080/100, Runtime 0.306790, Loss 1.113234, forward nfe 23208, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 65.2516
Epoch: 081/100, Runtime 0.418994, Loss 0.961790, forward nfe 23446, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 082/100, Runtime 0.302731, Loss 1.006664, forward nfe 23684, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 083/100, Runtime 0.298477, Loss 1.095182, forward nfe 23922, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 084/100, Runtime 0.293088, Loss 1.065707, forward nfe 24160, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 085/100, Runtime 0.290462, Loss 0.979102, forward nfe 24398, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 086/100, Runtime 0.296399, Loss 1.047942, forward nfe 24636, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 087/100, Runtime 0.297292, Loss 1.121947, forward nfe 24874, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 088/100, Runtime 0.302564, Loss 1.075011, forward nfe 25112, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 089/100, Runtime 0.299676, Loss 1.022402, forward nfe 25350, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 090/100, Runtime 0.295998, Loss 0.963372, forward nfe 25588, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 091/100, Runtime 0.300612, Loss 0.927511, forward nfe 25826, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 092/100, Runtime 0.311396, Loss 0.895652, forward nfe 26064, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 093/100, Runtime 0.289287, Loss 0.986189, forward nfe 26302, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 094/100, Runtime 0.297629, Loss 1.014331, forward nfe 26540, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 095/100, Runtime 0.302800, Loss 0.933716, forward nfe 26778, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 096/100, Runtime 0.296275, Loss 0.947031, forward nfe 27016, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 097/100, Runtime 0.313600, Loss 1.009054, forward nfe 27254, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 098/100, Runtime 0.312716, Loss 1.024588, forward nfe 27492, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
Epoch: 099/100, Runtime 0.295477, Loss 1.050357, forward nfe 27730, backward nfe 0, Train: 0.8750, Val: 0.7703, Test: 0.7419, Best time: 40.0000
best val accuracy 0.770290 with test accuracy 0.741935 at epoch 80 and best time 40.000000