/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 11.632145, Loss 1.098657, forward nfe 62, backward nfe 1098, Train: 0.6333, Val: 0.5632, Test: 0.5623, Best time: 0.2405
Epoch: 002/100, Runtime 8.931796, Loss 1.085319, forward nfe 360, backward nfe 1934, Train: 0.6667, Val: 0.5847, Test: 0.5921, Best time: 2.6910
Epoch: 003/100, Runtime 10.166983, Loss 1.067849, forward nfe 652, backward nfe 2905, Train: 0.7667, Val: 0.6736, Test: 0.6687, Best time: 2.6215
Epoch: 004/100, Runtime 10.354291, Loss 1.041771, forward nfe 938, backward nfe 3905, Train: 0.8333, Val: 0.7111, Test: 0.7035, Best time: 2.5314
Epoch: 005/100, Runtime 9.723060, Loss 1.006749, forward nfe 1218, backward nfe 4819, Train: 0.8000, Val: 0.7215, Test: 0.7096, Best time: 2.4538
Epoch: 006/100, Runtime 9.934579, Loss 0.960988, forward nfe 1504, backward nfe 5759, Train: 0.7500, Val: 0.7271, Test: 0.7169, Best time: 97.8709
Epoch: 007/100, Runtime 8.656547, Loss 0.914672, forward nfe 1778, backward nfe 6579, Train: 0.7500, Val: 0.7278, Test: 0.7163, Best time: 25.0000
Epoch: 008/100, Runtime 7.272180, Loss 0.855909, forward nfe 2046, backward nfe 7251, Train: 0.7500, Val: 0.7278, Test: 0.7163, Best time: 25.0000
Epoch: 009/100, Runtime 6.919531, Loss 0.809414, forward nfe 2314, backward nfe 7890, Train: 0.7500, Val: 0.7278, Test: 0.7163, Best time: 25.0000
Epoch: 010/100, Runtime 4.272779, Loss 0.753258, forward nfe 2576, backward nfe 8265, Train: 0.8333, Val: 0.7306, Test: 0.7155, Best time: 5.7575
Epoch: 011/100, Runtime 2.910647, Loss 0.690777, forward nfe 2838, backward nfe 8497, Train: 0.8500, Val: 0.7354, Test: 0.7244, Best time: 5.7910
Epoch: 012/100, Runtime 4.849473, Loss 0.641839, forward nfe 3094, backward nfe 8922, Train: 0.8167, Val: 0.7403, Test: 0.7282, Best time: 2.1266
Epoch: 013/100, Runtime 5.118006, Loss 0.579998, forward nfe 3350, backward nfe 9376, Train: 0.8500, Val: 0.7424, Test: 0.7306, Best time: 2.0951
Epoch: 014/100, Runtime 4.602013, Loss 0.556445, forward nfe 3600, backward nfe 9777, Train: 0.8500, Val: 0.7438, Test: 0.7320, Best time: 2.0692
Epoch: 015/100, Runtime 3.683598, Loss 0.535048, forward nfe 3850, backward nfe 10090, Train: 0.8667, Val: 0.7542, Test: 0.7447, Best time: 10.6776
Epoch: 016/100, Runtime 3.146354, Loss 0.493509, forward nfe 4088, backward nfe 10348, Train: 0.8667, Val: 0.7639, Test: 0.7508, Best time: 10.9142
Epoch: 017/100, Runtime 3.854287, Loss 0.477296, forward nfe 4326, backward nfe 10677, Train: 0.8667, Val: 0.7639, Test: 0.7508, Best time: 25.0000
Epoch: 018/100, Runtime 3.938435, Loss 0.443177, forward nfe 4558, backward nfe 11016, Train: 0.8667, Val: 0.7639, Test: 0.7508, Best time: 25.0000
Epoch: 019/100, Runtime 3.864437, Loss 0.395835, forward nfe 4778, backward nfe 11353, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 18.7451
Epoch: 020/100, Runtime 3.134103, Loss 0.425794, forward nfe 4992, backward nfe 11618, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 021/100, Runtime 3.107623, Loss 0.393228, forward nfe 5206, backward nfe 11880, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 022/100, Runtime 2.369648, Loss 0.371147, forward nfe 5420, backward nfe 12068, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 023/100, Runtime 1.845900, Loss 0.379216, forward nfe 5628, backward nfe 12203, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 024/100, Runtime 2.041959, Loss 0.369196, forward nfe 5836, backward nfe 12362, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 025/100, Runtime 1.803201, Loss 0.363556, forward nfe 6038, backward nfe 12495, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 026/100, Runtime 1.881170, Loss 0.324618, forward nfe 6240, backward nfe 12636, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 027/100, Runtime 1.721073, Loss 0.325390, forward nfe 6442, backward nfe 12762, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 028/100, Runtime 1.679339, Loss 0.289466, forward nfe 6638, backward nfe 12883, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 029/100, Runtime 1.555864, Loss 0.341303, forward nfe 6834, backward nfe 12995, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 030/100, Runtime 1.092108, Loss 0.264619, forward nfe 7018, backward nfe 13059, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 031/100, Runtime 0.930519, Loss 0.288577, forward nfe 7202, backward nfe 13110, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 032/100, Runtime 1.049742, Loss 0.268663, forward nfe 7362, backward nfe 13177, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 033/100, Runtime 1.099103, Loss 0.250219, forward nfe 7522, backward nfe 13250, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 034/100, Runtime 0.999637, Loss 0.268064, forward nfe 7682, backward nfe 13311, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 035/100, Runtime 0.668786, Loss 0.269955, forward nfe 7848, backward nfe 13336, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 036/100, Runtime 0.918293, Loss 0.237994, forward nfe 8008, backward nfe 13389, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 037/100, Runtime 0.960247, Loss 0.207115, forward nfe 8174, backward nfe 13444, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 038/100, Runtime 0.866673, Loss 0.210942, forward nfe 8340, backward nfe 13490, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 039/100, Runtime 1.107517, Loss 0.245582, forward nfe 8500, backward nfe 13566, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 040/100, Runtime 0.965240, Loss 0.164162, forward nfe 8648, backward nfe 13626, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 041/100, Runtime 0.891549, Loss 0.186149, forward nfe 8802, backward nfe 13679, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 042/100, Runtime 0.753750, Loss 0.191529, forward nfe 8950, backward nfe 13719, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 043/100, Runtime 0.682973, Loss 0.189839, forward nfe 9092, backward nfe 13750, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 044/100, Runtime 0.638097, Loss 0.204038, forward nfe 9240, backward nfe 13775, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 045/100, Runtime 0.613355, Loss 0.202002, forward nfe 9388, backward nfe 13799, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 046/100, Runtime 0.589807, Loss 0.151048, forward nfe 9530, backward nfe 13821, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 047/100, Runtime 0.618600, Loss 0.163713, forward nfe 9672, backward nfe 13846, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 048/100, Runtime 0.567694, Loss 0.137727, forward nfe 9814, backward nfe 13865, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 049/100, Runtime 0.607813, Loss 0.130265, forward nfe 9956, backward nfe 13889, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 050/100, Runtime 0.606095, Loss 0.214628, forward nfe 10098, backward nfe 13911, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 051/100, Runtime 0.589885, Loss 0.176171, forward nfe 10240, backward nfe 13933, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 052/100, Runtime 0.536006, Loss 0.142548, forward nfe 10382, backward nfe 13952, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 053/100, Runtime 0.536557, Loss 0.144675, forward nfe 10512, backward nfe 13971, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 054/100, Runtime 0.531922, Loss 0.175080, forward nfe 10642, backward nfe 13989, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 055/100, Runtime 0.516412, Loss 0.104435, forward nfe 10772, backward nfe 14006, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 056/100, Runtime 0.507656, Loss 0.108418, forward nfe 10902, backward nfe 14022, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 057/100, Runtime 0.514902, Loss 0.159211, forward nfe 11032, backward nfe 14038, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 058/100, Runtime 0.498150, Loss 0.116092, forward nfe 11162, backward nfe 14052, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 059/100, Runtime 0.484195, Loss 0.126600, forward nfe 11292, backward nfe 14067, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 060/100, Runtime 0.475138, Loss 0.114444, forward nfe 11416, backward nfe 14081, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 061/100, Runtime 0.462766, Loss 0.120016, forward nfe 11540, backward nfe 14094, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 062/100, Runtime 0.491971, Loss 0.107609, forward nfe 11664, backward nfe 14110, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 063/100, Runtime 0.486508, Loss 0.095434, forward nfe 11788, backward nfe 14125, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 064/100, Runtime 0.480637, Loss 0.109925, forward nfe 11912, backward nfe 14140, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 065/100, Runtime 0.488844, Loss 0.088649, forward nfe 12036, backward nfe 14155, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 066/100, Runtime 0.472133, Loss 0.100717, forward nfe 12160, backward nfe 14169, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 067/100, Runtime 0.449640, Loss 0.076422, forward nfe 12278, backward nfe 14182, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 068/100, Runtime 0.464862, Loss 0.060024, forward nfe 12396, backward nfe 14197, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 069/100, Runtime 0.465168, Loss 0.109419, forward nfe 12514, backward nfe 14212, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 070/100, Runtime 0.420887, Loss 0.081521, forward nfe 12632, backward nfe 14225, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 071/100, Runtime 0.433666, Loss 0.125152, forward nfe 12738, backward nfe 14240, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 072/100, Runtime 0.424316, Loss 0.128390, forward nfe 12844, backward nfe 14254, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 073/100, Runtime 0.443039, Loss 0.098017, forward nfe 12950, backward nfe 14270, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 074/100, Runtime 0.429913, Loss 0.116568, forward nfe 13056, backward nfe 14284, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 075/100, Runtime 0.426955, Loss 0.070618, forward nfe 13162, backward nfe 14298, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 076/100, Runtime 0.408709, Loss 0.075204, forward nfe 13268, backward nfe 14310, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 077/100, Runtime 0.449099, Loss 0.119851, forward nfe 13374, backward nfe 14326, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 078/100, Runtime 0.426012, Loss 0.060753, forward nfe 13480, backward nfe 14340, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 079/100, Runtime 0.424476, Loss 0.108666, forward nfe 13586, backward nfe 14353, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 080/100, Runtime 0.417506, Loss 0.109751, forward nfe 13692, backward nfe 14366, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 081/100, Runtime 0.417905, Loss 0.040138, forward nfe 13798, backward nfe 14379, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 082/100, Runtime 0.422379, Loss 0.044521, forward nfe 13904, backward nfe 14392, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 083/100, Runtime 0.438340, Loss 0.082010, forward nfe 14010, backward nfe 14406, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 084/100, Runtime 0.431311, Loss 0.103084, forward nfe 14116, backward nfe 14420, Train: 0.9000, Val: 0.7681, Test: 0.7572, Best time: 25.0000
Epoch: 085/100, Runtime 0.422019, Loss 0.058144, forward nfe 14222, backward nfe 14434, Train: 0.9833, Val: 0.7736, Test: 0.7652, Best time: 86.7617
Epoch: 086/100, Runtime 0.417812, Loss 0.062113, forward nfe 14328, backward nfe 14448, Train: 0.9833, Val: 0.7736, Test: 0.7652, Best time: 25.0000
Epoch: 087/100, Runtime 0.407973, Loss 0.054874, forward nfe 14434, backward nfe 14460, Train: 0.9833, Val: 0.7736, Test: 0.7652, Best time: 25.0000
Epoch: 088/100, Runtime 0.417835, Loss 0.075133, forward nfe 14540, backward nfe 14473, Train: 0.9833, Val: 0.7736, Test: 0.7652, Best time: 25.0000
Epoch: 089/100, Runtime 0.409992, Loss 0.066083, forward nfe 14646, backward nfe 14485, Train: 0.9833, Val: 0.7736, Test: 0.7652, Best time: 25.0000
Epoch: 090/100, Runtime 0.412451, Loss 0.095223, forward nfe 14752, backward nfe 14497, Train: 0.9833, Val: 0.7736, Test: 0.7652, Best time: 25.0000
Epoch: 091/100, Runtime 0.420219, Loss 0.102983, forward nfe 14858, backward nfe 14510, Train: 0.9833, Val: 0.7736, Test: 0.7652, Best time: 25.0000
Epoch: 092/100, Runtime 0.406756, Loss 0.033983, forward nfe 14964, backward nfe 14522, Train: 0.9833, Val: 0.7736, Test: 0.7652, Best time: 25.0000
Epoch: 093/100, Runtime 0.399424, Loss 0.049531, forward nfe 15070, backward nfe 14532, Train: 0.9833, Val: 0.7736, Test: 0.7652, Best time: 25.0000
Epoch: 094/100, Runtime 0.433393, Loss 0.164656, forward nfe 15176, backward nfe 14546, Train: 0.9833, Val: 0.7736, Test: 0.7652, Best time: 25.0000
Epoch: 095/100, Runtime 0.417732, Loss 0.062258, forward nfe 15282, backward nfe 14559, Train: 0.9833, Val: 0.7736, Test: 0.7652, Best time: 25.0000
Epoch: 096/100, Runtime 0.412346, Loss 0.041469, forward nfe 15388, backward nfe 14571, Train: 0.9833, Val: 0.7736, Test: 0.7652, Best time: 25.0000
Epoch: 097/100, Runtime 0.418079, Loss 0.066049, forward nfe 15494, backward nfe 14584, Train: 0.9833, Val: 0.7736, Test: 0.7652, Best time: 25.0000
Epoch: 098/100, Runtime 0.419247, Loss 0.106208, forward nfe 15600, backward nfe 14597, Train: 0.9833, Val: 0.7736, Test: 0.7652, Best time: 25.0000
Epoch: 099/100, Runtime 0.408290, Loss 0.041577, forward nfe 15706, backward nfe 14609, Train: 0.9833, Val: 0.7736, Test: 0.7652, Best time: 25.0000
best val accuracy 0.773611 with test accuracy 0.765219 at epoch 85 and best time 25.000000