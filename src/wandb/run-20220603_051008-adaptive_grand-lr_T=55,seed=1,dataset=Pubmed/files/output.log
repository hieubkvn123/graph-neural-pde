/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 1206.799641, Loss 1.100498, forward nfe 116, backward nfe 141142, Train: 0.4000, Val: 0.2521, Test: 0.2639, Best time: 0.2420
Epoch: 002/100, Runtime 1834.345584, Loss 1.099839, forward nfe 756, backward nfe 365913, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 11.0199
Epoch: 003/100, Runtime 1895.403556, Loss 1.096486, forward nfe 1396, backward nfe 596315, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 004/100, Runtime 733.543374, Loss 1.089285, forward nfe 2036, backward nfe 683116, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 005/100, Runtime 1254.819091, Loss 1.078781, forward nfe 2688, backward nfe 831975, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 006/100, Runtime 1341.142594, Loss 1.058246, forward nfe 3340, backward nfe 992519, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 007/100, Runtime 1588.021901, Loss 1.036039, forward nfe 3992, backward nfe 1184319, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 008/100, Runtime 1469.251530, Loss 1.002351, forward nfe 4644, backward nfe 1359112, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 009/100, Runtime 1441.324002, Loss 0.974421, forward nfe 5302, backward nfe 1530943, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 010/100, Runtime 1251.018864, Loss 0.926502, forward nfe 5960, backward nfe 1677986, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 011/100, Runtime 1320.291158, Loss 0.888496, forward nfe 6618, backward nfe 1835808, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 012/100, Runtime 1628.493876, Loss 0.837030, forward nfe 7276, backward nfe 2029646, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 013/100, Runtime 3093.917681, Loss 0.782008, forward nfe 7934, backward nfe 2410339, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 014/100, Runtime 1895.375897, Loss 0.717981, forward nfe 8598, backward nfe 2638734, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 015/100, Runtime 1582.645771, Loss 0.667623, forward nfe 9262, backward nfe 2829372, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 016/100, Runtime 1959.117925, Loss 0.621328, forward nfe 9932, backward nfe 3067326, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 017/100, Runtime 1628.994120, Loss 0.585503, forward nfe 10596, backward nfe 3261271, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 018/100, Runtime 2051.319829, Loss 0.534986, forward nfe 11266, backward nfe 3511454, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 019/100, Runtime 1112.054790, Loss 0.511997, forward nfe 11936, backward nfe 3642830, Train: 0.7833, Val: 0.7632, Test: 0.7617, Best time: 55.0000
Epoch: 020/100, Runtime 1545.965509, Loss 0.493828, forward nfe 12606, backward nfe 3828779, Train: 0.7500, Val: 0.7764, Test: 0.7617, Best time: 225.6173
Epoch: 021/100, Runtime 1638.674268, Loss 0.483023, forward nfe 13282, backward nfe 4023062, Train: 0.7500, Val: 0.7764, Test: 0.7617, Best time: 55.0000
Epoch: 022/100, Runtime 1425.223372, Loss 0.495752, forward nfe 13958, backward nfe 4193648, Train: 0.7500, Val: 0.7764, Test: 0.7617, Best time: 55.0000
Epoch: 023/100, Runtime 1656.394131, Loss 0.458759, forward nfe 14634, backward nfe 4392425, Train: 0.7500, Val: 0.7764, Test: 0.7617, Best time: 55.0000
Epoch: 024/100, Runtime 1350.856371, Loss 0.446444, forward nfe 15310, backward nfe 4554658, Train: 0.7500, Val: 0.7764, Test: 0.7617, Best time: 55.0000
Epoch: 025/100, Runtime 1500.538268, Loss 0.461456, forward nfe 15986, backward nfe 4734174, Train: 0.7500, Val: 0.7764, Test: 0.7617, Best time: 55.0000
Epoch: 026/100, Runtime 1745.382031, Loss 0.443762, forward nfe 16668, backward nfe 4944199, Train: 0.7500, Val: 0.7764, Test: 0.7617, Best time: 55.0000
Epoch: 027/100, Runtime 1262.426770, Loss 0.465222, forward nfe 17344, backward nfe 5095983, Train: 0.7500, Val: 0.7764, Test: 0.7617, Best time: 55.0000
Epoch: 028/100, Runtime 1338.213005, Loss 0.416771, forward nfe 18026, backward nfe 5256359, Train: 0.7500, Val: 0.7764, Test: 0.7617, Best time: 55.0000
Epoch: 029/100, Runtime 1500.885478, Loss 0.464347, forward nfe 18708, backward nfe 5438284, Train: 0.7500, Val: 0.7764, Test: 0.7617, Best time: 55.0000
Epoch: 030/100, Runtime 1470.148583, Loss 0.435924, forward nfe 19390, backward nfe 5616739, Train: 0.7500, Val: 0.7764, Test: 0.7617, Best time: 55.0000
Epoch: 031/100, Runtime 1361.894089, Loss 0.435603, forward nfe 20078, backward nfe 5781756, Train: 0.7500, Val: 0.7764, Test: 0.7617, Best time: 55.0000
Epoch: 032/100, Runtime 1414.582372, Loss 0.446907, forward nfe 20766, backward nfe 5955143, Train: 0.7500, Val: 0.7764, Test: 0.7617, Best time: 55.0000
Epoch: 033/100, Runtime 1969.860150, Loss 0.408473, forward nfe 21454, backward nfe 6193652, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 112.1545
Epoch: 034/100, Runtime 984.783226, Loss 0.453249, forward nfe 22142, backward nfe 6311743, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 035/100, Runtime 1415.213736, Loss 0.427347, forward nfe 22830, backward nfe 6481204, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 036/100, Runtime 1497.585164, Loss 0.380522, forward nfe 23524, backward nfe 6662433, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 037/100, Runtime 1568.853184, Loss 0.426273, forward nfe 24218, backward nfe 6853673, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 038/100, Runtime 1129.945585, Loss 0.385532, forward nfe 24912, backward nfe 6989418, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 039/100, Runtime 2001.797392, Loss 0.438440, forward nfe 25606, backward nfe 7230012, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 040/100, Runtime 1294.701909, Loss 0.460873, forward nfe 26306, backward nfe 7384246, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 041/100, Runtime 1415.479676, Loss 0.428150, forward nfe 27018, backward nfe 7557864, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 042/100, Runtime 1127.262462, Loss 0.373111, forward nfe 27724, backward nfe 7695059, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 043/100, Runtime 864.852365, Loss 0.373371, forward nfe 28436, backward nfe 7799898, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 044/100, Runtime 989.467652, Loss 0.394526, forward nfe 29142, backward nfe 7918742, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 045/100, Runtime 1449.525435, Loss 0.384069, forward nfe 29848, backward nfe 8095903, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 046/100, Runtime 1608.234199, Loss 0.403327, forward nfe 30554, backward nfe 8291378, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 047/100, Runtime 1480.279485, Loss 0.429689, forward nfe 31260, backward nfe 8472220, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 048/100, Runtime 1660.591212, Loss 0.387220, forward nfe 31966, backward nfe 8674236, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 049/100, Runtime 2356.312795, Loss 0.374167, forward nfe 32672, backward nfe 8965578, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 050/100, Runtime 1272.049670, Loss 0.344092, forward nfe 33378, backward nfe 9120452, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 051/100, Runtime 1529.699151, Loss 0.335485, forward nfe 34084, backward nfe 9307923, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 052/100, Runtime 1986.445955, Loss 0.341214, forward nfe 34790, backward nfe 9552420, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 053/100, Runtime 1603.469242, Loss 0.411907, forward nfe 35496, backward nfe 9747591, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 054/100, Runtime 1938.525446, Loss 0.303251, forward nfe 36202, backward nfe 9985437, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 055/100, Runtime 1068.429959, Loss 0.415491, forward nfe 36908, backward nfe 10115447, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 056/100, Runtime 1810.391414, Loss 0.333337, forward nfe 37614, backward nfe 10336945, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 057/100, Runtime 2043.811689, Loss 0.402945, forward nfe 38320, backward nfe 10587693, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 058/100, Runtime 1796.357849, Loss 0.374951, forward nfe 39026, backward nfe 10807403, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 059/100, Runtime 1851.930550, Loss 0.391930, forward nfe 39738, backward nfe 11036416, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 060/100, Runtime 1941.178114, Loss 0.385089, forward nfe 40444, backward nfe 11276791, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 061/100, Runtime 1551.357490, Loss 0.322592, forward nfe 41150, backward nfe 11465159, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 062/100, Runtime 1113.645607, Loss 0.365829, forward nfe 41862, backward nfe 11599315, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 063/100, Runtime 1719.071179, Loss 0.367089, forward nfe 42568, backward nfe 11810581, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 064/100, Runtime 1460.361213, Loss 0.337333, forward nfe 43274, backward nfe 11990055, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 065/100, Runtime 1606.408887, Loss 0.292952, forward nfe 43980, backward nfe 12184803, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 066/100, Runtime 1127.259664, Loss 0.311896, forward nfe 44686, backward nfe 12320550, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 067/100, Runtime 1187.913063, Loss 0.321624, forward nfe 45392, backward nfe 12465096, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 068/100, Runtime 1668.306117, Loss 0.327031, forward nfe 46104, backward nfe 12671503, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 069/100, Runtime 1096.822151, Loss 0.413400, forward nfe 46810, backward nfe 12803420, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 070/100, Runtime 1418.945712, Loss 0.371241, forward nfe 47528, backward nfe 12977288, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 071/100, Runtime 1229.075870, Loss 0.410259, forward nfe 48234, backward nfe 13126660, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 072/100, Runtime 1039.517060, Loss 0.318097, forward nfe 48946, backward nfe 13250867, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 073/100, Runtime 1210.974103, Loss 0.329991, forward nfe 49658, backward nfe 13398463, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 074/100, Runtime 819.179812, Loss 0.396438, forward nfe 50370, backward nfe 13496916, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 075/100, Runtime 1073.706098, Loss 0.368940, forward nfe 51082, backward nfe 13624681, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 076/100, Runtime 1310.482514, Loss 0.300836, forward nfe 51794, backward nfe 13782084, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 077/100, Runtime 1319.877390, Loss 0.339336, forward nfe 52506, backward nfe 13941265, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 078/100, Runtime 1199.494411, Loss 0.353689, forward nfe 53218, backward nfe 14085268, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 079/100, Runtime 1587.745831, Loss 0.340517, forward nfe 53930, backward nfe 14278316, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 080/100, Runtime 1964.296813, Loss 0.303760, forward nfe 54642, backward nfe 14516606, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 081/100, Runtime 1194.562192, Loss 0.316505, forward nfe 55354, backward nfe 14659402, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 082/100, Runtime 1733.190845, Loss 0.293928, forward nfe 56060, backward nfe 14868896, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 083/100, Runtime 1274.172522, Loss 0.340673, forward nfe 56766, backward nfe 15022058, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 084/100, Runtime 1115.276651, Loss 0.312773, forward nfe 57472, backward nfe 15157744, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 085/100, Runtime 1139.988713, Loss 0.321007, forward nfe 58178, backward nfe 15294751, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 086/100, Runtime 972.715094, Loss 0.342024, forward nfe 58890, backward nfe 15413665, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 087/100, Runtime 1540.771755, Loss 0.321198, forward nfe 59602, backward nfe 15599936, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 088/100, Runtime 1208.699494, Loss 0.390037, forward nfe 60314, backward nfe 15745341, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 089/100, Runtime 1117.016381, Loss 0.321256, forward nfe 61026, backward nfe 15878608, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 090/100, Runtime 1032.025880, Loss 0.366108, forward nfe 61738, backward nfe 16002724, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 091/100, Runtime 1659.148146, Loss 0.350932, forward nfe 62444, backward nfe 16203337, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 092/100, Runtime 1839.285681, Loss 0.420805, forward nfe 63156, backward nfe 16426429, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 093/100, Runtime 1037.559257, Loss 0.340909, forward nfe 63874, backward nfe 16551122, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 094/100, Runtime 1280.754302, Loss 0.365484, forward nfe 64586, backward nfe 16705697, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 095/100, Runtime 1209.764145, Loss 0.350304, forward nfe 65298, backward nfe 16849269, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 096/100, Runtime 1135.063606, Loss 0.343764, forward nfe 66010, backward nfe 16984246, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 097/100, Runtime 1556.897069, Loss 0.366031, forward nfe 66722, backward nfe 17173785, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 098/100, Runtime 1030.606301, Loss 0.273636, forward nfe 67440, backward nfe 17298069, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
Epoch: 099/100, Runtime 998.065944, Loss 0.346249, forward nfe 68152, backward nfe 17416599, Train: 0.7333, Val: 0.7868, Test: 0.7751, Best time: 55.0000
best val accuracy 0.786806 with test accuracy 0.775100 at epoch 33 and best time 55.000000