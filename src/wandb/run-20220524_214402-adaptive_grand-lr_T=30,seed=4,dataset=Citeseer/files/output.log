/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.473052, Loss 1.792188, forward nfe 128, backward nfe 0, Train: 0.3583, Val: 0.3239, Test: 0.3097, Best time: 30.0000
Epoch: 002/100, Runtime 0.397283, Loss 1.775480, forward nfe 480, backward nfe 0, Train: 0.4750, Val: 0.5507, Test: 0.5226, Best time: 81.4449
Epoch: 003/100, Runtime 0.423856, Loss 1.736228, forward nfe 826, backward nfe 0, Train: 0.6333, Val: 0.6261, Test: 0.5855, Best time: 0.8675
Epoch: 004/100, Runtime 0.430659, Loss 1.681499, forward nfe 1190, backward nfe 0, Train: 0.6917, Val: 0.6957, Test: 0.6855, Best time: 4.2009
Epoch: 005/100, Runtime 0.445906, Loss 1.661731, forward nfe 1554, backward nfe 0, Train: 0.7000, Val: 0.7333, Test: 0.7355, Best time: 6.0377
Epoch: 006/100, Runtime 0.420657, Loss 1.620768, forward nfe 1912, backward nfe 0, Train: 0.7250, Val: 0.7464, Test: 0.7435, Best time: 5.1667
Epoch: 007/100, Runtime 0.406035, Loss 1.583531, forward nfe 2264, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 8.5762
Epoch: 008/100, Runtime 0.400966, Loss 1.605760, forward nfe 2610, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 009/100, Runtime 0.406852, Loss 1.539793, forward nfe 2950, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 010/100, Runtime 0.395099, Loss 1.536938, forward nfe 3296, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 011/100, Runtime 0.398226, Loss 1.495349, forward nfe 3624, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 012/100, Runtime 0.378550, Loss 1.452923, forward nfe 3952, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 013/100, Runtime 0.376213, Loss 1.429062, forward nfe 4280, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 014/100, Runtime 0.369107, Loss 1.491744, forward nfe 4602, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 015/100, Runtime 0.383859, Loss 1.404623, forward nfe 4918, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 016/100, Runtime 0.359658, Loss 1.351916, forward nfe 5228, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 017/100, Runtime 0.385076, Loss 1.385584, forward nfe 5532, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 018/100, Runtime 0.360559, Loss 1.288391, forward nfe 5848, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 019/100, Runtime 0.357980, Loss 1.264788, forward nfe 6152, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 020/100, Runtime 0.388450, Loss 1.178182, forward nfe 6456, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 021/100, Runtime 0.364803, Loss 1.263954, forward nfe 6754, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 022/100, Runtime 0.354254, Loss 1.184075, forward nfe 7052, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 023/100, Runtime 0.344860, Loss 1.244539, forward nfe 7338, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 024/100, Runtime 0.351113, Loss 1.107390, forward nfe 7624, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 025/100, Runtime 0.325910, Loss 1.100930, forward nfe 7904, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 026/100, Runtime 0.330992, Loss 1.090863, forward nfe 8178, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 027/100, Runtime 0.332425, Loss 1.101055, forward nfe 8452, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 028/100, Runtime 0.316411, Loss 1.183744, forward nfe 8726, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 029/100, Runtime 0.327564, Loss 1.081059, forward nfe 8994, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 030/100, Runtime 0.324324, Loss 1.196611, forward nfe 9262, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 031/100, Runtime 0.310653, Loss 1.035762, forward nfe 9524, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 032/100, Runtime 0.318460, Loss 1.069943, forward nfe 9774, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 033/100, Runtime 0.297009, Loss 0.982969, forward nfe 10024, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 034/100, Runtime 0.304287, Loss 1.044773, forward nfe 10274, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 035/100, Runtime 0.315877, Loss 1.122887, forward nfe 10524, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 036/100, Runtime 0.294685, Loss 1.151805, forward nfe 10768, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 037/100, Runtime 0.302844, Loss 0.914792, forward nfe 11006, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 038/100, Runtime 0.294018, Loss 0.987307, forward nfe 11244, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 039/100, Runtime 0.305242, Loss 1.014977, forward nfe 11482, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 040/100, Runtime 0.288230, Loss 0.925828, forward nfe 11720, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 041/100, Runtime 0.286085, Loss 1.075926, forward nfe 11958, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 042/100, Runtime 0.280640, Loss 1.089638, forward nfe 12184, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 043/100, Runtime 0.281924, Loss 1.048220, forward nfe 12410, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 044/100, Runtime 0.293991, Loss 1.107511, forward nfe 12636, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 045/100, Runtime 0.264620, Loss 1.047139, forward nfe 12862, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 046/100, Runtime 0.273346, Loss 0.988836, forward nfe 13082, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 047/100, Runtime 0.268539, Loss 1.060287, forward nfe 13302, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 048/100, Runtime 0.269704, Loss 1.014541, forward nfe 13522, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 049/100, Runtime 0.272131, Loss 1.081849, forward nfe 13742, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 050/100, Runtime 0.258304, Loss 1.004887, forward nfe 13956, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 051/100, Runtime 0.266169, Loss 0.985841, forward nfe 14170, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 052/100, Runtime 0.267499, Loss 0.934446, forward nfe 14390, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 053/100, Runtime 0.277768, Loss 0.981876, forward nfe 14610, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 054/100, Runtime 0.278748, Loss 1.049817, forward nfe 14830, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 055/100, Runtime 0.288916, Loss 1.056821, forward nfe 15050, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 056/100, Runtime 0.286341, Loss 1.068802, forward nfe 15270, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 057/100, Runtime 0.272718, Loss 1.051689, forward nfe 15490, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 058/100, Runtime 0.262266, Loss 1.015536, forward nfe 15704, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 059/100, Runtime 0.263926, Loss 1.057519, forward nfe 15918, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 060/100, Runtime 0.286753, Loss 0.990553, forward nfe 16132, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 061/100, Runtime 0.274087, Loss 1.017343, forward nfe 16346, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 062/100, Runtime 0.273288, Loss 1.016591, forward nfe 16560, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 063/100, Runtime 0.279998, Loss 1.004375, forward nfe 16774, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 064/100, Runtime 0.276203, Loss 0.981488, forward nfe 16988, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 065/100, Runtime 0.266432, Loss 1.013534, forward nfe 17202, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 066/100, Runtime 0.271650, Loss 1.021605, forward nfe 17416, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 067/100, Runtime 0.284000, Loss 0.969884, forward nfe 17636, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 068/100, Runtime 0.292278, Loss 0.971348, forward nfe 17862, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 069/100, Runtime 0.279422, Loss 1.011403, forward nfe 18088, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 070/100, Runtime 0.288858, Loss 1.098471, forward nfe 18314, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 071/100, Runtime 0.279851, Loss 1.047338, forward nfe 18540, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 072/100, Runtime 0.291827, Loss 1.045239, forward nfe 18766, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 073/100, Runtime 0.288704, Loss 0.928628, forward nfe 18992, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 074/100, Runtime 0.291488, Loss 0.918990, forward nfe 19218, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 075/100, Runtime 0.294600, Loss 1.071191, forward nfe 19444, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 076/100, Runtime 0.289410, Loss 0.991361, forward nfe 19670, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 077/100, Runtime 0.285090, Loss 0.953154, forward nfe 19896, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 078/100, Runtime 0.276482, Loss 1.027634, forward nfe 20122, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 079/100, Runtime 0.279060, Loss 1.036886, forward nfe 20348, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 080/100, Runtime 0.285130, Loss 1.051419, forward nfe 20574, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 081/100, Runtime 0.422487, Loss 1.199975, forward nfe 20800, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 082/100, Runtime 0.271744, Loss 1.078404, forward nfe 21026, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 083/100, Runtime 0.285150, Loss 0.928080, forward nfe 21252, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 084/100, Runtime 0.274161, Loss 1.006902, forward nfe 21478, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 085/100, Runtime 0.285026, Loss 1.073410, forward nfe 21704, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 086/100, Runtime 0.278389, Loss 0.943998, forward nfe 21930, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 087/100, Runtime 0.277107, Loss 1.024886, forward nfe 22156, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 088/100, Runtime 0.282440, Loss 1.018029, forward nfe 22382, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 089/100, Runtime 0.279448, Loss 1.057121, forward nfe 22608, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 090/100, Runtime 0.284571, Loss 0.914373, forward nfe 22834, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 091/100, Runtime 0.279698, Loss 1.129957, forward nfe 23060, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 092/100, Runtime 0.271245, Loss 1.034740, forward nfe 23280, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 093/100, Runtime 0.267941, Loss 1.085864, forward nfe 23500, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 094/100, Runtime 0.269918, Loss 1.089015, forward nfe 23720, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 095/100, Runtime 0.272667, Loss 1.039541, forward nfe 23940, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 096/100, Runtime 0.279211, Loss 1.124014, forward nfe 24160, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 097/100, Runtime 0.270824, Loss 0.973793, forward nfe 24380, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 098/100, Runtime 0.276687, Loss 0.973681, forward nfe 24600, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
Epoch: 099/100, Runtime 0.272080, Loss 0.978502, forward nfe 24820, backward nfe 0, Train: 0.7417, Val: 0.7551, Test: 0.7500, Best time: 30.0000
best val accuracy 0.755072 with test accuracy 0.750000 at epoch 7 and best time 30.000000