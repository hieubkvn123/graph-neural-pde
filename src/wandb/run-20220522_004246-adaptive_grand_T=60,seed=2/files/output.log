/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 3.620794, Loss 1.948085, forward nfe 116, backward nfe 0, Train: 0.4000, Val: 0.3912, Test: 0.4305, Best time: 1.0484
Epoch: 002/100, Runtime 3.615844, Loss 1.866062, forward nfe 564, backward nfe 0, Train: 0.6214, Val: 0.5816, Test: 0.6071, Best time: 3.8247
Epoch: 003/100, Runtime 3.491366, Loss 1.664812, forward nfe 1012, backward nfe 0, Train: 0.7429, Val: 0.7103, Test: 0.7269, Best time: 5.6573
Epoch: 004/100, Runtime 3.479363, Loss 1.425591, forward nfe 1448, backward nfe 0, Train: 0.7714, Val: 0.7382, Test: 0.7635, Best time: 10.6321
Epoch: 005/100, Runtime 3.435051, Loss 1.185735, forward nfe 1872, backward nfe 0, Train: 0.7714, Val: 0.7699, Test: 0.7797, Best time: 8.1442
Epoch: 006/100, Runtime 3.340988, Loss 0.998613, forward nfe 2290, backward nfe 0, Train: 0.8071, Val: 0.8029, Test: 0.8061, Best time: 8.3986
Epoch: 007/100, Runtime 3.024725, Loss 0.832481, forward nfe 2702, backward nfe 0, Train: 0.8143, Val: 0.8066, Test: 0.8071, Best time: 15.5829
Epoch: 008/100, Runtime 3.045724, Loss 0.706123, forward nfe 3096, backward nfe 0, Train: 0.8143, Val: 0.8066, Test: 0.8071, Best time: 60.0000
Epoch: 009/100, Runtime 2.876288, Loss 0.620131, forward nfe 3484, backward nfe 0, Train: 0.8143, Val: 0.8066, Test: 0.8071, Best time: 60.0000
Epoch: 010/100, Runtime 2.939464, Loss 0.590738, forward nfe 3854, backward nfe 0, Train: 0.8786, Val: 0.8316, Test: 0.8183, Best time: 13.5856
Epoch: 011/100, Runtime 2.934571, Loss 0.521336, forward nfe 4212, backward nfe 0, Train: 0.8786, Val: 0.8316, Test: 0.8183, Best time: 60.0000
Epoch: 012/100, Runtime 2.834656, Loss 0.506317, forward nfe 4570, backward nfe 0, Train: 0.8786, Val: 0.8316, Test: 0.8183, Best time: 60.0000
Epoch: 013/100, Runtime 2.721908, Loss 0.507300, forward nfe 4922, backward nfe 0, Train: 0.8786, Val: 0.8316, Test: 0.8183, Best time: 60.0000
Epoch: 014/100, Runtime 2.769663, Loss 0.522016, forward nfe 5268, backward nfe 0, Train: 0.8786, Val: 0.8316, Test: 0.8183, Best time: 60.0000
Epoch: 015/100, Runtime 2.632994, Loss 0.500508, forward nfe 5608, backward nfe 0, Train: 0.8786, Val: 0.8316, Test: 0.8183, Best time: 60.0000
Epoch: 016/100, Runtime 2.647719, Loss 0.422031, forward nfe 5924, backward nfe 0, Train: 0.8786, Val: 0.8316, Test: 0.8183, Best time: 60.0000
Epoch: 017/100, Runtime 2.564784, Loss 0.520155, forward nfe 6240, backward nfe 0, Train: 0.8786, Val: 0.8316, Test: 0.8183, Best time: 60.0000
Epoch: 018/100, Runtime 2.340992, Loss 0.414266, forward nfe 6550, backward nfe 0, Train: 0.8786, Val: 0.8316, Test: 0.8183, Best time: 60.0000
Epoch: 019/100, Runtime 2.454831, Loss 0.478473, forward nfe 6842, backward nfe 0, Train: 0.8786, Val: 0.8316, Test: 0.8183, Best time: 60.0000
Epoch: 020/100, Runtime 2.319046, Loss 0.451420, forward nfe 7140, backward nfe 0, Train: 0.8786, Val: 0.8316, Test: 0.8183, Best time: 60.0000
Epoch: 021/100, Runtime 2.362970, Loss 0.388363, forward nfe 7432, backward nfe 0, Train: 0.8786, Val: 0.8316, Test: 0.8183, Best time: 60.0000
Epoch: 022/100, Runtime 2.348600, Loss 0.387027, forward nfe 7724, backward nfe 0, Train: 0.8786, Val: 0.8316, Test: 0.8183, Best time: 60.0000
Epoch: 023/100, Runtime 2.329003, Loss 0.347039, forward nfe 8016, backward nfe 0, Train: 0.9143, Val: 0.8412, Test: 0.8416, Best time: 77.6827
Epoch: 024/100, Runtime 2.050584, Loss 0.388875, forward nfe 8296, backward nfe 0, Train: 0.9143, Val: 0.8412, Test: 0.8416, Best time: 60.0000
Epoch: 025/100, Runtime 2.065229, Loss 0.290895, forward nfe 8564, backward nfe 0, Train: 0.9143, Val: 0.8412, Test: 0.8416, Best time: 60.0000
Epoch: 026/100, Runtime 2.038610, Loss 0.351741, forward nfe 8826, backward nfe 0, Train: 0.9143, Val: 0.8412, Test: 0.8416, Best time: 60.0000
Epoch: 027/100, Runtime 2.071666, Loss 0.278175, forward nfe 9088, backward nfe 0, Train: 0.9143, Val: 0.8412, Test: 0.8416, Best time: 60.0000
Epoch: 028/100, Runtime 2.144976, Loss 0.297242, forward nfe 9350, backward nfe 0, Train: 0.9143, Val: 0.8412, Test: 0.8416, Best time: 60.0000
Epoch: 029/100, Runtime 2.112155, Loss 0.283753, forward nfe 9606, backward nfe 0, Train: 0.9143, Val: 0.8412, Test: 0.8416, Best time: 60.0000
Epoch: 030/100, Runtime 2.088831, Loss 0.317066, forward nfe 9862, backward nfe 0, Train: 0.9143, Val: 0.8412, Test: 0.8416, Best time: 60.0000
Epoch: 031/100, Runtime 2.011114, Loss 0.292178, forward nfe 10112, backward nfe 0, Train: 0.9143, Val: 0.8412, Test: 0.8416, Best time: 60.0000
Epoch: 032/100, Runtime 2.088330, Loss 0.302495, forward nfe 10356, backward nfe 0, Train: 0.9143, Val: 0.8412, Test: 0.8416, Best time: 60.0000
Epoch: 033/100, Runtime 1.910622, Loss 0.294639, forward nfe 10600, backward nfe 0, Train: 0.9143, Val: 0.8412, Test: 0.8416, Best time: 60.0000
Epoch: 034/100, Runtime 1.873430, Loss 0.311673, forward nfe 10832, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 71.9860
Epoch: 035/100, Runtime 1.931017, Loss 0.275538, forward nfe 11058, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 036/100, Runtime 1.881181, Loss 0.333079, forward nfe 11290, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 037/100, Runtime 1.882857, Loss 0.214204, forward nfe 11522, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 038/100, Runtime 2.004859, Loss 0.233606, forward nfe 11748, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 039/100, Runtime 2.311504, Loss 0.252742, forward nfe 11968, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 040/100, Runtime 2.292887, Loss 0.230498, forward nfe 12188, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 041/100, Runtime 2.110523, Loss 0.238054, forward nfe 12402, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 042/100, Runtime 2.147551, Loss 0.235742, forward nfe 12610, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 043/100, Runtime 2.279094, Loss 0.274832, forward nfe 12818, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 044/100, Runtime 2.153910, Loss 0.279084, forward nfe 13032, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 045/100, Runtime 2.195627, Loss 0.190479, forward nfe 13246, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 046/100, Runtime 2.410302, Loss 0.208365, forward nfe 13460, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 047/100, Runtime 2.137996, Loss 0.187739, forward nfe 13674, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 048/100, Runtime 2.114776, Loss 0.237581, forward nfe 13888, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 049/100, Runtime 1.930947, Loss 0.187298, forward nfe 14090, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 050/100, Runtime 2.076263, Loss 0.150667, forward nfe 14292, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 051/100, Runtime 2.050262, Loss 0.185016, forward nfe 14494, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 052/100, Runtime 2.018683, Loss 0.186547, forward nfe 14696, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 053/100, Runtime 0.702074, Loss 0.170957, forward nfe 14898, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 054/100, Runtime 0.722635, Loss 0.137916, forward nfe 15100, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 055/100, Runtime 0.709882, Loss 0.201970, forward nfe 15302, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 056/100, Runtime 0.703662, Loss 0.135592, forward nfe 15504, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 057/100, Runtime 0.689528, Loss 0.147761, forward nfe 15706, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 058/100, Runtime 0.674736, Loss 0.164139, forward nfe 15908, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 059/100, Runtime 0.732430, Loss 0.161220, forward nfe 16110, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 060/100, Runtime 0.762293, Loss 0.095719, forward nfe 16312, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 061/100, Runtime 0.759639, Loss 0.125596, forward nfe 16514, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 062/100, Runtime 0.755983, Loss 0.140506, forward nfe 16716, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 063/100, Runtime 0.773012, Loss 0.141542, forward nfe 16918, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 064/100, Runtime 0.739128, Loss 0.116766, forward nfe 17120, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 065/100, Runtime 0.725666, Loss 0.119838, forward nfe 17322, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 066/100, Runtime 0.763247, Loss 0.097664, forward nfe 17524, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 067/100, Runtime 0.710001, Loss 0.125465, forward nfe 17726, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 068/100, Runtime 0.759555, Loss 0.128489, forward nfe 17928, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 069/100, Runtime 0.760870, Loss 0.147112, forward nfe 18130, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 070/100, Runtime 0.767315, Loss 0.122116, forward nfe 18332, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 071/100, Runtime 0.766098, Loss 0.103288, forward nfe 18534, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 072/100, Runtime 0.762303, Loss 0.081257, forward nfe 18736, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 073/100, Runtime 0.759427, Loss 0.123104, forward nfe 18938, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 074/100, Runtime 0.764622, Loss 0.134797, forward nfe 19140, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 075/100, Runtime 0.835006, Loss 0.084811, forward nfe 19342, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 076/100, Runtime 0.782871, Loss 0.120818, forward nfe 19544, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 077/100, Runtime 0.774776, Loss 0.123983, forward nfe 19746, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 078/100, Runtime 0.780888, Loss 0.106585, forward nfe 19948, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 079/100, Runtime 0.784883, Loss 0.096053, forward nfe 20150, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 080/100, Runtime 0.900817, Loss 0.069256, forward nfe 20352, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 081/100, Runtime 0.833584, Loss 0.060292, forward nfe 20554, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 082/100, Runtime 0.793741, Loss 0.049265, forward nfe 20756, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 083/100, Runtime 1.366463, Loss 0.082917, forward nfe 20958, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 084/100, Runtime 1.656229, Loss 0.063323, forward nfe 21154, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 085/100, Runtime 1.704823, Loss 0.053677, forward nfe 21350, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 086/100, Runtime 1.611471, Loss 0.093389, forward nfe 21546, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 087/100, Runtime 1.682336, Loss 0.090722, forward nfe 21742, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 088/100, Runtime 1.617867, Loss 0.074219, forward nfe 21938, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 089/100, Runtime 1.704647, Loss 0.062734, forward nfe 22128, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 090/100, Runtime 1.697850, Loss 0.043857, forward nfe 22324, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 091/100, Runtime 1.590724, Loss 0.084531, forward nfe 22520, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 092/100, Runtime 1.710574, Loss 0.086527, forward nfe 22716, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 093/100, Runtime 1.690763, Loss 0.079826, forward nfe 22912, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 094/100, Runtime 1.676434, Loss 0.133109, forward nfe 23114, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 095/100, Runtime 1.741302, Loss 0.088355, forward nfe 23316, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 096/100, Runtime 1.703066, Loss 0.070505, forward nfe 23512, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 097/100, Runtime 1.586424, Loss 0.065828, forward nfe 23708, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 098/100, Runtime 1.440463, Loss 0.030291, forward nfe 23898, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
Epoch: 099/100, Runtime 1.338998, Loss 0.054191, forward nfe 24082, backward nfe 0, Train: 0.9500, Val: 0.8463, Test: 0.8365, Best time: 60.0000
best val accuracy 0.846324 with test accuracy 0.836548 at epoch 34 and best time 60.000000