/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 1.526964, Loss 1.947406, forward nfe 110, backward nfe 0, Train: 0.3286, Val: 0.3456, Test: 0.3543, Best time: 5.7071
Epoch: 002/100, Runtime 1.360636, Loss 1.975622, forward nfe 522, backward nfe 0, Train: 0.3286, Val: 0.3456, Test: 0.3543, Best time: 55.0000
Epoch: 003/100, Runtime 1.364213, Loss 1.944328, forward nfe 940, backward nfe 0, Train: 0.3286, Val: 0.3456, Test: 0.3543, Best time: 55.0000
Epoch: 004/100, Runtime 1.284210, Loss 1.927013, forward nfe 1346, backward nfe 0, Train: 0.3286, Val: 0.3456, Test: 0.3543, Best time: 55.0000
Epoch: 005/100, Runtime 3.766242, Loss 1.876290, forward nfe 1740, backward nfe 0, Train: 0.4714, Val: 0.4118, Test: 0.4447, Best time: 2.3160
Epoch: 006/100, Runtime 4.282632, Loss 1.780662, forward nfe 2128, backward nfe 0, Train: 0.6071, Val: 0.5750, Test: 0.5949, Best time: 40.6232
Epoch: 007/100, Runtime 4.136672, Loss 1.648761, forward nfe 2504, backward nfe 0, Train: 0.7357, Val: 0.6772, Test: 0.6883, Best time: 10.8423
Epoch: 008/100, Runtime 4.163641, Loss 1.475206, forward nfe 2874, backward nfe 0, Train: 0.7857, Val: 0.7265, Test: 0.7320, Best time: 38.0298
Epoch: 009/100, Runtime 3.980254, Loss 1.297844, forward nfe 3250, backward nfe 0, Train: 0.7857, Val: 0.7537, Test: 0.7533, Best time: 151.4744
Epoch: 010/100, Runtime 3.832411, Loss 1.110461, forward nfe 3608, backward nfe 0, Train: 0.8000, Val: 0.7824, Test: 0.7777, Best time: 166.9500
Epoch: 011/100, Runtime 3.817202, Loss 0.924893, forward nfe 3966, backward nfe 0, Train: 0.8714, Val: 0.8140, Test: 0.8102, Best time: 60.3220
Epoch: 012/100, Runtime 3.788687, Loss 0.771003, forward nfe 4318, backward nfe 0, Train: 0.8714, Val: 0.8140, Test: 0.8102, Best time: 55.0000
Epoch: 013/100, Runtime 3.601960, Loss 0.671436, forward nfe 4658, backward nfe 0, Train: 0.8714, Val: 0.8140, Test: 0.8102, Best time: 55.0000
Epoch: 014/100, Runtime 3.511677, Loss 0.555957, forward nfe 4992, backward nfe 0, Train: 0.8357, Val: 0.8154, Test: 0.7909, Best time: 55.0000
Epoch: 015/100, Runtime 3.289856, Loss 0.527292, forward nfe 5314, backward nfe 0, Train: 0.8357, Val: 0.8154, Test: 0.7909, Best time: 55.0000
Epoch: 016/100, Runtime 3.347553, Loss 0.552086, forward nfe 5612, backward nfe 0, Train: 0.8357, Val: 0.8324, Test: 0.8193, Best time: 55.0000
Epoch: 017/100, Runtime 3.237746, Loss 0.491455, forward nfe 5910, backward nfe 0, Train: 0.8357, Val: 0.8324, Test: 0.8193, Best time: 55.0000
Epoch: 018/100, Runtime 3.274910, Loss 0.509004, forward nfe 6202, backward nfe 0, Train: 0.8357, Val: 0.8324, Test: 0.8193, Best time: 55.0000
Epoch: 019/100, Runtime 3.119741, Loss 0.383418, forward nfe 6494, backward nfe 0, Train: 0.8929, Val: 0.8346, Test: 0.8091, Best time: 118.7880
Epoch: 020/100, Runtime 2.994741, Loss 0.473852, forward nfe 6774, backward nfe 0, Train: 0.8929, Val: 0.8346, Test: 0.8091, Best time: 55.0000
Epoch: 021/100, Runtime 2.891990, Loss 0.443798, forward nfe 7048, backward nfe 0, Train: 0.8929, Val: 0.8346, Test: 0.8091, Best time: 55.0000
Epoch: 022/100, Runtime 2.855483, Loss 0.393999, forward nfe 7298, backward nfe 0, Train: 0.8929, Val: 0.8346, Test: 0.8091, Best time: 55.0000
Epoch: 023/100, Runtime 2.939961, Loss 0.396527, forward nfe 7554, backward nfe 0, Train: 0.8929, Val: 0.8346, Test: 0.8091, Best time: 55.0000
Epoch: 024/100, Runtime 2.813438, Loss 0.361756, forward nfe 7816, backward nfe 0, Train: 0.8929, Val: 0.8346, Test: 0.8091, Best time: 55.0000
Epoch: 025/100, Runtime 2.908405, Loss 0.352660, forward nfe 8072, backward nfe 0, Train: 0.8929, Val: 0.8346, Test: 0.8091, Best time: 55.0000
Epoch: 026/100, Runtime 2.640023, Loss 0.348222, forward nfe 8328, backward nfe 0, Train: 0.8929, Val: 0.8346, Test: 0.8091, Best time: 55.0000
Epoch: 027/100, Runtime 2.660979, Loss 0.293442, forward nfe 8560, backward nfe 0, Train: 0.8929, Val: 0.8346, Test: 0.8091, Best time: 55.0000
Epoch: 028/100, Runtime 2.633526, Loss 0.326281, forward nfe 8792, backward nfe 0, Train: 0.8929, Val: 0.8346, Test: 0.8091, Best time: 55.0000
Epoch: 029/100, Runtime 2.596417, Loss 0.363072, forward nfe 9030, backward nfe 0, Train: 0.8929, Val: 0.8346, Test: 0.8091, Best time: 55.0000
Epoch: 030/100, Runtime 2.572856, Loss 0.273192, forward nfe 9262, backward nfe 0, Train: 0.8929, Val: 0.8346, Test: 0.8091, Best time: 55.0000
Epoch: 031/100, Runtime 2.625029, Loss 0.357424, forward nfe 9494, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 144.0247
Epoch: 032/100, Runtime 2.546961, Loss 0.320752, forward nfe 9720, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 033/100, Runtime 2.518742, Loss 0.330129, forward nfe 9946, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 034/100, Runtime 2.468046, Loss 0.274034, forward nfe 10172, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 035/100, Runtime 2.552675, Loss 0.241343, forward nfe 10392, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 036/100, Runtime 2.458171, Loss 0.222493, forward nfe 10612, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 037/100, Runtime 2.375610, Loss 0.254612, forward nfe 10832, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 038/100, Runtime 2.407239, Loss 0.246718, forward nfe 11046, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 039/100, Runtime 2.354250, Loss 0.271628, forward nfe 11260, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 040/100, Runtime 2.351360, Loss 0.169540, forward nfe 11468, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 041/100, Runtime 2.410220, Loss 0.200257, forward nfe 11676, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 042/100, Runtime 2.424249, Loss 0.254136, forward nfe 11890, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 043/100, Runtime 2.363081, Loss 0.176964, forward nfe 12104, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 044/100, Runtime 2.340027, Loss 0.183015, forward nfe 12306, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 045/100, Runtime 2.336520, Loss 0.190108, forward nfe 12508, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 046/100, Runtime 2.238380, Loss 0.279300, forward nfe 12710, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 047/100, Runtime 2.256073, Loss 0.131774, forward nfe 12906, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 048/100, Runtime 2.268096, Loss 0.243691, forward nfe 13102, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 049/100, Runtime 2.199937, Loss 0.224695, forward nfe 13298, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 050/100, Runtime 2.271637, Loss 0.139422, forward nfe 13494, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 051/100, Runtime 2.165109, Loss 0.183991, forward nfe 13690, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 052/100, Runtime 2.184202, Loss 0.150026, forward nfe 13880, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 053/100, Runtime 2.199425, Loss 0.229798, forward nfe 14070, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 054/100, Runtime 2.249435, Loss 0.231178, forward nfe 14266, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 055/100, Runtime 2.258629, Loss 0.143667, forward nfe 14462, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 056/100, Runtime 2.189215, Loss 0.152652, forward nfe 14658, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 057/100, Runtime 2.264960, Loss 0.149171, forward nfe 14854, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 058/100, Runtime 2.182539, Loss 0.119757, forward nfe 15050, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 059/100, Runtime 2.287789, Loss 0.119289, forward nfe 15246, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 060/100, Runtime 2.218784, Loss 0.107329, forward nfe 15442, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 061/100, Runtime 2.264758, Loss 0.120943, forward nfe 15638, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 062/100, Runtime 2.101993, Loss 0.184791, forward nfe 15834, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 063/100, Runtime 2.237927, Loss 0.122211, forward nfe 16024, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 064/100, Runtime 2.192492, Loss 0.090306, forward nfe 16214, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 065/100, Runtime 2.257520, Loss 0.102531, forward nfe 16404, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 066/100, Runtime 2.256216, Loss 0.075243, forward nfe 16594, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 067/100, Runtime 2.219827, Loss 0.127737, forward nfe 16784, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 068/100, Runtime 2.142070, Loss 0.183978, forward nfe 16974, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 069/100, Runtime 2.254991, Loss 0.103701, forward nfe 17164, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 070/100, Runtime 2.268401, Loss 0.056005, forward nfe 17360, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 071/100, Runtime 2.219513, Loss 0.080276, forward nfe 17556, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 072/100, Runtime 2.275258, Loss 0.084544, forward nfe 17752, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 073/100, Runtime 2.204120, Loss 0.099603, forward nfe 17948, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 074/100, Runtime 2.211216, Loss 0.085341, forward nfe 18144, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 075/100, Runtime 2.266053, Loss 0.080121, forward nfe 18340, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 076/100, Runtime 2.227382, Loss 0.071868, forward nfe 18536, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 077/100, Runtime 2.151589, Loss 0.127591, forward nfe 18732, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 078/100, Runtime 2.274297, Loss 0.109476, forward nfe 18928, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 079/100, Runtime 2.194350, Loss 0.069331, forward nfe 19124, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 080/100, Runtime 2.193643, Loss 0.050931, forward nfe 19320, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 081/100, Runtime 2.098549, Loss 0.057983, forward nfe 19516, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 082/100, Runtime 2.203593, Loss 0.078647, forward nfe 19706, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 083/100, Runtime 2.222326, Loss 0.084386, forward nfe 19896, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 084/100, Runtime 2.126685, Loss 0.050670, forward nfe 20086, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 085/100, Runtime 2.190301, Loss 0.056706, forward nfe 20276, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 086/100, Runtime 2.230163, Loss 0.084675, forward nfe 20466, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 087/100, Runtime 2.071371, Loss 0.049850, forward nfe 20656, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 088/100, Runtime 2.162951, Loss 0.063880, forward nfe 20834, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 089/100, Runtime 2.110931, Loss 0.073793, forward nfe 21018, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 090/100, Runtime 2.185683, Loss 0.080880, forward nfe 21202, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 091/100, Runtime 2.185239, Loss 0.059782, forward nfe 21386, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 092/100, Runtime 2.256318, Loss 0.051172, forward nfe 21570, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 093/100, Runtime 2.305270, Loss 0.079444, forward nfe 21760, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 094/100, Runtime 2.216194, Loss 0.051738, forward nfe 21950, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 095/100, Runtime 2.042972, Loss 0.085923, forward nfe 22134, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 096/100, Runtime 2.265079, Loss 0.068019, forward nfe 22318, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 097/100, Runtime 2.165890, Loss 0.067868, forward nfe 22502, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 098/100, Runtime 2.136562, Loss 0.147824, forward nfe 22686, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
Epoch: 099/100, Runtime 2.088784, Loss 0.094055, forward nfe 22870, backward nfe 0, Train: 0.9357, Val: 0.8353, Test: 0.8183, Best time: 55.0000
best val accuracy 0.835294 with test accuracy 0.818274 at epoch 31 and best time 55.000000