/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 6.985635, Loss 1.947005, forward nfe 116, backward nfe 0, Train: 0.2786, Val: 0.2360, Test: 0.2203, Best time: 1.0247
Epoch: 002/100, Runtime 6.885683, Loss 1.894616, forward nfe 570, backward nfe 0, Train: 0.4571, Val: 0.4044, Test: 0.4102, Best time: 0.0909
Epoch: 003/100, Runtime 6.521160, Loss 1.835931, forward nfe 1012, backward nfe 0, Train: 0.7571, Val: 0.6978, Test: 0.6964, Best time: 7.6340
Epoch: 004/100, Runtime 6.835441, Loss 1.684300, forward nfe 1448, backward nfe 0, Train: 0.8143, Val: 0.7206, Test: 0.7178, Best time: 3.9004
Epoch: 005/100, Runtime 6.313653, Loss 1.493879, forward nfe 1866, backward nfe 0, Train: 0.8143, Val: 0.7206, Test: 0.7178, Best time: 60.0000
Epoch: 006/100, Runtime 6.285528, Loss 1.272149, forward nfe 2284, backward nfe 0, Train: 0.8500, Val: 0.7574, Test: 0.7574, Best time: 19.1894
Epoch: 007/100, Runtime 6.058374, Loss 1.010033, forward nfe 2690, backward nfe 0, Train: 0.8714, Val: 0.7654, Test: 0.7726, Best time: 19.7925
Epoch: 008/100, Runtime 6.137184, Loss 0.828134, forward nfe 3078, backward nfe 0, Train: 0.8714, Val: 0.7654, Test: 0.7726, Best time: 60.0000
Epoch: 009/100, Runtime 5.901756, Loss 0.675836, forward nfe 3472, backward nfe 0, Train: 0.8786, Val: 0.7971, Test: 0.7959, Best time: 4.4606
Epoch: 010/100, Runtime 5.866544, Loss 0.557681, forward nfe 3860, backward nfe 0, Train: 0.9071, Val: 0.8162, Test: 0.8203, Best time: 6.8384
Epoch: 011/100, Runtime 5.714106, Loss 0.501915, forward nfe 4236, backward nfe 0, Train: 0.9143, Val: 0.8176, Test: 0.8234, Best time: 7.1452
Epoch: 012/100, Runtime 5.244087, Loss 0.452967, forward nfe 4600, backward nfe 0, Train: 0.9143, Val: 0.8176, Test: 0.8234, Best time: 60.0000
Epoch: 013/100, Runtime 5.366038, Loss 0.420423, forward nfe 4940, backward nfe 0, Train: 0.9143, Val: 0.8176, Test: 0.8234, Best time: 60.0000
Epoch: 014/100, Runtime 5.013634, Loss 0.417033, forward nfe 5274, backward nfe 0, Train: 0.9143, Val: 0.8176, Test: 0.8234, Best time: 60.0000
Epoch: 015/100, Runtime 5.138169, Loss 0.442318, forward nfe 5602, backward nfe 0, Train: 0.9000, Val: 0.8265, Test: 0.8335, Best time: 22.4970
Epoch: 016/100, Runtime 4.980971, Loss 0.361128, forward nfe 5930, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 32.1529
Epoch: 017/100, Runtime 5.018884, Loss 0.406957, forward nfe 6246, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 018/100, Runtime 4.675725, Loss 0.348286, forward nfe 6562, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 019/100, Runtime 4.434514, Loss 0.367640, forward nfe 6866, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 020/100, Runtime 4.383801, Loss 0.343345, forward nfe 7152, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 021/100, Runtime 4.369743, Loss 0.365387, forward nfe 7432, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 022/100, Runtime 4.429131, Loss 0.356726, forward nfe 7706, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 023/100, Runtime 4.261086, Loss 0.357045, forward nfe 7986, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 024/100, Runtime 4.239847, Loss 0.359196, forward nfe 8260, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 025/100, Runtime 4.410567, Loss 0.313042, forward nfe 8534, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 026/100, Runtime 4.035732, Loss 0.324083, forward nfe 8808, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 027/100, Runtime 4.179255, Loss 0.337361, forward nfe 9070, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 028/100, Runtime 4.126593, Loss 0.295850, forward nfe 9332, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 029/100, Runtime 3.674786, Loss 0.299358, forward nfe 9588, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 030/100, Runtime 4.180074, Loss 0.273154, forward nfe 9826, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 031/100, Runtime 3.816342, Loss 0.245071, forward nfe 10076, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 032/100, Runtime 3.856719, Loss 0.286621, forward nfe 10326, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 033/100, Runtime 3.666248, Loss 0.258177, forward nfe 10570, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 034/100, Runtime 3.920223, Loss 0.223459, forward nfe 10814, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 035/100, Runtime 3.860940, Loss 0.191763, forward nfe 11058, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 036/100, Runtime 3.749546, Loss 0.184308, forward nfe 11302, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 037/100, Runtime 3.645885, Loss 0.255610, forward nfe 11540, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 038/100, Runtime 3.768503, Loss 0.270429, forward nfe 11772, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 039/100, Runtime 3.490633, Loss 0.168950, forward nfe 12004, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 040/100, Runtime 3.579200, Loss 0.266490, forward nfe 12236, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 041/100, Runtime 3.423934, Loss 0.188264, forward nfe 12456, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 042/100, Runtime 3.482765, Loss 0.124634, forward nfe 12676, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 043/100, Runtime 3.544698, Loss 0.162597, forward nfe 12896, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 044/100, Runtime 3.297564, Loss 0.187061, forward nfe 13116, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 045/100, Runtime 3.478983, Loss 0.152511, forward nfe 13336, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 046/100, Runtime 3.464636, Loss 0.144429, forward nfe 13556, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 047/100, Runtime 3.415114, Loss 0.132800, forward nfe 13776, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 048/100, Runtime 3.561342, Loss 0.167882, forward nfe 13996, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 049/100, Runtime 3.205173, Loss 0.190810, forward nfe 14204, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 050/100, Runtime 2.931967, Loss 0.128225, forward nfe 14400, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 051/100, Runtime 3.208374, Loss 0.156278, forward nfe 14590, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 052/100, Runtime 3.159066, Loss 0.083275, forward nfe 14780, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 053/100, Runtime 3.052927, Loss 0.167371, forward nfe 14970, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 054/100, Runtime 2.996338, Loss 0.115667, forward nfe 15160, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 055/100, Runtime 2.881877, Loss 0.129037, forward nfe 15344, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 056/100, Runtime 3.092134, Loss 0.099378, forward nfe 15528, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 057/100, Runtime 2.983627, Loss 0.160475, forward nfe 15712, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 058/100, Runtime 2.988299, Loss 0.111067, forward nfe 15896, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 059/100, Runtime 2.913500, Loss 0.117775, forward nfe 16080, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 060/100, Runtime 2.979738, Loss 0.111449, forward nfe 16264, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 061/100, Runtime 2.910773, Loss 0.080110, forward nfe 16448, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 062/100, Runtime 2.894690, Loss 0.072813, forward nfe 16626, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 063/100, Runtime 3.021538, Loss 0.099404, forward nfe 16804, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 064/100, Runtime 2.898617, Loss 0.091072, forward nfe 16982, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 065/100, Runtime 2.869214, Loss 0.090234, forward nfe 17160, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 066/100, Runtime 2.957274, Loss 0.053644, forward nfe 17338, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 067/100, Runtime 2.884529, Loss 0.077900, forward nfe 17522, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 068/100, Runtime 2.957275, Loss 0.140701, forward nfe 17706, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 069/100, Runtime 2.908504, Loss 0.125620, forward nfe 17884, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 070/100, Runtime 3.017841, Loss 0.123084, forward nfe 18062, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 071/100, Runtime 2.790795, Loss 0.089331, forward nfe 18240, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 072/100, Runtime 2.788831, Loss 0.040516, forward nfe 18412, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 073/100, Runtime 2.780402, Loss 0.094401, forward nfe 18584, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 074/100, Runtime 2.790485, Loss 0.134706, forward nfe 18756, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 075/100, Runtime 2.784989, Loss 0.094415, forward nfe 18928, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 076/100, Runtime 2.732395, Loss 0.042504, forward nfe 19100, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 077/100, Runtime 2.840892, Loss 0.071658, forward nfe 19272, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 078/100, Runtime 2.775204, Loss 0.075462, forward nfe 19444, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 079/100, Runtime 2.820081, Loss 0.045052, forward nfe 19616, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 080/100, Runtime 2.824891, Loss 0.110415, forward nfe 19788, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 081/100, Runtime 2.804631, Loss 0.039971, forward nfe 19960, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 082/100, Runtime 2.786460, Loss 0.052663, forward nfe 20132, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 083/100, Runtime 2.853308, Loss 0.037683, forward nfe 20304, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 084/100, Runtime 2.804166, Loss 0.040199, forward nfe 20476, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 085/100, Runtime 3.053921, Loss 0.052511, forward nfe 20654, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 086/100, Runtime 2.969540, Loss 0.054847, forward nfe 20838, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 087/100, Runtime 3.082921, Loss 0.046085, forward nfe 21022, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 088/100, Runtime 3.016005, Loss 0.034345, forward nfe 21206, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 089/100, Runtime 2.940893, Loss 0.099965, forward nfe 21390, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 090/100, Runtime 2.957086, Loss 0.045302, forward nfe 21574, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 091/100, Runtime 2.981811, Loss 0.073098, forward nfe 21758, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 092/100, Runtime 3.048454, Loss 0.042077, forward nfe 21942, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 093/100, Runtime 3.032531, Loss 0.045618, forward nfe 22126, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 094/100, Runtime 3.011122, Loss 0.035848, forward nfe 22310, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 095/100, Runtime 3.029329, Loss 0.049071, forward nfe 22494, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 096/100, Runtime 2.886040, Loss 0.037693, forward nfe 22684, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 097/100, Runtime 3.056931, Loss 0.095118, forward nfe 22868, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 098/100, Runtime 3.119046, Loss 0.042913, forward nfe 23052, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
Epoch: 099/100, Runtime 3.163791, Loss 0.070532, forward nfe 23242, backward nfe 0, Train: 0.8929, Val: 0.8404, Test: 0.8406, Best time: 60.0000
best val accuracy 0.840441 with test accuracy 0.840609 at epoch 16 and best time 60.000000