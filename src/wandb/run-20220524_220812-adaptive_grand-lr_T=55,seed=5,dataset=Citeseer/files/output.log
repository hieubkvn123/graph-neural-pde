/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.651762, Loss 1.790678, forward nfe 164, backward nfe 0, Train: 0.3500, Val: 0.4616, Test: 0.4613, Best time: 86.7804
Epoch: 002/100, Runtime 0.578246, Loss 1.775753, forward nfe 678, backward nfe 0, Train: 0.5167, Val: 0.6022, Test: 0.5871, Best time: 33.1819
Epoch: 003/100, Runtime 0.626620, Loss 1.716608, forward nfe 1198, backward nfe 0, Train: 0.5917, Val: 0.6522, Test: 0.6177, Best time: 5.9389
Epoch: 004/100, Runtime 0.591749, Loss 1.676424, forward nfe 1718, backward nfe 0, Train: 0.6500, Val: 0.6826, Test: 0.6548, Best time: 14.7725
Epoch: 005/100, Runtime 0.594309, Loss 1.649141, forward nfe 2238, backward nfe 0, Train: 0.7083, Val: 0.7109, Test: 0.6919, Best time: 8.5397
Epoch: 006/100, Runtime 0.575155, Loss 1.580555, forward nfe 2746, backward nfe 0, Train: 0.7333, Val: 0.7348, Test: 0.7242, Best time: 12.2002
Epoch: 007/100, Runtime 0.566012, Loss 1.562994, forward nfe 3248, backward nfe 0, Train: 0.7417, Val: 0.7384, Test: 0.7323, Best time: 28.9403
Epoch: 008/100, Runtime 0.550904, Loss 1.545818, forward nfe 3738, backward nfe 0, Train: 0.7500, Val: 0.7500, Test: 0.7403, Best time: 35.9939
Epoch: 009/100, Runtime 0.544085, Loss 1.509916, forward nfe 4216, backward nfe 0, Train: 0.7500, Val: 0.7500, Test: 0.7403, Best time: 55.0000
Epoch: 010/100, Runtime 0.557672, Loss 1.524156, forward nfe 4694, backward nfe 0, Train: 0.7500, Val: 0.7500, Test: 0.7403, Best time: 55.0000
Epoch: 011/100, Runtime 0.541373, Loss 1.510307, forward nfe 5166, backward nfe 0, Train: 0.7500, Val: 0.7500, Test: 0.7403, Best time: 55.0000
Epoch: 012/100, Runtime 0.524386, Loss 1.464887, forward nfe 5632, backward nfe 0, Train: 0.7500, Val: 0.7500, Test: 0.7403, Best time: 55.0000
Epoch: 013/100, Runtime 0.543369, Loss 1.413372, forward nfe 6086, backward nfe 0, Train: 0.7250, Val: 0.7551, Test: 0.7403, Best time: 21.6889
Epoch: 014/100, Runtime 0.521006, Loss 1.419628, forward nfe 6546, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 26.2237
Epoch: 015/100, Runtime 0.519893, Loss 1.375196, forward nfe 6994, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 016/100, Runtime 0.503735, Loss 1.381163, forward nfe 7448, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 017/100, Runtime 0.497004, Loss 1.327546, forward nfe 7884, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 018/100, Runtime 0.490419, Loss 1.271270, forward nfe 8314, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 019/100, Runtime 0.466198, Loss 1.280543, forward nfe 8732, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 020/100, Runtime 0.474144, Loss 1.241582, forward nfe 9144, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 021/100, Runtime 0.487948, Loss 1.237135, forward nfe 9550, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 022/100, Runtime 0.487812, Loss 1.209336, forward nfe 9968, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 023/100, Runtime 0.451607, Loss 1.268059, forward nfe 10368, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 024/100, Runtime 0.470048, Loss 1.290708, forward nfe 10762, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 025/100, Runtime 0.461331, Loss 1.195787, forward nfe 11150, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 026/100, Runtime 0.439858, Loss 1.226976, forward nfe 11532, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 027/100, Runtime 0.444052, Loss 1.212517, forward nfe 11908, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 028/100, Runtime 0.428918, Loss 1.229456, forward nfe 12284, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 029/100, Runtime 0.430351, Loss 1.264900, forward nfe 12648, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 030/100, Runtime 0.409620, Loss 1.142506, forward nfe 13012, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 031/100, Runtime 0.425633, Loss 1.127489, forward nfe 13370, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 032/100, Runtime 0.403929, Loss 1.467824, forward nfe 13728, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 033/100, Runtime 0.410769, Loss 1.118471, forward nfe 14074, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 034/100, Runtime 0.403841, Loss 1.180292, forward nfe 14420, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 035/100, Runtime 0.405426, Loss 1.287038, forward nfe 14766, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 036/100, Runtime 0.424636, Loss 1.268721, forward nfe 15112, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 037/100, Runtime 0.400689, Loss 1.118568, forward nfe 15452, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 038/100, Runtime 0.395172, Loss 1.169294, forward nfe 15786, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 039/100, Runtime 0.398672, Loss 1.153643, forward nfe 16120, backward nfe 0, Train: 0.7333, Val: 0.7565, Test: 0.7323, Best time: 55.0000
Epoch: 040/100, Runtime 0.425209, Loss 1.146559, forward nfe 16448, backward nfe 0, Train: 0.7833, Val: 0.7623, Test: 0.7194, Best time: 43.4825
Epoch: 041/100, Runtime 0.437494, Loss 1.201845, forward nfe 16776, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 31.9704
Epoch: 042/100, Runtime 0.375373, Loss 1.110556, forward nfe 17092, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 043/100, Runtime 0.364311, Loss 1.108682, forward nfe 17408, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 044/100, Runtime 0.391043, Loss 1.175455, forward nfe 17724, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 045/100, Runtime 0.384617, Loss 1.103971, forward nfe 18034, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 046/100, Runtime 0.383460, Loss 1.073432, forward nfe 18344, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 047/100, Runtime 0.359522, Loss 1.188841, forward nfe 18648, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 048/100, Runtime 0.350980, Loss 1.083899, forward nfe 18946, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 049/100, Runtime 0.344887, Loss 1.192639, forward nfe 19244, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 050/100, Runtime 0.339067, Loss 1.137567, forward nfe 19536, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 051/100, Runtime 0.337012, Loss 1.104503, forward nfe 19828, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 052/100, Runtime 0.344797, Loss 1.211740, forward nfe 20120, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 053/100, Runtime 0.356603, Loss 1.201364, forward nfe 20406, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 054/100, Runtime 0.341251, Loss 1.399203, forward nfe 20698, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 055/100, Runtime 0.338118, Loss 1.145660, forward nfe 20984, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 056/100, Runtime 0.342382, Loss 1.157067, forward nfe 21264, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 057/100, Runtime 0.345345, Loss 1.089924, forward nfe 21544, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 058/100, Runtime 0.343538, Loss 1.185233, forward nfe 21824, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 059/100, Runtime 0.466027, Loss 1.198529, forward nfe 22104, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 060/100, Runtime 0.334534, Loss 1.145138, forward nfe 22390, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 061/100, Runtime 0.344769, Loss 1.110494, forward nfe 22670, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 062/100, Runtime 0.343055, Loss 1.165152, forward nfe 22950, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 063/100, Runtime 0.342989, Loss 1.305378, forward nfe 23230, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 064/100, Runtime 0.349988, Loss 1.424601, forward nfe 23510, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 065/100, Runtime 0.331172, Loss 1.306620, forward nfe 23790, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 066/100, Runtime 0.332664, Loss 1.256103, forward nfe 24070, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 067/100, Runtime 0.357215, Loss 1.171789, forward nfe 24356, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 068/100, Runtime 0.363085, Loss 1.109929, forward nfe 24642, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 069/100, Runtime 0.360202, Loss 1.151787, forward nfe 24928, backward nfe 0, Train: 0.8417, Val: 0.7674, Test: 0.7306, Best time: 55.0000
Epoch: 070/100, Runtime 0.348480, Loss 1.222944, forward nfe 25214, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 27.2906
Epoch: 071/100, Runtime 0.353668, Loss 1.143122, forward nfe 25500, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 072/100, Runtime 0.344123, Loss 1.303243, forward nfe 25786, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 073/100, Runtime 0.347803, Loss 1.228429, forward nfe 26072, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 074/100, Runtime 0.352137, Loss 1.088940, forward nfe 26358, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 075/100, Runtime 0.362356, Loss 1.181394, forward nfe 26644, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 076/100, Runtime 0.351161, Loss 1.216341, forward nfe 26930, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 077/100, Runtime 0.350669, Loss 1.106841, forward nfe 27216, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 078/100, Runtime 0.345702, Loss 1.132914, forward nfe 27502, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 079/100, Runtime 0.346654, Loss 1.198678, forward nfe 27782, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 080/100, Runtime 0.338760, Loss 1.065218, forward nfe 28062, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 081/100, Runtime 0.354324, Loss 1.090263, forward nfe 28342, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 082/100, Runtime 0.349764, Loss 1.054614, forward nfe 28622, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 083/100, Runtime 0.339392, Loss 1.171988, forward nfe 28902, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 084/100, Runtime 0.349343, Loss 1.032786, forward nfe 29182, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 085/100, Runtime 0.336901, Loss 1.015434, forward nfe 29462, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 086/100, Runtime 0.342552, Loss 1.119793, forward nfe 29736, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 087/100, Runtime 0.367553, Loss 1.152755, forward nfe 30010, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 088/100, Runtime 0.328088, Loss 1.127861, forward nfe 30278, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 089/100, Runtime 0.334567, Loss 1.120983, forward nfe 30546, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 090/100, Runtime 0.335563, Loss 1.071184, forward nfe 30814, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 091/100, Runtime 0.335345, Loss 1.203277, forward nfe 31088, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 092/100, Runtime 0.351060, Loss 1.092618, forward nfe 31362, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 093/100, Runtime 0.339764, Loss 1.303623, forward nfe 31636, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 094/100, Runtime 0.332641, Loss 1.028585, forward nfe 31910, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 095/100, Runtime 0.326043, Loss 1.040491, forward nfe 32184, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 096/100, Runtime 0.332435, Loss 1.146010, forward nfe 32458, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 097/100, Runtime 0.341161, Loss 1.075962, forward nfe 32726, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 098/100, Runtime 0.342943, Loss 1.100590, forward nfe 32994, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
Epoch: 099/100, Runtime 0.333122, Loss 1.003225, forward nfe 33262, backward nfe 0, Train: 0.8250, Val: 0.7696, Test: 0.7452, Best time: 55.0000
best val accuracy 0.769565 with test accuracy 0.745161 at epoch 70 and best time 55.000000