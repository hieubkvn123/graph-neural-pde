/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.540767, Loss 1.791153, forward nfe 140, backward nfe 0, Train: 0.4000, Val: 0.3370, Test: 0.3226, Best time: 87.7268
Epoch: 002/100, Runtime 0.455946, Loss 1.755792, forward nfe 522, backward nfe 0, Train: 0.5750, Val: 0.4486, Test: 0.4210, Best time: 17.3229
Epoch: 003/100, Runtime 0.455015, Loss 1.732315, forward nfe 916, backward nfe 0, Train: 0.6333, Val: 0.6333, Test: 0.6016, Best time: 108.1373
Epoch: 004/100, Runtime 0.460769, Loss 1.677427, forward nfe 1304, backward nfe 0, Train: 0.7250, Val: 0.7174, Test: 0.6758, Best time: 53.0843
Epoch: 005/100, Runtime 0.440758, Loss 1.623596, forward nfe 1698, backward nfe 0, Train: 0.7417, Val: 0.7290, Test: 0.6871, Best time: 28.3420
Epoch: 006/100, Runtime 0.447879, Loss 1.595333, forward nfe 2080, backward nfe 0, Train: 0.7417, Val: 0.7290, Test: 0.6871, Best time: 35.0000
Epoch: 007/100, Runtime 0.438517, Loss 1.566737, forward nfe 2456, backward nfe 0, Train: 0.7000, Val: 0.7428, Test: 0.7065, Best time: 31.3380
Epoch: 008/100, Runtime 0.452666, Loss 1.555836, forward nfe 2826, backward nfe 0, Train: 0.7000, Val: 0.7428, Test: 0.7065, Best time: 35.0000
Epoch: 009/100, Runtime 0.446391, Loss 1.478798, forward nfe 3196, backward nfe 0, Train: 0.8000, Val: 0.7486, Test: 0.7242, Best time: 5.8006
Epoch: 010/100, Runtime 0.421539, Loss 1.469414, forward nfe 3560, backward nfe 0, Train: 0.7667, Val: 0.7507, Test: 0.7290, Best time: 13.1472
Epoch: 011/100, Runtime 0.420496, Loss 1.505573, forward nfe 3912, backward nfe 0, Train: 0.8000, Val: 0.7594, Test: 0.7242, Best time: 9.9214
Epoch: 012/100, Runtime 0.417286, Loss 1.486833, forward nfe 4264, backward nfe 0, Train: 0.7667, Val: 0.7630, Test: 0.7339, Best time: 16.4598
Epoch: 013/100, Runtime 0.418625, Loss 1.402517, forward nfe 4616, backward nfe 0, Train: 0.7667, Val: 0.7630, Test: 0.7339, Best time: 35.0000
Epoch: 014/100, Runtime 0.390743, Loss 1.426055, forward nfe 4962, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 42.0693
Epoch: 015/100, Runtime 0.393522, Loss 1.344470, forward nfe 5296, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 016/100, Runtime 0.400716, Loss 1.299881, forward nfe 5630, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 017/100, Runtime 0.403954, Loss 1.260304, forward nfe 5964, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 018/100, Runtime 0.397555, Loss 1.228644, forward nfe 6298, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 019/100, Runtime 0.388157, Loss 1.219746, forward nfe 6620, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 020/100, Runtime 0.385354, Loss 1.209834, forward nfe 6942, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 021/100, Runtime 0.389177, Loss 1.158744, forward nfe 7258, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 022/100, Runtime 0.366444, Loss 1.177708, forward nfe 7574, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 023/100, Runtime 0.377558, Loss 1.174524, forward nfe 7878, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 024/100, Runtime 0.372600, Loss 1.178172, forward nfe 8176, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 025/100, Runtime 0.360000, Loss 1.105922, forward nfe 8474, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 026/100, Runtime 0.352270, Loss 1.076082, forward nfe 8766, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 027/100, Runtime 0.343310, Loss 1.109054, forward nfe 9058, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 028/100, Runtime 0.348382, Loss 1.051458, forward nfe 9344, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 029/100, Runtime 0.345414, Loss 1.140527, forward nfe 9624, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 030/100, Runtime 0.346061, Loss 1.129135, forward nfe 9904, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 031/100, Runtime 0.344737, Loss 1.163320, forward nfe 10178, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 032/100, Runtime 0.338256, Loss 1.056083, forward nfe 10452, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 033/100, Runtime 0.325304, Loss 1.037705, forward nfe 10726, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 034/100, Runtime 0.320665, Loss 1.003944, forward nfe 10988, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 035/100, Runtime 0.325285, Loss 1.069143, forward nfe 11244, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 036/100, Runtime 0.311090, Loss 0.997673, forward nfe 11500, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 037/100, Runtime 0.311559, Loss 0.945381, forward nfe 11756, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 038/100, Runtime 0.311363, Loss 1.007306, forward nfe 12006, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 039/100, Runtime 0.299164, Loss 1.028172, forward nfe 12250, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 040/100, Runtime 0.301908, Loss 1.055707, forward nfe 12494, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 041/100, Runtime 0.293821, Loss 0.999851, forward nfe 12732, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 042/100, Runtime 0.312632, Loss 0.971551, forward nfe 12970, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 043/100, Runtime 0.303419, Loss 0.994200, forward nfe 13208, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 044/100, Runtime 0.284986, Loss 1.028519, forward nfe 13440, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 045/100, Runtime 0.286099, Loss 0.939921, forward nfe 13666, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 046/100, Runtime 0.277462, Loss 0.980161, forward nfe 13892, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 047/100, Runtime 0.276593, Loss 0.952487, forward nfe 14118, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 048/100, Runtime 0.275890, Loss 0.922322, forward nfe 14344, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 049/100, Runtime 0.288589, Loss 1.107183, forward nfe 14570, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 050/100, Runtime 0.280911, Loss 1.076517, forward nfe 14796, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 051/100, Runtime 0.281288, Loss 0.933905, forward nfe 15022, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 052/100, Runtime 0.280517, Loss 0.968656, forward nfe 15248, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 053/100, Runtime 0.280053, Loss 1.015123, forward nfe 15474, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 054/100, Runtime 0.285183, Loss 0.932598, forward nfe 15706, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 055/100, Runtime 0.289301, Loss 0.895212, forward nfe 15938, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 056/100, Runtime 0.300069, Loss 0.914109, forward nfe 16170, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 057/100, Runtime 0.291348, Loss 1.035948, forward nfe 16396, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 058/100, Runtime 0.291918, Loss 0.980172, forward nfe 16628, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 059/100, Runtime 0.286222, Loss 1.083132, forward nfe 16854, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 060/100, Runtime 0.281833, Loss 0.916221, forward nfe 17080, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 061/100, Runtime 0.293997, Loss 0.940370, forward nfe 17306, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 062/100, Runtime 0.280907, Loss 0.986735, forward nfe 17532, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 063/100, Runtime 0.298632, Loss 0.970758, forward nfe 17758, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 064/100, Runtime 0.286479, Loss 0.885301, forward nfe 17984, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 065/100, Runtime 0.291305, Loss 0.868491, forward nfe 18210, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 066/100, Runtime 0.278067, Loss 0.919649, forward nfe 18436, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 067/100, Runtime 0.277441, Loss 0.903616, forward nfe 18662, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 068/100, Runtime 0.282511, Loss 0.942796, forward nfe 18888, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 069/100, Runtime 0.287099, Loss 0.894849, forward nfe 19114, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 070/100, Runtime 0.291330, Loss 1.046765, forward nfe 19346, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 071/100, Runtime 0.286911, Loss 0.884740, forward nfe 19572, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 072/100, Runtime 0.297591, Loss 1.048516, forward nfe 19804, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 073/100, Runtime 0.285192, Loss 0.893405, forward nfe 20036, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 074/100, Runtime 0.281946, Loss 0.964406, forward nfe 20268, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 075/100, Runtime 0.296708, Loss 0.940611, forward nfe 20500, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 076/100, Runtime 0.283920, Loss 0.909525, forward nfe 20732, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 077/100, Runtime 0.293071, Loss 1.009313, forward nfe 20964, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 078/100, Runtime 0.290538, Loss 1.016327, forward nfe 21196, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 079/100, Runtime 0.283297, Loss 1.013520, forward nfe 21428, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 080/100, Runtime 0.286900, Loss 0.890119, forward nfe 21660, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 081/100, Runtime 0.279967, Loss 0.990878, forward nfe 21892, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 082/100, Runtime 0.284378, Loss 0.935077, forward nfe 22124, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 083/100, Runtime 0.293814, Loss 1.022195, forward nfe 22356, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 084/100, Runtime 0.427616, Loss 0.853437, forward nfe 22588, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 085/100, Runtime 0.303362, Loss 0.879675, forward nfe 22826, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 086/100, Runtime 0.290462, Loss 0.855846, forward nfe 23058, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 087/100, Runtime 0.292155, Loss 0.836976, forward nfe 23290, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 088/100, Runtime 0.287580, Loss 1.002319, forward nfe 23522, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 089/100, Runtime 0.302868, Loss 1.024250, forward nfe 23754, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 090/100, Runtime 0.300632, Loss 1.055186, forward nfe 23986, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 091/100, Runtime 0.292008, Loss 1.025408, forward nfe 24218, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 092/100, Runtime 0.299207, Loss 0.906499, forward nfe 24450, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 093/100, Runtime 0.293994, Loss 0.954048, forward nfe 24682, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 094/100, Runtime 0.289503, Loss 1.039467, forward nfe 24914, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 095/100, Runtime 0.295402, Loss 0.996282, forward nfe 25146, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 096/100, Runtime 0.292274, Loss 0.925324, forward nfe 25378, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 097/100, Runtime 0.300426, Loss 0.927745, forward nfe 25610, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 098/100, Runtime 0.286355, Loss 0.915011, forward nfe 25842, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
Epoch: 099/100, Runtime 0.295996, Loss 0.833215, forward nfe 26074, backward nfe 0, Train: 0.7583, Val: 0.7652, Test: 0.7161, Best time: 35.0000
best val accuracy 0.765217 with test accuracy 0.716129 at epoch 14 and best time 35.000000