/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.441886, Loss 1.795942, forward nfe 122, backward nfe 0, Train: 0.4000, Val: 0.1812, Test: 0.1903, Best time: 0.9239
Epoch: 002/100, Runtime 0.406504, Loss 1.776594, forward nfe 432, backward nfe 0, Train: 0.4583, Val: 0.2254, Test: 0.2500, Best time: 0.0395
Epoch: 003/100, Runtime 0.391207, Loss 1.752884, forward nfe 760, backward nfe 0, Train: 0.6500, Val: 0.4203, Test: 0.4419, Best time: 0.3197
Epoch: 004/100, Runtime 0.399653, Loss 1.715303, forward nfe 1088, backward nfe 0, Train: 0.7750, Val: 0.5210, Test: 0.5565, Best time: 3.4165
Epoch: 005/100, Runtime 0.414566, Loss 1.685496, forward nfe 1410, backward nfe 0, Train: 0.8000, Val: 0.5812, Test: 0.6177, Best time: 3.4286
Epoch: 006/100, Runtime 0.396982, Loss 1.655689, forward nfe 1732, backward nfe 0, Train: 0.7500, Val: 0.6000, Test: 0.6387, Best time: 6.0815
Epoch: 007/100, Runtime 0.382937, Loss 1.624177, forward nfe 2054, backward nfe 0, Train: 0.7583, Val: 0.6558, Test: 0.6823, Best time: 7.2955
Epoch: 008/100, Runtime 0.382324, Loss 1.572145, forward nfe 2376, backward nfe 0, Train: 0.7917, Val: 0.6797, Test: 0.6887, Best time: 3.6240
Epoch: 009/100, Runtime 0.376306, Loss 1.579905, forward nfe 2692, backward nfe 0, Train: 0.7583, Val: 0.6913, Test: 0.6952, Best time: 8.9874
Epoch: 010/100, Runtime 0.385602, Loss 1.580526, forward nfe 3002, backward nfe 0, Train: 0.7750, Val: 0.6935, Test: 0.6887, Best time: 9.3079
Epoch: 011/100, Runtime 0.380323, Loss 1.557748, forward nfe 3318, backward nfe 0, Train: 0.7750, Val: 0.6935, Test: 0.6887, Best time: 25.0000
Epoch: 012/100, Runtime 0.364405, Loss 1.522730, forward nfe 3622, backward nfe 0, Train: 0.7750, Val: 0.6935, Test: 0.6887, Best time: 25.0000
Epoch: 013/100, Runtime 0.357920, Loss 1.464499, forward nfe 3920, backward nfe 0, Train: 0.7750, Val: 0.6935, Test: 0.6887, Best time: 25.0000
Epoch: 014/100, Runtime 0.368218, Loss 1.442634, forward nfe 4212, backward nfe 0, Train: 0.7833, Val: 0.6986, Test: 0.6806, Best time: 6.3018
Epoch: 015/100, Runtime 0.381368, Loss 1.399477, forward nfe 4510, backward nfe 0, Train: 0.8167, Val: 0.7261, Test: 0.7065, Best time: 6.3876
Epoch: 016/100, Runtime 0.346942, Loss 1.363482, forward nfe 4802, backward nfe 0, Train: 0.8250, Val: 0.7406, Test: 0.7097, Best time: 6.4602
Epoch: 017/100, Runtime 0.346156, Loss 1.329396, forward nfe 5094, backward nfe 0, Train: 0.8250, Val: 0.7406, Test: 0.7097, Best time: 25.0000
Epoch: 018/100, Runtime 0.337007, Loss 1.258322, forward nfe 5380, backward nfe 0, Train: 0.8250, Val: 0.7406, Test: 0.7097, Best time: 25.0000
Epoch: 019/100, Runtime 0.337803, Loss 1.230968, forward nfe 5660, backward nfe 0, Train: 0.8250, Val: 0.7406, Test: 0.7097, Best time: 25.0000
Epoch: 020/100, Runtime 0.332238, Loss 1.217529, forward nfe 5940, backward nfe 0, Train: 0.8750, Val: 0.7420, Test: 0.7048, Best time: 4.6250
Epoch: 021/100, Runtime 0.369340, Loss 1.148984, forward nfe 6220, backward nfe 0, Train: 0.8750, Val: 0.7420, Test: 0.7048, Best time: 25.0000
Epoch: 022/100, Runtime 0.334812, Loss 1.115835, forward nfe 6506, backward nfe 0, Train: 0.8750, Val: 0.7420, Test: 0.7048, Best time: 25.0000
Epoch: 023/100, Runtime 0.315096, Loss 1.091217, forward nfe 6774, backward nfe 0, Train: 0.8750, Val: 0.7420, Test: 0.7048, Best time: 25.0000
Epoch: 024/100, Runtime 0.336849, Loss 1.093521, forward nfe 7042, backward nfe 0, Train: 0.8750, Val: 0.7420, Test: 0.7048, Best time: 25.0000
Epoch: 025/100, Runtime 0.322061, Loss 0.998555, forward nfe 7310, backward nfe 0, Train: 0.8750, Val: 0.7420, Test: 0.7048, Best time: 25.0000
Epoch: 026/100, Runtime 0.324368, Loss 1.028483, forward nfe 7572, backward nfe 0, Train: 0.8750, Val: 0.7420, Test: 0.7048, Best time: 25.0000
Epoch: 027/100, Runtime 0.317692, Loss 1.100484, forward nfe 7834, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 6.7165
Epoch: 028/100, Runtime 0.290195, Loss 0.960340, forward nfe 8084, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 029/100, Runtime 0.292772, Loss 1.020170, forward nfe 8328, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 030/100, Runtime 0.292549, Loss 0.906646, forward nfe 8572, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 031/100, Runtime 0.298862, Loss 1.017146, forward nfe 8816, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 032/100, Runtime 0.289229, Loss 1.013526, forward nfe 9060, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 033/100, Runtime 0.281855, Loss 1.004344, forward nfe 9292, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 034/100, Runtime 0.292953, Loss 0.981794, forward nfe 9524, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 035/100, Runtime 0.282152, Loss 0.990816, forward nfe 9756, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 036/100, Runtime 0.279486, Loss 0.975861, forward nfe 9988, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 037/100, Runtime 0.276522, Loss 1.026560, forward nfe 10214, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 038/100, Runtime 0.272333, Loss 0.969318, forward nfe 10434, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 039/100, Runtime 0.274779, Loss 1.034034, forward nfe 10654, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 040/100, Runtime 0.268429, Loss 0.914842, forward nfe 10874, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 041/100, Runtime 0.282292, Loss 0.886970, forward nfe 11094, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 042/100, Runtime 0.262262, Loss 0.963265, forward nfe 11314, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 043/100, Runtime 0.259401, Loss 0.940074, forward nfe 11522, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 044/100, Runtime 0.258809, Loss 0.893061, forward nfe 11724, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 045/100, Runtime 0.264056, Loss 1.019594, forward nfe 11926, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 046/100, Runtime 0.254698, Loss 1.069909, forward nfe 12134, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 047/100, Runtime 0.256878, Loss 0.927135, forward nfe 12330, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 048/100, Runtime 0.251270, Loss 0.979530, forward nfe 12526, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 049/100, Runtime 0.268293, Loss 0.979930, forward nfe 12716, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 050/100, Runtime 0.236147, Loss 0.906981, forward nfe 12906, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 051/100, Runtime 0.245435, Loss 0.935898, forward nfe 13096, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 052/100, Runtime 0.252032, Loss 0.917687, forward nfe 13286, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 053/100, Runtime 0.245138, Loss 0.862889, forward nfe 13476, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 054/100, Runtime 0.240316, Loss 0.898897, forward nfe 13672, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 055/100, Runtime 0.257427, Loss 0.924938, forward nfe 13868, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 056/100, Runtime 0.253691, Loss 0.854229, forward nfe 14064, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 057/100, Runtime 0.254763, Loss 0.944264, forward nfe 14260, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 058/100, Runtime 0.249091, Loss 0.893527, forward nfe 14456, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 059/100, Runtime 0.256556, Loss 0.993341, forward nfe 14658, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 060/100, Runtime 0.252613, Loss 0.956713, forward nfe 14860, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 061/100, Runtime 0.251059, Loss 0.946707, forward nfe 15062, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 062/100, Runtime 0.254766, Loss 0.880932, forward nfe 15264, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 063/100, Runtime 0.262687, Loss 0.903436, forward nfe 15466, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 064/100, Runtime 0.253934, Loss 0.975639, forward nfe 15668, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 065/100, Runtime 0.270826, Loss 0.985393, forward nfe 15870, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 066/100, Runtime 0.253262, Loss 0.887210, forward nfe 16072, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 067/100, Runtime 0.254198, Loss 0.972318, forward nfe 16274, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 068/100, Runtime 0.252631, Loss 0.930739, forward nfe 16476, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 069/100, Runtime 0.258599, Loss 0.944790, forward nfe 16678, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 070/100, Runtime 0.251224, Loss 0.904462, forward nfe 16880, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 071/100, Runtime 0.251106, Loss 0.872599, forward nfe 17082, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 072/100, Runtime 0.258203, Loss 0.940203, forward nfe 17290, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 073/100, Runtime 0.258978, Loss 0.853522, forward nfe 17492, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 074/100, Runtime 0.264071, Loss 0.967529, forward nfe 17700, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 075/100, Runtime 0.266488, Loss 0.803589, forward nfe 17914, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 076/100, Runtime 0.251055, Loss 0.892232, forward nfe 18122, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 077/100, Runtime 0.255950, Loss 0.996540, forward nfe 18336, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 078/100, Runtime 0.255333, Loss 0.999945, forward nfe 18538, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 079/100, Runtime 0.256851, Loss 0.929669, forward nfe 18740, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 080/100, Runtime 0.257234, Loss 0.884221, forward nfe 18942, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 081/100, Runtime 0.258307, Loss 0.801489, forward nfe 19144, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 082/100, Runtime 0.259039, Loss 0.921770, forward nfe 19346, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 083/100, Runtime 0.255472, Loss 0.970570, forward nfe 19554, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 084/100, Runtime 0.252836, Loss 1.012908, forward nfe 19756, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 085/100, Runtime 0.258522, Loss 1.020990, forward nfe 19958, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 086/100, Runtime 0.262968, Loss 0.836780, forward nfe 20160, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 087/100, Runtime 0.386869, Loss 0.955271, forward nfe 20368, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 088/100, Runtime 0.264286, Loss 0.889047, forward nfe 20576, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 089/100, Runtime 0.268773, Loss 0.908721, forward nfe 20790, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 090/100, Runtime 0.267652, Loss 0.913952, forward nfe 21004, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 091/100, Runtime 0.259432, Loss 0.767049, forward nfe 21212, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 092/100, Runtime 0.257168, Loss 0.898345, forward nfe 21420, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 093/100, Runtime 0.259776, Loss 0.862940, forward nfe 21628, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 094/100, Runtime 0.266890, Loss 0.865180, forward nfe 21836, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 095/100, Runtime 0.274074, Loss 0.891463, forward nfe 22044, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 096/100, Runtime 0.258175, Loss 0.792017, forward nfe 22252, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 097/100, Runtime 0.253844, Loss 0.888177, forward nfe 22460, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 098/100, Runtime 0.257007, Loss 0.895211, forward nfe 22662, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
Epoch: 099/100, Runtime 0.258155, Loss 0.872706, forward nfe 22864, backward nfe 0, Train: 0.8833, Val: 0.7457, Test: 0.7016, Best time: 25.0000
best val accuracy 0.745652 with test accuracy 0.701613 at epoch 27 and best time 25.000000