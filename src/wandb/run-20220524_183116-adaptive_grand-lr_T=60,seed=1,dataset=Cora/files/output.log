/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 4.395781, Loss 1.948572, forward nfe 116, backward nfe 0, Train: 0.4286, Val: 0.3765, Test: 0.3949, Best time: 1.0374
Epoch: 002/100, Runtime 4.427602, Loss 1.982652, forward nfe 576, backward nfe 0, Train: 0.4286, Val: 0.3765, Test: 0.3949, Best time: 60.0000
Epoch: 003/100, Runtime 4.196707, Loss 1.940025, forward nfe 1024, backward nfe 0, Train: 0.4286, Val: 0.3765, Test: 0.3949, Best time: 60.0000
Epoch: 004/100, Runtime 4.159532, Loss 1.869417, forward nfe 1454, backward nfe 0, Train: 0.4286, Val: 0.3765, Test: 0.3949, Best time: 60.0000
Epoch: 005/100, Runtime 4.074253, Loss 1.749413, forward nfe 1878, backward nfe 0, Train: 0.6000, Val: 0.5059, Test: 0.5411, Best time: 7.5384
Epoch: 006/100, Runtime 3.949575, Loss 1.573019, forward nfe 2296, backward nfe 0, Train: 0.6000, Val: 0.5265, Test: 0.5848, Best time: 0.9804
Epoch: 007/100, Runtime 3.956358, Loss 1.399702, forward nfe 2702, backward nfe 0, Train: 0.6857, Val: 0.5632, Test: 0.6264, Best time: 4.0323
Epoch: 008/100, Runtime 3.906589, Loss 1.223402, forward nfe 3108, backward nfe 0, Train: 0.7429, Val: 0.6919, Test: 0.7360, Best time: 8.4560
Epoch: 009/100, Runtime 3.716146, Loss 1.041591, forward nfe 3502, backward nfe 0, Train: 0.8143, Val: 0.7257, Test: 0.7695, Best time: 11.7867
Epoch: 010/100, Runtime 3.840896, Loss 0.863000, forward nfe 3896, backward nfe 0, Train: 0.8357, Val: 0.7493, Test: 0.7990, Best time: 6.5746
Epoch: 011/100, Runtime 3.617275, Loss 0.735757, forward nfe 4284, backward nfe 0, Train: 0.8643, Val: 0.7728, Test: 0.8284, Best time: 9.4767
Epoch: 012/100, Runtime 3.482389, Loss 0.645119, forward nfe 4654, backward nfe 0, Train: 0.8857, Val: 0.7868, Test: 0.8325, Best time: 9.8790
Epoch: 013/100, Runtime 3.398876, Loss 0.563898, forward nfe 5012, backward nfe 0, Train: 0.8857, Val: 0.7875, Test: 0.8294, Best time: 14.0142
Epoch: 014/100, Runtime 3.297168, Loss 0.510102, forward nfe 5364, backward nfe 0, Train: 0.9071, Val: 0.7919, Test: 0.8325, Best time: 106.4978
Epoch: 015/100, Runtime 3.193841, Loss 0.460983, forward nfe 5698, backward nfe 0, Train: 0.8857, Val: 0.7978, Test: 0.8386, Best time: 15.5350
Epoch: 016/100, Runtime 3.193501, Loss 0.368252, forward nfe 6026, backward nfe 0, Train: 0.8857, Val: 0.7978, Test: 0.8386, Best time: 60.0000
Epoch: 017/100, Runtime 3.243143, Loss 0.408383, forward nfe 6360, backward nfe 0, Train: 0.8857, Val: 0.7978, Test: 0.8386, Best time: 60.0000
Epoch: 018/100, Runtime 3.002667, Loss 0.405087, forward nfe 6682, backward nfe 0, Train: 0.8857, Val: 0.7978, Test: 0.8386, Best time: 60.0000
Epoch: 019/100, Runtime 3.039147, Loss 0.373301, forward nfe 6992, backward nfe 0, Train: 0.8857, Val: 0.7978, Test: 0.8386, Best time: 60.0000
Epoch: 020/100, Runtime 2.925869, Loss 0.380751, forward nfe 7296, backward nfe 0, Train: 0.8857, Val: 0.7978, Test: 0.8386, Best time: 60.0000
Epoch: 021/100, Runtime 3.029266, Loss 0.325540, forward nfe 7582, backward nfe 0, Train: 0.8857, Val: 0.7978, Test: 0.8386, Best time: 60.0000
Epoch: 022/100, Runtime 2.821451, Loss 0.269596, forward nfe 7886, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8355, Best time: 49.6647
Epoch: 023/100, Runtime 2.784652, Loss 0.295890, forward nfe 8178, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8355, Best time: 60.0000
Epoch: 024/100, Runtime 2.828144, Loss 0.310896, forward nfe 8476, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8355, Best time: 60.0000
Epoch: 025/100, Runtime 2.906086, Loss 0.273892, forward nfe 8756, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8355, Best time: 60.0000
Epoch: 026/100, Runtime 2.668898, Loss 0.287008, forward nfe 9030, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8355, Best time: 60.0000
Epoch: 027/100, Runtime 2.690912, Loss 0.272355, forward nfe 9304, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8355, Best time: 60.0000
Epoch: 028/100, Runtime 2.795470, Loss 0.295161, forward nfe 9584, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8355, Best time: 60.0000
Epoch: 029/100, Runtime 2.772788, Loss 0.243202, forward nfe 9858, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8355, Best time: 60.0000
Epoch: 030/100, Runtime 2.590469, Loss 0.306543, forward nfe 10132, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8355, Best time: 60.0000
Epoch: 031/100, Runtime 2.770571, Loss 0.220157, forward nfe 10406, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8355, Best time: 60.0000
Epoch: 032/100, Runtime 3.074436, Loss 0.226412, forward nfe 10680, backward nfe 0, Train: 0.9429, Val: 0.8059, Test: 0.8457, Best time: 66.5238
Epoch: 033/100, Runtime 4.123879, Loss 0.285239, forward nfe 10954, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 83.3999
Epoch: 034/100, Runtime 4.338846, Loss 0.192384, forward nfe 11228, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 035/100, Runtime 4.321642, Loss 0.254582, forward nfe 11502, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 036/100, Runtime 4.221718, Loss 0.299499, forward nfe 11770, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 037/100, Runtime 4.106000, Loss 0.215506, forward nfe 12038, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 038/100, Runtime 4.296021, Loss 0.299264, forward nfe 12300, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 039/100, Runtime 3.976381, Loss 0.267993, forward nfe 12562, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 040/100, Runtime 4.110339, Loss 0.187008, forward nfe 12824, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 041/100, Runtime 4.137960, Loss 0.220870, forward nfe 13080, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 042/100, Runtime 4.050179, Loss 0.190640, forward nfe 13342, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 043/100, Runtime 4.172967, Loss 0.183347, forward nfe 13604, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 044/100, Runtime 4.181450, Loss 0.162099, forward nfe 13866, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 045/100, Runtime 4.007555, Loss 0.174369, forward nfe 14128, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 046/100, Runtime 4.240915, Loss 0.127033, forward nfe 14390, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 047/100, Runtime 4.132936, Loss 0.138888, forward nfe 14652, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 048/100, Runtime 3.953451, Loss 0.161114, forward nfe 14914, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 049/100, Runtime 4.101055, Loss 0.135583, forward nfe 15164, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 050/100, Runtime 3.847126, Loss 0.153374, forward nfe 15414, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 051/100, Runtime 4.029870, Loss 0.187632, forward nfe 15664, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 052/100, Runtime 3.936074, Loss 0.121668, forward nfe 15914, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 053/100, Runtime 3.936285, Loss 0.245973, forward nfe 16164, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 054/100, Runtime 3.858823, Loss 0.180975, forward nfe 16408, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 055/100, Runtime 3.691594, Loss 0.171147, forward nfe 16652, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 056/100, Runtime 3.800584, Loss 0.196906, forward nfe 16890, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 057/100, Runtime 3.663996, Loss 0.135344, forward nfe 17128, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 058/100, Runtime 3.714002, Loss 0.149093, forward nfe 17366, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 059/100, Runtime 3.829699, Loss 0.114579, forward nfe 17604, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 060/100, Runtime 3.709017, Loss 0.176730, forward nfe 17830, backward nfe 0, Train: 0.9571, Val: 0.8096, Test: 0.8467, Best time: 60.0000
Epoch: 061/100, Runtime 3.837870, Loss 0.105415, forward nfe 18062, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 108.0182
Epoch: 062/100, Runtime 3.566187, Loss 0.129254, forward nfe 18294, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 063/100, Runtime 3.635576, Loss 0.172700, forward nfe 18526, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 064/100, Runtime 3.598160, Loss 0.130818, forward nfe 18746, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 065/100, Runtime 3.779597, Loss 0.156608, forward nfe 18978, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 066/100, Runtime 3.641851, Loss 0.107733, forward nfe 19210, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 067/100, Runtime 3.623980, Loss 0.234603, forward nfe 19442, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 068/100, Runtime 3.565800, Loss 0.082967, forward nfe 19668, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 069/100, Runtime 3.458733, Loss 0.114302, forward nfe 19888, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 070/100, Runtime 3.640139, Loss 0.106241, forward nfe 20108, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 071/100, Runtime 3.464304, Loss 0.082063, forward nfe 20328, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 072/100, Runtime 3.549208, Loss 0.130038, forward nfe 20548, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 073/100, Runtime 3.581917, Loss 0.097100, forward nfe 20768, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 074/100, Runtime 3.394965, Loss 0.064668, forward nfe 20988, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 075/100, Runtime 3.573112, Loss 0.097483, forward nfe 21208, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 076/100, Runtime 3.503242, Loss 0.155941, forward nfe 21428, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 077/100, Runtime 3.484439, Loss 0.082445, forward nfe 21648, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 078/100, Runtime 3.585990, Loss 0.077966, forward nfe 21868, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 079/100, Runtime 3.423027, Loss 0.075169, forward nfe 22088, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 080/100, Runtime 3.435335, Loss 0.106347, forward nfe 22308, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 081/100, Runtime 3.496457, Loss 0.064128, forward nfe 22522, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 082/100, Runtime 3.312532, Loss 0.059768, forward nfe 22736, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 083/100, Runtime 3.400289, Loss 0.068927, forward nfe 22950, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 084/100, Runtime 3.527779, Loss 0.082831, forward nfe 23164, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 085/100, Runtime 3.472420, Loss 0.056790, forward nfe 23384, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 086/100, Runtime 3.649865, Loss 0.044109, forward nfe 23604, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 087/100, Runtime 3.473101, Loss 0.053773, forward nfe 23824, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 088/100, Runtime 3.318686, Loss 0.053684, forward nfe 24044, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 089/100, Runtime 3.397186, Loss 0.053165, forward nfe 24252, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 090/100, Runtime 3.198675, Loss 0.085559, forward nfe 24460, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 091/100, Runtime 3.279459, Loss 0.044248, forward nfe 24668, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 092/100, Runtime 3.446365, Loss 0.078935, forward nfe 24876, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 093/100, Runtime 3.301259, Loss 0.044405, forward nfe 25084, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 094/100, Runtime 3.199147, Loss 0.062016, forward nfe 25292, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 095/100, Runtime 3.388089, Loss 0.043036, forward nfe 25500, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 096/100, Runtime 3.475837, Loss 0.053041, forward nfe 25708, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 097/100, Runtime 3.197262, Loss 0.080734, forward nfe 25916, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 098/100, Runtime 3.253154, Loss 0.056211, forward nfe 26124, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
Epoch: 099/100, Runtime 3.426733, Loss 0.075307, forward nfe 26332, backward nfe 0, Train: 0.9857, Val: 0.8132, Test: 0.8508, Best time: 60.0000
best val accuracy 0.813235 with test accuracy 0.850761 at epoch 61 and best time 60.000000