/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 3.473779, Loss 1.948817, forward nfe 110, backward nfe 0, Train: 0.2643, Val: 0.1949, Test: 0.2223, Best time: 0.0935
Epoch: 002/100, Runtime 3.356532, Loss 1.976048, forward nfe 546, backward nfe 0, Train: 0.3071, Val: 0.2368, Test: 0.2711, Best time: 0.0881
Epoch: 003/100, Runtime 3.225981, Loss 1.939832, forward nfe 958, backward nfe 0, Train: 0.2714, Val: 0.2610, Test: 0.2893, Best time: 0.0862
Epoch: 004/100, Runtime 3.104739, Loss 1.888991, forward nfe 1364, backward nfe 0, Train: 0.5500, Val: 0.4529, Test: 0.4893, Best time: 7.1895
Epoch: 005/100, Runtime 3.064107, Loss 1.776208, forward nfe 1764, backward nfe 0, Train: 0.7143, Val: 0.6456, Test: 0.6680, Best time: 3.7276
Epoch: 006/100, Runtime 3.168648, Loss 1.614950, forward nfe 2152, backward nfe 0, Train: 0.8286, Val: 0.7647, Test: 0.7909, Best time: 30.1654
Epoch: 007/100, Runtime 3.149043, Loss 1.413598, forward nfe 2534, backward nfe 0, Train: 0.8571, Val: 0.7831, Test: 0.8041, Best time: 24.1209
Epoch: 008/100, Runtime 3.057640, Loss 1.201470, forward nfe 2910, backward nfe 0, Train: 0.8786, Val: 0.7882, Test: 0.8102, Best time: 25.1722
Epoch: 009/100, Runtime 3.036058, Loss 0.964533, forward nfe 3280, backward nfe 0, Train: 0.8786, Val: 0.7882, Test: 0.8102, Best time: 55.0000
Epoch: 010/100, Runtime 2.888518, Loss 0.801199, forward nfe 3638, backward nfe 0, Train: 0.8786, Val: 0.7882, Test: 0.8102, Best time: 55.0000
Epoch: 011/100, Runtime 2.910012, Loss 0.707605, forward nfe 3996, backward nfe 0, Train: 0.8714, Val: 0.8074, Test: 0.8274, Best time: 35.8575
Epoch: 012/100, Runtime 2.682308, Loss 0.573182, forward nfe 4354, backward nfe 0, Train: 0.8714, Val: 0.8096, Test: 0.8315, Best time: 43.5958
Epoch: 013/100, Runtime 2.471609, Loss 0.495490, forward nfe 4694, backward nfe 0, Train: 0.8929, Val: 0.8199, Test: 0.8406, Best time: 46.0040
Epoch: 014/100, Runtime 2.779213, Loss 0.464493, forward nfe 5028, backward nfe 0, Train: 0.8786, Val: 0.8206, Test: 0.8234, Best time: 19.1734
Epoch: 015/100, Runtime 2.522192, Loss 0.442152, forward nfe 5350, backward nfe 0, Train: 0.8786, Val: 0.8206, Test: 0.8234, Best time: 55.0000
Epoch: 016/100, Runtime 2.542072, Loss 0.411307, forward nfe 5648, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 98.6169
Epoch: 017/100, Runtime 2.540384, Loss 0.422853, forward nfe 5946, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 018/100, Runtime 2.448828, Loss 0.347343, forward nfe 6250, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 019/100, Runtime 2.352039, Loss 0.411239, forward nfe 6542, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 020/100, Runtime 2.364272, Loss 0.428823, forward nfe 6822, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 021/100, Runtime 2.300473, Loss 0.438853, forward nfe 7102, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 022/100, Runtime 2.312799, Loss 0.352048, forward nfe 7370, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 023/100, Runtime 2.198041, Loss 0.366106, forward nfe 7638, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 024/100, Runtime 2.235266, Loss 0.419568, forward nfe 7906, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 025/100, Runtime 2.098666, Loss 0.295603, forward nfe 8174, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 026/100, Runtime 2.199506, Loss 0.297729, forward nfe 8430, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 027/100, Runtime 1.918633, Loss 0.336773, forward nfe 8674, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 028/100, Runtime 1.960618, Loss 0.364907, forward nfe 8906, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 029/100, Runtime 1.904480, Loss 0.371439, forward nfe 9138, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 030/100, Runtime 1.834792, Loss 0.259293, forward nfe 9376, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 031/100, Runtime 1.832024, Loss 0.321114, forward nfe 9608, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 032/100, Runtime 1.769196, Loss 0.355003, forward nfe 9840, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 033/100, Runtime 1.846417, Loss 0.285871, forward nfe 10066, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 034/100, Runtime 1.846270, Loss 0.238578, forward nfe 10286, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 035/100, Runtime 1.894387, Loss 0.250314, forward nfe 10506, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 036/100, Runtime 1.862464, Loss 0.306967, forward nfe 10726, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 037/100, Runtime 1.925786, Loss 0.256859, forward nfe 10946, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 038/100, Runtime 1.791355, Loss 0.225008, forward nfe 11166, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 039/100, Runtime 1.752870, Loss 0.250012, forward nfe 11374, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 040/100, Runtime 1.739981, Loss 0.237890, forward nfe 11582, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 041/100, Runtime 1.728803, Loss 0.246411, forward nfe 11790, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 042/100, Runtime 1.772529, Loss 0.252016, forward nfe 11998, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 043/100, Runtime 1.768663, Loss 0.197208, forward nfe 12206, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 044/100, Runtime 1.774417, Loss 0.198356, forward nfe 12414, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 045/100, Runtime 1.749273, Loss 0.208514, forward nfe 12622, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 046/100, Runtime 1.664941, Loss 0.165320, forward nfe 12830, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 047/100, Runtime 1.738497, Loss 0.243021, forward nfe 13038, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 048/100, Runtime 1.696715, Loss 0.176448, forward nfe 13246, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 049/100, Runtime 1.661388, Loss 0.162410, forward nfe 13448, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 050/100, Runtime 1.625824, Loss 0.247211, forward nfe 13656, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 051/100, Runtime 1.670453, Loss 0.149581, forward nfe 13864, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 052/100, Runtime 1.672919, Loss 0.155663, forward nfe 14072, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 053/100, Runtime 1.653124, Loss 0.295965, forward nfe 14274, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 054/100, Runtime 1.596939, Loss 0.196707, forward nfe 14476, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 055/100, Runtime 1.735516, Loss 0.131330, forward nfe 14678, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 056/100, Runtime 1.710152, Loss 0.199791, forward nfe 14880, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 057/100, Runtime 1.651169, Loss 0.213481, forward nfe 15082, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 058/100, Runtime 1.727829, Loss 0.140637, forward nfe 15284, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 059/100, Runtime 1.692487, Loss 0.129537, forward nfe 15486, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 060/100, Runtime 1.676600, Loss 0.148405, forward nfe 15688, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 061/100, Runtime 1.723942, Loss 0.122322, forward nfe 15890, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 062/100, Runtime 1.663090, Loss 0.095769, forward nfe 16092, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 063/100, Runtime 1.682731, Loss 0.105539, forward nfe 16294, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 064/100, Runtime 1.715343, Loss 0.108608, forward nfe 16496, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 065/100, Runtime 1.695261, Loss 0.070330, forward nfe 16698, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 066/100, Runtime 1.678781, Loss 0.088761, forward nfe 16900, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 067/100, Runtime 1.689749, Loss 0.127769, forward nfe 17090, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 068/100, Runtime 1.552896, Loss 0.088037, forward nfe 17280, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 069/100, Runtime 1.572658, Loss 0.087317, forward nfe 17470, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 070/100, Runtime 1.520288, Loss 0.070825, forward nfe 17648, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 071/100, Runtime 1.637620, Loss 0.073892, forward nfe 17838, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 072/100, Runtime 1.599017, Loss 0.090144, forward nfe 18028, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 073/100, Runtime 1.582967, Loss 0.107588, forward nfe 18218, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 074/100, Runtime 1.673788, Loss 0.051043, forward nfe 18408, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 075/100, Runtime 1.618783, Loss 0.108738, forward nfe 18604, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 076/100, Runtime 1.647135, Loss 0.088241, forward nfe 18800, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 077/100, Runtime 1.622173, Loss 0.075853, forward nfe 18996, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 078/100, Runtime 1.548853, Loss 0.123990, forward nfe 19192, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 079/100, Runtime 1.477650, Loss 0.080293, forward nfe 19382, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 080/100, Runtime 1.456339, Loss 0.164302, forward nfe 19572, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 081/100, Runtime 1.496489, Loss 0.063531, forward nfe 19762, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 082/100, Runtime 1.528716, Loss 0.070362, forward nfe 19958, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 083/100, Runtime 1.516695, Loss 0.048820, forward nfe 20154, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 084/100, Runtime 1.486610, Loss 0.066003, forward nfe 20350, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 085/100, Runtime 1.430805, Loss 0.082820, forward nfe 20546, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 086/100, Runtime 1.550515, Loss 0.074594, forward nfe 20742, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 087/100, Runtime 1.499307, Loss 0.065623, forward nfe 20938, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 088/100, Runtime 1.526756, Loss 0.052384, forward nfe 21134, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 089/100, Runtime 1.540406, Loss 0.045669, forward nfe 21330, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 090/100, Runtime 1.498241, Loss 0.096310, forward nfe 21526, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 091/100, Runtime 1.581013, Loss 0.066902, forward nfe 21722, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 092/100, Runtime 1.504742, Loss 0.115791, forward nfe 21918, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 093/100, Runtime 1.473447, Loss 0.056435, forward nfe 22114, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 094/100, Runtime 2.089995, Loss 0.062997, forward nfe 22310, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 095/100, Runtime 2.053339, Loss 0.048871, forward nfe 22506, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 096/100, Runtime 2.283558, Loss 0.043619, forward nfe 22702, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 097/100, Runtime 2.362318, Loss 0.066901, forward nfe 22898, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 098/100, Runtime 2.255384, Loss 0.055967, forward nfe 23094, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
Epoch: 099/100, Runtime 2.152387, Loss 0.074960, forward nfe 23290, backward nfe 0, Train: 0.8929, Val: 0.8375, Test: 0.8365, Best time: 55.0000
best val accuracy 0.837500 with test accuracy 0.836548 at epoch 16 and best time 55.000000