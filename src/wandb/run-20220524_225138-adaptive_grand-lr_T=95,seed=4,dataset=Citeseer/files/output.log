/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.955492, Loss 1.792470, forward nfe 230, backward nfe 0, Train: 0.2333, Val: 0.1290, Test: 0.1306, Best time: 95.0000
Epoch: 002/100, Runtime 0.900446, Loss 1.773264, forward nfe 1014, backward nfe 0, Train: 0.4500, Val: 0.3377, Test: 0.3113, Best time: 0.0384
Epoch: 003/100, Runtime 0.872040, Loss 1.747735, forward nfe 1804, backward nfe 0, Train: 0.5167, Val: 0.5362, Test: 0.5032, Best time: 38.7008
Epoch: 004/100, Runtime 0.845226, Loss 1.693067, forward nfe 2576, backward nfe 0, Train: 0.5333, Val: 0.5471, Test: 0.5226, Best time: 111.1654
Epoch: 005/100, Runtime 0.832217, Loss 1.642349, forward nfe 3336, backward nfe 0, Train: 0.5333, Val: 0.5471, Test: 0.5226, Best time: 95.0000
Epoch: 006/100, Runtime 0.816967, Loss 1.670284, forward nfe 4090, backward nfe 0, Train: 0.5333, Val: 0.5471, Test: 0.5226, Best time: 95.0000
Epoch: 007/100, Runtime 0.802604, Loss 1.610556, forward nfe 4820, backward nfe 0, Train: 0.6833, Val: 0.5783, Test: 0.6081, Best time: 91.9543
Epoch: 008/100, Runtime 0.810313, Loss 1.619695, forward nfe 5550, backward nfe 0, Train: 0.6917, Val: 0.6500, Test: 0.6516, Best time: 23.3926
Epoch: 009/100, Runtime 0.789729, Loss 1.566592, forward nfe 6268, backward nfe 0, Train: 0.6583, Val: 0.7051, Test: 0.7097, Best time: 20.4743
Epoch: 010/100, Runtime 0.801847, Loss 1.521742, forward nfe 6968, backward nfe 0, Train: 0.7083, Val: 0.7152, Test: 0.7387, Best time: 20.9549
Epoch: 011/100, Runtime 0.740738, Loss 1.574420, forward nfe 7656, backward nfe 0, Train: 0.7083, Val: 0.7152, Test: 0.7387, Best time: 95.0000
Epoch: 012/100, Runtime 0.758772, Loss 1.531537, forward nfe 8338, backward nfe 0, Train: 0.7083, Val: 0.7152, Test: 0.7387, Best time: 95.0000
Epoch: 013/100, Runtime 0.747442, Loss 1.504061, forward nfe 9014, backward nfe 0, Train: 0.7083, Val: 0.7152, Test: 0.7387, Best time: 95.0000
Epoch: 014/100, Runtime 0.719153, Loss 1.417249, forward nfe 9666, backward nfe 0, Train: 0.7083, Val: 0.7152, Test: 0.7387, Best time: 95.0000
Epoch: 015/100, Runtime 0.734586, Loss 1.502923, forward nfe 10306, backward nfe 0, Train: 0.7083, Val: 0.7152, Test: 0.7387, Best time: 95.0000
Epoch: 016/100, Runtime 0.746262, Loss 1.440212, forward nfe 10952, backward nfe 0, Train: 0.7083, Val: 0.7152, Test: 0.7387, Best time: 95.0000
Epoch: 017/100, Runtime 0.686809, Loss 1.454330, forward nfe 11586, backward nfe 0, Train: 0.7083, Val: 0.7152, Test: 0.7387, Best time: 95.0000
Epoch: 018/100, Runtime 0.682859, Loss 1.379961, forward nfe 12208, backward nfe 0, Train: 0.7083, Val: 0.7152, Test: 0.7387, Best time: 95.0000
Epoch: 019/100, Runtime 0.671377, Loss 1.333103, forward nfe 12818, backward nfe 0, Train: 0.7083, Val: 0.7152, Test: 0.7387, Best time: 95.0000
Epoch: 020/100, Runtime 0.663730, Loss 1.403080, forward nfe 13422, backward nfe 0, Train: 0.7250, Val: 0.7232, Test: 0.7129, Best time: 68.3406
Epoch: 021/100, Runtime 0.669744, Loss 1.463410, forward nfe 14020, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 26.0158
Epoch: 022/100, Runtime 0.673393, Loss 1.298821, forward nfe 14612, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 023/100, Runtime 0.646698, Loss 1.419150, forward nfe 15198, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 024/100, Runtime 0.652698, Loss 1.472717, forward nfe 15766, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 025/100, Runtime 0.636754, Loss 1.405851, forward nfe 16334, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 026/100, Runtime 0.616517, Loss 1.410688, forward nfe 16890, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 027/100, Runtime 0.619897, Loss 1.346549, forward nfe 17434, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 028/100, Runtime 0.590881, Loss 1.325032, forward nfe 17966, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 029/100, Runtime 0.596163, Loss 1.444356, forward nfe 18486, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 030/100, Runtime 0.606829, Loss 1.434943, forward nfe 19012, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 031/100, Runtime 0.566982, Loss 1.417408, forward nfe 19526, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 032/100, Runtime 0.568307, Loss 1.427298, forward nfe 20022, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 033/100, Runtime 0.535939, Loss 1.311601, forward nfe 20512, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 034/100, Runtime 0.553368, Loss 1.459270, forward nfe 20996, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 035/100, Runtime 0.536103, Loss 1.557592, forward nfe 21480, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 036/100, Runtime 0.531737, Loss 1.509198, forward nfe 21952, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 037/100, Runtime 0.531323, Loss 1.432511, forward nfe 22412, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 038/100, Runtime 0.527061, Loss 1.442164, forward nfe 22872, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 039/100, Runtime 0.541266, Loss 1.405334, forward nfe 23332, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 040/100, Runtime 0.521477, Loss 1.456376, forward nfe 23786, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 041/100, Runtime 0.512215, Loss 1.398783, forward nfe 24240, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 042/100, Runtime 0.534634, Loss 1.459305, forward nfe 24682, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 043/100, Runtime 0.511106, Loss 1.471722, forward nfe 25118, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 044/100, Runtime 0.511029, Loss 1.335525, forward nfe 25548, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 045/100, Runtime 0.516279, Loss 1.407610, forward nfe 25978, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 046/100, Runtime 0.494710, Loss 1.342007, forward nfe 26402, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 047/100, Runtime 0.476920, Loss 1.428924, forward nfe 26820, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 048/100, Runtime 0.470614, Loss 1.382321, forward nfe 27232, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 049/100, Runtime 0.481926, Loss 1.335990, forward nfe 27638, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 050/100, Runtime 0.441899, Loss 1.335224, forward nfe 28038, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 051/100, Runtime 0.447434, Loss 1.427036, forward nfe 28432, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 052/100, Runtime 0.441622, Loss 1.451116, forward nfe 28820, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 053/100, Runtime 0.434391, Loss 1.336568, forward nfe 29208, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 054/100, Runtime 0.451932, Loss 1.314991, forward nfe 29590, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 055/100, Runtime 0.562988, Loss 1.353927, forward nfe 29972, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 056/100, Runtime 0.447929, Loss 1.318620, forward nfe 30348, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 057/100, Runtime 0.428403, Loss 1.502528, forward nfe 30712, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 058/100, Runtime 0.440816, Loss 1.446541, forward nfe 31082, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 059/100, Runtime 0.416587, Loss 1.334515, forward nfe 31452, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 060/100, Runtime 0.421077, Loss 1.331580, forward nfe 31810, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 061/100, Runtime 0.409122, Loss 1.520300, forward nfe 32168, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 062/100, Runtime 0.412258, Loss 1.388386, forward nfe 32520, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 063/100, Runtime 0.431871, Loss 1.297036, forward nfe 32872, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 064/100, Runtime 0.412551, Loss 1.290068, forward nfe 33224, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 065/100, Runtime 0.415560, Loss 1.370632, forward nfe 33576, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 066/100, Runtime 0.401909, Loss 1.330986, forward nfe 33928, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 067/100, Runtime 0.408586, Loss 1.306003, forward nfe 34280, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 068/100, Runtime 0.415145, Loss 1.445587, forward nfe 34626, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 069/100, Runtime 0.411847, Loss 1.298283, forward nfe 34972, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 070/100, Runtime 0.412493, Loss 1.335796, forward nfe 35324, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 071/100, Runtime 0.412779, Loss 1.319776, forward nfe 35676, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 072/100, Runtime 0.419287, Loss 1.360655, forward nfe 36028, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 073/100, Runtime 0.413307, Loss 1.357497, forward nfe 36380, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 074/100, Runtime 0.414144, Loss 1.322957, forward nfe 36732, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 075/100, Runtime 0.414943, Loss 1.335619, forward nfe 37078, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 076/100, Runtime 0.400280, Loss 1.341455, forward nfe 37424, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 077/100, Runtime 0.417312, Loss 1.410415, forward nfe 37770, backward nfe 0, Train: 0.7167, Val: 0.7319, Test: 0.7161, Best time: 95.0000
Epoch: 078/100, Runtime 0.406248, Loss 1.212000, forward nfe 38110, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 138.3712
Epoch: 079/100, Runtime 0.401022, Loss 1.335428, forward nfe 38450, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 080/100, Runtime 0.407050, Loss 1.254148, forward nfe 38790, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 081/100, Runtime 0.419212, Loss 1.346328, forward nfe 39130, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 082/100, Runtime 0.398114, Loss 1.429433, forward nfe 39470, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 083/100, Runtime 0.394557, Loss 1.369939, forward nfe 39810, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 084/100, Runtime 0.404309, Loss 1.498404, forward nfe 40144, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 085/100, Runtime 0.398271, Loss 1.352345, forward nfe 40478, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 086/100, Runtime 0.386116, Loss 1.297079, forward nfe 40818, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 087/100, Runtime 0.407793, Loss 1.281442, forward nfe 41158, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 088/100, Runtime 0.399408, Loss 1.255192, forward nfe 41492, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 089/100, Runtime 0.393775, Loss 1.304951, forward nfe 41820, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 090/100, Runtime 0.387125, Loss 1.291114, forward nfe 42148, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 091/100, Runtime 0.381556, Loss 1.299391, forward nfe 42470, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 092/100, Runtime 0.386952, Loss 1.355784, forward nfe 42792, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 093/100, Runtime 0.385633, Loss 1.306523, forward nfe 43114, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 094/100, Runtime 0.396006, Loss 1.406720, forward nfe 43436, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 095/100, Runtime 0.391301, Loss 1.387287, forward nfe 43758, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 096/100, Runtime 0.383172, Loss 1.197030, forward nfe 44080, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 097/100, Runtime 0.384178, Loss 1.467895, forward nfe 44402, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 098/100, Runtime 0.385656, Loss 1.312743, forward nfe 44724, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
Epoch: 099/100, Runtime 0.380084, Loss 1.283047, forward nfe 45052, backward nfe 0, Train: 0.7333, Val: 0.7341, Test: 0.7339, Best time: 95.0000
best val accuracy 0.734058 with test accuracy 0.733871 at epoch 78 and best time 95.000000