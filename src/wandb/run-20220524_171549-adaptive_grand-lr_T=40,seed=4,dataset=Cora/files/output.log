/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 5.152297, Loss 1.948857, forward nfe 92, backward nfe 0, Train: 0.3857, Val: 0.5059, Test: 0.4579, Best time: 0.0930
Epoch: 002/100, Runtime 4.991623, Loss 1.957671, forward nfe 426, backward nfe 0, Train: 0.3429, Val: 0.5140, Test: 0.4822, Best time: 0.0875
Epoch: 003/100, Runtime 5.009665, Loss 1.906879, forward nfe 736, backward nfe 0, Train: 0.4929, Val: 0.6360, Test: 0.5777, Best time: 5.1590
Epoch: 004/100, Runtime 4.831844, Loss 1.799115, forward nfe 1058, backward nfe 0, Train: 0.6071, Val: 0.7088, Test: 0.6497, Best time: 5.3016
Epoch: 005/100, Runtime 4.721507, Loss 1.611369, forward nfe 1368, backward nfe 0, Train: 0.7500, Val: 0.7529, Test: 0.7239, Best time: 7.5000
Epoch: 006/100, Runtime 4.704375, Loss 1.403944, forward nfe 1672, backward nfe 0, Train: 0.8214, Val: 0.7588, Test: 0.7503, Best time: 17.6335
Epoch: 007/100, Runtime 4.428935, Loss 1.175149, forward nfe 1964, backward nfe 0, Train: 0.9000, Val: 0.7919, Test: 0.7868, Best time: 13.9098
Epoch: 008/100, Runtime 4.273982, Loss 0.941991, forward nfe 2250, backward nfe 0, Train: 0.9357, Val: 0.8029, Test: 0.7990, Best time: 14.3672
Epoch: 009/100, Runtime 4.465172, Loss 0.726733, forward nfe 2524, backward nfe 0, Train: 0.9357, Val: 0.8279, Test: 0.8203, Best time: 25.8452
Epoch: 010/100, Runtime 4.200256, Loss 0.580852, forward nfe 2804, backward nfe 0, Train: 0.9357, Val: 0.8279, Test: 0.8203, Best time: 40.0000
Epoch: 011/100, Runtime 4.153334, Loss 0.442510, forward nfe 3078, backward nfe 0, Train: 0.9357, Val: 0.8279, Test: 0.8203, Best time: 40.0000
Epoch: 012/100, Runtime 4.309845, Loss 0.367285, forward nfe 3352, backward nfe 0, Train: 0.9357, Val: 0.8279, Test: 0.8203, Best time: 40.0000
Epoch: 013/100, Runtime 3.778003, Loss 0.312786, forward nfe 3620, backward nfe 0, Train: 0.9357, Val: 0.8279, Test: 0.8203, Best time: 40.0000
Epoch: 014/100, Runtime 3.984166, Loss 0.283338, forward nfe 3876, backward nfe 0, Train: 0.9357, Val: 0.8279, Test: 0.8203, Best time: 40.0000
Epoch: 015/100, Runtime 3.646763, Loss 0.242082, forward nfe 4120, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 35.7024
Epoch: 016/100, Runtime 3.790370, Loss 0.255803, forward nfe 4358, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 017/100, Runtime 3.669657, Loss 0.267706, forward nfe 4596, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 018/100, Runtime 3.861135, Loss 0.276430, forward nfe 4834, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 019/100, Runtime 3.437771, Loss 0.200613, forward nfe 5066, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 020/100, Runtime 3.541976, Loss 0.227451, forward nfe 5292, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 021/100, Runtime 3.362677, Loss 0.272965, forward nfe 5512, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 022/100, Runtime 3.255058, Loss 0.232416, forward nfe 5732, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 023/100, Runtime 3.484620, Loss 0.215935, forward nfe 5940, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 024/100, Runtime 3.260468, Loss 0.206692, forward nfe 6142, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 025/100, Runtime 3.242159, Loss 0.219257, forward nfe 6350, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 026/100, Runtime 3.360833, Loss 0.200756, forward nfe 6558, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 027/100, Runtime 3.490097, Loss 0.264570, forward nfe 6766, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 028/100, Runtime 3.112760, Loss 0.163036, forward nfe 6974, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 029/100, Runtime 3.272999, Loss 0.232349, forward nfe 7176, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 030/100, Runtime 3.331019, Loss 0.166067, forward nfe 7384, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 031/100, Runtime 3.220593, Loss 0.165652, forward nfe 7586, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 032/100, Runtime 3.091546, Loss 0.184491, forward nfe 7788, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 033/100, Runtime 3.194946, Loss 0.120364, forward nfe 7990, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 034/100, Runtime 3.375455, Loss 0.126857, forward nfe 8198, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 035/100, Runtime 3.150735, Loss 0.152627, forward nfe 8406, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 036/100, Runtime 3.229788, Loss 0.123992, forward nfe 8614, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 037/100, Runtime 3.380973, Loss 0.138866, forward nfe 8822, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 038/100, Runtime 3.205734, Loss 0.088098, forward nfe 9030, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 039/100, Runtime 3.220385, Loss 0.111866, forward nfe 9238, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 040/100, Runtime 3.271695, Loss 0.117715, forward nfe 9446, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 041/100, Runtime 3.357372, Loss 0.101635, forward nfe 9654, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 042/100, Runtime 3.091274, Loss 0.060866, forward nfe 9862, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 043/100, Runtime 3.264987, Loss 0.124924, forward nfe 10070, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 044/100, Runtime 3.371732, Loss 0.099559, forward nfe 10278, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 045/100, Runtime 3.194038, Loss 0.109264, forward nfe 10486, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 046/100, Runtime 3.124619, Loss 0.099543, forward nfe 10694, backward nfe 0, Train: 0.9500, Val: 0.8324, Test: 0.8213, Best time: 40.0000
Epoch: 047/100, Runtime 3.350243, Loss 0.130893, forward nfe 10902, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8325, Best time: 115.5165
Epoch: 048/100, Runtime 3.244262, Loss 0.090787, forward nfe 11098, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8325, Best time: 40.0000
Epoch: 049/100, Runtime 3.037246, Loss 0.130533, forward nfe 11294, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8325, Best time: 40.0000
Epoch: 050/100, Runtime 3.139190, Loss 0.144373, forward nfe 11490, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8325, Best time: 40.0000
Epoch: 051/100, Runtime 3.169406, Loss 0.117275, forward nfe 11686, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8325, Best time: 40.0000
Epoch: 052/100, Runtime 3.205545, Loss 0.096747, forward nfe 11882, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8325, Best time: 40.0000
Epoch: 053/100, Runtime 3.113316, Loss 0.067782, forward nfe 12078, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8325, Best time: 40.0000
Epoch: 054/100, Runtime 2.970107, Loss 0.096168, forward nfe 12274, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8325, Best time: 40.0000
Epoch: 055/100, Runtime 3.264649, Loss 0.082389, forward nfe 12470, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8325, Best time: 40.0000
Epoch: 056/100, Runtime 3.205707, Loss 0.059521, forward nfe 12666, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8325, Best time: 40.0000
Epoch: 057/100, Runtime 3.100854, Loss 0.132054, forward nfe 12862, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8325, Best time: 40.0000
Epoch: 058/100, Runtime 3.212186, Loss 0.092299, forward nfe 13058, backward nfe 0, Train: 0.9857, Val: 0.8331, Test: 0.8325, Best time: 40.0000
Epoch: 059/100, Runtime 2.951677, Loss 0.126479, forward nfe 13254, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 113.4055
Epoch: 060/100, Runtime 3.188917, Loss 0.067075, forward nfe 13444, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 061/100, Runtime 3.036699, Loss 0.070827, forward nfe 13634, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 062/100, Runtime 3.093899, Loss 0.112864, forward nfe 13824, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 063/100, Runtime 2.897231, Loss 0.089150, forward nfe 14014, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 064/100, Runtime 3.084623, Loss 0.056020, forward nfe 14198, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 065/100, Runtime 3.037733, Loss 0.044786, forward nfe 14388, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 066/100, Runtime 3.168123, Loss 0.065642, forward nfe 14578, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 067/100, Runtime 3.031220, Loss 0.065211, forward nfe 14768, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 068/100, Runtime 3.061355, Loss 0.045348, forward nfe 14958, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 069/100, Runtime 2.947974, Loss 0.036061, forward nfe 15148, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 070/100, Runtime 2.915329, Loss 0.077060, forward nfe 15338, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 071/100, Runtime 2.931616, Loss 0.101812, forward nfe 15516, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 072/100, Runtime 2.998369, Loss 0.038563, forward nfe 15700, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 073/100, Runtime 2.938327, Loss 0.061993, forward nfe 15884, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 074/100, Runtime 2.859991, Loss 0.051519, forward nfe 16068, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 075/100, Runtime 2.928482, Loss 0.072749, forward nfe 16252, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 076/100, Runtime 2.897477, Loss 0.053185, forward nfe 16436, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 077/100, Runtime 3.053513, Loss 0.081707, forward nfe 16620, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 078/100, Runtime 2.880677, Loss 0.056976, forward nfe 16798, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 079/100, Runtime 2.954224, Loss 0.090206, forward nfe 16976, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 080/100, Runtime 2.619078, Loss 0.110478, forward nfe 17154, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 081/100, Runtime 2.667526, Loss 0.080116, forward nfe 17320, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 082/100, Runtime 2.538373, Loss 0.088029, forward nfe 17486, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 083/100, Runtime 2.729684, Loss 0.057548, forward nfe 17646, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 084/100, Runtime 2.700973, Loss 0.061455, forward nfe 17812, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 085/100, Runtime 2.583859, Loss 0.053651, forward nfe 17978, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 086/100, Runtime 2.648042, Loss 0.033550, forward nfe 18144, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 087/100, Runtime 2.714648, Loss 0.066954, forward nfe 18310, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 088/100, Runtime 2.734496, Loss 0.045342, forward nfe 18476, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 089/100, Runtime 2.652897, Loss 0.032309, forward nfe 18642, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 090/100, Runtime 2.672009, Loss 0.041729, forward nfe 18808, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 091/100, Runtime 2.739265, Loss 0.032139, forward nfe 18974, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 092/100, Runtime 2.763645, Loss 0.050439, forward nfe 19140, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 093/100, Runtime 2.665846, Loss 0.033083, forward nfe 19306, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 094/100, Runtime 2.593635, Loss 0.036345, forward nfe 19472, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 095/100, Runtime 2.670966, Loss 0.047974, forward nfe 19638, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 096/100, Runtime 2.717368, Loss 0.026232, forward nfe 19804, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 097/100, Runtime 2.627369, Loss 0.040706, forward nfe 19970, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 098/100, Runtime 2.958938, Loss 0.042126, forward nfe 20136, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
Epoch: 099/100, Runtime 3.038239, Loss 0.039429, forward nfe 20320, backward nfe 0, Train: 0.9714, Val: 0.8397, Test: 0.8426, Best time: 40.0000
best val accuracy 0.839706 with test accuracy 0.842640 at epoch 59 and best time 40.000000