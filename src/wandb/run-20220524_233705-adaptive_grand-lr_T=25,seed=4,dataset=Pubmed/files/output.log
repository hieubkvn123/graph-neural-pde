/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 11.619910, Loss 1.098346, forward nfe 62, backward nfe 1098, Train: 0.7167, Val: 0.5924, Test: 0.6006, Best time: 2.6483
Epoch: 002/100, Runtime 11.142368, Loss 1.088045, forward nfe 360, backward nfe 2140, Train: 0.8167, Val: 0.6701, Test: 0.6907, Best time: 10.6857
Epoch: 003/100, Runtime 8.483915, Loss 1.071013, forward nfe 658, backward nfe 2919, Train: 0.8000, Val: 0.7257, Test: 0.7420, Best time: 6.0859
Epoch: 004/100, Runtime 8.474069, Loss 1.044495, forward nfe 950, backward nfe 3695, Train: 0.7500, Val: 0.7431, Test: 0.7514, Best time: 33.6886
Epoch: 005/100, Runtime 8.991088, Loss 1.009979, forward nfe 1242, backward nfe 4521, Train: 0.8000, Val: 0.7451, Test: 0.7526, Best time: 20.7573
Epoch: 006/100, Runtime 10.054921, Loss 0.973569, forward nfe 1540, backward nfe 5460, Train: 0.8000, Val: 0.7451, Test: 0.7526, Best time: 25.0000
Epoch: 007/100, Runtime 9.267198, Loss 0.932952, forward nfe 1832, backward nfe 6341, Train: 0.8000, Val: 0.7451, Test: 0.7526, Best time: 25.0000
Epoch: 008/100, Runtime 8.676416, Loss 0.869076, forward nfe 2100, backward nfe 7152, Train: 0.8000, Val: 0.7451, Test: 0.7526, Best time: 25.0000
Epoch: 009/100, Runtime 7.873530, Loss 0.810325, forward nfe 2368, backward nfe 7887, Train: 0.8000, Val: 0.7451, Test: 0.7526, Best time: 25.0000
Epoch: 010/100, Runtime 6.946868, Loss 0.741444, forward nfe 2636, backward nfe 8535, Train: 0.8000, Val: 0.7590, Test: 0.7640, Best time: 45.5008
Epoch: 011/100, Runtime 4.984241, Loss 0.702555, forward nfe 2898, backward nfe 8980, Train: 0.8167, Val: 0.7694, Test: 0.7715, Best time: 46.2028
Epoch: 012/100, Runtime 3.388013, Loss 0.644988, forward nfe 3160, backward nfe 9259, Train: 0.8167, Val: 0.7743, Test: 0.7755, Best time: 52.0438
Epoch: 013/100, Runtime 3.819735, Loss 0.599397, forward nfe 3416, backward nfe 9581, Train: 0.8167, Val: 0.7771, Test: 0.7770, Best time: 67.8498
Epoch: 014/100, Runtime 4.537303, Loss 0.533547, forward nfe 3672, backward nfe 9976, Train: 0.8167, Val: 0.7812, Test: 0.7836, Best time: 69.1037
Epoch: 015/100, Runtime 4.506897, Loss 0.524382, forward nfe 3922, backward nfe 10367, Train: 0.8333, Val: 0.7958, Test: 0.7915, Best time: 70.4164
Epoch: 016/100, Runtime 2.922665, Loss 0.482305, forward nfe 4172, backward nfe 10605, Train: 0.8500, Val: 0.8035, Test: 0.8007, Best time: 45.3299
Epoch: 017/100, Runtime 3.428017, Loss 0.437886, forward nfe 4410, backward nfe 10891, Train: 0.8500, Val: 0.8049, Test: 0.8004, Best time: 57.0211
Epoch: 018/100, Runtime 4.691273, Loss 0.426621, forward nfe 4648, backward nfe 11306, Train: 0.8500, Val: 0.8049, Test: 0.8004, Best time: 25.0000
Epoch: 019/100, Runtime 4.791948, Loss 0.387673, forward nfe 4874, backward nfe 11734, Train: 0.8500, Val: 0.8049, Test: 0.8004, Best time: 25.0000
Epoch: 020/100, Runtime 4.815649, Loss 0.376656, forward nfe 5094, backward nfe 12164, Train: 0.8500, Val: 0.8049, Test: 0.8004, Best time: 25.0000
Epoch: 021/100, Runtime 4.267360, Loss 0.342942, forward nfe 5314, backward nfe 12541, Train: 0.9000, Val: 0.8056, Test: 0.8012, Best time: 73.7725
Epoch: 022/100, Runtime 3.246752, Loss 0.324669, forward nfe 5534, backward nfe 12813, Train: 0.9167, Val: 0.8076, Test: 0.8022, Best time: 51.2409
Epoch: 023/100, Runtime 2.698647, Loss 0.327993, forward nfe 5754, backward nfe 13032, Train: 0.9167, Val: 0.8076, Test: 0.8022, Best time: 25.0000
Epoch: 024/100, Runtime 1.398603, Loss 0.290518, forward nfe 5968, backward nfe 13120, Train: 0.9167, Val: 0.8076, Test: 0.8022, Best time: 25.0000
Epoch: 025/100, Runtime 1.497465, Loss 0.325361, forward nfe 6182, backward nfe 13222, Train: 0.9167, Val: 0.8076, Test: 0.8022, Best time: 25.0000
Epoch: 026/100, Runtime 2.143759, Loss 0.301363, forward nfe 6384, backward nfe 13388, Train: 0.9000, Val: 0.8139, Test: 0.7989, Best time: 75.3648
Epoch: 027/100, Runtime 2.079061, Loss 0.280223, forward nfe 6586, backward nfe 13549, Train: 0.9000, Val: 0.8139, Test: 0.7989, Best time: 25.0000
Epoch: 028/100, Runtime 1.961822, Loss 0.277631, forward nfe 6788, backward nfe 13699, Train: 0.9000, Val: 0.8139, Test: 0.7989, Best time: 25.0000
Epoch: 029/100, Runtime 1.639474, Loss 0.273855, forward nfe 6984, backward nfe 13818, Train: 0.9000, Val: 0.8139, Test: 0.7989, Best time: 25.0000
Epoch: 030/100, Runtime 1.029700, Loss 0.221442, forward nfe 7174, backward nfe 13877, Train: 0.9000, Val: 0.8139, Test: 0.7989, Best time: 25.0000
Epoch: 031/100, Runtime 1.106157, Loss 0.242769, forward nfe 7358, backward nfe 13944, Train: 0.9000, Val: 0.8139, Test: 0.7989, Best time: 25.0000
Epoch: 032/100, Runtime 1.356710, Loss 0.235725, forward nfe 7530, backward nfe 14039, Train: 0.9000, Val: 0.8139, Test: 0.7989, Best time: 25.0000
Epoch: 033/100, Runtime 1.342909, Loss 0.198376, forward nfe 7702, backward nfe 14135, Train: 0.9000, Val: 0.8139, Test: 0.7989, Best time: 25.0000
Epoch: 034/100, Runtime 1.137991, Loss 0.217775, forward nfe 7868, backward nfe 14209, Train: 0.9000, Val: 0.8139, Test: 0.7989, Best time: 25.0000
Epoch: 035/100, Runtime 0.663952, Loss 0.184376, forward nfe 8034, backward nfe 14231, Train: 0.9000, Val: 0.8139, Test: 0.7989, Best time: 25.0000
Epoch: 036/100, Runtime 0.947543, Loss 0.202046, forward nfe 8206, backward nfe 14285, Train: 0.9000, Val: 0.8139, Test: 0.7989, Best time: 25.0000
Epoch: 037/100, Runtime 0.851610, Loss 0.153942, forward nfe 8372, backward nfe 14330, Train: 0.9000, Val: 0.8139, Test: 0.7989, Best time: 25.0000
Epoch: 038/100, Runtime 0.889531, Loss 0.170707, forward nfe 8538, backward nfe 14377, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 56.6155
Epoch: 039/100, Runtime 0.955775, Loss 0.198122, forward nfe 8704, backward nfe 14432, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 040/100, Runtime 0.936425, Loss 0.143175, forward nfe 8870, backward nfe 14488, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 041/100, Runtime 1.002730, Loss 0.177654, forward nfe 9018, backward nfe 14550, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 042/100, Runtime 0.858718, Loss 0.161127, forward nfe 9172, backward nfe 14599, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 043/100, Runtime 0.745244, Loss 0.154038, forward nfe 9320, backward nfe 14637, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 044/100, Runtime 0.699501, Loss 0.146187, forward nfe 9462, backward nfe 14669, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 045/100, Runtime 0.684890, Loss 0.165762, forward nfe 9610, backward nfe 14699, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 046/100, Runtime 0.633538, Loss 0.149941, forward nfe 9758, backward nfe 14723, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 047/100, Runtime 0.577733, Loss 0.158550, forward nfe 9906, backward nfe 14745, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 048/100, Runtime 0.571702, Loss 0.126650, forward nfe 10042, backward nfe 14766, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 049/100, Runtime 0.586232, Loss 0.131737, forward nfe 10178, backward nfe 14790, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 050/100, Runtime 0.578978, Loss 0.176516, forward nfe 10314, backward nfe 14813, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 051/100, Runtime 0.530457, Loss 0.100348, forward nfe 10450, backward nfe 14831, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 052/100, Runtime 0.538997, Loss 0.118785, forward nfe 10586, backward nfe 14851, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 053/100, Runtime 0.536869, Loss 0.168518, forward nfe 10722, backward nfe 14870, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 054/100, Runtime 0.522763, Loss 0.100576, forward nfe 10858, backward nfe 14887, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 055/100, Runtime 0.497190, Loss 0.091336, forward nfe 10994, backward nfe 14902, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 056/100, Runtime 0.521808, Loss 0.193415, forward nfe 11130, backward nfe 14919, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 057/100, Runtime 0.506902, Loss 0.091603, forward nfe 11266, backward nfe 14934, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 058/100, Runtime 0.502593, Loss 0.081527, forward nfe 11402, backward nfe 14949, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 059/100, Runtime 0.514630, Loss 0.144314, forward nfe 11538, backward nfe 14965, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 060/100, Runtime 0.502111, Loss 0.095985, forward nfe 11674, backward nfe 14982, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 061/100, Runtime 0.499506, Loss 0.085771, forward nfe 11804, backward nfe 14998, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 062/100, Runtime 0.482354, Loss 0.078808, forward nfe 11934, backward nfe 15012, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 063/100, Runtime 0.494249, Loss 0.076620, forward nfe 12064, backward nfe 15026, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 064/100, Runtime 0.508326, Loss 0.071846, forward nfe 12194, backward nfe 15042, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 065/100, Runtime 0.492837, Loss 0.072055, forward nfe 12324, backward nfe 15056, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 066/100, Runtime 0.505936, Loss 0.103885, forward nfe 12454, backward nfe 15072, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 067/100, Runtime 0.506705, Loss 0.056633, forward nfe 12584, backward nfe 15087, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 068/100, Runtime 0.487659, Loss 0.122240, forward nfe 12714, backward nfe 15101, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 069/100, Runtime 0.482893, Loss 0.106031, forward nfe 12844, backward nfe 15115, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 070/100, Runtime 0.449297, Loss 0.052647, forward nfe 12974, backward nfe 15128, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 071/100, Runtime 0.511317, Loss 0.148497, forward nfe 13098, backward nfe 15147, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 072/100, Runtime 0.449171, Loss 0.113006, forward nfe 13216, backward nfe 15162, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 073/100, Runtime 0.440357, Loss 0.062316, forward nfe 13334, backward nfe 15175, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 074/100, Runtime 0.442879, Loss 0.074271, forward nfe 13452, backward nfe 15189, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 075/100, Runtime 0.458641, Loss 0.114211, forward nfe 13570, backward nfe 15204, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 076/100, Runtime 0.448159, Loss 0.087574, forward nfe 13688, backward nfe 15218, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 077/100, Runtime 0.473164, Loss 0.091311, forward nfe 13806, backward nfe 15235, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 078/100, Runtime 0.457301, Loss 0.077015, forward nfe 13924, backward nfe 15249, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 079/100, Runtime 0.447994, Loss 0.067399, forward nfe 14042, backward nfe 15263, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 080/100, Runtime 0.448676, Loss 0.068446, forward nfe 14160, backward nfe 15277, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 081/100, Runtime 0.468603, Loss 0.092654, forward nfe 14278, backward nfe 15293, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 082/100, Runtime 0.454425, Loss 0.066251, forward nfe 14396, backward nfe 15308, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 083/100, Runtime 0.473516, Loss 0.075707, forward nfe 14514, backward nfe 15324, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 084/100, Runtime 0.436401, Loss 0.060402, forward nfe 14632, backward nfe 15337, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 085/100, Runtime 0.443899, Loss 0.080568, forward nfe 14750, backward nfe 15351, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 086/100, Runtime 0.443898, Loss 0.077934, forward nfe 14868, backward nfe 15365, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 087/100, Runtime 0.448499, Loss 0.072382, forward nfe 14986, backward nfe 15380, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 088/100, Runtime 0.411161, Loss 0.055637, forward nfe 15098, backward nfe 15392, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 089/100, Runtime 0.418182, Loss 0.070484, forward nfe 15210, backward nfe 15405, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 090/100, Runtime 0.416404, Loss 0.037951, forward nfe 15322, backward nfe 15418, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 091/100, Runtime 0.412333, Loss 0.037422, forward nfe 15434, backward nfe 15432, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 092/100, Runtime 0.406339, Loss 0.096633, forward nfe 15540, backward nfe 15445, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 093/100, Runtime 0.434022, Loss 0.083334, forward nfe 15646, backward nfe 15460, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 094/100, Runtime 0.397355, Loss 0.056285, forward nfe 15752, backward nfe 15472, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 095/100, Runtime 0.399004, Loss 0.052607, forward nfe 15858, backward nfe 15484, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 096/100, Runtime 0.407551, Loss 0.048304, forward nfe 15964, backward nfe 15497, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 097/100, Runtime 0.414993, Loss 0.067326, forward nfe 16070, backward nfe 15510, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 098/100, Runtime 0.435604, Loss 0.069924, forward nfe 16176, backward nfe 15524, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
Epoch: 099/100, Runtime 0.419953, Loss 0.029865, forward nfe 16282, backward nfe 15538, Train: 0.9667, Val: 0.8160, Test: 0.8036, Best time: 25.0000
best val accuracy 0.815972 with test accuracy 0.803645 at epoch 38 and best time 25.000000