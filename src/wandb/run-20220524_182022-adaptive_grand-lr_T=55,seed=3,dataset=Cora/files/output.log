****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 4.727582, Loss 1.948642, forward nfe 110, backward nfe 0, Train: 0.3000, Val: 0.2074, Test: 0.2030, Best time: 0.0948
Epoch: 002/100, Runtime 4.591365, Loss 1.982125, forward nfe 540, backward nfe 0, Train: 0.3000, Val: 0.2074, Test: 0.2030, Best time: 55.0000
Epoch: 003/100, Runtime 4.478106, Loss 1.935665, forward nfe 958, backward nfe 0, Train: 0.3000, Val: 0.2074, Test: 0.2030, Best time: 55.0000
Epoch: 004/100, Runtime 4.319527, Loss 1.891186, forward nfe 1364, backward nfe 0, Train: 0.3286, Val: 0.3059, Test: 0.2954, Best time: 0.9631
Epoch: 005/100, Runtime 4.298779, Loss 1.787554, forward nfe 1758, backward nfe 0, Train: 0.6214, Val: 0.5294, Test: 0.5503, Best time: 55.0438
Epoch: 006/100, Runtime 4.264409, Loss 1.619332, forward nfe 2146, backward nfe 0, Train: 0.7143, Val: 0.6566, Test: 0.6680, Best time: 18.1080
Epoch: 007/100, Runtime 4.240940, Loss 1.446426, forward nfe 2522, backward nfe 0, Train: 0.7071, Val: 0.7154, Test: 0.7371, Best time: 96.3577
Epoch: 008/100, Runtime 4.247880, Loss 1.260386, forward nfe 2892, backward nfe 0, Train: 0.7714, Val: 0.7287, Test: 0.7492, Best time: 8.4976
Epoch: 009/100, Runtime 4.159366, Loss 1.072441, forward nfe 3262, backward nfe 0, Train: 0.8429, Val: 0.7441, Test: 0.7777, Best time: 8.8471
Epoch: 010/100, Runtime 4.096969, Loss 0.918921, forward nfe 3626, backward nfe 0, Train: 0.9000, Val: 0.7824, Test: 0.8081, Best time: 12.4158
Epoch: 011/100, Runtime 3.972350, Loss 0.747937, forward nfe 3984, backward nfe 0, Train: 0.8857, Val: 0.7971, Test: 0.8223, Best time: 101.9906
Epoch: 012/100, Runtime 3.684396, Loss 0.592958, forward nfe 4324, backward nfe 0, Train: 0.8857, Val: 0.7971, Test: 0.8223, Best time: 55.0000
Epoch: 013/100, Runtime 3.761534, Loss 0.517270, forward nfe 4652, backward nfe 0, Train: 0.9357, Val: 0.8007, Test: 0.8305, Best time: 19.0223
Epoch: 014/100, Runtime 3.699567, Loss 0.412151, forward nfe 4980, backward nfe 0, Train: 0.9500, Val: 0.8110, Test: 0.8386, Best time: 20.0703
Epoch: 015/100, Runtime 3.497893, Loss 0.364111, forward nfe 5290, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 28.7862
Epoch: 016/100, Runtime 3.432444, Loss 0.373609, forward nfe 5594, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 55.0000
Epoch: 017/100, Runtime 3.388500, Loss 0.326609, forward nfe 5898, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 55.0000
Epoch: 018/100, Runtime 3.166849, Loss 0.286130, forward nfe 6190, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 55.0000
Epoch: 019/100, Runtime 3.194078, Loss 0.256110, forward nfe 6470, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 55.0000
Epoch: 020/100, Runtime 3.139870, Loss 0.313067, forward nfe 6750, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 55.0000
Epoch: 021/100, Runtime 2.877725, Loss 0.240940, forward nfe 7012, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 55.0000
Epoch: 022/100, Runtime 2.846375, Loss 0.222452, forward nfe 7268, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 55.0000
Epoch: 023/100, Runtime 2.845747, Loss 0.268550, forward nfe 7524, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 55.0000
Epoch: 024/100, Runtime 2.758894, Loss 0.184896, forward nfe 7780, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 55.0000
Epoch: 025/100, Runtime 2.691288, Loss 0.196297, forward nfe 8024, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 55.0000
Epoch: 026/100, Runtime 2.528768, Loss 0.224199, forward nfe 8256, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 55.0000
Epoch: 027/100, Runtime 2.652683, Loss 0.228283, forward nfe 8482, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 55.0000
Epoch: 028/100, Runtime 2.556025, Loss 0.172153, forward nfe 8714, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 55.0000
Epoch: 029/100, Runtime 2.467897, Loss 0.220113, forward nfe 8934, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 55.0000
Epoch: 030/100, Runtime 2.363009, Loss 0.218879, forward nfe 9154, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 55.0000
Epoch: 031/100, Runtime 2.546876, Loss 0.155361, forward nfe 9362, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8497, Best time: 55.0000
Epoch: 032/100, Runtime 2.437073, Loss 0.161101, forward nfe 9576, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 141.7547
Epoch: 033/100, Runtime 2.440529, Loss 0.154420, forward nfe 9784, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 034/100, Runtime 2.392554, Loss 0.199603, forward nfe 9992, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 035/100, Runtime 2.250060, Loss 0.149630, forward nfe 10200, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 036/100, Runtime 2.262658, Loss 0.158851, forward nfe 10402, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 037/100, Runtime 2.269043, Loss 0.116546, forward nfe 10604, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 038/100, Runtime 2.268710, Loss 0.151924, forward nfe 10800, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 039/100, Runtime 2.234941, Loss 0.176277, forward nfe 10996, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 040/100, Runtime 2.256333, Loss 0.124558, forward nfe 11192, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 041/100, Runtime 2.199442, Loss 0.124581, forward nfe 11388, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 042/100, Runtime 2.345698, Loss 0.126885, forward nfe 11584, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 043/100, Runtime 2.327831, Loss 0.153784, forward nfe 11780, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 044/100, Runtime 2.332893, Loss 0.106822, forward nfe 11976, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 045/100, Runtime 2.324996, Loss 0.104604, forward nfe 12172, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 046/100, Runtime 2.304092, Loss 0.118773, forward nfe 12368, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 047/100, Runtime 2.285112, Loss 0.114987, forward nfe 12564, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 048/100, Runtime 2.249372, Loss 0.082678, forward nfe 12760, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 049/100, Runtime 2.278659, Loss 0.106802, forward nfe 12950, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 050/100, Runtime 2.258965, Loss 0.084046, forward nfe 13140, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 051/100, Runtime 2.203831, Loss 0.089606, forward nfe 13330, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 052/100, Runtime 2.243907, Loss 0.089757, forward nfe 13520, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 053/100, Runtime 2.182045, Loss 0.123678, forward nfe 13710, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 054/100, Runtime 2.133702, Loss 0.122177, forward nfe 13900, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 055/100, Runtime 2.202578, Loss 0.091387, forward nfe 14090, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 056/100, Runtime 2.190519, Loss 0.096614, forward nfe 14280, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 057/100, Runtime 2.191519, Loss 0.109873, forward nfe 14470, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 058/100, Runtime 2.090160, Loss 0.060423, forward nfe 14660, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 059/100, Runtime 2.226092, Loss 0.107301, forward nfe 14850, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 060/100, Runtime 2.180701, Loss 0.071492, forward nfe 15040, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 061/100, Runtime 2.155163, Loss 0.059001, forward nfe 15230, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 062/100, Runtime 2.188274, Loss 0.062444, forward nfe 15420, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 063/100, Runtime 2.178002, Loss 0.092471, forward nfe 15610, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 064/100, Runtime 2.194654, Loss 0.051851, forward nfe 15800, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 065/100, Runtime 2.100313, Loss 0.082733, forward nfe 15990, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 066/100, Runtime 2.189984, Loss 0.052186, forward nfe 16180, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 067/100, Runtime 2.219762, Loss 0.067625, forward nfe 16364, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 068/100, Runtime 2.162328, Loss 0.031301, forward nfe 16548, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 069/100, Runtime 2.152454, Loss 0.062881, forward nfe 16732, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 070/100, Runtime 2.106506, Loss 0.067208, forward nfe 16916, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 071/100, Runtime 2.180043, Loss 0.048293, forward nfe 17094, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 072/100, Runtime 2.063324, Loss 0.064498, forward nfe 17272, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 073/100, Runtime 2.086403, Loss 0.050684, forward nfe 17450, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 074/100, Runtime 2.061125, Loss 0.024387, forward nfe 17622, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 075/100, Runtime 2.043571, Loss 0.033274, forward nfe 17794, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 076/100, Runtime 1.930907, Loss 0.051341, forward nfe 17966, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 077/100, Runtime 1.910997, Loss 0.064459, forward nfe 18126, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 078/100, Runtime 1.914997, Loss 0.054479, forward nfe 18286, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 079/100, Runtime 1.913885, Loss 0.047689, forward nfe 18452, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 080/100, Runtime 0.658872, Loss 0.084155, forward nfe 18618, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 081/100, Runtime 0.588917, Loss 0.073355, forward nfe 18784, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 082/100, Runtime 0.602256, Loss 0.081543, forward nfe 18944, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 083/100, Runtime 0.687729, Loss 0.031121, forward nfe 19104, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 084/100, Runtime 0.611983, Loss 0.051179, forward nfe 19264, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 085/100, Runtime 0.595427, Loss 0.062239, forward nfe 19424, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 086/100, Runtime 0.687761, Loss 0.054197, forward nfe 19584, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 087/100, Runtime 0.597980, Loss 0.045041, forward nfe 19744, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 088/100, Runtime 0.586970, Loss 0.062167, forward nfe 19904, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 089/100, Runtime 0.690445, Loss 0.040751, forward nfe 20064, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 090/100, Runtime 0.596746, Loss 0.033536, forward nfe 20224, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 091/100, Runtime 0.673789, Loss 0.068206, forward nfe 20384, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 092/100, Runtime 0.608303, Loss 0.021379, forward nfe 20544, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 093/100, Runtime 0.575769, Loss 0.026712, forward nfe 20704, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 094/100, Runtime 0.602301, Loss 0.035897, forward nfe 20864, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 095/100, Runtime 0.722498, Loss 0.036755, forward nfe 21030, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 096/100, Runtime 0.601492, Loss 0.049500, forward nfe 21196, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 097/100, Runtime 0.702837, Loss 0.054799, forward nfe 21362, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 098/100, Runtime 0.642326, Loss 0.037070, forward nfe 21522, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
Epoch: 099/100, Runtime 0.668907, Loss 0.040927, forward nfe 21682, backward nfe 0, Train: 0.9857, Val: 0.8243, Test: 0.8396, Best time: 55.0000
best val accuracy 0.824265 with test accuracy 0.839594 at epoch 32 and best time 55.000000