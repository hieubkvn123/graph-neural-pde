/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 1.047031, Loss 1.951377, forward nfe 44, backward nfe 0, Train: 0.6214, Val: 0.4074, Test: 0.3898, Best time: 0.0986
Epoch: 002/100, Runtime 1.044305, Loss 1.850221, forward nfe 168, backward nfe 0, Train: 0.7857, Val: 0.5882, Test: 0.5848, Best time: 5.4329
Epoch: 003/100, Runtime 1.061335, Loss 1.655489, forward nfe 304, backward nfe 0, Train: 0.8571, Val: 0.6669, Test: 0.6751, Best time: 7.2511
Epoch: 004/100, Runtime 1.065393, Loss 1.415959, forward nfe 434, backward nfe 0, Train: 0.8500, Val: 0.7397, Test: 0.7401, Best time: 21.1155
Epoch: 005/100, Runtime 1.022464, Loss 1.153251, forward nfe 564, backward nfe 0, Train: 0.8643, Val: 0.7662, Test: 0.7756, Best time: 32.9713
Epoch: 006/100, Runtime 1.090958, Loss 0.893999, forward nfe 694, backward nfe 0, Train: 0.9000, Val: 0.7963, Test: 0.7929, Best time: 10.0000
Epoch: 007/100, Runtime 1.016791, Loss 0.645105, forward nfe 824, backward nfe 0, Train: 0.9000, Val: 0.8118, Test: 0.8091, Best time: 34.3437
Epoch: 008/100, Runtime 1.153014, Loss 0.479345, forward nfe 954, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8071, Best time: 22.0672
Epoch: 009/100, Runtime 1.083865, Loss 0.355752, forward nfe 1084, backward nfe 0, Train: 0.9286, Val: 0.8221, Test: 0.8142, Best time: 22.8096
Epoch: 010/100, Runtime 0.955027, Loss 0.263303, forward nfe 1208, backward nfe 0, Train: 0.9500, Val: 0.8235, Test: 0.8142, Best time: 14.0001
Epoch: 011/100, Runtime 0.954326, Loss 0.225933, forward nfe 1320, backward nfe 0, Train: 0.9571, Val: 0.8250, Test: 0.8234, Best time: 24.8155
Epoch: 012/100, Runtime 0.972025, Loss 0.185375, forward nfe 1432, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 013/100, Runtime 0.967380, Loss 0.130862, forward nfe 1544, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 014/100, Runtime 0.964090, Loss 0.109354, forward nfe 1656, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 015/100, Runtime 0.907293, Loss 0.200026, forward nfe 1768, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 016/100, Runtime 0.949961, Loss 0.110408, forward nfe 1874, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 017/100, Runtime 0.919310, Loss 0.102711, forward nfe 1974, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 018/100, Runtime 0.848220, Loss 0.131847, forward nfe 2074, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 019/100, Runtime 0.863627, Loss 0.115555, forward nfe 2174, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 020/100, Runtime 0.915796, Loss 0.157921, forward nfe 2274, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 021/100, Runtime 0.824084, Loss 0.155361, forward nfe 2374, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 022/100, Runtime 0.729258, Loss 0.139114, forward nfe 2468, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 023/100, Runtime 0.797160, Loss 0.173716, forward nfe 2562, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 024/100, Runtime 0.747333, Loss 0.143629, forward nfe 2656, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 025/100, Runtime 0.788190, Loss 0.146461, forward nfe 2750, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 026/100, Runtime 0.813934, Loss 0.125629, forward nfe 2844, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 027/100, Runtime 0.713531, Loss 0.140613, forward nfe 2932, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 028/100, Runtime 0.809029, Loss 0.129335, forward nfe 3020, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 029/100, Runtime 0.547820, Loss 0.116101, forward nfe 3108, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 030/100, Runtime 0.971130, Loss 0.145775, forward nfe 3190, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 031/100, Runtime 0.929966, Loss 0.097508, forward nfe 3272, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 032/100, Runtime 0.963317, Loss 0.107777, forward nfe 3354, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 033/100, Runtime 0.936052, Loss 0.136242, forward nfe 3436, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 034/100, Runtime 0.976966, Loss 0.122891, forward nfe 3518, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 035/100, Runtime 0.950264, Loss 0.101821, forward nfe 3600, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 036/100, Runtime 0.941370, Loss 0.126864, forward nfe 3682, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 037/100, Runtime 0.989611, Loss 0.127079, forward nfe 3764, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 038/100, Runtime 1.049031, Loss 0.081307, forward nfe 3846, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 039/100, Runtime 1.011838, Loss 0.084932, forward nfe 3928, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 040/100, Runtime 1.030317, Loss 0.076714, forward nfe 4010, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 041/100, Runtime 1.030856, Loss 0.071919, forward nfe 4092, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 042/100, Runtime 0.949043, Loss 0.068757, forward nfe 4174, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 043/100, Runtime 0.969832, Loss 0.108770, forward nfe 4250, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 044/100, Runtime 0.914148, Loss 0.075831, forward nfe 4326, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 045/100, Runtime 0.932132, Loss 0.081405, forward nfe 4402, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 046/100, Runtime 0.909875, Loss 0.103219, forward nfe 4478, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 047/100, Runtime 0.917965, Loss 0.066121, forward nfe 4554, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 048/100, Runtime 0.948242, Loss 0.064159, forward nfe 4630, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 049/100, Runtime 0.921118, Loss 0.077658, forward nfe 4706, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 050/100, Runtime 0.935921, Loss 0.098401, forward nfe 4782, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 051/100, Runtime 0.990184, Loss 0.079497, forward nfe 4858, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 052/100, Runtime 0.869157, Loss 0.069013, forward nfe 4928, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 053/100, Runtime 0.897745, Loss 0.070424, forward nfe 4998, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 054/100, Runtime 0.862386, Loss 0.106274, forward nfe 5068, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 055/100, Runtime 0.793646, Loss 0.094992, forward nfe 5138, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 056/100, Runtime 0.899350, Loss 0.071739, forward nfe 5208, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 057/100, Runtime 0.959652, Loss 0.105158, forward nfe 5278, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 058/100, Runtime 0.878311, Loss 0.065922, forward nfe 5348, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 059/100, Runtime 0.867004, Loss 0.083156, forward nfe 5418, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 060/100, Runtime 0.874604, Loss 0.073125, forward nfe 5488, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 061/100, Runtime 0.850410, Loss 0.070286, forward nfe 5558, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 062/100, Runtime 0.845204, Loss 0.059739, forward nfe 5628, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 063/100, Runtime 0.688012, Loss 0.054266, forward nfe 5698, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 064/100, Runtime 0.610694, Loss 0.039320, forward nfe 5768, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 065/100, Runtime 0.614219, Loss 0.058947, forward nfe 5838, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 066/100, Runtime 0.612679, Loss 0.067680, forward nfe 5908, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 067/100, Runtime 0.610200, Loss 0.056654, forward nfe 5978, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 068/100, Runtime 0.641327, Loss 0.058599, forward nfe 6048, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 069/100, Runtime 0.647956, Loss 0.042015, forward nfe 6118, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 070/100, Runtime 0.603317, Loss 0.072594, forward nfe 6188, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 071/100, Runtime 0.682163, Loss 0.060874, forward nfe 6258, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 072/100, Runtime 0.633628, Loss 0.095749, forward nfe 6328, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 073/100, Runtime 0.644498, Loss 0.038881, forward nfe 6398, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 074/100, Runtime 0.698025, Loss 0.101675, forward nfe 6468, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 075/100, Runtime 0.644484, Loss 0.060236, forward nfe 6538, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 076/100, Runtime 0.649421, Loss 0.101527, forward nfe 6608, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 077/100, Runtime 0.649042, Loss 0.069830, forward nfe 6678, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 078/100, Runtime 0.740526, Loss 0.077543, forward nfe 6748, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 079/100, Runtime 0.639856, Loss 0.089272, forward nfe 6818, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 080/100, Runtime 0.674904, Loss 0.057401, forward nfe 6888, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 081/100, Runtime 0.685796, Loss 0.074922, forward nfe 6964, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 082/100, Runtime 0.711545, Loss 0.061978, forward nfe 7040, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 083/100, Runtime 0.751912, Loss 0.054556, forward nfe 7116, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 084/100, Runtime 0.721895, Loss 0.056104, forward nfe 7192, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 085/100, Runtime 0.847176, Loss 0.052893, forward nfe 7274, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 086/100, Runtime 0.773044, Loss 0.062913, forward nfe 7368, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 087/100, Runtime 0.807210, Loss 0.074087, forward nfe 7456, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 088/100, Runtime 0.721437, Loss 0.084051, forward nfe 7544, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 089/100, Runtime 0.891652, Loss 0.036968, forward nfe 7632, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 090/100, Runtime 0.927250, Loss 0.074675, forward nfe 7738, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 091/100, Runtime 0.854489, Loss 0.055568, forward nfe 7844, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 092/100, Runtime 0.894228, Loss 0.053182, forward nfe 7950, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 093/100, Runtime 0.973123, Loss 0.039309, forward nfe 8056, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 094/100, Runtime 1.064333, Loss 0.050902, forward nfe 8168, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 095/100, Runtime 0.997488, Loss 0.046439, forward nfe 8280, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 096/100, Runtime 1.149202, Loss 0.046432, forward nfe 8392, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 097/100, Runtime 1.210408, Loss 0.029773, forward nfe 8516, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 098/100, Runtime 1.191350, Loss 0.039027, forward nfe 8652, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
Epoch: 099/100, Runtime 1.268115, Loss 0.069340, forward nfe 8794, backward nfe 0, Train: 0.9643, Val: 0.8257, Test: 0.8274, Best time: 10.0000
best val accuracy 0.825735 with test accuracy 0.827411 at epoch 12 and best time 10.000000