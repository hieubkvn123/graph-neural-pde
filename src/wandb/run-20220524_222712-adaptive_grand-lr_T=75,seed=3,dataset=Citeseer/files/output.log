/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.821119, Loss 1.793872, forward nfe 200, backward nfe 0, Train: 0.2667, Val: 0.2478, Test: 0.2419, Best time: 0.0410
Epoch: 002/100, Runtime 0.732441, Loss 1.786858, forward nfe 846, backward nfe 0, Train: 0.4417, Val: 0.3667, Test: 0.3677, Best time: 0.3194
Epoch: 003/100, Runtime 0.755766, Loss 1.769575, forward nfe 1510, backward nfe 0, Train: 0.5250, Val: 0.5130, Test: 0.5065, Best time: 0.8612
Epoch: 004/100, Runtime 0.744512, Loss 1.746294, forward nfe 2150, backward nfe 0, Train: 0.6417, Val: 0.5884, Test: 0.5710, Best time: 0.8748
Epoch: 005/100, Runtime 0.739672, Loss 1.698725, forward nfe 2796, backward nfe 0, Train: 0.7250, Val: 0.6913, Test: 0.6742, Best time: 2.1191
Epoch: 006/100, Runtime 0.706464, Loss 1.655803, forward nfe 3436, backward nfe 0, Train: 0.7417, Val: 0.7384, Test: 0.7161, Best time: 8.8782
Epoch: 007/100, Runtime 0.701676, Loss 1.639387, forward nfe 4052, backward nfe 0, Train: 0.7333, Val: 0.7399, Test: 0.7274, Best time: 5.6652
Epoch: 008/100, Runtime 0.717293, Loss 1.616304, forward nfe 4668, backward nfe 0, Train: 0.7333, Val: 0.7399, Test: 0.7274, Best time: 75.0000
Epoch: 009/100, Runtime 0.672004, Loss 1.569992, forward nfe 5266, backward nfe 0, Train: 0.7333, Val: 0.7399, Test: 0.7274, Best time: 75.0000
Epoch: 010/100, Runtime 0.692588, Loss 1.583453, forward nfe 5858, backward nfe 0, Train: 0.7333, Val: 0.7399, Test: 0.7274, Best time: 75.0000
Epoch: 011/100, Runtime 0.650500, Loss 1.557896, forward nfe 6456, backward nfe 0, Train: 0.7333, Val: 0.7399, Test: 0.7274, Best time: 75.0000
Epoch: 012/100, Runtime 0.651801, Loss 1.513528, forward nfe 7030, backward nfe 0, Train: 0.7333, Val: 0.7399, Test: 0.7274, Best time: 75.0000
Epoch: 013/100, Runtime 0.633595, Loss 1.536325, forward nfe 7598, backward nfe 0, Train: 0.7333, Val: 0.7399, Test: 0.7274, Best time: 75.0000
Epoch: 014/100, Runtime 0.651324, Loss 1.489895, forward nfe 8160, backward nfe 0, Train: 0.7333, Val: 0.7399, Test: 0.7274, Best time: 75.0000
Epoch: 015/100, Runtime 0.620622, Loss 1.387700, forward nfe 8728, backward nfe 0, Train: 0.7333, Val: 0.7399, Test: 0.7274, Best time: 75.0000
Epoch: 016/100, Runtime 0.631605, Loss 1.362167, forward nfe 9284, backward nfe 0, Train: 0.7333, Val: 0.7399, Test: 0.7274, Best time: 75.0000
Epoch: 017/100, Runtime 0.599620, Loss 1.335753, forward nfe 9828, backward nfe 0, Train: 0.7417, Val: 0.7420, Test: 0.7226, Best time: 59.2807
Epoch: 018/100, Runtime 0.608146, Loss 1.283550, forward nfe 10360, backward nfe 0, Train: 0.7417, Val: 0.7420, Test: 0.7226, Best time: 75.0000
Epoch: 019/100, Runtime 0.603361, Loss 1.263838, forward nfe 10880, backward nfe 0, Train: 0.7417, Val: 0.7420, Test: 0.7226, Best time: 75.0000
Epoch: 020/100, Runtime 0.566765, Loss 1.178059, forward nfe 11400, backward nfe 0, Train: 0.7417, Val: 0.7420, Test: 0.7226, Best time: 75.0000
Epoch: 021/100, Runtime 0.573747, Loss 1.323103, forward nfe 11920, backward nfe 0, Train: 0.7083, Val: 0.7486, Test: 0.7323, Best time: 118.0008
Epoch: 022/100, Runtime 0.559444, Loss 1.221655, forward nfe 12422, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 50.1522
Epoch: 023/100, Runtime 0.541580, Loss 1.185061, forward nfe 12912, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 024/100, Runtime 0.538060, Loss 1.251456, forward nfe 13396, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 025/100, Runtime 0.574644, Loss 1.143871, forward nfe 13886, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 026/100, Runtime 0.510960, Loss 1.155861, forward nfe 14358, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 027/100, Runtime 0.516825, Loss 1.277549, forward nfe 14818, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 028/100, Runtime 0.522593, Loss 1.106427, forward nfe 15284, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 029/100, Runtime 0.530830, Loss 1.199790, forward nfe 15744, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 030/100, Runtime 0.507726, Loss 1.185837, forward nfe 16198, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 031/100, Runtime 0.510545, Loss 1.188859, forward nfe 16640, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 032/100, Runtime 0.505845, Loss 1.184180, forward nfe 17076, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 033/100, Runtime 0.493665, Loss 1.189163, forward nfe 17500, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 034/100, Runtime 0.493790, Loss 1.069852, forward nfe 17924, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 035/100, Runtime 0.457925, Loss 1.171655, forward nfe 18336, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 036/100, Runtime 0.462964, Loss 1.045048, forward nfe 18742, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 037/100, Runtime 0.452701, Loss 1.143140, forward nfe 19142, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 038/100, Runtime 0.457468, Loss 1.156419, forward nfe 19536, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 039/100, Runtime 0.447734, Loss 1.123024, forward nfe 19924, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 040/100, Runtime 0.442046, Loss 1.124397, forward nfe 20306, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 041/100, Runtime 0.447715, Loss 1.089186, forward nfe 20688, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 042/100, Runtime 0.467068, Loss 1.068545, forward nfe 21070, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 043/100, Runtime 0.427582, Loss 1.119330, forward nfe 21446, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 044/100, Runtime 0.421987, Loss 1.204610, forward nfe 21804, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 045/100, Runtime 0.430622, Loss 1.143407, forward nfe 22162, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 046/100, Runtime 0.429722, Loss 1.128430, forward nfe 22520, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 047/100, Runtime 0.421795, Loss 1.161488, forward nfe 22872, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 048/100, Runtime 0.408241, Loss 1.267031, forward nfe 23224, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 049/100, Runtime 0.405681, Loss 1.053927, forward nfe 23570, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 050/100, Runtime 0.410277, Loss 1.138786, forward nfe 23916, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 051/100, Runtime 0.404268, Loss 1.200493, forward nfe 24256, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 052/100, Runtime 0.400187, Loss 1.091946, forward nfe 24590, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 053/100, Runtime 0.394410, Loss 1.179776, forward nfe 24918, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 054/100, Runtime 0.391818, Loss 1.155203, forward nfe 25246, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 055/100, Runtime 0.389911, Loss 1.204532, forward nfe 25574, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 056/100, Runtime 0.374480, Loss 1.168980, forward nfe 25896, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 057/100, Runtime 0.374536, Loss 1.134681, forward nfe 26224, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 058/100, Runtime 0.371906, Loss 1.218435, forward nfe 26546, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 059/100, Runtime 0.377135, Loss 1.225562, forward nfe 26868, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 060/100, Runtime 0.387453, Loss 1.234025, forward nfe 27190, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 061/100, Runtime 0.391667, Loss 1.143481, forward nfe 27512, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 062/100, Runtime 0.375261, Loss 1.115139, forward nfe 27834, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 063/100, Runtime 0.376909, Loss 1.243590, forward nfe 28156, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 064/100, Runtime 0.516846, Loss 1.225874, forward nfe 28478, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 065/100, Runtime 0.394808, Loss 1.120453, forward nfe 28806, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 066/100, Runtime 0.399540, Loss 1.172642, forward nfe 29134, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 067/100, Runtime 0.398810, Loss 1.147387, forward nfe 29462, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 068/100, Runtime 0.402527, Loss 1.166715, forward nfe 29790, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 069/100, Runtime 0.385065, Loss 1.178043, forward nfe 30106, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 070/100, Runtime 0.404506, Loss 1.310301, forward nfe 30422, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 071/100, Runtime 0.397713, Loss 1.167250, forward nfe 30738, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 072/100, Runtime 0.372136, Loss 1.066817, forward nfe 31060, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 073/100, Runtime 0.374650, Loss 1.063506, forward nfe 31376, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 074/100, Runtime 0.366146, Loss 1.183756, forward nfe 31686, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 075/100, Runtime 0.371407, Loss 1.198711, forward nfe 31996, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 076/100, Runtime 0.370246, Loss 0.993293, forward nfe 32312, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 077/100, Runtime 0.367789, Loss 1.222435, forward nfe 32622, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 078/100, Runtime 0.370607, Loss 1.139760, forward nfe 32932, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 079/100, Runtime 0.380997, Loss 1.171719, forward nfe 33242, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 080/100, Runtime 0.371960, Loss 1.004327, forward nfe 33558, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 081/100, Runtime 0.381319, Loss 1.126227, forward nfe 33874, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 082/100, Runtime 0.371761, Loss 1.030158, forward nfe 34184, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 083/100, Runtime 0.378683, Loss 0.934363, forward nfe 34494, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 084/100, Runtime 0.362675, Loss 1.059496, forward nfe 34804, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 085/100, Runtime 0.369005, Loss 1.003033, forward nfe 35114, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 086/100, Runtime 0.380637, Loss 1.092526, forward nfe 35418, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 087/100, Runtime 0.378953, Loss 1.114796, forward nfe 35722, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 088/100, Runtime 0.372852, Loss 0.990515, forward nfe 36026, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 089/100, Runtime 0.381316, Loss 1.153918, forward nfe 36330, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 090/100, Runtime 0.369347, Loss 1.164270, forward nfe 36634, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 091/100, Runtime 0.382809, Loss 1.075243, forward nfe 36938, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 092/100, Runtime 0.376143, Loss 1.165763, forward nfe 37242, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 093/100, Runtime 0.377843, Loss 1.032230, forward nfe 37540, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 094/100, Runtime 0.375804, Loss 1.175826, forward nfe 37838, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 095/100, Runtime 0.363750, Loss 1.005556, forward nfe 38136, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 096/100, Runtime 0.364619, Loss 1.169093, forward nfe 38434, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 097/100, Runtime 0.370068, Loss 1.067875, forward nfe 38732, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 098/100, Runtime 0.356308, Loss 1.282785, forward nfe 39030, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
Epoch: 099/100, Runtime 0.396845, Loss 1.155672, forward nfe 39328, backward nfe 0, Train: 0.7583, Val: 0.7529, Test: 0.7339, Best time: 75.0000
best val accuracy 0.752899 with test accuracy 0.733871 at epoch 22 and best time 75.000000