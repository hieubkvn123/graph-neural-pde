/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 6.169286, Loss 1.948029, forward nfe 152, backward nfe 0, Train: 0.2571, Val: 0.2037, Test: 0.2041, Best time: 0.0917
Epoch: 002/100, Runtime 6.060302, Loss 1.882602, forward nfe 738, backward nfe 0, Train: 0.5714, Val: 0.6426, Test: 0.6254, Best time: 5.3100
Epoch: 003/100, Runtime 5.763343, Loss 1.841557, forward nfe 1300, backward nfe 0, Train: 0.6214, Val: 0.6875, Test: 0.6650, Best time: 17.0705
Epoch: 004/100, Runtime 5.722101, Loss 1.671988, forward nfe 1844, backward nfe 0, Train: 0.7286, Val: 0.7309, Test: 0.7198, Best time: 7.7219
Epoch: 005/100, Runtime 5.671778, Loss 1.396016, forward nfe 2376, backward nfe 0, Train: 0.7286, Val: 0.7309, Test: 0.7198, Best time: 80.0000
Epoch: 006/100, Runtime 5.385750, Loss 1.253786, forward nfe 2902, backward nfe 0, Train: 0.7286, Val: 0.7309, Test: 0.7198, Best time: 80.0000
Epoch: 007/100, Runtime 5.206965, Loss 1.079746, forward nfe 3422, backward nfe 0, Train: 0.8071, Val: 0.7978, Test: 0.7990, Best time: 8.4310
Epoch: 008/100, Runtime 5.335586, Loss 0.881439, forward nfe 3930, backward nfe 0, Train: 0.8071, Val: 0.7978, Test: 0.7990, Best time: 80.0000
Epoch: 009/100, Runtime 5.249378, Loss 0.865512, forward nfe 4432, backward nfe 0, Train: 0.8071, Val: 0.7978, Test: 0.7990, Best time: 80.0000
Epoch: 010/100, Runtime 5.013310, Loss 0.742457, forward nfe 4916, backward nfe 0, Train: 0.8071, Val: 0.7978, Test: 0.7990, Best time: 80.0000
Epoch: 011/100, Runtime 4.810170, Loss 0.656772, forward nfe 5394, backward nfe 0, Train: 0.8071, Val: 0.7978, Test: 0.7990, Best time: 80.0000
Epoch: 012/100, Runtime 4.747953, Loss 0.674751, forward nfe 5842, backward nfe 0, Train: 0.8071, Val: 0.7978, Test: 0.7990, Best time: 80.0000
Epoch: 013/100, Runtime 4.320478, Loss 0.634467, forward nfe 6284, backward nfe 0, Train: 0.8571, Val: 0.8081, Test: 0.8051, Best time: 14.7237
Epoch: 014/100, Runtime 4.471293, Loss 0.588044, forward nfe 6708, backward nfe 0, Train: 0.8571, Val: 0.8257, Test: 0.8325, Best time: 37.1464
Epoch: 015/100, Runtime 4.340974, Loss 0.553076, forward nfe 7120, backward nfe 0, Train: 0.8571, Val: 0.8287, Test: 0.8345, Best time: 73.3302
Epoch: 016/100, Runtime 4.155601, Loss 0.523319, forward nfe 7526, backward nfe 0, Train: 0.8571, Val: 0.8287, Test: 0.8345, Best time: 80.0000
Epoch: 017/100, Runtime 4.181026, Loss 0.541870, forward nfe 7932, backward nfe 0, Train: 0.8571, Val: 0.8287, Test: 0.8345, Best time: 80.0000
Epoch: 018/100, Runtime 4.141756, Loss 0.499209, forward nfe 8338, backward nfe 0, Train: 0.8571, Val: 0.8287, Test: 0.8345, Best time: 80.0000
Epoch: 019/100, Runtime 4.044437, Loss 0.491640, forward nfe 8732, backward nfe 0, Train: 0.8571, Val: 0.8287, Test: 0.8345, Best time: 80.0000
Epoch: 020/100, Runtime 4.993517, Loss 0.484439, forward nfe 9114, backward nfe 0, Train: 0.8571, Val: 0.8287, Test: 0.8345, Best time: 80.0000
Epoch: 021/100, Runtime 4.906334, Loss 0.502318, forward nfe 9484, backward nfe 0, Train: 0.8571, Val: 0.8287, Test: 0.8345, Best time: 80.0000
Epoch: 022/100, Runtime 4.850903, Loss 0.486107, forward nfe 9836, backward nfe 0, Train: 0.8571, Val: 0.8287, Test: 0.8345, Best time: 80.0000
Epoch: 023/100, Runtime 4.741331, Loss 0.442830, forward nfe 10182, backward nfe 0, Train: 0.8429, Val: 0.8375, Test: 0.8477, Best time: 232.5106
Epoch: 024/100, Runtime 4.722382, Loss 0.465572, forward nfe 10522, backward nfe 0, Train: 0.8429, Val: 0.8375, Test: 0.8477, Best time: 80.0000
Epoch: 025/100, Runtime 4.449952, Loss 0.419807, forward nfe 10862, backward nfe 0, Train: 0.8429, Val: 0.8375, Test: 0.8477, Best time: 80.0000
Epoch: 026/100, Runtime 4.544388, Loss 0.404835, forward nfe 11196, backward nfe 0, Train: 0.8429, Val: 0.8375, Test: 0.8477, Best time: 80.0000
Epoch: 027/100, Runtime 4.005522, Loss 0.430825, forward nfe 11524, backward nfe 0, Train: 0.8429, Val: 0.8375, Test: 0.8477, Best time: 80.0000
Epoch: 028/100, Runtime 3.301153, Loss 0.401027, forward nfe 11852, backward nfe 0, Train: 0.8429, Val: 0.8375, Test: 0.8477, Best time: 80.0000
Epoch: 029/100, Runtime 3.246751, Loss 0.386301, forward nfe 12168, backward nfe 0, Train: 0.8429, Val: 0.8375, Test: 0.8477, Best time: 80.0000
Epoch: 030/100, Runtime 3.171177, Loss 0.385920, forward nfe 12472, backward nfe 0, Train: 0.8929, Val: 0.8397, Test: 0.8305, Best time: 103.9126
Epoch: 031/100, Runtime 3.078683, Loss 0.366304, forward nfe 12770, backward nfe 0, Train: 0.8929, Val: 0.8397, Test: 0.8305, Best time: 80.0000
Epoch: 032/100, Runtime 2.945745, Loss 0.359280, forward nfe 13056, backward nfe 0, Train: 0.8929, Val: 0.8412, Test: 0.8426, Best time: 89.1604
Epoch: 033/100, Runtime 3.251523, Loss 0.377944, forward nfe 13348, backward nfe 0, Train: 0.8929, Val: 0.8412, Test: 0.8426, Best time: 80.0000
Epoch: 034/100, Runtime 3.026514, Loss 0.411535, forward nfe 13634, backward nfe 0, Train: 0.8929, Val: 0.8412, Test: 0.8426, Best time: 80.0000
Epoch: 035/100, Runtime 3.071116, Loss 0.332583, forward nfe 13914, backward nfe 0, Train: 0.8929, Val: 0.8412, Test: 0.8426, Best time: 80.0000
Epoch: 036/100, Runtime 2.843236, Loss 0.384448, forward nfe 14194, backward nfe 0, Train: 0.8929, Val: 0.8412, Test: 0.8426, Best time: 80.0000
Epoch: 037/100, Runtime 2.933700, Loss 0.308842, forward nfe 14468, backward nfe 0, Train: 0.8929, Val: 0.8412, Test: 0.8426, Best time: 80.0000
Epoch: 038/100, Runtime 2.859169, Loss 0.334858, forward nfe 14742, backward nfe 0, Train: 0.8929, Val: 0.8412, Test: 0.8426, Best time: 80.0000
Epoch: 039/100, Runtime 2.836313, Loss 0.278893, forward nfe 15016, backward nfe 0, Train: 0.8929, Val: 0.8412, Test: 0.8426, Best time: 80.0000
Epoch: 040/100, Runtime 2.751061, Loss 0.307596, forward nfe 15272, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8497, Best time: 147.3496
Epoch: 041/100, Runtime 2.585258, Loss 0.325705, forward nfe 15528, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8497, Best time: 80.0000
Epoch: 042/100, Runtime 2.731971, Loss 0.270417, forward nfe 15784, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8497, Best time: 80.0000
Epoch: 043/100, Runtime 2.634067, Loss 0.251902, forward nfe 16034, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8497, Best time: 80.0000
Epoch: 044/100, Runtime 2.692139, Loss 0.298563, forward nfe 16284, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8497, Best time: 80.0000
Epoch: 045/100, Runtime 2.591984, Loss 0.274069, forward nfe 16534, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8497, Best time: 80.0000
Epoch: 046/100, Runtime 2.559544, Loss 0.245912, forward nfe 16778, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8497, Best time: 80.0000
Epoch: 047/100, Runtime 2.489422, Loss 0.254204, forward nfe 17022, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8497, Best time: 80.0000
Epoch: 048/100, Runtime 2.661946, Loss 0.228625, forward nfe 17266, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8497, Best time: 80.0000
Epoch: 049/100, Runtime 2.619592, Loss 0.194507, forward nfe 17504, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8497, Best time: 80.0000
Epoch: 050/100, Runtime 2.531865, Loss 0.203994, forward nfe 17736, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8497, Best time: 80.0000
Epoch: 051/100, Runtime 2.508870, Loss 0.192020, forward nfe 17968, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8497, Best time: 80.0000
Epoch: 052/100, Runtime 2.590664, Loss 0.178324, forward nfe 18200, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8497, Best time: 80.0000
Epoch: 053/100, Runtime 2.542677, Loss 0.195339, forward nfe 18432, backward nfe 0, Train: 0.9357, Val: 0.8471, Test: 0.8497, Best time: 80.0000
Epoch: 054/100, Runtime 2.358852, Loss 0.173783, forward nfe 18664, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 200.6654
Epoch: 055/100, Runtime 2.385697, Loss 0.163775, forward nfe 18890, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 056/100, Runtime 2.367833, Loss 0.170114, forward nfe 19116, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 057/100, Runtime 2.349573, Loss 0.124902, forward nfe 19342, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 058/100, Runtime 2.539990, Loss 0.151222, forward nfe 19568, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 059/100, Runtime 2.415497, Loss 0.114079, forward nfe 19794, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 060/100, Runtime 2.406339, Loss 0.148163, forward nfe 20014, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 061/100, Runtime 2.189666, Loss 0.127966, forward nfe 20228, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 062/100, Runtime 2.492992, Loss 0.103269, forward nfe 20442, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 063/100, Runtime 2.380235, Loss 0.138202, forward nfe 20662, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 064/100, Runtime 2.483518, Loss 0.115018, forward nfe 20882, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 065/100, Runtime 2.429512, Loss 0.114765, forward nfe 21102, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 066/100, Runtime 2.425281, Loss 0.057293, forward nfe 21322, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 067/100, Runtime 2.260561, Loss 0.077083, forward nfe 21542, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 068/100, Runtime 2.481192, Loss 0.101683, forward nfe 21762, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 069/100, Runtime 2.415492, Loss 0.084682, forward nfe 21982, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 070/100, Runtime 2.384131, Loss 0.066780, forward nfe 22202, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 071/100, Runtime 2.286209, Loss 0.055832, forward nfe 22416, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 072/100, Runtime 2.434971, Loss 0.052986, forward nfe 22630, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 073/100, Runtime 2.314822, Loss 0.057967, forward nfe 22844, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 074/100, Runtime 2.384505, Loss 0.074791, forward nfe 23058, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 075/100, Runtime 2.375878, Loss 0.072799, forward nfe 23272, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 076/100, Runtime 2.240697, Loss 0.055245, forward nfe 23486, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 077/100, Runtime 2.409267, Loss 0.062522, forward nfe 23694, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 078/100, Runtime 2.329985, Loss 0.070306, forward nfe 23908, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 079/100, Runtime 2.402094, Loss 0.084822, forward nfe 24122, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 080/100, Runtime 2.404418, Loss 0.081395, forward nfe 24336, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 081/100, Runtime 2.613349, Loss 0.077879, forward nfe 24556, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 082/100, Runtime 2.393903, Loss 0.053299, forward nfe 24776, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 083/100, Runtime 2.531039, Loss 0.043635, forward nfe 25002, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 084/100, Runtime 2.221889, Loss 0.108608, forward nfe 25228, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 085/100, Runtime 2.475406, Loss 0.072444, forward nfe 25448, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 086/100, Runtime 2.351080, Loss 0.096129, forward nfe 25668, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 087/100, Runtime 2.496130, Loss 0.036816, forward nfe 25888, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 088/100, Runtime 2.193781, Loss 0.077045, forward nfe 26108, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 089/100, Runtime 2.237865, Loss 0.100267, forward nfe 26322, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 090/100, Runtime 2.335137, Loss 0.103237, forward nfe 26530, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 091/100, Runtime 2.260080, Loss 0.092985, forward nfe 26738, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 092/100, Runtime 2.249205, Loss 0.053233, forward nfe 26946, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 093/100, Runtime 2.312358, Loss 0.089813, forward nfe 27154, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 094/100, Runtime 2.160413, Loss 0.070304, forward nfe 27362, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 095/100, Runtime 2.297033, Loss 0.042031, forward nfe 27570, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 096/100, Runtime 2.166291, Loss 0.075652, forward nfe 27778, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 097/100, Runtime 2.248766, Loss 0.083297, forward nfe 27980, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 098/100, Runtime 2.246411, Loss 0.040448, forward nfe 28182, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
Epoch: 099/100, Runtime 2.193661, Loss 0.081216, forward nfe 28384, backward nfe 0, Train: 0.9643, Val: 0.8618, Test: 0.8589, Best time: 80.0000
best val accuracy 0.861765 with test accuracy 0.858883 at epoch 54 and best time 80.000000