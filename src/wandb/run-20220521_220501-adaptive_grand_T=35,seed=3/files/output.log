/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 2.870736, Loss 1.946851, forward nfe 80, backward nfe 0, Train: 0.3929, Val: 0.3566, Test: 0.3239, Best time: 0.0959
Epoch: 002/100, Runtime 2.914199, Loss 1.803322, forward nfe 372, backward nfe 0, Train: 0.8286, Val: 0.7044, Test: 0.6751, Best time: 10.2211
Epoch: 003/100, Runtime 2.918216, Loss 1.517290, forward nfe 664, backward nfe 0, Train: 0.9286, Val: 0.8184, Test: 0.7858, Best time: 10.1511
Epoch: 004/100, Runtime 2.718748, Loss 1.165940, forward nfe 944, backward nfe 0, Train: 0.9286, Val: 0.8368, Test: 0.8102, Best time: 13.4286
Epoch: 005/100, Runtime 2.891473, Loss 0.860765, forward nfe 1218, backward nfe 0, Train: 0.9286, Val: 0.8368, Test: 0.8102, Best time: 35.0000
Epoch: 006/100, Runtime 2.540126, Loss 0.618787, forward nfe 1486, backward nfe 0, Train: 0.9286, Val: 0.8368, Test: 0.8102, Best time: 35.0000
Epoch: 007/100, Runtime 2.716821, Loss 0.436838, forward nfe 1742, backward nfe 0, Train: 0.9429, Val: 0.8463, Test: 0.8122, Best time: 8.3153
Epoch: 008/100, Runtime 2.548453, Loss 0.343912, forward nfe 2004, backward nfe 0, Train: 0.9357, Val: 0.8500, Test: 0.8294, Best time: 11.5681
Epoch: 009/100, Runtime 2.581423, Loss 0.302746, forward nfe 2260, backward nfe 0, Train: 0.9500, Val: 0.8515, Test: 0.8294, Best time: 21.1829
Epoch: 010/100, Runtime 2.656373, Loss 0.276420, forward nfe 2510, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8335, Best time: 16.8296
Epoch: 011/100, Runtime 1.948990, Loss 0.227877, forward nfe 2754, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8335, Best time: 35.0000
Epoch: 012/100, Runtime 1.732625, Loss 0.255648, forward nfe 2986, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8335, Best time: 35.0000
Epoch: 013/100, Runtime 1.796442, Loss 0.232662, forward nfe 3218, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 26.3438
Epoch: 014/100, Runtime 1.804762, Loss 0.233618, forward nfe 3438, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 015/100, Runtime 1.716241, Loss 0.208664, forward nfe 3646, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 016/100, Runtime 1.722202, Loss 0.223963, forward nfe 3848, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 017/100, Runtime 1.710458, Loss 0.239687, forward nfe 4056, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 018/100, Runtime 1.758049, Loss 0.208451, forward nfe 4264, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 019/100, Runtime 1.604073, Loss 0.216053, forward nfe 4472, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 020/100, Runtime 1.554062, Loss 0.191706, forward nfe 4662, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 021/100, Runtime 1.577430, Loss 0.243761, forward nfe 4846, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 022/100, Runtime 1.400494, Loss 0.153095, forward nfe 5030, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 023/100, Runtime 1.464643, Loss 0.229949, forward nfe 5202, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 024/100, Runtime 1.511390, Loss 0.150369, forward nfe 5374, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 025/100, Runtime 1.514109, Loss 0.152660, forward nfe 5558, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 026/100, Runtime 1.444019, Loss 0.175912, forward nfe 5742, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 027/100, Runtime 1.475415, Loss 0.203458, forward nfe 5908, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 028/100, Runtime 1.436883, Loss 0.106796, forward nfe 6080, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 029/100, Runtime 1.348138, Loss 0.130445, forward nfe 6246, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 030/100, Runtime 1.352425, Loss 0.133302, forward nfe 6412, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 031/100, Runtime 1.282550, Loss 0.121040, forward nfe 6566, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 032/100, Runtime 1.287144, Loss 0.135794, forward nfe 6720, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 033/100, Runtime 1.381060, Loss 0.125244, forward nfe 6874, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 034/100, Runtime 1.363701, Loss 0.131080, forward nfe 7034, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 035/100, Runtime 1.369261, Loss 0.199282, forward nfe 7194, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 036/100, Runtime 1.261265, Loss 0.121255, forward nfe 7348, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 037/100, Runtime 1.290366, Loss 0.102341, forward nfe 7496, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 038/100, Runtime 1.298317, Loss 0.125455, forward nfe 7644, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 039/100, Runtime 1.284291, Loss 0.108801, forward nfe 7792, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 040/100, Runtime 1.274020, Loss 0.123088, forward nfe 7940, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 041/100, Runtime 1.304861, Loss 0.105767, forward nfe 8088, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 042/100, Runtime 1.245412, Loss 0.095912, forward nfe 8236, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 043/100, Runtime 1.271588, Loss 0.075069, forward nfe 8384, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 044/100, Runtime 1.205492, Loss 0.105517, forward nfe 8532, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 045/100, Runtime 1.199075, Loss 0.066761, forward nfe 8674, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 046/100, Runtime 1.203463, Loss 0.079939, forward nfe 8816, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 047/100, Runtime 1.254793, Loss 0.084362, forward nfe 8958, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 048/100, Runtime 1.221553, Loss 0.085839, forward nfe 9100, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 049/100, Runtime 1.218031, Loss 0.081089, forward nfe 9242, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 050/100, Runtime 1.223948, Loss 0.099057, forward nfe 9384, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 051/100, Runtime 1.181243, Loss 0.076177, forward nfe 9526, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 052/100, Runtime 1.167245, Loss 0.068481, forward nfe 9668, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 053/100, Runtime 1.132410, Loss 0.143805, forward nfe 9804, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 054/100, Runtime 1.153486, Loss 0.060706, forward nfe 9940, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 055/100, Runtime 1.197719, Loss 0.058682, forward nfe 10076, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 056/100, Runtime 1.192967, Loss 0.083129, forward nfe 10212, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 057/100, Runtime 1.184943, Loss 0.085418, forward nfe 10348, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 058/100, Runtime 1.181127, Loss 0.031196, forward nfe 10484, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 059/100, Runtime 1.181503, Loss 0.072453, forward nfe 10620, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 060/100, Runtime 1.205325, Loss 0.087218, forward nfe 10756, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 061/100, Runtime 1.193683, Loss 0.040507, forward nfe 10892, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 062/100, Runtime 1.195698, Loss 0.092246, forward nfe 11028, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 063/100, Runtime 1.118002, Loss 0.089670, forward nfe 11164, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 064/100, Runtime 1.150215, Loss 0.072264, forward nfe 11300, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 065/100, Runtime 1.134738, Loss 0.123410, forward nfe 11436, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 066/100, Runtime 1.191884, Loss 0.062857, forward nfe 11572, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 067/100, Runtime 1.156288, Loss 0.034007, forward nfe 11708, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 068/100, Runtime 1.197251, Loss 0.057396, forward nfe 11844, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 069/100, Runtime 1.190596, Loss 0.063208, forward nfe 11980, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 070/100, Runtime 1.211547, Loss 0.091545, forward nfe 12116, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 071/100, Runtime 1.202428, Loss 0.045801, forward nfe 12252, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 072/100, Runtime 1.159620, Loss 0.052715, forward nfe 12388, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 073/100, Runtime 1.143361, Loss 0.039770, forward nfe 12518, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 074/100, Runtime 1.058416, Loss 0.043835, forward nfe 12648, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 075/100, Runtime 1.185667, Loss 0.051241, forward nfe 12778, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 076/100, Runtime 1.102625, Loss 0.061591, forward nfe 12914, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 077/100, Runtime 1.155086, Loss 0.045947, forward nfe 13038, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 078/100, Runtime 1.203714, Loss 0.046976, forward nfe 13168, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 079/100, Runtime 1.250505, Loss 0.053996, forward nfe 13310, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 080/100, Runtime 1.265952, Loss 0.040000, forward nfe 13452, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 081/100, Runtime 1.326222, Loss 0.042637, forward nfe 13600, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 082/100, Runtime 1.281345, Loss 0.054332, forward nfe 13748, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 083/100, Runtime 1.270195, Loss 0.044940, forward nfe 13896, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 084/100, Runtime 1.269323, Loss 0.050792, forward nfe 14044, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 085/100, Runtime 1.316763, Loss 0.064587, forward nfe 14192, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 086/100, Runtime 1.308206, Loss 0.029251, forward nfe 14340, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 087/100, Runtime 1.390332, Loss 0.041459, forward nfe 14494, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 088/100, Runtime 1.386265, Loss 0.045601, forward nfe 14654, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 089/100, Runtime 1.938616, Loss 0.074592, forward nfe 14814, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 090/100, Runtime 1.881753, Loss 0.026621, forward nfe 14986, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 091/100, Runtime 2.149163, Loss 0.030350, forward nfe 15164, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 092/100, Runtime 2.093252, Loss 0.034921, forward nfe 15342, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 093/100, Runtime 2.013544, Loss 0.058336, forward nfe 15526, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 094/100, Runtime 1.731233, Loss 0.028574, forward nfe 15710, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 095/100, Runtime 1.726126, Loss 0.081325, forward nfe 15894, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 096/100, Runtime 1.840886, Loss 0.039930, forward nfe 16078, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 097/100, Runtime 1.860927, Loss 0.065543, forward nfe 16262, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 098/100, Runtime 1.942529, Loss 0.028631, forward nfe 16446, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
Epoch: 099/100, Runtime 1.810677, Loss 0.062871, forward nfe 16630, backward nfe 0, Train: 0.9643, Val: 0.8588, Test: 0.8345, Best time: 35.0000
best val accuracy 0.858824 with test accuracy 0.834518 at epoch 13 and best time 35.000000