****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 6.054308, Loss 1.947586, forward nfe 104, backward nfe 0, Train: 0.3000, Val: 0.1853, Test: 0.2020, Best time: 0.0927
Epoch: 002/100, Runtime 5.953717, Loss 1.970096, forward nfe 498, backward nfe 0, Train: 0.3000, Val: 0.1853, Test: 0.2020, Best time: 50.0000
Epoch: 003/100, Runtime 5.976871, Loss 1.935647, forward nfe 886, backward nfe 0, Train: 0.3286, Val: 0.2132, Test: 0.2203, Best time: 0.0858
Epoch: 004/100, Runtime 5.759042, Loss 1.871606, forward nfe 1262, backward nfe 0, Train: 0.6071, Val: 0.4647, Test: 0.4579, Best time: 5.2254
Epoch: 005/100, Runtime 5.612276, Loss 1.736218, forward nfe 1632, backward nfe 0, Train: 0.7214, Val: 0.6456, Test: 0.6325, Best time: 5.3792
Epoch: 006/100, Runtime 5.543321, Loss 1.552785, forward nfe 1996, backward nfe 0, Train: 0.7929, Val: 0.7500, Test: 0.7523, Best time: 10.1026
Epoch: 007/100, Runtime 5.405986, Loss 1.343745, forward nfe 2354, backward nfe 0, Train: 0.8500, Val: 0.8022, Test: 0.8102, Best time: 13.6711
Epoch: 008/100, Runtime 5.240790, Loss 1.153565, forward nfe 2700, backward nfe 0, Train: 0.8500, Val: 0.8022, Test: 0.8102, Best time: 50.0000
Epoch: 009/100, Runtime 5.400977, Loss 0.920264, forward nfe 3040, backward nfe 0, Train: 0.8500, Val: 0.8022, Test: 0.8102, Best time: 50.0000
Epoch: 010/100, Runtime 5.129450, Loss 0.751257, forward nfe 3368, backward nfe 0, Train: 0.8500, Val: 0.8022, Test: 0.8102, Best time: 50.0000
Epoch: 011/100, Runtime 4.993869, Loss 0.635653, forward nfe 3696, backward nfe 0, Train: 0.8500, Val: 0.8022, Test: 0.8102, Best time: 50.0000
Epoch: 012/100, Runtime 4.878300, Loss 0.505735, forward nfe 4018, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 29.8683
Epoch: 013/100, Runtime 4.816625, Loss 0.472960, forward nfe 4334, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 014/100, Runtime 4.716002, Loss 0.450240, forward nfe 4638, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 015/100, Runtime 4.614809, Loss 0.395462, forward nfe 4942, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 016/100, Runtime 4.381263, Loss 0.433267, forward nfe 5234, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 017/100, Runtime 4.196056, Loss 0.460031, forward nfe 5508, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 018/100, Runtime 4.391209, Loss 0.396649, forward nfe 5782, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 019/100, Runtime 4.319072, Loss 0.388494, forward nfe 6062, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 020/100, Runtime 4.020262, Loss 0.379510, forward nfe 6330, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 021/100, Runtime 4.065383, Loss 0.352359, forward nfe 6592, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 022/100, Runtime 3.741539, Loss 0.370310, forward nfe 6836, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 023/100, Runtime 3.881360, Loss 0.324295, forward nfe 7080, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 024/100, Runtime 3.628500, Loss 0.418280, forward nfe 7312, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 025/100, Runtime 3.861062, Loss 0.393010, forward nfe 7556, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 026/100, Runtime 3.588627, Loss 0.297676, forward nfe 7794, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 027/100, Runtime 3.745337, Loss 0.270206, forward nfe 8032, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 028/100, Runtime 3.427906, Loss 0.297537, forward nfe 8258, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 029/100, Runtime 3.430041, Loss 0.285840, forward nfe 8472, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 030/100, Runtime 3.583915, Loss 0.240053, forward nfe 8686, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 031/100, Runtime 3.257984, Loss 0.311810, forward nfe 8906, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 032/100, Runtime 3.439273, Loss 0.258384, forward nfe 9114, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 033/100, Runtime 3.368021, Loss 0.257629, forward nfe 9328, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 034/100, Runtime 3.246299, Loss 0.225273, forward nfe 9548, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 035/100, Runtime 3.146710, Loss 0.171712, forward nfe 9738, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 036/100, Runtime 3.158926, Loss 0.230089, forward nfe 9928, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 037/100, Runtime 3.217394, Loss 0.248303, forward nfe 10118, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 038/100, Runtime 2.899963, Loss 0.247917, forward nfe 10308, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 039/100, Runtime 3.087211, Loss 0.213286, forward nfe 10492, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 040/100, Runtime 2.858512, Loss 0.213253, forward nfe 10676, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 041/100, Runtime 2.934578, Loss 0.212470, forward nfe 10854, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 042/100, Runtime 2.932040, Loss 0.153649, forward nfe 11032, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 043/100, Runtime 2.906372, Loss 0.198402, forward nfe 11210, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 044/100, Runtime 2.982346, Loss 0.222885, forward nfe 11388, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 045/100, Runtime 2.820951, Loss 0.167136, forward nfe 11566, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 046/100, Runtime 2.886029, Loss 0.171871, forward nfe 11744, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 047/100, Runtime 2.900628, Loss 0.136636, forward nfe 11922, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 048/100, Runtime 2.888729, Loss 0.171709, forward nfe 12100, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 049/100, Runtime 2.966909, Loss 0.167943, forward nfe 12278, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 050/100, Runtime 2.887018, Loss 0.126934, forward nfe 12456, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 051/100, Runtime 2.864653, Loss 0.207290, forward nfe 12634, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 052/100, Runtime 2.705300, Loss 0.082420, forward nfe 12812, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 053/100, Runtime 2.676809, Loss 0.112932, forward nfe 12978, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 054/100, Runtime 2.633664, Loss 0.162519, forward nfe 13144, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 055/100, Runtime 2.653753, Loss 0.117910, forward nfe 13310, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 056/100, Runtime 2.750288, Loss 0.080622, forward nfe 13476, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 057/100, Runtime 2.716804, Loss 0.090776, forward nfe 13642, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 058/100, Runtime 2.790700, Loss 0.127589, forward nfe 13814, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 059/100, Runtime 2.826410, Loss 0.159627, forward nfe 13986, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 060/100, Runtime 2.834067, Loss 0.211487, forward nfe 14158, backward nfe 0, Train: 0.8857, Val: 0.8243, Test: 0.8294, Best time: 50.0000
Epoch: 061/100, Runtime 2.791663, Loss 0.131354, forward nfe 14330, backward nfe 0, Train: 0.9786, Val: 0.8265, Test: 0.8193, Best time: 150.2145
Epoch: 062/100, Runtime 2.880280, Loss 0.120904, forward nfe 14502, backward nfe 0, Train: 0.9786, Val: 0.8265, Test: 0.8193, Best time: 50.0000
Epoch: 063/100, Runtime 2.823357, Loss 0.167639, forward nfe 14680, backward nfe 0, Train: 0.9786, Val: 0.8265, Test: 0.8193, Best time: 50.0000
Epoch: 064/100, Runtime 2.823325, Loss 0.061683, forward nfe 14858, backward nfe 0, Train: 0.9786, Val: 0.8265, Test: 0.8193, Best time: 50.0000
Epoch: 065/100, Runtime 2.963555, Loss 0.076997, forward nfe 15036, backward nfe 0, Train: 0.9786, Val: 0.8265, Test: 0.8193, Best time: 50.0000
Epoch: 066/100, Runtime 2.908710, Loss 0.104989, forward nfe 15214, backward nfe 0, Train: 0.9786, Val: 0.8265, Test: 0.8193, Best time: 50.0000
Epoch: 067/100, Runtime 2.964752, Loss 0.105036, forward nfe 15392, backward nfe 0, Train: 0.9786, Val: 0.8265, Test: 0.8193, Best time: 50.0000
Epoch: 068/100, Runtime 2.928963, Loss 0.092653, forward nfe 15570, backward nfe 0, Train: 0.9786, Val: 0.8265, Test: 0.8193, Best time: 50.0000
Epoch: 069/100, Runtime 2.780658, Loss 0.043512, forward nfe 15748, backward nfe 0, Train: 0.9786, Val: 0.8265, Test: 0.8193, Best time: 50.0000
Epoch: 070/100, Runtime 2.726556, Loss 0.130011, forward nfe 15920, backward nfe 0, Train: 0.9786, Val: 0.8265, Test: 0.8193, Best time: 50.0000
Epoch: 071/100, Runtime 2.807309, Loss 0.073107, forward nfe 16092, backward nfe 0, Train: 0.9786, Val: 0.8265, Test: 0.8193, Best time: 50.0000
Epoch: 072/100, Runtime 2.814379, Loss 0.063543, forward nfe 16264, backward nfe 0, Train: 0.9786, Val: 0.8265, Test: 0.8193, Best time: 50.0000
Epoch: 073/100, Runtime 2.906397, Loss 0.115071, forward nfe 16442, backward nfe 0, Train: 0.9786, Val: 0.8265, Test: 0.8193, Best time: 50.0000
Epoch: 074/100, Runtime 2.762770, Loss 0.092889, forward nfe 16620, backward nfe 0, Train: 0.9786, Val: 0.8265, Test: 0.8193, Best time: 50.0000
Epoch: 075/100, Runtime 2.824359, Loss 0.068995, forward nfe 16792, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 076/100, Runtime 2.720299, Loss 0.048955, forward nfe 16964, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 077/100, Runtime 2.791348, Loss 0.043300, forward nfe 17130, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 078/100, Runtime 2.672843, Loss 0.078916, forward nfe 17296, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 079/100, Runtime 2.692080, Loss 0.132259, forward nfe 17462, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 080/100, Runtime 2.672369, Loss 0.048525, forward nfe 17628, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 081/100, Runtime 2.734837, Loss 0.061395, forward nfe 17794, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 082/100, Runtime 2.748534, Loss 0.054304, forward nfe 17960, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 083/100, Runtime 2.715952, Loss 0.064496, forward nfe 18132, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 084/100, Runtime 2.738669, Loss 0.058024, forward nfe 18304, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 085/100, Runtime 2.659872, Loss 0.050068, forward nfe 18470, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 086/100, Runtime 2.668517, Loss 0.038797, forward nfe 18636, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 087/100, Runtime 2.664598, Loss 0.059610, forward nfe 18802, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 088/100, Runtime 2.731417, Loss 0.055435, forward nfe 18968, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 089/100, Runtime 2.739527, Loss 0.087549, forward nfe 19134, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 090/100, Runtime 2.643101, Loss 0.048733, forward nfe 19300, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 091/100, Runtime 2.697328, Loss 0.056434, forward nfe 19466, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 092/100, Runtime 2.519195, Loss 0.070047, forward nfe 19632, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 093/100, Runtime 2.597582, Loss 0.083054, forward nfe 19792, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 094/100, Runtime 2.771047, Loss 0.036961, forward nfe 19952, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 095/100, Runtime 2.673445, Loss 0.057437, forward nfe 20118, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 096/100, Runtime 2.961844, Loss 0.033373, forward nfe 20290, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 097/100, Runtime 2.971676, Loss 0.050266, forward nfe 20468, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 098/100, Runtime 3.433282, Loss 0.040424, forward nfe 20652, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
Epoch: 099/100, Runtime 3.193052, Loss 0.044605, forward nfe 20854, backward nfe 0, Train: 0.9929, Val: 0.8287, Test: 0.8010, Best time: 50.0000
best val accuracy 0.828676 with test accuracy 0.801015 at epoch 75 and best time 50.000000