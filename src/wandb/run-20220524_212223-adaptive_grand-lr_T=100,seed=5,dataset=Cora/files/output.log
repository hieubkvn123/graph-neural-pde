****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.688375, Loss 1.948592, forward nfe 182, backward nfe 0, Train: 0.1429, Val: 0.1412, Test: 0.1340, Best time: 100.0000
Epoch: 002/100, Runtime 0.506831, Loss 2.022299, forward nfe 894, backward nfe 0, Train: 0.1429, Val: 0.1412, Test: 0.1340, Best time: 100.0000
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 003/100, Runtime 0.562753, Loss 1.968978, forward nfe 1600, backward nfe 0, Train: 0.1429, Val: 0.1412, Test: 0.1340, Best time: 100.0000
Epoch: 004/100, Runtime 0.608275, Loss 1.948486, forward nfe 2294, backward nfe 0, Train: 0.1429, Val: 0.1412, Test: 0.1340, Best time: 100.0000
Epoch: 005/100, Runtime 0.572899, Loss 1.909065, forward nfe 2976, backward nfe 0, Train: 0.3214, Val: 0.3515, Test: 0.3462, Best time: 5.0885
Epoch: 006/100, Runtime 0.565784, Loss 1.873599, forward nfe 3640, backward nfe 0, Train: 0.4357, Val: 0.5037, Test: 0.4934, Best time: 15.9680
Epoch: 007/100, Runtime 0.557591, Loss 1.824442, forward nfe 4292, backward nfe 0, Train: 0.5071, Val: 0.5235, Test: 0.5330, Best time: 3.7348
Epoch: 008/100, Runtime 0.534580, Loss 1.731516, forward nfe 4932, backward nfe 0, Train: 0.5071, Val: 0.5235, Test: 0.5330, Best time: 100.0000
Epoch: 009/100, Runtime 0.542537, Loss 1.644258, forward nfe 5554, backward nfe 0, Train: 0.7071, Val: 0.6610, Test: 0.6863, Best time: 5.8786
Epoch: 010/100, Runtime 0.650784, Loss 1.488779, forward nfe 6158, backward nfe 0, Train: 0.8071, Val: 0.7419, Test: 0.7817, Best time: 51.1348
Epoch: 011/100, Runtime 0.639655, Loss 1.360481, forward nfe 6744, backward nfe 0, Train: 0.8071, Val: 0.7846, Test: 0.8081, Best time: 70.8905
Epoch: 012/100, Runtime 0.631269, Loss 1.202599, forward nfe 7318, backward nfe 0, Train: 0.8071, Val: 0.7846, Test: 0.8081, Best time: 100.0000
Epoch: 013/100, Runtime 0.617448, Loss 1.068248, forward nfe 7880, backward nfe 0, Train: 0.8071, Val: 0.7846, Test: 0.8081, Best time: 100.0000
Epoch: 014/100, Runtime 0.616276, Loss 0.985593, forward nfe 8442, backward nfe 0, Train: 0.8071, Val: 0.7846, Test: 0.8081, Best time: 100.0000
Epoch: 015/100, Runtime 0.609329, Loss 0.826765, forward nfe 8986, backward nfe 0, Train: 0.8071, Val: 0.7846, Test: 0.8081, Best time: 100.0000
Epoch: 016/100, Runtime 0.576219, Loss 0.753768, forward nfe 9524, backward nfe 0, Train: 0.8000, Val: 0.7949, Test: 0.8081, Best time: 26.5057
Epoch: 017/100, Runtime 0.541353, Loss 0.714359, forward nfe 10044, backward nfe 0, Train: 0.7929, Val: 0.8007, Test: 0.8254, Best time: 37.4503
Epoch: 018/100, Runtime 0.533781, Loss 0.686582, forward nfe 10540, backward nfe 0, Train: 0.8071, Val: 0.8096, Test: 0.8223, Best time: 46.2848
Epoch: 019/100, Runtime 0.524681, Loss 0.652085, forward nfe 11024, backward nfe 0, Train: 0.8214, Val: 0.8221, Test: 0.8294, Best time: 120.8914
Epoch: 020/100, Runtime 0.515479, Loss 0.571301, forward nfe 11502, backward nfe 0, Train: 0.8214, Val: 0.8221, Test: 0.8294, Best time: 100.0000
Epoch: 021/100, Runtime 0.516933, Loss 0.600458, forward nfe 11974, backward nfe 0, Train: 0.8214, Val: 0.8221, Test: 0.8294, Best time: 100.0000
Epoch: 022/100, Runtime 0.501978, Loss 0.522854, forward nfe 12440, backward nfe 0, Train: 0.8214, Val: 0.8221, Test: 0.8294, Best time: 100.0000
Epoch: 023/100, Runtime 0.476411, Loss 0.564611, forward nfe 12882, backward nfe 0, Train: 0.8214, Val: 0.8221, Test: 0.8294, Best time: 100.0000
Epoch: 024/100, Runtime 0.478448, Loss 0.507475, forward nfe 13318, backward nfe 0, Train: 0.8214, Val: 0.8221, Test: 0.8294, Best time: 100.0000
Epoch: 025/100, Runtime 0.458695, Loss 0.527145, forward nfe 13748, backward nfe 0, Train: 0.8214, Val: 0.8221, Test: 0.8294, Best time: 100.0000
Epoch: 026/100, Runtime 0.464906, Loss 0.466205, forward nfe 14154, backward nfe 0, Train: 0.8429, Val: 0.8309, Test: 0.8325, Best time: 113.3387
Epoch: 027/100, Runtime 0.453256, Loss 0.499864, forward nfe 14560, backward nfe 0, Train: 0.8429, Val: 0.8309, Test: 0.8325, Best time: 100.0000
Epoch: 028/100, Runtime 0.447102, Loss 0.459794, forward nfe 14966, backward nfe 0, Train: 0.8429, Val: 0.8309, Test: 0.8325, Best time: 100.0000
Epoch: 029/100, Runtime 0.442807, Loss 0.500809, forward nfe 15360, backward nfe 0, Train: 0.8571, Val: 0.8456, Test: 0.8467, Best time: 123.0558
Epoch: 030/100, Runtime 0.415666, Loss 0.482865, forward nfe 15742, backward nfe 0, Train: 0.8571, Val: 0.8456, Test: 0.8467, Best time: 100.0000
Epoch: 031/100, Runtime 0.416117, Loss 0.445365, forward nfe 16118, backward nfe 0, Train: 0.8571, Val: 0.8456, Test: 0.8467, Best time: 100.0000
Epoch: 032/100, Runtime 0.399567, Loss 0.403485, forward nfe 16482, backward nfe 0, Train: 0.8571, Val: 0.8456, Test: 0.8467, Best time: 100.0000
Epoch: 033/100, Runtime 0.417058, Loss 0.511932, forward nfe 16840, backward nfe 0, Train: 0.8571, Val: 0.8456, Test: 0.8467, Best time: 100.0000
Epoch: 034/100, Runtime 0.414178, Loss 0.417028, forward nfe 17204, backward nfe 0, Train: 0.8571, Val: 0.8456, Test: 0.8467, Best time: 100.0000
Epoch: 035/100, Runtime 0.395510, Loss 0.411086, forward nfe 17562, backward nfe 0, Train: 0.8571, Val: 0.8456, Test: 0.8467, Best time: 100.0000
Epoch: 036/100, Runtime 0.379165, Loss 0.433577, forward nfe 17902, backward nfe 0, Train: 0.8571, Val: 0.8456, Test: 0.8467, Best time: 100.0000
Epoch: 037/100, Runtime 0.374097, Loss 0.356837, forward nfe 18242, backward nfe 0, Train: 0.9071, Val: 0.8463, Test: 0.8477, Best time: 85.8412
Epoch: 038/100, Runtime 0.377235, Loss 0.350237, forward nfe 18576, backward nfe 0, Train: 0.9071, Val: 0.8463, Test: 0.8477, Best time: 100.0000
Epoch: 039/100, Runtime 0.366796, Loss 0.321681, forward nfe 18916, backward nfe 0, Train: 0.9071, Val: 0.8463, Test: 0.8477, Best time: 100.0000
Epoch: 040/100, Runtime 0.378871, Loss 0.329618, forward nfe 19232, backward nfe 0, Train: 0.9071, Val: 0.8463, Test: 0.8477, Best time: 100.0000
Epoch: 041/100, Runtime 0.359447, Loss 0.290136, forward nfe 19554, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 137.6887
Epoch: 042/100, Runtime 0.350726, Loss 0.303457, forward nfe 19864, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 043/100, Runtime 0.339623, Loss 0.309791, forward nfe 20174, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 044/100, Runtime 0.335423, Loss 0.265108, forward nfe 20472, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 045/100, Runtime 0.338622, Loss 0.275939, forward nfe 20770, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 046/100, Runtime 0.317511, Loss 0.231500, forward nfe 21062, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 047/100, Runtime 0.326169, Loss 0.296798, forward nfe 21342, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 048/100, Runtime 0.327932, Loss 0.275981, forward nfe 21628, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 049/100, Runtime 0.322006, Loss 0.321235, forward nfe 21914, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 050/100, Runtime 0.323870, Loss 0.227258, forward nfe 22188, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 051/100, Runtime 0.315629, Loss 0.259814, forward nfe 22468, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 052/100, Runtime 0.322757, Loss 0.241750, forward nfe 22748, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 053/100, Runtime 0.304333, Loss 0.193333, forward nfe 23022, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 054/100, Runtime 0.314391, Loss 0.205300, forward nfe 23296, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 055/100, Runtime 0.317728, Loss 0.179758, forward nfe 23570, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 056/100, Runtime 0.299912, Loss 0.192208, forward nfe 23844, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 057/100, Runtime 0.309210, Loss 0.153471, forward nfe 24106, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 058/100, Runtime 0.304079, Loss 0.171989, forward nfe 24368, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 059/100, Runtime 0.299349, Loss 0.138114, forward nfe 24630, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 060/100, Runtime 0.293615, Loss 0.098909, forward nfe 24892, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 061/100, Runtime 0.297272, Loss 0.102055, forward nfe 25142, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 062/100, Runtime 0.286773, Loss 0.090246, forward nfe 25398, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 063/100, Runtime 0.289632, Loss 0.094581, forward nfe 25648, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 064/100, Runtime 0.288007, Loss 0.111499, forward nfe 25898, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 065/100, Runtime 0.300460, Loss 0.106847, forward nfe 26154, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 066/100, Runtime 0.302490, Loss 0.164966, forward nfe 26410, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 067/100, Runtime 0.440829, Loss 0.168422, forward nfe 26660, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 068/100, Runtime 0.299132, Loss 0.098828, forward nfe 26916, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 069/100, Runtime 0.286170, Loss 0.170190, forward nfe 27172, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 070/100, Runtime 0.283571, Loss 0.074885, forward nfe 27422, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 071/100, Runtime 0.301478, Loss 0.049923, forward nfe 27672, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 072/100, Runtime 0.278699, Loss 0.082929, forward nfe 27922, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 073/100, Runtime 0.276535, Loss 0.065974, forward nfe 28160, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 074/100, Runtime 0.270941, Loss 0.092313, forward nfe 28398, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 075/100, Runtime 0.277995, Loss 0.073701, forward nfe 28636, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 076/100, Runtime 0.280671, Loss 0.056670, forward nfe 28874, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 077/100, Runtime 0.282232, Loss 0.052739, forward nfe 29112, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 078/100, Runtime 0.284878, Loss 0.078093, forward nfe 29350, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 079/100, Runtime 0.285004, Loss 0.088322, forward nfe 29588, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 080/100, Runtime 0.282228, Loss 0.080083, forward nfe 29826, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 081/100, Runtime 0.274343, Loss 0.075021, forward nfe 30064, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 082/100, Runtime 0.285773, Loss 0.062672, forward nfe 30302, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 083/100, Runtime 0.282720, Loss 0.065193, forward nfe 30546, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 084/100, Runtime 0.280513, Loss 0.059244, forward nfe 30790, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 085/100, Runtime 0.282346, Loss 0.075823, forward nfe 31034, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 086/100, Runtime 0.281814, Loss 0.059825, forward nfe 31278, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 087/100, Runtime 0.273295, Loss 0.087669, forward nfe 31522, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 088/100, Runtime 0.270403, Loss 0.037168, forward nfe 31754, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 089/100, Runtime 0.278945, Loss 0.038517, forward nfe 31986, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 090/100, Runtime 0.275108, Loss 0.040891, forward nfe 32224, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 091/100, Runtime 0.278838, Loss 0.039146, forward nfe 32462, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 092/100, Runtime 0.269729, Loss 0.081420, forward nfe 32700, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 093/100, Runtime 0.279201, Loss 0.090138, forward nfe 32938, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 094/100, Runtime 0.276026, Loss 0.047346, forward nfe 33176, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 095/100, Runtime 0.272415, Loss 0.080428, forward nfe 33414, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 096/100, Runtime 0.275697, Loss 0.057354, forward nfe 33652, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 097/100, Runtime 0.274035, Loss 0.025807, forward nfe 33890, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 098/100, Runtime 0.276647, Loss 0.035060, forward nfe 34128, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
Epoch: 099/100, Runtime 0.284766, Loss 0.075675, forward nfe 34366, backward nfe 0, Train: 0.9286, Val: 0.8493, Test: 0.8518, Best time: 100.0000
best val accuracy 0.849265 with test accuracy 0.851777 at epoch 41 and best time 100.000000