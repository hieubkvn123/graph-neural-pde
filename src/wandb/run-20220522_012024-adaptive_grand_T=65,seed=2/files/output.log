/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 3.933076, Loss 1.947570, forward nfe 122, backward nfe 0, Train: 0.2500, Val: 0.1515, Test: 0.1624, Best time: 0.0933
Epoch: 002/100, Runtime 3.777880, Loss 1.914750, forward nfe 612, backward nfe 0, Train: 0.5429, Val: 0.5529, Test: 0.5655, Best time: 2.2919
Epoch: 003/100, Runtime 3.696804, Loss 1.806530, forward nfe 1084, backward nfe 0, Train: 0.7071, Val: 0.7449, Test: 0.7401, Best time: 10.0152
Epoch: 004/100, Runtime 3.599195, Loss 1.667300, forward nfe 1538, backward nfe 0, Train: 0.7071, Val: 0.7449, Test: 0.7401, Best time: 65.0000
Epoch: 005/100, Runtime 3.480632, Loss 1.414754, forward nfe 1980, backward nfe 0, Train: 0.7071, Val: 0.7449, Test: 0.7401, Best time: 65.0000
Epoch: 006/100, Runtime 3.451725, Loss 1.198588, forward nfe 2416, backward nfe 0, Train: 0.7071, Val: 0.7449, Test: 0.7401, Best time: 65.0000
Epoch: 007/100, Runtime 3.390153, Loss 1.000111, forward nfe 2852, backward nfe 0, Train: 0.8286, Val: 0.7919, Test: 0.8203, Best time: 11.2674
Epoch: 008/100, Runtime 3.295723, Loss 0.809153, forward nfe 3270, backward nfe 0, Train: 0.8286, Val: 0.8206, Test: 0.8386, Best time: 20.3774
Epoch: 009/100, Runtime 3.297125, Loss 0.712652, forward nfe 3688, backward nfe 0, Train: 0.8286, Val: 0.8206, Test: 0.8386, Best time: 65.0000
Epoch: 010/100, Runtime 3.101799, Loss 0.637826, forward nfe 4100, backward nfe 0, Train: 0.8286, Val: 0.8206, Test: 0.8386, Best time: 65.0000
Epoch: 011/100, Runtime 3.996801, Loss 0.562252, forward nfe 4494, backward nfe 0, Train: 0.8286, Val: 0.8206, Test: 0.8386, Best time: 65.0000
Epoch: 012/100, Runtime 4.068159, Loss 0.518651, forward nfe 4882, backward nfe 0, Train: 0.8286, Val: 0.8206, Test: 0.8386, Best time: 65.0000
Epoch: 013/100, Runtime 3.759791, Loss 0.494067, forward nfe 5252, backward nfe 0, Train: 0.8714, Val: 0.8287, Test: 0.8426, Best time: 26.4905
Epoch: 014/100, Runtime 3.472192, Loss 0.499147, forward nfe 5616, backward nfe 0, Train: 0.8714, Val: 0.8287, Test: 0.8426, Best time: 65.0000
Epoch: 015/100, Runtime 3.946788, Loss 0.478601, forward nfe 5974, backward nfe 0, Train: 0.8714, Val: 0.8287, Test: 0.8426, Best time: 65.0000
Epoch: 016/100, Runtime 3.838698, Loss 0.491343, forward nfe 6326, backward nfe 0, Train: 0.8714, Val: 0.8287, Test: 0.8426, Best time: 65.0000
Epoch: 017/100, Runtime 3.915445, Loss 0.483380, forward nfe 6672, backward nfe 0, Train: 0.8714, Val: 0.8287, Test: 0.8426, Best time: 65.0000
Epoch: 018/100, Runtime 3.441724, Loss 0.406489, forward nfe 7018, backward nfe 0, Train: 0.9000, Val: 0.8324, Test: 0.8447, Best time: 43.1760
Epoch: 019/100, Runtime 2.402200, Loss 0.421430, forward nfe 7358, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 52.8984
Epoch: 020/100, Runtime 2.334460, Loss 0.398343, forward nfe 7680, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 021/100, Runtime 2.376894, Loss 0.405023, forward nfe 7996, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 022/100, Runtime 2.448365, Loss 0.413020, forward nfe 8306, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 023/100, Runtime 2.400225, Loss 0.417327, forward nfe 8604, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 024/100, Runtime 2.471022, Loss 0.337403, forward nfe 8902, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 025/100, Runtime 2.330992, Loss 0.328413, forward nfe 9206, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 026/100, Runtime 2.420990, Loss 0.331328, forward nfe 9498, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 027/100, Runtime 2.432859, Loss 0.309663, forward nfe 9802, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 028/100, Runtime 2.285844, Loss 0.292377, forward nfe 10094, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 029/100, Runtime 2.272178, Loss 0.304259, forward nfe 10368, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 030/100, Runtime 2.177472, Loss 0.330124, forward nfe 10636, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 031/100, Runtime 2.187574, Loss 0.274530, forward nfe 10898, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 032/100, Runtime 2.220359, Loss 0.248211, forward nfe 11172, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 033/100, Runtime 2.285042, Loss 0.259309, forward nfe 11446, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 034/100, Runtime 2.101894, Loss 0.282377, forward nfe 11720, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 035/100, Runtime 2.137561, Loss 0.211077, forward nfe 11982, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 036/100, Runtime 2.073874, Loss 0.226836, forward nfe 12238, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 037/100, Runtime 2.042610, Loss 0.248099, forward nfe 12494, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 038/100, Runtime 2.059626, Loss 0.250577, forward nfe 12744, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 039/100, Runtime 2.040269, Loss 0.235201, forward nfe 12994, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 040/100, Runtime 2.006377, Loss 0.199748, forward nfe 13244, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 041/100, Runtime 1.867235, Loss 0.221438, forward nfe 13488, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 042/100, Runtime 1.880770, Loss 0.191669, forward nfe 13720, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 043/100, Runtime 1.753897, Loss 0.204218, forward nfe 13952, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 044/100, Runtime 1.877619, Loss 0.214179, forward nfe 14190, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 045/100, Runtime 1.852342, Loss 0.189741, forward nfe 14428, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 046/100, Runtime 1.886814, Loss 0.148038, forward nfe 14666, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 047/100, Runtime 1.793864, Loss 0.163979, forward nfe 14892, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 048/100, Runtime 1.839610, Loss 0.139515, forward nfe 15118, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 049/100, Runtime 1.848574, Loss 0.138651, forward nfe 15338, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 050/100, Runtime 1.843790, Loss 0.144343, forward nfe 15558, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 051/100, Runtime 1.842896, Loss 0.134618, forward nfe 15778, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 052/100, Runtime 1.859253, Loss 0.165126, forward nfe 15998, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 053/100, Runtime 1.857229, Loss 0.240124, forward nfe 16224, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 054/100, Runtime 1.865036, Loss 0.113080, forward nfe 16450, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 055/100, Runtime 1.833616, Loss 0.132907, forward nfe 16676, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 056/100, Runtime 1.812066, Loss 0.128718, forward nfe 16896, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 057/100, Runtime 1.813955, Loss 0.172473, forward nfe 17116, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 058/100, Runtime 1.830749, Loss 0.114854, forward nfe 17336, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 059/100, Runtime 1.804374, Loss 0.195320, forward nfe 17556, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 060/100, Runtime 1.819143, Loss 0.084810, forward nfe 17776, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 061/100, Runtime 1.894991, Loss 0.102358, forward nfe 17996, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 062/100, Runtime 1.894658, Loss 0.103423, forward nfe 18216, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 063/100, Runtime 1.860595, Loss 0.132881, forward nfe 18442, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 064/100, Runtime 1.595457, Loss 0.123325, forward nfe 18668, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 065/100, Runtime 1.538249, Loss 0.118439, forward nfe 18894, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 066/100, Runtime 1.759495, Loss 0.101832, forward nfe 19120, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 067/100, Runtime 1.754817, Loss 0.201181, forward nfe 19346, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 068/100, Runtime 1.805102, Loss 0.081543, forward nfe 19572, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 069/100, Runtime 1.822879, Loss 0.050902, forward nfe 19798, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 070/100, Runtime 1.671849, Loss 0.099987, forward nfe 20018, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 071/100, Runtime 1.732747, Loss 0.061072, forward nfe 20238, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 072/100, Runtime 1.613951, Loss 0.043273, forward nfe 20446, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 073/100, Runtime 1.612827, Loss 0.079463, forward nfe 20660, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 074/100, Runtime 1.630310, Loss 0.068632, forward nfe 20862, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 075/100, Runtime 1.517496, Loss 0.072482, forward nfe 21064, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 076/100, Runtime 1.613059, Loss 0.053992, forward nfe 21260, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 077/100, Runtime 1.476586, Loss 0.044531, forward nfe 21456, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 078/100, Runtime 1.542066, Loss 0.035801, forward nfe 21646, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 079/100, Runtime 1.586384, Loss 0.089687, forward nfe 21842, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 080/100, Runtime 1.570459, Loss 0.058468, forward nfe 22038, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 081/100, Runtime 1.603097, Loss 0.070365, forward nfe 22234, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 082/100, Runtime 1.585991, Loss 0.050175, forward nfe 22430, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 083/100, Runtime 1.607893, Loss 0.070384, forward nfe 22620, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 084/100, Runtime 1.596347, Loss 0.041734, forward nfe 22810, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 085/100, Runtime 1.573151, Loss 0.049143, forward nfe 23000, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 086/100, Runtime 1.640598, Loss 0.044498, forward nfe 23190, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 087/100, Runtime 1.547481, Loss 0.142708, forward nfe 23380, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 088/100, Runtime 1.561587, Loss 0.063626, forward nfe 23564, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 089/100, Runtime 1.552763, Loss 0.072627, forward nfe 23748, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 090/100, Runtime 1.553748, Loss 0.058832, forward nfe 23932, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 091/100, Runtime 1.544866, Loss 0.060614, forward nfe 24116, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 092/100, Runtime 1.636641, Loss 0.036036, forward nfe 24300, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 093/100, Runtime 1.606984, Loss 0.053458, forward nfe 24490, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 094/100, Runtime 1.663368, Loss 0.068459, forward nfe 24692, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 095/100, Runtime 1.621894, Loss 0.045556, forward nfe 24882, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 096/100, Runtime 1.643105, Loss 0.039696, forward nfe 25084, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 097/100, Runtime 1.554326, Loss 0.038548, forward nfe 25268, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 098/100, Runtime 1.553649, Loss 0.043494, forward nfe 25452, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
Epoch: 099/100, Runtime 1.553029, Loss 0.048112, forward nfe 25636, backward nfe 0, Train: 0.9000, Val: 0.8368, Test: 0.8365, Best time: 65.0000
best val accuracy 0.836765 with test accuracy 0.836548 at epoch 19 and best time 65.000000