/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 3.308801, Loss 1.099108, forward nfe 56, backward nfe 280, Train: 0.8000, Val: 0.6778, Test: 0.6929, Best time: 24.1083
Epoch: 002/100, Runtime 2.448571, Loss 1.091184, forward nfe 306, backward nfe 470, Train: 0.8000, Val: 0.6778, Test: 0.6929, Best time: 20.0000
Epoch: 003/100, Runtime 3.963220, Loss 1.078215, forward nfe 556, backward nfe 807, Train: 0.8000, Val: 0.7000, Test: 0.7063, Best time: 2.5811
Epoch: 004/100, Runtime 4.594450, Loss 1.059537, forward nfe 806, backward nfe 1207, Train: 0.8333, Val: 0.7104, Test: 0.7215, Best time: 2.5091
Epoch: 005/100, Runtime 4.270783, Loss 1.031002, forward nfe 1056, backward nfe 1575, Train: 0.8667, Val: 0.7160, Test: 0.7243, Best time: 2.4414
Epoch: 006/100, Runtime 4.803616, Loss 0.994608, forward nfe 1306, backward nfe 1997, Train: 0.8667, Val: 0.7160, Test: 0.7243, Best time: 20.0000
Epoch: 007/100, Runtime 5.976210, Loss 0.947059, forward nfe 1532, backward nfe 2541, Train: 0.8667, Val: 0.7160, Test: 0.7243, Best time: 20.0000
Epoch: 008/100, Runtime 5.191840, Loss 0.903132, forward nfe 1758, backward nfe 3008, Train: 0.8667, Val: 0.7160, Test: 0.7243, Best time: 20.0000
Epoch: 009/100, Runtime 4.698075, Loss 0.832547, forward nfe 1978, backward nfe 3425, Train: 0.8667, Val: 0.7160, Test: 0.7243, Best time: 20.0000
Epoch: 010/100, Runtime 3.682125, Loss 0.759104, forward nfe 2198, backward nfe 3742, Train: 0.8667, Val: 0.7160, Test: 0.7243, Best time: 20.0000
Epoch: 011/100, Runtime 3.539632, Loss 0.694583, forward nfe 2418, backward nfe 4046, Train: 0.8667, Val: 0.7160, Test: 0.7243, Best time: 20.0000
Epoch: 012/100, Runtime 3.264827, Loss 0.615854, forward nfe 2626, backward nfe 4325, Train: 0.9000, Val: 0.7222, Test: 0.7209, Best time: 2.1338
Epoch: 013/100, Runtime 2.812433, Loss 0.554266, forward nfe 2834, backward nfe 4559, Train: 0.9167, Val: 0.7257, Test: 0.7253, Best time: 2.0976
Epoch: 014/100, Runtime 2.637556, Loss 0.493512, forward nfe 3030, backward nfe 4775, Train: 0.9167, Val: 0.7299, Test: 0.7296, Best time: 2.0637
Epoch: 015/100, Runtime 2.097129, Loss 0.441248, forward nfe 3226, backward nfe 4938, Train: 0.9333, Val: 0.7410, Test: 0.7405, Best time: 2.0334
Epoch: 016/100, Runtime 1.690331, Loss 0.368488, forward nfe 3422, backward nfe 5061, Train: 0.9500, Val: 0.7562, Test: 0.7501, Best time: 2.0059
Epoch: 017/100, Runtime 1.315801, Loss 0.354960, forward nfe 3612, backward nfe 5146, Train: 0.9667, Val: 0.7653, Test: 0.7612, Best time: 1.9825
Epoch: 018/100, Runtime 1.322856, Loss 0.290625, forward nfe 3802, backward nfe 5234, Train: 0.9333, Val: 0.7715, Test: 0.7720, Best time: 5.9729
Epoch: 019/100, Runtime 1.553937, Loss 0.314356, forward nfe 3986, backward nfe 5346, Train: 0.9667, Val: 0.7806, Test: 0.7853, Best time: 6.0943
Epoch: 020/100, Runtime 1.612195, Loss 0.279105, forward nfe 4170, backward nfe 5462, Train: 0.9333, Val: 0.7826, Test: 0.7879, Best time: 17.4571
Epoch: 021/100, Runtime 1.536737, Loss 0.245297, forward nfe 4360, backward nfe 5573, Train: 0.9333, Val: 0.7826, Test: 0.7879, Best time: 20.0000
Epoch: 022/100, Runtime 1.463469, Loss 0.235092, forward nfe 4544, backward nfe 5676, Train: 0.9333, Val: 0.7826, Test: 0.7879, Best time: 20.0000
Epoch: 023/100, Runtime 1.522568, Loss 0.247551, forward nfe 4728, backward nfe 5785, Train: 0.9333, Val: 0.7826, Test: 0.7879, Best time: 20.0000
Epoch: 024/100, Runtime 1.380697, Loss 0.194746, forward nfe 4912, backward nfe 5880, Train: 0.9833, Val: 0.7951, Test: 0.7946, Best time: 6.8701
Epoch: 025/100, Runtime 1.391129, Loss 0.175294, forward nfe 5090, backward nfe 5977, Train: 0.9667, Val: 0.8021, Test: 0.8008, Best time: 19.9325
Epoch: 026/100, Runtime 1.059874, Loss 0.228305, forward nfe 5268, backward nfe 6040, Train: 0.9667, Val: 0.8021, Test: 0.8008, Best time: 20.0000
Epoch: 027/100, Runtime 0.687403, Loss 0.217331, forward nfe 5446, backward nfe 6066, Train: 0.9667, Val: 0.8021, Test: 0.8008, Best time: 20.0000
Epoch: 028/100, Runtime 0.780994, Loss 0.232572, forward nfe 5612, backward nfe 6101, Train: 0.9667, Val: 0.8021, Test: 0.8008, Best time: 20.0000
Epoch: 029/100, Runtime 0.854987, Loss 0.213156, forward nfe 5772, backward nfe 6147, Train: 0.9667, Val: 0.8021, Test: 0.8008, Best time: 20.0000
Epoch: 030/100, Runtime 0.771245, Loss 0.190686, forward nfe 5932, backward nfe 6184, Train: 0.9667, Val: 0.8021, Test: 0.8008, Best time: 20.0000
Epoch: 031/100, Runtime 0.720865, Loss 0.222063, forward nfe 6092, backward nfe 6217, Train: 0.9667, Val: 0.8021, Test: 0.8008, Best time: 20.0000
Epoch: 032/100, Runtime 0.593571, Loss 0.162104, forward nfe 6246, backward nfe 6234, Train: 0.9667, Val: 0.8021, Test: 0.8008, Best time: 20.0000
Epoch: 033/100, Runtime 0.585385, Loss 0.150529, forward nfe 6400, backward nfe 6250, Train: 0.9667, Val: 0.8021, Test: 0.8008, Best time: 20.0000
Epoch: 034/100, Runtime 0.706815, Loss 0.236476, forward nfe 6554, backward nfe 6284, Train: 0.9667, Val: 0.8021, Test: 0.8008, Best time: 20.0000
Epoch: 035/100, Runtime 0.706324, Loss 0.127805, forward nfe 6696, backward nfe 6318, Train: 0.9667, Val: 0.8021, Test: 0.8008, Best time: 20.0000
Epoch: 036/100, Runtime 0.701514, Loss 0.149638, forward nfe 6838, backward nfe 6352, Train: 0.9667, Val: 0.8021, Test: 0.8008, Best time: 20.0000
Epoch: 037/100, Runtime 0.774269, Loss 0.159956, forward nfe 6980, backward nfe 6393, Train: 0.9667, Val: 0.8021, Test: 0.8008, Best time: 20.0000
Epoch: 038/100, Runtime 0.657329, Loss 0.146374, forward nfe 7122, backward nfe 6425, Train: 0.9667, Val: 0.8021, Test: 0.8008, Best time: 20.0000
Epoch: 039/100, Runtime 0.554456, Loss 0.137200, forward nfe 7252, backward nfe 6445, Train: 0.9667, Val: 0.8021, Test: 0.8008, Best time: 20.0000
Epoch: 040/100, Runtime 0.537016, Loss 0.162461, forward nfe 7388, backward nfe 6462, Train: 0.9667, Val: 0.8021, Test: 0.8008, Best time: 20.0000
Epoch: 041/100, Runtime 0.633908, Loss 0.111684, forward nfe 7524, backward nfe 6491, Train: 0.9833, Val: 0.8042, Test: 0.8062, Best time: 38.2752
Epoch: 042/100, Runtime 0.693904, Loss 0.120381, forward nfe 7654, backward nfe 6528, Train: 0.9667, Val: 0.8069, Test: 0.8057, Best time: 46.9565
Epoch: 043/100, Runtime 0.705178, Loss 0.104204, forward nfe 7784, backward nfe 6566, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 39.6349
Epoch: 044/100, Runtime 0.613691, Loss 0.102990, forward nfe 7914, backward nfe 6594, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 045/100, Runtime 0.654057, Loss 0.107596, forward nfe 8044, backward nfe 6627, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 046/100, Runtime 0.560892, Loss 0.108052, forward nfe 8168, backward nfe 6651, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 047/100, Runtime 0.573872, Loss 0.167730, forward nfe 8292, backward nfe 6675, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 048/100, Runtime 0.529861, Loss 0.090157, forward nfe 8416, backward nfe 6695, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 049/100, Runtime 0.542614, Loss 0.106699, forward nfe 8540, backward nfe 6716, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 050/100, Runtime 0.516822, Loss 0.094346, forward nfe 8664, backward nfe 6734, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 051/100, Runtime 0.519703, Loss 0.126164, forward nfe 8788, backward nfe 6750, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 052/100, Runtime 0.514370, Loss 0.086700, forward nfe 8918, backward nfe 6767, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 053/100, Runtime 0.452317, Loss 0.081168, forward nfe 9042, backward nfe 6781, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 054/100, Runtime 0.459934, Loss 0.083976, forward nfe 9154, backward nfe 6796, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 055/100, Runtime 0.445256, Loss 0.075012, forward nfe 9266, backward nfe 6810, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 056/100, Runtime 0.481995, Loss 0.077884, forward nfe 9378, backward nfe 6826, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 057/100, Runtime 0.458302, Loss 0.084016, forward nfe 9496, backward nfe 6840, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 058/100, Runtime 0.434916, Loss 0.078094, forward nfe 9614, backward nfe 6852, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 059/100, Runtime 0.424643, Loss 0.079319, forward nfe 9732, backward nfe 6865, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 060/100, Runtime 0.409015, Loss 0.064652, forward nfe 9838, backward nfe 6877, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 061/100, Runtime 0.419600, Loss 0.054401, forward nfe 9944, backward nfe 6890, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 062/100, Runtime 0.412163, Loss 0.046710, forward nfe 10050, backward nfe 6902, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 063/100, Runtime 0.425568, Loss 0.065394, forward nfe 10156, backward nfe 6915, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 064/100, Runtime 0.426967, Loss 0.058886, forward nfe 10262, backward nfe 6929, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 065/100, Runtime 0.424876, Loss 0.064690, forward nfe 10368, backward nfe 6942, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 066/100, Runtime 0.415097, Loss 0.071385, forward nfe 10474, backward nfe 6955, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 067/100, Runtime 0.415989, Loss 0.063283, forward nfe 10580, backward nfe 6967, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 068/100, Runtime 0.419630, Loss 0.062110, forward nfe 10686, backward nfe 6979, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 069/100, Runtime 0.405331, Loss 0.046844, forward nfe 10792, backward nfe 6990, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 070/100, Runtime 0.409962, Loss 0.078856, forward nfe 10898, backward nfe 7002, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 071/100, Runtime 0.414082, Loss 0.064761, forward nfe 11004, backward nfe 7014, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 072/100, Runtime 0.414551, Loss 0.051217, forward nfe 11110, backward nfe 7026, Train: 0.9667, Val: 0.8090, Test: 0.8061, Best time: 20.0000
Epoch: 073/100, Runtime 0.403638, Loss 0.080959, forward nfe 11216, backward nfe 7037, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 14.5064
Epoch: 074/100, Runtime 0.405924, Loss 0.071719, forward nfe 11322, backward nfe 7049, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 075/100, Runtime 0.417599, Loss 0.036186, forward nfe 11428, backward nfe 7062, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 076/100, Runtime 0.435978, Loss 0.069592, forward nfe 11534, backward nfe 7077, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 077/100, Runtime 0.391784, Loss 0.034401, forward nfe 11634, backward nfe 7089, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 078/100, Runtime 0.393630, Loss 0.058752, forward nfe 11734, backward nfe 7101, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 079/100, Runtime 0.405971, Loss 0.068158, forward nfe 11834, backward nfe 7114, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 080/100, Runtime 0.396115, Loss 0.062923, forward nfe 11934, backward nfe 7125, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 081/100, Runtime 0.397223, Loss 0.068986, forward nfe 12034, backward nfe 7137, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 082/100, Runtime 0.404029, Loss 0.040461, forward nfe 12134, backward nfe 7150, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 083/100, Runtime 0.412677, Loss 0.118855, forward nfe 12234, backward nfe 7163, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 084/100, Runtime 0.387034, Loss 0.056038, forward nfe 12334, backward nfe 7173, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 085/100, Runtime 0.405174, Loss 0.073836, forward nfe 12434, backward nfe 7186, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 086/100, Runtime 0.399609, Loss 0.079852, forward nfe 12534, backward nfe 7197, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 087/100, Runtime 0.389844, Loss 0.073243, forward nfe 12634, backward nfe 7209, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 088/100, Runtime 0.400180, Loss 0.059803, forward nfe 12734, backward nfe 7220, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 089/100, Runtime 0.372913, Loss 0.083713, forward nfe 12834, backward nfe 7230, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 090/100, Runtime 0.392930, Loss 0.065024, forward nfe 12934, backward nfe 7242, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 091/100, Runtime 0.395692, Loss 0.061100, forward nfe 13034, backward nfe 7254, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 092/100, Runtime 0.391310, Loss 0.054604, forward nfe 13134, backward nfe 7267, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 093/100, Runtime 0.367499, Loss 0.047467, forward nfe 13228, backward nfe 7278, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 094/100, Runtime 0.377405, Loss 0.043310, forward nfe 13322, backward nfe 7290, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 095/100, Runtime 0.373510, Loss 0.024411, forward nfe 13416, backward nfe 7302, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 096/100, Runtime 0.379717, Loss 0.070354, forward nfe 13510, backward nfe 7314, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 097/100, Runtime 0.393006, Loss 0.068213, forward nfe 13604, backward nfe 7326, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 098/100, Runtime 0.375414, Loss 0.058136, forward nfe 13698, backward nfe 7338, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
Epoch: 099/100, Runtime 0.362812, Loss 0.056880, forward nfe 13792, backward nfe 7349, Train: 1.0000, Val: 0.8139, Test: 0.8028, Best time: 20.0000
best val accuracy 0.813889 with test accuracy 0.802822 at epoch 73 and best time 20.000000