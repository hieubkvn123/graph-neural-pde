/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 2.841313, Loss 1.099713, forward nfe 56, backward nfe 219, Train: 0.7667, Val: 0.6826, Test: 0.6916, Best time: 10.3191
Epoch: 002/100, Runtime 3.956855, Loss 1.090518, forward nfe 312, backward nfe 555, Train: 0.7667, Val: 0.6826, Test: 0.6916, Best time: 20.0000
Epoch: 003/100, Runtime 4.455022, Loss 1.076459, forward nfe 556, backward nfe 944, Train: 0.7333, Val: 0.6910, Test: 0.7063, Best time: 2.6717
Epoch: 004/100, Runtime 5.146954, Loss 1.061168, forward nfe 794, backward nfe 1401, Train: 0.8000, Val: 0.7458, Test: 0.7519, Best time: 5.9608
Epoch: 005/100, Runtime 4.760529, Loss 1.034464, forward nfe 1044, backward nfe 1820, Train: 0.7500, Val: 0.7576, Test: 0.7607, Best time: 15.9079
Epoch: 006/100, Runtime 4.937822, Loss 1.001881, forward nfe 1282, backward nfe 2260, Train: 0.8167, Val: 0.7667, Test: 0.7666, Best time: 10.0179
Epoch: 007/100, Runtime 4.730189, Loss 0.964580, forward nfe 1520, backward nfe 2676, Train: 0.8167, Val: 0.7667, Test: 0.7666, Best time: 20.0000
Epoch: 008/100, Runtime 4.433079, Loss 0.921421, forward nfe 1758, backward nfe 3064, Train: 0.8167, Val: 0.7667, Test: 0.7666, Best time: 20.0000
Epoch: 009/100, Runtime 4.277927, Loss 0.884958, forward nfe 1996, backward nfe 3436, Train: 0.8167, Val: 0.7667, Test: 0.7666, Best time: 20.0000
Epoch: 010/100, Runtime 4.148478, Loss 0.820815, forward nfe 2228, backward nfe 3804, Train: 0.8167, Val: 0.7667, Test: 0.7666, Best time: 20.0000
Epoch: 011/100, Runtime 3.553627, Loss 0.773141, forward nfe 2448, backward nfe 4115, Train: 0.8167, Val: 0.7667, Test: 0.7666, Best time: 20.0000
Epoch: 012/100, Runtime 3.287421, Loss 0.722685, forward nfe 2668, backward nfe 4400, Train: 0.8500, Val: 0.7757, Test: 0.7788, Best time: 15.7173
Epoch: 013/100, Runtime 2.908098, Loss 0.647005, forward nfe 2888, backward nfe 4643, Train: 0.8500, Val: 0.7826, Test: 0.7882, Best time: 31.9582
Epoch: 014/100, Runtime 2.367172, Loss 0.590023, forward nfe 3102, backward nfe 4828, Train: 0.8667, Val: 0.7882, Test: 0.7908, Best time: 27.2606
Epoch: 015/100, Runtime 1.928318, Loss 0.551055, forward nfe 3316, backward nfe 4971, Train: 0.8667, Val: 0.7896, Test: 0.7929, Best time: 22.7022
Epoch: 016/100, Runtime 2.039636, Loss 0.501730, forward nfe 3530, backward nfe 5125, Train: 0.8667, Val: 0.7896, Test: 0.7929, Best time: 20.0000
Epoch: 017/100, Runtime 1.924024, Loss 0.456760, forward nfe 3738, backward nfe 5268, Train: 0.8667, Val: 0.7896, Test: 0.7929, Best time: 20.0000
Epoch: 018/100, Runtime 2.074686, Loss 0.441020, forward nfe 3946, backward nfe 5429, Train: 0.8667, Val: 0.7896, Test: 0.7929, Best time: 20.0000
Epoch: 019/100, Runtime 2.119169, Loss 0.403311, forward nfe 4142, backward nfe 5595, Train: 0.9000, Val: 0.7931, Test: 0.7910, Best time: 75.9934
Epoch: 020/100, Runtime 2.222362, Loss 0.387338, forward nfe 4338, backward nfe 5772, Train: 0.9000, Val: 0.7944, Test: 0.7909, Best time: 77.2993
Epoch: 021/100, Runtime 2.360303, Loss 0.330874, forward nfe 4534, backward nfe 5961, Train: 0.9000, Val: 0.7944, Test: 0.7909, Best time: 20.0000
Epoch: 022/100, Runtime 1.986980, Loss 0.322743, forward nfe 4730, backward nfe 6115, Train: 0.9000, Val: 0.7944, Test: 0.7909, Best time: 20.0000
Epoch: 023/100, Runtime 1.567174, Loss 0.311824, forward nfe 4926, backward nfe 6226, Train: 0.9000, Val: 0.7944, Test: 0.7909, Best time: 20.0000
Epoch: 024/100, Runtime 1.383671, Loss 0.262477, forward nfe 5122, backward nfe 6317, Train: 0.9000, Val: 0.7944, Test: 0.7909, Best time: 20.0000
Epoch: 025/100, Runtime 1.091726, Loss 0.216442, forward nfe 5318, backward nfe 6380, Train: 0.9167, Val: 0.7972, Test: 0.7939, Best time: 95.7862
Epoch: 026/100, Runtime 0.903466, Loss 0.257347, forward nfe 5508, backward nfe 6423, Train: 0.9167, Val: 0.7972, Test: 0.7939, Best time: 20.0000
Epoch: 027/100, Runtime 1.040023, Loss 0.247132, forward nfe 5686, backward nfe 6484, Train: 0.9167, Val: 0.7972, Test: 0.7939, Best time: 20.0000
Epoch: 028/100, Runtime 0.937682, Loss 0.259554, forward nfe 5864, backward nfe 6538, Train: 0.9167, Val: 0.7972, Test: 0.7939, Best time: 20.0000
Epoch: 029/100, Runtime 0.971958, Loss 0.229151, forward nfe 6030, backward nfe 6594, Train: 0.9167, Val: 0.7972, Test: 0.7939, Best time: 20.0000
Epoch: 030/100, Runtime 0.946976, Loss 0.257542, forward nfe 6196, backward nfe 6647, Train: 0.9167, Val: 0.7972, Test: 0.7939, Best time: 20.0000
Epoch: 031/100, Runtime 0.750047, Loss 0.249051, forward nfe 6362, backward nfe 6682, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 94.4307
Epoch: 032/100, Runtime 0.688579, Loss 0.233684, forward nfe 6522, backward nfe 6711, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 033/100, Runtime 0.941032, Loss 0.258793, forward nfe 6676, backward nfe 6768, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 034/100, Runtime 0.842819, Loss 0.188699, forward nfe 6830, backward nfe 6812, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 035/100, Runtime 0.870269, Loss 0.202881, forward nfe 6990, backward nfe 6861, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 036/100, Runtime 0.913822, Loss 0.176446, forward nfe 7144, backward nfe 6915, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 037/100, Runtime 0.736195, Loss 0.156204, forward nfe 7298, backward nfe 6950, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 038/100, Runtime 0.815703, Loss 0.155221, forward nfe 7458, backward nfe 6992, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 039/100, Runtime 0.835685, Loss 0.107506, forward nfe 7618, backward nfe 7036, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 040/100, Runtime 0.767013, Loss 0.141219, forward nfe 7778, backward nfe 7076, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 041/100, Runtime 0.791832, Loss 0.111884, forward nfe 7926, backward nfe 7118, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 042/100, Runtime 0.653312, Loss 0.150056, forward nfe 8068, backward nfe 7145, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 043/100, Runtime 0.719619, Loss 0.127482, forward nfe 8222, backward nfe 7178, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 044/100, Runtime 0.566285, Loss 0.142403, forward nfe 8370, backward nfe 7198, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 045/100, Runtime 0.543219, Loss 0.133716, forward nfe 8506, backward nfe 7215, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 046/100, Runtime 0.539987, Loss 0.144672, forward nfe 8642, backward nfe 7232, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 047/100, Runtime 0.548573, Loss 0.126401, forward nfe 8778, backward nfe 7248, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 048/100, Runtime 0.515270, Loss 0.117819, forward nfe 8920, backward nfe 7262, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 049/100, Runtime 0.541462, Loss 0.123415, forward nfe 9056, backward nfe 7281, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 050/100, Runtime 0.503525, Loss 0.104312, forward nfe 9186, backward nfe 7297, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 051/100, Runtime 0.485829, Loss 0.101494, forward nfe 9316, backward nfe 7310, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 052/100, Runtime 0.509760, Loss 0.096577, forward nfe 9446, backward nfe 7325, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 053/100, Runtime 0.514907, Loss 0.105081, forward nfe 9576, backward nfe 7342, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 054/100, Runtime 0.507704, Loss 0.101180, forward nfe 9706, backward nfe 7358, Train: 0.9333, Val: 0.8007, Test: 0.8006, Best time: 20.0000
Epoch: 055/100, Runtime 0.508359, Loss 0.094881, forward nfe 9836, backward nfe 7374, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 53.7269
Epoch: 056/100, Runtime 0.502722, Loss 0.101687, forward nfe 9960, backward nfe 7390, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 057/100, Runtime 0.497966, Loss 0.166290, forward nfe 10084, backward nfe 7407, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 058/100, Runtime 0.487753, Loss 0.080061, forward nfe 10208, backward nfe 7423, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 059/100, Runtime 0.464055, Loss 0.085953, forward nfe 10326, backward nfe 7438, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 060/100, Runtime 0.473800, Loss 0.076975, forward nfe 10444, backward nfe 7453, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 061/100, Runtime 0.466456, Loss 0.096431, forward nfe 10562, backward nfe 7468, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 062/100, Runtime 0.486966, Loss 0.103866, forward nfe 10680, backward nfe 7485, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 063/100, Runtime 0.447599, Loss 0.081583, forward nfe 10798, backward nfe 7498, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 064/100, Runtime 0.460933, Loss 0.067998, forward nfe 10916, backward nfe 7512, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 065/100, Runtime 0.455445, Loss 0.050153, forward nfe 11034, backward nfe 7526, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 066/100, Runtime 0.447850, Loss 0.096437, forward nfe 11152, backward nfe 7539, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 067/100, Runtime 0.462761, Loss 0.072567, forward nfe 11270, backward nfe 7553, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 068/100, Runtime 0.456213, Loss 0.105010, forward nfe 11388, backward nfe 7567, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 069/100, Runtime 0.476361, Loss 0.072688, forward nfe 11506, backward nfe 7582, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 070/100, Runtime 0.458133, Loss 0.076080, forward nfe 11624, backward nfe 7596, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 071/100, Runtime 0.452056, Loss 0.116893, forward nfe 11742, backward nfe 7609, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 072/100, Runtime 0.428615, Loss 0.075176, forward nfe 11860, backward nfe 7623, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 073/100, Runtime 0.415583, Loss 0.046090, forward nfe 11966, backward nfe 7635, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 074/100, Runtime 0.441542, Loss 0.074022, forward nfe 12072, backward nfe 7649, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 075/100, Runtime 0.427406, Loss 0.079952, forward nfe 12178, backward nfe 7663, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 076/100, Runtime 0.403239, Loss 0.065399, forward nfe 12284, backward nfe 7675, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 077/100, Runtime 0.420319, Loss 0.081318, forward nfe 12390, backward nfe 7688, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 078/100, Runtime 0.422974, Loss 0.068517, forward nfe 12496, backward nfe 7701, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 079/100, Runtime 0.406337, Loss 0.078845, forward nfe 12602, backward nfe 7713, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 080/100, Runtime 0.426327, Loss 0.087789, forward nfe 12708, backward nfe 7726, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 081/100, Runtime 0.417883, Loss 0.058157, forward nfe 12814, backward nfe 7739, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 082/100, Runtime 0.435597, Loss 0.060181, forward nfe 12920, backward nfe 7753, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 083/100, Runtime 0.428741, Loss 0.071434, forward nfe 13026, backward nfe 7766, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 084/100, Runtime 0.408353, Loss 0.056972, forward nfe 13132, backward nfe 7778, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 085/100, Runtime 0.415980, Loss 0.057629, forward nfe 13238, backward nfe 7791, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 086/100, Runtime 0.418309, Loss 0.111975, forward nfe 13344, backward nfe 7804, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 087/100, Runtime 0.412995, Loss 0.061235, forward nfe 13450, backward nfe 7816, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 088/100, Runtime 0.418793, Loss 0.056435, forward nfe 13556, backward nfe 7828, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 089/100, Runtime 0.405452, Loss 0.064273, forward nfe 13662, backward nfe 7839, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 090/100, Runtime 0.411808, Loss 0.054758, forward nfe 13768, backward nfe 7851, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 091/100, Runtime 0.400628, Loss 0.049565, forward nfe 13874, backward nfe 7862, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 092/100, Runtime 0.423614, Loss 0.060002, forward nfe 13980, backward nfe 7875, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 093/100, Runtime 0.426106, Loss 0.082794, forward nfe 14086, backward nfe 7888, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 094/100, Runtime 0.424799, Loss 0.086500, forward nfe 14192, backward nfe 7902, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 095/100, Runtime 0.408583, Loss 0.040340, forward nfe 14298, backward nfe 7914, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 096/100, Runtime 0.417088, Loss 0.075486, forward nfe 14404, backward nfe 7927, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 097/100, Runtime 0.401825, Loss 0.084871, forward nfe 14510, backward nfe 7938, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 098/100, Runtime 0.406751, Loss 0.038114, forward nfe 14616, backward nfe 7949, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
Epoch: 099/100, Runtime 0.417195, Loss 0.038596, forward nfe 14722, backward nfe 7962, Train: 1.0000, Val: 0.8035, Test: 0.7951, Best time: 20.0000
best val accuracy 0.803472 with test accuracy 0.795136 at epoch 55 and best time 20.000000