/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([64, 745])
m1.module.bias
torch.Size([64])
m2.module.weight
torch.Size([8, 64])
m2.module.bias
torch.Size([8])
bn_in.weight
torch.Size([64])
bn_in.bias
torch.Size([64])
bn_out.weight
torch.Size([64])
bn_out.bias
torch.Size([64])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([64, 64])
odeblock.odefunc.d
torch.Size([64])
odeblock.odefunc.k_d
torch.Size([64])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([64, 64])
odeblock.reg_odefunc.odefunc.d
torch.Size([64])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([64])
odeblock.multihead_att_layer.Q.weight
torch.Size([64, 64])
odeblock.multihead_att_layer.Q.bias
torch.Size([64])
odeblock.multihead_att_layer.V.weight
torch.Size([64, 64])
odeblock.multihead_att_layer.V.bias
torch.Size([64])
odeblock.multihead_att_layer.K.weight
torch.Size([64, 64])
odeblock.multihead_att_layer.K.bias
torch.Size([64])
odeblock.multihead_att_layer.Wout.weight
torch.Size([64, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([64])
K_d =  Parameter containing:
tensor([0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944,
        0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944,
        0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944,
        0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944,
        0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944,
        0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944,
        0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944,
        0.9944], device='cuda:0', requires_grad=True)
Epoch: 001/100, Runtime 1.550493, Loss 2.081036, forward nfe 32, backward nfe 20, Train: 0.2437, Val: 0.1784, Test: 0.1951, Best time: 0.0898
K_d =  Parameter containing:
tensor([0.9889, 0.9889, 0.9901, 0.9890, 0.9889, 0.9889, 0.9889, 0.9889, 0.9889,
        0.9890, 0.9890, 0.9892, 0.9889, 0.9889, 0.9889, 0.9889, 0.9889, 0.9889,
        0.9889, 0.9889, 0.9889, 0.9889, 0.9889, 0.9891, 0.9889, 0.9890, 0.9889,
        0.9889, 0.9889, 0.9889, 0.9889, 0.9890, 0.9889, 0.9893, 0.9889, 0.9889,
        0.9890, 0.9891, 0.9889, 0.9889, 0.9891, 0.9889, 0.9889, 0.9889, 0.9889,
        0.9889, 0.9889, 0.9890, 0.9889, 0.9893, 0.9893, 0.9891, 0.9891, 0.9889,
        0.9890, 0.9889, 0.9889, 0.9889, 0.9889, 0.9890, 0.9889, 0.9889, 0.9889,
        0.9889], device='cuda:0', requires_grad=True)
Epoch: 002/100, Runtime 2.730746, Loss 1.829496, forward nfe 126, backward nfe 40, Train: 0.3438, Val: 0.2799, Test: 0.3017, Best time: 0.0837
K_d =  Parameter containing:
tensor([0.9834, 0.9834, 0.9856, 0.9834, 0.9833, 0.9833, 0.9834, 0.9834, 0.9833,
        0.9835, 0.9835, 0.9838, 0.9833, 0.9834, 0.9834, 0.9835, 0.9834, 0.9833,
        0.9833, 0.9834, 0.9833, 0.9834, 0.9835, 0.9837, 0.9836, 0.9838, 0.9833,
        0.9833, 0.9834, 0.9833, 0.9833, 0.9834, 0.9833, 0.9839, 0.9833, 0.9834,
        0.9836, 0.9838, 0.9834, 0.9833, 0.9837, 0.9833, 0.9833, 0.9833, 0.9834,
        0.9834, 0.9833, 0.9835, 0.9833, 0.9840, 0.9841, 0.9838, 0.9836, 0.9834,
        0.9835, 0.9833, 0.9833, 0.9833, 0.9833, 0.9836, 0.9833, 0.9834, 0.9835,
        0.9833], device='cuda:0', requires_grad=True)
Epoch: 003/100, Runtime 2.534972, Loss 1.663699, forward nfe 226, backward nfe 60, Train: 0.5250, Val: 0.4463, Test: 0.4520, Best time: 0.0820
K_d =  Parameter containing:
tensor([0.9780, 0.9780, 0.9813, 0.9781, 0.9778, 0.9777, 0.9780, 0.9780, 0.9778,
        0.9780, 0.9781, 0.9784, 0.9778, 0.9779, 0.9780, 0.9782, 0.9778, 0.9777,
        0.9777, 0.9779, 0.9778, 0.9781, 0.9782, 0.9782, 0.9782, 0.9784, 0.9778,
        0.9778, 0.9779, 0.9778, 0.9777, 0.9779, 0.9781, 0.9785, 0.9777, 0.9778,
        0.9781, 0.9785, 0.9779, 0.9778, 0.9782, 0.9778, 0.9778, 0.9778, 0.9781,
        0.9779, 0.9780, 0.9782, 0.9777, 0.9788, 0.9787, 0.9786, 0.9781, 0.9779,
        0.9780, 0.9778, 0.9777, 0.9777, 0.9777, 0.9784, 0.9777, 0.9779, 0.9780,
        0.9777], device='cuda:0', requires_grad=True)
Epoch: 004/100, Runtime 1.566563, Loss 1.523025, forward nfe 320, backward nfe 80, Train: 0.6125, Val: 0.5940, Test: 0.5968, Best time: 0.9043
K_d =  Parameter containing:
tensor([0.9726, 0.9725, 0.9771, 0.9726, 0.9722, 0.9722, 0.9724, 0.9725, 0.9722,
        0.9726, 0.9726, 0.9729, 0.9723, 0.9723, 0.9726, 0.9730, 0.9722, 0.9722,
        0.9721, 0.9724, 0.9723, 0.9727, 0.9729, 0.9727, 0.9728, 0.9730, 0.9722,
        0.9722, 0.9725, 0.9722, 0.9721, 0.9724, 0.9730, 0.9730, 0.9722, 0.9723,
        0.9725, 0.9731, 0.9724, 0.9722, 0.9727, 0.9722, 0.9722, 0.9722, 0.9728,
        0.9724, 0.9726, 0.9728, 0.9722, 0.9737, 0.9733, 0.9737, 0.9726, 0.9724,
        0.9724, 0.9722, 0.9723, 0.9721, 0.9721, 0.9731, 0.9721, 0.9723, 0.9724,
        0.9721], device='cuda:0', requires_grad=True)
Epoch: 005/100, Runtime 1.490509, Loss 1.359021, forward nfe 414, backward nfe 100, Train: 0.7312, Val: 0.6351, Test: 0.6537, Best time: 0.9151
K_d =  Parameter containing:
tensor([0.9671, 0.9671, 0.9729, 0.9674, 0.9666, 0.9666, 0.9669, 0.9670, 0.9666,
        0.9677, 0.9672, 0.9675, 0.9668, 0.9669, 0.9671, 0.9676, 0.9667, 0.9666,
        0.9665, 0.9668, 0.9669, 0.9672, 0.9675, 0.9672, 0.9673, 0.9678, 0.9666,
        0.9667, 0.9670, 0.9666, 0.9667, 0.9668, 0.9679, 0.9676, 0.9666, 0.9669,
        0.9670, 0.9677, 0.9669, 0.9666, 0.9671, 0.9666, 0.9666, 0.9666, 0.9675,
        0.9668, 0.9673, 0.9673, 0.9666, 0.9683, 0.9680, 0.9685, 0.9671, 0.9668,
        0.9668, 0.9666, 0.9671, 0.9668, 0.9665, 0.9679, 0.9665, 0.9668, 0.9669,
        0.9666], device='cuda:0', requires_grad=True)
Epoch: 006/100, Runtime 1.566878, Loss 1.279227, forward nfe 508, backward nfe 120, Train: 0.8125, Val: 0.6716, Test: 0.6963, Best time: 0.9258
K_d =  Parameter containing:
tensor([0.9615, 0.9616, 0.9688, 0.9620, 0.9612, 0.9610, 0.9613, 0.9615, 0.9611,
        0.9630, 0.9616, 0.9620, 0.9612, 0.9613, 0.9617, 0.9621, 0.9612, 0.9609,
        0.9609, 0.9613, 0.9615, 0.9618, 0.9621, 0.9616, 0.9618, 0.9626, 0.9610,
        0.9612, 0.9618, 0.9611, 0.9613, 0.9612, 0.9629, 0.9620, 0.9610, 0.9613,
        0.9613, 0.9623, 0.9613, 0.9610, 0.9616, 0.9611, 0.9611, 0.9610, 0.9622,
        0.9613, 0.9620, 0.9617, 0.9611, 0.9629, 0.9625, 0.9633, 0.9618, 0.9613,
        0.9612, 0.9609, 0.9618, 0.9615, 0.9610, 0.9627, 0.9608, 0.9611, 0.9613,
        0.9610], device='cuda:0', requires_grad=True)
Epoch: 007/100, Runtime 1.518393, Loss 1.184184, forward nfe 596, backward nfe 140, Train: 0.8625, Val: 0.7358, Test: 0.7516, Best time: 0.9392
K_d =  Parameter containing:
tensor([0.9559, 0.9561, 0.9651, 0.9566, 0.9557, 0.9554, 0.9557, 0.9560, 0.9555,
        0.9583, 0.9560, 0.9564, 0.9557, 0.9559, 0.9562, 0.9566, 0.9557, 0.9552,
        0.9553, 0.9557, 0.9560, 0.9564, 0.9567, 0.9559, 0.9562, 0.9574, 0.9554,
        0.9557, 0.9567, 0.9555, 0.9560, 0.9556, 0.9578, 0.9564, 0.9554, 0.9559,
        0.9557, 0.9568, 0.9558, 0.9554, 0.9560, 0.9554, 0.9556, 0.9554, 0.9567,
        0.9558, 0.9568, 0.9561, 0.9556, 0.9574, 0.9570, 0.9579, 0.9565, 0.9557,
        0.9555, 0.9553, 0.9565, 0.9562, 0.9556, 0.9574, 0.9552, 0.9555, 0.9557,
        0.9555], device='cuda:0', requires_grad=True)
Epoch: 008/100, Runtime 1.382823, Loss 1.083765, forward nfe 684, backward nfe 160, Train: 0.9125, Val: 0.8030, Test: 0.8228, Best time: 2.2062
K_d =  Parameter containing:
tensor([0.9503, 0.9506, 0.9616, 0.9511, 0.9502, 0.9497, 0.9501, 0.9503, 0.9501,
        0.9536, 0.9504, 0.9508, 0.9502, 0.9504, 0.9508, 0.9512, 0.9503, 0.9496,
        0.9497, 0.9502, 0.9504, 0.9509, 0.9512, 0.9502, 0.9506, 0.9522, 0.9498,
        0.9502, 0.9515, 0.9500, 0.9508, 0.9499, 0.9526, 0.9508, 0.9498, 0.9504,
        0.9499, 0.9514, 0.9503, 0.9498, 0.9505, 0.9498, 0.9501, 0.9498, 0.9513,
        0.9503, 0.9515, 0.9505, 0.9500, 0.9518, 0.9514, 0.9524, 0.9510, 0.9501,
        0.9498, 0.9497, 0.9511, 0.9507, 0.9501, 0.9523, 0.9496, 0.9498, 0.9500,
        0.9499], device='cuda:0', requires_grad=True)
Epoch: 009/100, Runtime 1.576824, Loss 1.013154, forward nfe 772, backward nfe 180, Train: 0.9250, Val: 0.8448, Test: 0.8685, Best time: 3.6512
K_d =  Parameter containing:
tensor([0.9446, 0.9450, 0.9583, 0.9456, 0.9447, 0.9440, 0.9445, 0.9446, 0.9447,
        0.9490, 0.9447, 0.9451, 0.9446, 0.9449, 0.9453, 0.9457, 0.9450, 0.9440,
        0.9441, 0.9446, 0.9448, 0.9455, 0.9457, 0.9448, 0.9450, 0.9469, 0.9443,
        0.9447, 0.9463, 0.9445, 0.9457, 0.9442, 0.9473, 0.9451, 0.9443, 0.9451,
        0.9443, 0.9459, 0.9447, 0.9442, 0.9449, 0.9441, 0.9446, 0.9443, 0.9458,
        0.9448, 0.9462, 0.9448, 0.9445, 0.9461, 0.9458, 0.9468, 0.9457, 0.9445,
        0.9441, 0.9441, 0.9457, 0.9453, 0.9447, 0.9472, 0.9441, 0.9441, 0.9445,
        0.9444], device='cuda:0', requires_grad=True)
Epoch: 010/100, Runtime 1.473781, Loss 0.967331, forward nfe 860, backward nfe 200, Train: 0.9062, Val: 0.8612, Test: 0.8685, Best time: 3.7044
K_d =  Parameter containing:
tensor([0.9389, 0.9394, 0.9548, 0.9400, 0.9392, 0.9383, 0.9390, 0.9389, 0.9393,
        0.9442, 0.9390, 0.9396, 0.9391, 0.9394, 0.9398, 0.9402, 0.9396, 0.9384,
        0.9384, 0.9390, 0.9392, 0.9401, 0.9402, 0.9395, 0.9393, 0.9417, 0.9387,
        0.9391, 0.9411, 0.9391, 0.9406, 0.9384, 0.9418, 0.9394, 0.9387, 0.9397,
        0.9387, 0.9405, 0.9391, 0.9386, 0.9393, 0.9383, 0.9392, 0.9388, 0.9403,
        0.9394, 0.9408, 0.9391, 0.9390, 0.9404, 0.9404, 0.9412, 0.9403, 0.9390,
        0.9384, 0.9385, 0.9403, 0.9398, 0.9393, 0.9420, 0.9385, 0.9384, 0.9389,
        0.9389], device='cuda:0', requires_grad=True)
Epoch: 011/100, Runtime 1.451674, Loss 0.860265, forward nfe 948, backward nfe 220, Train: 0.9062, Val: 0.8612, Test: 0.8685, Best time: 5.0000
K_d =  Parameter containing:
tensor([0.9333, 0.9339, 0.9512, 0.9344, 0.9337, 0.9326, 0.9334, 0.9330, 0.9339,
        0.9396, 0.9334, 0.9340, 0.9337, 0.9338, 0.9344, 0.9347, 0.9342, 0.9327,
        0.9328, 0.9333, 0.9336, 0.9346, 0.9346, 0.9341, 0.9337, 0.9365, 0.9331,
        0.9335, 0.9359, 0.9336, 0.9356, 0.9326, 0.9363, 0.9337, 0.9332, 0.9342,
        0.9329, 0.9352, 0.9334, 0.9330, 0.9338, 0.9325, 0.9338, 0.9334, 0.9349,
        0.9339, 0.9355, 0.9334, 0.9335, 0.9346, 0.9349, 0.9357, 0.9349, 0.9335,
        0.9326, 0.9330, 0.9348, 0.9343, 0.9340, 0.9369, 0.9329, 0.9328, 0.9332,
        0.9334], device='cuda:0', requires_grad=True)
Epoch: 012/100, Runtime 1.574853, Loss 0.771059, forward nfe 1036, backward nfe 240, Train: 0.9062, Val: 0.8612, Test: 0.8685, Best time: 5.0000
K_d =  Parameter containing:
tensor([0.9277, 0.9285, 0.9475, 0.9287, 0.9282, 0.9268, 0.9279, 0.9272, 0.9284,
        0.9349, 0.9279, 0.9285, 0.9284, 0.9281, 0.9289, 0.9292, 0.9289, 0.9270,
        0.9271, 0.9275, 0.9279, 0.9290, 0.9290, 0.9286, 0.9280, 0.9314, 0.9275,
        0.9278, 0.9309, 0.9281, 0.9306, 0.9267, 0.9306, 0.9279, 0.9275, 0.9289,
        0.9271, 0.9300, 0.9276, 0.9274, 0.9283, 0.9267, 0.9284, 0.9279, 0.9295,
        0.9284, 0.9302, 0.9276, 0.9280, 0.9288, 0.9295, 0.9301, 0.9294, 0.9279,
        0.9268, 0.9275, 0.9293, 0.9288, 0.9288, 0.9315, 0.9275, 0.9272, 0.9275,
        0.9280], device='cuda:0', requires_grad=True)
Epoch: 013/100, Runtime 1.407309, Loss 0.736327, forward nfe 1124, backward nfe 260, Train: 0.9062, Val: 0.8612, Test: 0.8685, Best time: 5.0000
K_d =  Parameter containing:
tensor([0.9219, 0.9230, 0.9438, 0.9230, 0.9227, 0.9212, 0.9224, 0.9214, 0.9230,
        0.9302, 0.9224, 0.9230, 0.9231, 0.9225, 0.9234, 0.9239, 0.9235, 0.9213,
        0.9215, 0.9217, 0.9221, 0.9234, 0.9234, 0.9231, 0.9223, 0.9263, 0.9219,
        0.9221, 0.9257, 0.9227, 0.9255, 0.9208, 0.9250, 0.9222, 0.9219, 0.9237,
        0.9213, 0.9247, 0.9219, 0.9217, 0.9228, 0.9210, 0.9231, 0.9224, 0.9239,
        0.9229, 0.9250, 0.9218, 0.9225, 0.9229, 0.9241, 0.9245, 0.9240, 0.9223,
        0.9209, 0.9220, 0.9238, 0.9232, 0.9236, 0.9261, 0.9221, 0.9215, 0.9217,
        0.9226], device='cuda:0', requires_grad=True)
Epoch: 014/100, Runtime 1.488970, Loss 0.693516, forward nfe 1212, backward nfe 280, Train: 0.8875, Val: 0.8657, Test: 0.8726, Best time: 3.8557
K_d =  Parameter containing:
tensor([0.9163, 0.9175, 0.9398, 0.9173, 0.9173, 0.9155, 0.9167, 0.9156, 0.9176,
        0.9255, 0.9170, 0.9176, 0.9178, 0.9167, 0.9182, 0.9185, 0.9182, 0.9156,
        0.9158, 0.9158, 0.9164, 0.9178, 0.9177, 0.9175, 0.9167, 0.9212, 0.9163,
        0.9164, 0.9203, 0.9172, 0.9205, 0.9150, 0.9194, 0.9165, 0.9163, 0.9184,
        0.9154, 0.9194, 0.9161, 0.9161, 0.9174, 0.9153, 0.9177, 0.9168, 0.9183,
        0.9174, 0.9199, 0.9159, 0.9169, 0.9171, 0.9187, 0.9188, 0.9187, 0.9168,
        0.9150, 0.9164, 0.9183, 0.9175, 0.9184, 0.9207, 0.9167, 0.9158, 0.9158,
        0.9171], device='cuda:0', requires_grad=True)
Epoch: 015/100, Runtime 1.567064, Loss 0.658180, forward nfe 1300, backward nfe 300, Train: 0.9375, Val: 0.8694, Test: 0.8854, Best time: 3.8947
K_d =  Parameter containing:
tensor([0.9107, 0.9119, 0.9359, 0.9116, 0.9119, 0.9098, 0.9112, 0.9099, 0.9122,
        0.9208, 0.9115, 0.9121, 0.9124, 0.9109, 0.9131, 0.9132, 0.9129, 0.9098,
        0.9102, 0.9099, 0.9107, 0.9120, 0.9120, 0.9118, 0.9110, 0.9160, 0.9108,
        0.9107, 0.9147, 0.9118, 0.9156, 0.9092, 0.9139, 0.9109, 0.9109, 0.9131,
        0.9096, 0.9141, 0.9102, 0.9105, 0.9119, 0.9094, 0.9123, 0.9112, 0.9127,
        0.9119, 0.9148, 0.9099, 0.9114, 0.9112, 0.9134, 0.9131, 0.9136, 0.9113,
        0.9091, 0.9108, 0.9128, 0.9119, 0.9131, 0.9152, 0.9114, 0.9101, 0.9099,
        0.9117], device='cuda:0', requires_grad=True)
Epoch: 016/100, Runtime 1.385470, Loss 0.636418, forward nfe 1388, backward nfe 320, Train: 0.9375, Val: 0.8694, Test: 0.8854, Best time: 5.0000
K_d =  Parameter containing:
tensor([0.9050, 0.9064, 0.9321, 0.9058, 0.9065, 0.9041, 0.9057, 0.9041, 0.9068,
        0.9160, 0.9059, 0.9065, 0.9070, 0.9051, 0.9080, 0.9079, 0.9077, 0.9041,
        0.9046, 0.9041, 0.9051, 0.9061, 0.9063, 0.9063, 0.9053, 0.9106, 0.9053,
        0.9050, 0.9089, 0.9063, 0.9106, 0.9033, 0.9084, 0.9052, 0.9054, 0.9078,
        0.9036, 0.9089, 0.9043, 0.9049, 0.9065, 0.9035, 0.9070, 0.9056, 0.9072,
        0.9064, 0.9098, 0.9040, 0.9059, 0.9054, 0.9082, 0.9072, 0.9085, 0.9058,
        0.9031, 0.9053, 0.9074, 0.9061, 0.9079, 0.9098, 0.9061, 0.9043, 0.9040,
        0.9063], device='cuda:0', requires_grad=True)
Epoch: 017/100, Runtime 1.516917, Loss 0.554110, forward nfe 1476, backward nfe 340, Train: 0.9375, Val: 0.8694, Test: 0.8854, Best time: 5.0000
K_d =  Parameter containing:
tensor([0.8993, 0.9009, 0.9280, 0.9000, 0.9011, 0.8984, 0.9003, 0.8984, 0.9014,
        0.9112, 0.9003, 0.9009, 0.9016, 0.8992, 0.9028, 0.9026, 0.9023, 0.8984,
        0.8990, 0.8982, 0.8994, 0.9002, 0.9006, 0.9006, 0.8995, 0.9052, 0.8998,
        0.8992, 0.9030, 0.9010, 0.9056, 0.8973, 0.9027, 0.8996, 0.9001, 0.9023,
        0.8976, 0.9036, 0.8982, 0.8993, 0.9011, 0.8976, 0.9017, 0.8999, 0.9015,
        0.9010, 0.9048, 0.8981, 0.9004, 0.8996, 0.9029, 0.9014, 0.9034, 0.9004,
        0.8971, 0.8998, 0.9019, 0.9003, 0.9027, 0.9044, 0.9008, 0.8985, 0.8980,
        0.9008], device='cuda:0', requires_grad=True)
