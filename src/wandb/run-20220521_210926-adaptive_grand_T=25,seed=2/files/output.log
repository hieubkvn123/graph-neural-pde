/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 1.885756, Loss 1.949386, forward nfe 56, backward nfe 0, Train: 0.3500, Val: 0.2794, Test: 0.2985, Best time: 0.0899
Epoch: 002/100, Runtime 1.875300, Loss 1.913061, forward nfe 282, backward nfe 0, Train: 0.5714, Val: 0.4316, Test: 0.4426, Best time: 0.9436
Epoch: 003/100, Runtime 1.805858, Loss 1.828218, forward nfe 508, backward nfe 0, Train: 0.6929, Val: 0.4757, Test: 0.4964, Best time: 2.1772
Epoch: 004/100, Runtime 1.765930, Loss 1.676351, forward nfe 722, backward nfe 0, Train: 0.7500, Val: 0.5507, Test: 0.5766, Best time: 5.2534
Epoch: 005/100, Runtime 1.718473, Loss 1.468299, forward nfe 936, backward nfe 0, Train: 0.8429, Val: 0.6662, Test: 0.6832, Best time: 7.3710
Epoch: 006/100, Runtime 1.705434, Loss 1.234571, forward nfe 1144, backward nfe 0, Train: 0.8857, Val: 0.7846, Test: 0.7959, Best time: 7.5712
Epoch: 007/100, Runtime 1.759629, Loss 1.010852, forward nfe 1352, backward nfe 0, Train: 0.8786, Val: 0.8213, Test: 0.8244, Best time: 5.6749
Epoch: 008/100, Runtime 1.580475, Loss 0.790530, forward nfe 1560, backward nfe 0, Train: 0.8857, Val: 0.8272, Test: 0.8497, Best time: 8.0279
Epoch: 009/100, Runtime 1.630643, Loss 0.620040, forward nfe 1762, backward nfe 0, Train: 0.8857, Val: 0.8309, Test: 0.8518, Best time: 11.0661
Epoch: 010/100, Runtime 1.569771, Loss 0.505006, forward nfe 1964, backward nfe 0, Train: 0.9000, Val: 0.8397, Test: 0.8477, Best time: 11.5171
Epoch: 011/100, Runtime 1.675218, Loss 0.418688, forward nfe 2148, backward nfe 0, Train: 0.9000, Val: 0.8397, Test: 0.8477, Best time: 25.0000
Epoch: 012/100, Runtime 1.434128, Loss 0.374986, forward nfe 2332, backward nfe 0, Train: 0.9000, Val: 0.8397, Test: 0.8477, Best time: 25.0000
Epoch: 013/100, Runtime 1.515635, Loss 0.371793, forward nfe 2510, backward nfe 0, Train: 0.9000, Val: 0.8397, Test: 0.8477, Best time: 25.0000
Epoch: 014/100, Runtime 1.545346, Loss 0.331501, forward nfe 2694, backward nfe 0, Train: 0.9143, Val: 0.8507, Test: 0.8569, Best time: 54.7165
Epoch: 015/100, Runtime 1.487884, Loss 0.312431, forward nfe 2878, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 56.9215
Epoch: 016/100, Runtime 1.374823, Loss 0.297398, forward nfe 3050, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 017/100, Runtime 1.340794, Loss 0.241954, forward nfe 3216, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 018/100, Runtime 1.357876, Loss 0.216565, forward nfe 3376, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 019/100, Runtime 1.324339, Loss 0.299063, forward nfe 3536, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 020/100, Runtime 1.394671, Loss 0.310862, forward nfe 3696, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 021/100, Runtime 1.347172, Loss 0.259409, forward nfe 3862, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 022/100, Runtime 1.208605, Loss 0.249154, forward nfe 4022, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 023/100, Runtime 1.175449, Loss 0.202283, forward nfe 4176, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 024/100, Runtime 1.216940, Loss 0.269960, forward nfe 4324, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 025/100, Runtime 1.165028, Loss 0.211074, forward nfe 4472, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 026/100, Runtime 1.210769, Loss 0.196944, forward nfe 4620, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 027/100, Runtime 1.294048, Loss 0.193553, forward nfe 4768, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 028/100, Runtime 1.321281, Loss 0.170191, forward nfe 4922, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 029/100, Runtime 1.328684, Loss 0.208026, forward nfe 5076, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 030/100, Runtime 1.290153, Loss 0.210791, forward nfe 5230, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 031/100, Runtime 1.255553, Loss 0.144699, forward nfe 5384, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 032/100, Runtime 1.123428, Loss 0.133005, forward nfe 5526, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 033/100, Runtime 1.149124, Loss 0.176852, forward nfe 5662, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 034/100, Runtime 1.161103, Loss 0.164217, forward nfe 5798, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 035/100, Runtime 1.176073, Loss 0.155047, forward nfe 5934, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 036/100, Runtime 1.128940, Loss 0.113307, forward nfe 6070, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 037/100, Runtime 1.199302, Loss 0.183375, forward nfe 6206, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 038/100, Runtime 1.180609, Loss 0.254959, forward nfe 6342, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 039/100, Runtime 1.179180, Loss 0.150324, forward nfe 6478, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 040/100, Runtime 1.108742, Loss 0.156655, forward nfe 6614, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 041/100, Runtime 1.191829, Loss 0.135789, forward nfe 6750, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 042/100, Runtime 1.204318, Loss 0.129826, forward nfe 6886, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 043/100, Runtime 1.200654, Loss 0.145942, forward nfe 7022, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 044/100, Runtime 1.171398, Loss 0.160456, forward nfe 7158, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 045/100, Runtime 1.192823, Loss 0.108304, forward nfe 7300, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 046/100, Runtime 1.209916, Loss 0.126571, forward nfe 7442, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 047/100, Runtime 1.228756, Loss 0.118004, forward nfe 7584, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 048/100, Runtime 1.216673, Loss 0.087681, forward nfe 7726, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 049/100, Runtime 1.246131, Loss 0.116195, forward nfe 7868, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 050/100, Runtime 1.245869, Loss 0.070769, forward nfe 8010, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 051/100, Runtime 1.236069, Loss 0.091911, forward nfe 8152, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 052/100, Runtime 1.217471, Loss 0.127618, forward nfe 8294, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 053/100, Runtime 1.211791, Loss 0.064468, forward nfe 8436, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 054/100, Runtime 1.165191, Loss 0.084912, forward nfe 8578, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 055/100, Runtime 1.185421, Loss 0.120733, forward nfe 8720, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 056/100, Runtime 1.230025, Loss 0.105558, forward nfe 8862, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 057/100, Runtime 1.196252, Loss 0.092818, forward nfe 9004, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 058/100, Runtime 1.411741, Loss 0.069035, forward nfe 9146, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 059/100, Runtime 1.466485, Loss 0.069601, forward nfe 9288, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 060/100, Runtime 1.624788, Loss 0.103494, forward nfe 9430, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 061/100, Runtime 1.651522, Loss 0.087344, forward nfe 9572, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 062/100, Runtime 1.675649, Loss 0.071910, forward nfe 9714, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 063/100, Runtime 1.598473, Loss 0.078278, forward nfe 9856, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 064/100, Runtime 1.484534, Loss 0.083862, forward nfe 9992, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 065/100, Runtime 1.415474, Loss 0.067811, forward nfe 10128, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 066/100, Runtime 1.547826, Loss 0.049326, forward nfe 10264, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 067/100, Runtime 1.394541, Loss 0.064672, forward nfe 10400, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 068/100, Runtime 1.267332, Loss 0.068094, forward nfe 10536, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 069/100, Runtime 1.597692, Loss 0.072784, forward nfe 10672, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 070/100, Runtime 1.571277, Loss 0.068758, forward nfe 10808, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 071/100, Runtime 1.283104, Loss 0.073181, forward nfe 10944, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 072/100, Runtime 1.231896, Loss 0.050107, forward nfe 11080, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 073/100, Runtime 1.451883, Loss 0.055934, forward nfe 11216, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 074/100, Runtime 1.542073, Loss 0.085341, forward nfe 11352, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 075/100, Runtime 1.578346, Loss 0.077601, forward nfe 11488, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 076/100, Runtime 1.512515, Loss 0.063498, forward nfe 11624, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 077/100, Runtime 1.327695, Loss 0.082604, forward nfe 11760, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 078/100, Runtime 1.077368, Loss 0.051970, forward nfe 11896, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 079/100, Runtime 1.124243, Loss 0.065253, forward nfe 12032, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 080/100, Runtime 1.110862, Loss 0.059811, forward nfe 12168, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 081/100, Runtime 1.179418, Loss 0.052623, forward nfe 12304, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 082/100, Runtime 1.236405, Loss 0.031887, forward nfe 12446, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 083/100, Runtime 1.241616, Loss 0.056030, forward nfe 12588, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 084/100, Runtime 1.284804, Loss 0.052463, forward nfe 12730, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 085/100, Runtime 1.420943, Loss 0.048227, forward nfe 12878, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 086/100, Runtime 1.442408, Loss 0.037840, forward nfe 13032, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 087/100, Runtime 1.329749, Loss 0.053360, forward nfe 13192, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 088/100, Runtime 1.441182, Loss 0.041295, forward nfe 13352, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 089/100, Runtime 1.405612, Loss 0.057766, forward nfe 13518, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 090/100, Runtime 1.481570, Loss 0.083990, forward nfe 13690, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 091/100, Runtime 1.485197, Loss 0.056235, forward nfe 13862, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 092/100, Runtime 1.465289, Loss 0.023812, forward nfe 14040, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 093/100, Runtime 1.504518, Loss 0.035101, forward nfe 14218, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 094/100, Runtime 1.555529, Loss 0.033065, forward nfe 14402, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 095/100, Runtime 1.547161, Loss 0.039523, forward nfe 14586, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 096/100, Runtime 1.534841, Loss 0.044174, forward nfe 14758, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 097/100, Runtime 1.564520, Loss 0.052157, forward nfe 14948, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 098/100, Runtime 1.596533, Loss 0.046093, forward nfe 15138, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
Epoch: 099/100, Runtime 1.680784, Loss 0.065524, forward nfe 15328, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8660, Best time: 25.0000
best val accuracy 0.851471 with test accuracy 0.865990 at epoch 15 and best time 25.000000