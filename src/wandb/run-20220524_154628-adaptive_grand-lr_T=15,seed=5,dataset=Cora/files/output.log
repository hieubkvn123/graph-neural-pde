/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 1.163982, Loss 1.948700, forward nfe 50, backward nfe 0, Train: 0.8571, Val: 0.6831, Test: 0.7096, Best time: 5.5194
Epoch: 002/100, Runtime 1.071398, Loss 1.883451, forward nfe 210, backward nfe 0, Train: 0.8286, Val: 0.7213, Test: 0.7218, Best time: 7.2454
Epoch: 003/100, Runtime 1.146066, Loss 1.742738, forward nfe 370, backward nfe 0, Train: 0.8643, Val: 0.7831, Test: 0.7919, Best time: 5.2456
Epoch: 004/100, Runtime 1.130251, Loss 1.535287, forward nfe 530, backward nfe 0, Train: 0.8929, Val: 0.8213, Test: 0.8264, Best time: 9.5706
Epoch: 005/100, Runtime 1.111162, Loss 1.296101, forward nfe 690, backward nfe 0, Train: 0.9071, Val: 0.8257, Test: 0.8305, Best time: 12.6186
Epoch: 006/100, Runtime 1.113746, Loss 1.029810, forward nfe 850, backward nfe 0, Train: 0.9071, Val: 0.8257, Test: 0.8305, Best time: 15.0000
Epoch: 007/100, Runtime 1.031511, Loss 0.754144, forward nfe 1010, backward nfe 0, Train: 0.9071, Val: 0.8257, Test: 0.8305, Best time: 15.0000
Epoch: 008/100, Runtime 1.064133, Loss 0.572183, forward nfe 1164, backward nfe 0, Train: 0.9214, Val: 0.8272, Test: 0.8305, Best time: 22.6942
Epoch: 009/100, Runtime 1.091822, Loss 0.384899, forward nfe 1318, backward nfe 0, Train: 0.9214, Val: 0.8272, Test: 0.8305, Best time: 15.0000
Epoch: 010/100, Runtime 1.068797, Loss 0.335628, forward nfe 1472, backward nfe 0, Train: 0.9500, Val: 0.8390, Test: 0.8386, Best time: 32.0975
Epoch: 011/100, Runtime 0.977391, Loss 0.243781, forward nfe 1626, backward nfe 0, Train: 0.9357, Val: 0.8419, Test: 0.8457, Best time: 33.6092
Epoch: 012/100, Runtime 0.843690, Loss 0.227948, forward nfe 1768, backward nfe 0, Train: 0.9357, Val: 0.8419, Test: 0.8457, Best time: 15.0000
Epoch: 013/100, Runtime 0.994772, Loss 0.200907, forward nfe 1904, backward nfe 0, Train: 0.9357, Val: 0.8419, Test: 0.8457, Best time: 15.0000
Epoch: 014/100, Runtime 0.910847, Loss 0.192637, forward nfe 2040, backward nfe 0, Train: 0.9357, Val: 0.8419, Test: 0.8457, Best time: 15.0000
Epoch: 015/100, Runtime 0.915843, Loss 0.225416, forward nfe 2176, backward nfe 0, Train: 0.9357, Val: 0.8419, Test: 0.8457, Best time: 15.0000
Epoch: 016/100, Runtime 1.006512, Loss 0.187612, forward nfe 2312, backward nfe 0, Train: 0.9357, Val: 0.8419, Test: 0.8457, Best time: 15.0000
Epoch: 017/100, Runtime 1.010660, Loss 0.173438, forward nfe 2448, backward nfe 0, Train: 0.9357, Val: 0.8419, Test: 0.8457, Best time: 15.0000
Epoch: 018/100, Runtime 0.766576, Loss 0.197932, forward nfe 2584, backward nfe 0, Train: 0.9357, Val: 0.8419, Test: 0.8457, Best time: 15.0000
Epoch: 019/100, Runtime 0.900058, Loss 0.207202, forward nfe 2714, backward nfe 0, Train: 0.9357, Val: 0.8419, Test: 0.8457, Best time: 15.0000
Epoch: 020/100, Runtime 0.768689, Loss 0.193118, forward nfe 2832, backward nfe 0, Train: 0.9357, Val: 0.8419, Test: 0.8457, Best time: 15.0000
Epoch: 021/100, Runtime 0.775708, Loss 0.179801, forward nfe 2950, backward nfe 0, Train: 0.9357, Val: 0.8419, Test: 0.8457, Best time: 15.0000
Epoch: 022/100, Runtime 0.898129, Loss 0.167225, forward nfe 3068, backward nfe 0, Train: 0.9357, Val: 0.8419, Test: 0.8457, Best time: 15.0000
Epoch: 023/100, Runtime 0.826503, Loss 0.186163, forward nfe 3192, backward nfe 0, Train: 0.9357, Val: 0.8419, Test: 0.8457, Best time: 15.0000
Epoch: 024/100, Runtime 0.894714, Loss 0.189476, forward nfe 3316, backward nfe 0, Train: 0.9357, Val: 0.8419, Test: 0.8457, Best time: 15.0000
Epoch: 025/100, Runtime 0.878377, Loss 0.179459, forward nfe 3440, backward nfe 0, Train: 0.9357, Val: 0.8419, Test: 0.8457, Best time: 15.0000
Epoch: 026/100, Runtime 0.807984, Loss 0.191638, forward nfe 3564, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 027/100, Runtime 0.716308, Loss 0.241536, forward nfe 3676, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 028/100, Runtime 0.861071, Loss 0.191698, forward nfe 3788, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 029/100, Runtime 0.701061, Loss 0.138599, forward nfe 3900, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 030/100, Runtime 0.696421, Loss 0.120375, forward nfe 4006, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 031/100, Runtime 0.895447, Loss 0.169629, forward nfe 4112, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 032/100, Runtime 0.715611, Loss 0.116994, forward nfe 4224, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 033/100, Runtime 0.824536, Loss 0.140811, forward nfe 4336, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 034/100, Runtime 0.777039, Loss 0.140292, forward nfe 4448, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 035/100, Runtime 0.578770, Loss 0.123216, forward nfe 4560, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 036/100, Runtime 0.179590, Loss 0.135776, forward nfe 4672, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 037/100, Runtime 0.163050, Loss 0.106479, forward nfe 4784, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 038/100, Runtime 0.163720, Loss 0.096352, forward nfe 4890, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 039/100, Runtime 0.164433, Loss 0.106216, forward nfe 4996, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 040/100, Runtime 0.151361, Loss 0.077869, forward nfe 5102, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 041/100, Runtime 0.834551, Loss 0.071905, forward nfe 5208, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 042/100, Runtime 0.985198, Loss 0.122500, forward nfe 5314, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 043/100, Runtime 1.142090, Loss 0.164472, forward nfe 5420, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 044/100, Runtime 1.005548, Loss 0.105482, forward nfe 5526, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 045/100, Runtime 0.958709, Loss 0.082824, forward nfe 5632, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 046/100, Runtime 1.065427, Loss 0.103088, forward nfe 5732, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 047/100, Runtime 0.831923, Loss 0.141151, forward nfe 5832, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 048/100, Runtime 1.081335, Loss 0.090726, forward nfe 5932, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 049/100, Runtime 1.152989, Loss 0.103649, forward nfe 6038, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 050/100, Runtime 0.951268, Loss 0.069176, forward nfe 6144, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 051/100, Runtime 1.068188, Loss 0.129976, forward nfe 6250, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 052/100, Runtime 1.141785, Loss 0.096050, forward nfe 6356, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 053/100, Runtime 0.954293, Loss 0.097105, forward nfe 6462, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 054/100, Runtime 1.084418, Loss 0.106542, forward nfe 6568, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 055/100, Runtime 1.172259, Loss 0.078334, forward nfe 6674, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 056/100, Runtime 1.014306, Loss 0.078245, forward nfe 6780, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 057/100, Runtime 1.083566, Loss 0.111014, forward nfe 6886, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 058/100, Runtime 1.190356, Loss 0.079976, forward nfe 6992, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 059/100, Runtime 0.984419, Loss 0.096525, forward nfe 7098, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 060/100, Runtime 1.092021, Loss 0.106970, forward nfe 7204, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 061/100, Runtime 1.381535, Loss 0.099363, forward nfe 7310, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 062/100, Runtime 1.318770, Loss 0.101475, forward nfe 7416, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 063/100, Runtime 1.235495, Loss 0.100956, forward nfe 7522, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 064/100, Runtime 1.398219, Loss 0.058712, forward nfe 7628, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 065/100, Runtime 1.310926, Loss 0.086179, forward nfe 7728, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 066/100, Runtime 1.226243, Loss 0.047251, forward nfe 7834, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 067/100, Runtime 1.314900, Loss 0.063800, forward nfe 7934, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 068/100, Runtime 1.430717, Loss 0.089687, forward nfe 8040, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 069/100, Runtime 1.220876, Loss 0.065944, forward nfe 8146, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 070/100, Runtime 1.284969, Loss 0.053017, forward nfe 8246, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 071/100, Runtime 1.379016, Loss 0.063980, forward nfe 8346, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 072/100, Runtime 1.175042, Loss 0.062971, forward nfe 8446, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 073/100, Runtime 1.295127, Loss 0.054871, forward nfe 8546, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 074/100, Runtime 1.354309, Loss 0.069040, forward nfe 8646, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 075/100, Runtime 1.205883, Loss 0.048185, forward nfe 8746, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 076/100, Runtime 1.266589, Loss 0.074942, forward nfe 8846, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 077/100, Runtime 1.361033, Loss 0.071258, forward nfe 8946, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 078/100, Runtime 1.239997, Loss 0.052253, forward nfe 9046, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 079/100, Runtime 1.215832, Loss 0.089748, forward nfe 9146, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 080/100, Runtime 1.371258, Loss 0.054841, forward nfe 9246, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 081/100, Runtime 1.264708, Loss 0.030032, forward nfe 9346, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 082/100, Runtime 1.170741, Loss 0.064213, forward nfe 9446, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 083/100, Runtime 1.375251, Loss 0.064087, forward nfe 9546, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 084/100, Runtime 1.269497, Loss 0.072332, forward nfe 9646, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 085/100, Runtime 1.120338, Loss 0.067420, forward nfe 9746, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 086/100, Runtime 1.322787, Loss 0.052643, forward nfe 9840, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 087/100, Runtime 1.249844, Loss 0.064173, forward nfe 9934, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 088/100, Runtime 1.205116, Loss 0.054970, forward nfe 10034, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 089/100, Runtime 1.354607, Loss 0.067718, forward nfe 10134, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 090/100, Runtime 1.425677, Loss 0.056966, forward nfe 10234, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 091/100, Runtime 1.342391, Loss 0.072929, forward nfe 10346, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 092/100, Runtime 1.458717, Loss 0.036796, forward nfe 10458, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 093/100, Runtime 1.472325, Loss 0.055212, forward nfe 10570, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 094/100, Runtime 1.542204, Loss 0.078645, forward nfe 10682, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 095/100, Runtime 1.526794, Loss 0.071259, forward nfe 10800, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 096/100, Runtime 1.518877, Loss 0.063191, forward nfe 10924, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 097/100, Runtime 1.704189, Loss 0.075196, forward nfe 11048, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 098/100, Runtime 1.794438, Loss 0.060186, forward nfe 11184, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
Epoch: 099/100, Runtime 1.737875, Loss 0.036275, forward nfe 11320, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8376, Best time: 15.0000
best val accuracy 0.845588 with test accuracy 0.837563 at epoch 26 and best time 15.000000