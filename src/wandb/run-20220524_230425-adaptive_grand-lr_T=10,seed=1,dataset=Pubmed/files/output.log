/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
Epoch: 001/100, Runtime 0.519025, Loss 1.098647, forward nfe 32, backward nfe 13, Train: 0.8500, Val: 0.7417, Test: 0.7341, Best time: 2.6191
Epoch: 002/100, Runtime 0.501028, Loss 1.081866, forward nfe 168, backward nfe 28, Train: 0.8500, Val: 0.7417, Test: 0.7341, Best time: 10.0000
Epoch: 003/100, Runtime 0.520854, Loss 1.060190, forward nfe 298, backward nfe 46, Train: 0.8500, Val: 0.7417, Test: 0.7341, Best time: 10.0000
Epoch: 004/100, Runtime 0.519596, Loss 1.031033, forward nfe 428, backward nfe 62, Train: 0.8500, Val: 0.7417, Test: 0.7341, Best time: 10.0000
Epoch: 005/100, Runtime 0.520911, Loss 1.000059, forward nfe 564, backward nfe 76, Train: 0.8500, Val: 0.7417, Test: 0.7341, Best time: 10.0000
Epoch: 006/100, Runtime 0.517649, Loss 0.956390, forward nfe 700, backward nfe 91, Train: 0.8500, Val: 0.7417, Test: 0.7341, Best time: 10.0000
Epoch: 007/100, Runtime 0.516611, Loss 0.908690, forward nfe 830, backward nfe 107, Train: 0.8500, Val: 0.7417, Test: 0.7341, Best time: 10.0000
Epoch: 008/100, Runtime 0.501826, Loss 0.853392, forward nfe 960, backward nfe 123, Train: 0.8500, Val: 0.7417, Test: 0.7341, Best time: 10.0000
Epoch: 009/100, Runtime 0.507554, Loss 0.797978, forward nfe 1084, backward nfe 142, Train: 0.8500, Val: 0.7417, Test: 0.7341, Best time: 10.0000
Epoch: 010/100, Runtime 0.504348, Loss 0.727371, forward nfe 1202, backward nfe 160, Train: 0.8500, Val: 0.7417, Test: 0.7341, Best time: 10.0000
Epoch: 011/100, Runtime 0.495124, Loss 0.660973, forward nfe 1320, backward nfe 177, Train: 0.8500, Val: 0.7417, Test: 0.7341, Best time: 10.0000
Epoch: 012/100, Runtime 0.505224, Loss 0.606971, forward nfe 1438, backward nfe 195, Train: 0.8500, Val: 0.7417, Test: 0.7341, Best time: 10.0000
Epoch: 013/100, Runtime 0.489242, Loss 0.516327, forward nfe 1556, backward nfe 211, Train: 0.8500, Val: 0.7417, Test: 0.7341, Best time: 10.0000
Epoch: 014/100, Runtime 0.486017, Loss 0.480857, forward nfe 1674, backward nfe 229, Train: 0.8500, Val: 0.7417, Test: 0.7341, Best time: 10.0000
Epoch: 015/100, Runtime 0.503762, Loss 0.408796, forward nfe 1786, backward nfe 248, Train: 0.8667, Val: 0.7451, Test: 0.7558, Best time: 51.4402
Epoch: 016/100, Runtime 0.458116, Loss 0.375566, forward nfe 1898, backward nfe 264, Train: 0.8667, Val: 0.7451, Test: 0.7558, Best time: 10.0000
Epoch: 017/100, Runtime 0.467037, Loss 0.316284, forward nfe 2010, backward nfe 279, Train: 0.8667, Val: 0.7451, Test: 0.7558, Best time: 10.0000
Epoch: 018/100, Runtime 0.452652, Loss 0.281767, forward nfe 2122, backward nfe 293, Train: 0.8667, Val: 0.7451, Test: 0.7558, Best time: 10.0000
Epoch: 019/100, Runtime 0.447286, Loss 0.274765, forward nfe 2228, backward nfe 309, Train: 0.8667, Val: 0.7451, Test: 0.7558, Best time: 10.0000
Epoch: 020/100, Runtime 0.436583, Loss 0.226336, forward nfe 2334, backward nfe 326, Train: 0.8667, Val: 0.7451, Test: 0.7558, Best time: 10.0000
Epoch: 021/100, Runtime 0.447693, Loss 0.202333, forward nfe 2434, backward nfe 343, Train: 0.8667, Val: 0.7451, Test: 0.7558, Best time: 10.0000
Epoch: 022/100, Runtime 0.417855, Loss 0.165287, forward nfe 2534, backward nfe 356, Train: 0.8667, Val: 0.7451, Test: 0.7558, Best time: 10.0000
Epoch: 023/100, Runtime 0.414701, Loss 0.179992, forward nfe 2640, backward nfe 369, Train: 0.8667, Val: 0.7451, Test: 0.7558, Best time: 10.0000
Epoch: 024/100, Runtime 0.430052, Loss 0.151471, forward nfe 2746, backward nfe 383, Train: 0.8667, Val: 0.7451, Test: 0.7558, Best time: 10.0000
Epoch: 025/100, Runtime 0.442839, Loss 0.150668, forward nfe 2852, backward nfe 399, Train: 0.8667, Val: 0.7451, Test: 0.7558, Best time: 10.0000
Epoch: 026/100, Runtime 0.385916, Loss 0.151898, forward nfe 2958, backward nfe 411, Train: 0.9667, Val: 0.7583, Test: 0.7665, Best time: 10.0000
Epoch: 027/100, Runtime 0.400696, Loss 0.148165, forward nfe 3052, backward nfe 425, Train: 0.9833, Val: 0.7667, Test: 0.7741, Best time: 51.4618
Epoch: 028/100, Runtime 0.396201, Loss 0.109765, forward nfe 3146, backward nfe 439, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 52.3540
Epoch: 029/100, Runtime 0.395098, Loss 0.130729, forward nfe 3240, backward nfe 453, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 030/100, Runtime 0.383914, Loss 0.140581, forward nfe 3334, backward nfe 465, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 031/100, Runtime 0.371127, Loss 0.111335, forward nfe 3428, backward nfe 476, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 032/100, Runtime 0.385395, Loss 0.138990, forward nfe 3522, backward nfe 489, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 033/100, Runtime 0.370582, Loss 0.120462, forward nfe 3616, backward nfe 502, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 034/100, Runtime 0.365489, Loss 0.106880, forward nfe 3704, backward nfe 514, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 035/100, Runtime 0.373493, Loss 0.145418, forward nfe 3792, backward nfe 529, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 036/100, Runtime 0.362658, Loss 0.095404, forward nfe 3874, backward nfe 541, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 037/100, Runtime 0.351681, Loss 0.144950, forward nfe 3956, backward nfe 553, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 038/100, Runtime 0.365301, Loss 0.125265, forward nfe 4038, backward nfe 566, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 039/100, Runtime 0.352393, Loss 0.103266, forward nfe 4120, backward nfe 580, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 040/100, Runtime 0.337061, Loss 0.092813, forward nfe 4196, backward nfe 591, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 041/100, Runtime 0.347918, Loss 0.110651, forward nfe 4278, backward nfe 603, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 042/100, Runtime 0.365986, Loss 0.096229, forward nfe 4360, backward nfe 617, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 043/100, Runtime 0.337504, Loss 0.103442, forward nfe 4436, backward nfe 630, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 044/100, Runtime 0.321736, Loss 0.099827, forward nfe 4512, backward nfe 640, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 045/100, Runtime 0.327576, Loss 0.075228, forward nfe 4594, backward nfe 652, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 046/100, Runtime 0.318870, Loss 0.115463, forward nfe 4670, backward nfe 663, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 047/100, Runtime 0.323387, Loss 0.105178, forward nfe 4746, backward nfe 675, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 048/100, Runtime 0.317145, Loss 0.099277, forward nfe 4822, backward nfe 685, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 049/100, Runtime 0.329322, Loss 0.062863, forward nfe 4898, backward nfe 697, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 050/100, Runtime 0.302827, Loss 0.112587, forward nfe 4974, backward nfe 706, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 051/100, Runtime 0.321574, Loss 0.093033, forward nfe 5050, backward nfe 717, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 052/100, Runtime 0.302582, Loss 0.098280, forward nfe 5126, backward nfe 726, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 053/100, Runtime 0.327281, Loss 0.081468, forward nfe 5202, backward nfe 738, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 054/100, Runtime 0.306457, Loss 0.067370, forward nfe 5278, backward nfe 748, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 055/100, Runtime 0.333344, Loss 0.117392, forward nfe 5354, backward nfe 761, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 056/100, Runtime 0.308522, Loss 0.067030, forward nfe 5430, backward nfe 771, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 057/100, Runtime 0.309491, Loss 0.061748, forward nfe 5506, backward nfe 781, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 058/100, Runtime 0.306300, Loss 0.061821, forward nfe 5582, backward nfe 790, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 059/100, Runtime 0.308974, Loss 0.059827, forward nfe 5658, backward nfe 800, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 060/100, Runtime 0.313907, Loss 0.068002, forward nfe 5734, backward nfe 810, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 061/100, Runtime 0.303357, Loss 0.056759, forward nfe 5810, backward nfe 819, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 062/100, Runtime 0.302273, Loss 0.077226, forward nfe 5886, backward nfe 828, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 063/100, Runtime 0.302305, Loss 0.065923, forward nfe 5962, backward nfe 837, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 064/100, Runtime 0.312765, Loss 0.062302, forward nfe 6038, backward nfe 847, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 065/100, Runtime 0.317634, Loss 0.070264, forward nfe 6114, backward nfe 858, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 066/100, Runtime 0.311030, Loss 0.063498, forward nfe 6190, backward nfe 868, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 067/100, Runtime 0.312232, Loss 0.091695, forward nfe 6266, backward nfe 878, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 068/100, Runtime 0.357953, Loss 0.126982, forward nfe 6342, backward nfe 892, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 069/100, Runtime 0.309841, Loss 0.068064, forward nfe 6418, backward nfe 902, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 070/100, Runtime 0.300390, Loss 0.042122, forward nfe 6494, backward nfe 912, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 071/100, Runtime 0.298279, Loss 0.055390, forward nfe 6570, backward nfe 921, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 072/100, Runtime 0.298586, Loss 0.055660, forward nfe 6646, backward nfe 930, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 073/100, Runtime 0.302672, Loss 0.074930, forward nfe 6722, backward nfe 939, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 074/100, Runtime 0.319555, Loss 0.088726, forward nfe 6798, backward nfe 950, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 075/100, Runtime 0.298249, Loss 0.051078, forward nfe 6874, backward nfe 959, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 076/100, Runtime 0.314458, Loss 0.072455, forward nfe 6950, backward nfe 969, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 077/100, Runtime 0.295403, Loss 0.080601, forward nfe 7026, backward nfe 978, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 078/100, Runtime 0.317525, Loss 0.057925, forward nfe 7102, backward nfe 989, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 079/100, Runtime 0.305457, Loss 0.045813, forward nfe 7178, backward nfe 999, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 080/100, Runtime 0.276646, Loss 0.072293, forward nfe 7254, backward nfe 1009, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 081/100, Runtime 0.275801, Loss 0.057444, forward nfe 7318, backward nfe 1018, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 082/100, Runtime 0.279572, Loss 0.058964, forward nfe 7382, backward nfe 1028, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 083/100, Runtime 0.290621, Loss 0.060172, forward nfe 7446, backward nfe 1039, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 084/100, Runtime 0.274233, Loss 0.046212, forward nfe 7510, backward nfe 1049, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 085/100, Runtime 0.273723, Loss 0.052500, forward nfe 7574, backward nfe 1058, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 086/100, Runtime 0.284315, Loss 0.065308, forward nfe 7638, backward nfe 1068, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 087/100, Runtime 0.267427, Loss 0.043192, forward nfe 7702, backward nfe 1077, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 088/100, Runtime 0.292440, Loss 0.044883, forward nfe 7766, backward nfe 1088, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 089/100, Runtime 0.269565, Loss 0.093332, forward nfe 7830, backward nfe 1097, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 090/100, Runtime 0.286893, Loss 0.070828, forward nfe 7894, backward nfe 1107, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 091/100, Runtime 0.281789, Loss 0.033440, forward nfe 7958, backward nfe 1118, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 092/100, Runtime 0.271875, Loss 0.057346, forward nfe 8022, backward nfe 1127, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 093/100, Runtime 0.259258, Loss 0.046802, forward nfe 8086, backward nfe 1135, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 094/100, Runtime 0.268092, Loss 0.045381, forward nfe 8150, backward nfe 1146, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 095/100, Runtime 0.258028, Loss 0.054047, forward nfe 8208, backward nfe 1155, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 096/100, Runtime 0.255300, Loss 0.053905, forward nfe 8266, backward nfe 1164, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 097/100, Runtime 0.252160, Loss 0.057024, forward nfe 8324, backward nfe 1173, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 098/100, Runtime 0.258901, Loss 0.063258, forward nfe 8382, backward nfe 1182, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
Epoch: 099/100, Runtime 0.278746, Loss 0.055830, forward nfe 8440, backward nfe 1193, Train: 0.9833, Val: 0.7681, Test: 0.7811, Best time: 10.0000
best val accuracy 0.768056 with test accuracy 0.781084 at epoch 28 and best time 10.000000