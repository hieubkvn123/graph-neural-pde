/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 2.264472, Loss 1.947344, forward nfe 50, backward nfe 0, Train: 0.6214, Val: 0.5059, Test: 0.5096, Best time: 2.3816
Epoch: 002/100, Runtime 2.246547, Loss 1.876468, forward nfe 210, backward nfe 0, Train: 0.7500, Val: 0.6522, Test: 0.6335, Best time: 3.6940
Epoch: 003/100, Runtime 2.158238, Loss 1.713015, forward nfe 370, backward nfe 0, Train: 0.8429, Val: 0.7199, Test: 0.7005, Best time: 3.6435
Epoch: 004/100, Runtime 2.301924, Loss 1.477119, forward nfe 524, backward nfe 0, Train: 0.8571, Val: 0.7412, Test: 0.7421, Best time: 7.2517
Epoch: 005/100, Runtime 2.272427, Loss 1.194086, forward nfe 684, backward nfe 0, Train: 0.8714, Val: 0.7559, Test: 0.7655, Best time: 16.4771
Epoch: 006/100, Runtime 2.241412, Loss 0.888651, forward nfe 844, backward nfe 0, Train: 0.9214, Val: 0.7794, Test: 0.8000, Best time: 7.4158
Epoch: 007/100, Runtime 2.115581, Loss 0.622736, forward nfe 1004, backward nfe 0, Train: 0.9214, Val: 0.8044, Test: 0.8162, Best time: 10.0162
Epoch: 008/100, Runtime 2.115471, Loss 0.442036, forward nfe 1158, backward nfe 0, Train: 0.9286, Val: 0.8176, Test: 0.8162, Best time: 13.3980
Epoch: 009/100, Runtime 2.173305, Loss 0.329593, forward nfe 1312, backward nfe 0, Train: 0.9286, Val: 0.8176, Test: 0.8162, Best time: 15.0000
Epoch: 010/100, Runtime 2.067792, Loss 0.252446, forward nfe 1466, backward nfe 0, Train: 0.9286, Val: 0.8176, Test: 0.8162, Best time: 15.0000
Epoch: 011/100, Runtime 2.007658, Loss 0.238236, forward nfe 1620, backward nfe 0, Train: 0.9286, Val: 0.8176, Test: 0.8162, Best time: 15.0000
Epoch: 012/100, Runtime 2.036376, Loss 0.185030, forward nfe 1762, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8203, Best time: 15.0000
Epoch: 013/100, Runtime 1.969214, Loss 0.139083, forward nfe 1898, backward nfe 0, Train: 0.9714, Val: 0.8228, Test: 0.8183, Best time: 48.9876
Epoch: 014/100, Runtime 1.903339, Loss 0.155004, forward nfe 2034, backward nfe 0, Train: 0.9786, Val: 0.8257, Test: 0.8223, Best time: 50.3388
Epoch: 015/100, Runtime 1.872655, Loss 0.118884, forward nfe 2170, backward nfe 0, Train: 0.9786, Val: 0.8257, Test: 0.8223, Best time: 15.0000
Epoch: 016/100, Runtime 1.944982, Loss 0.118920, forward nfe 2306, backward nfe 0, Train: 0.9786, Val: 0.8257, Test: 0.8223, Best time: 15.0000
Epoch: 017/100, Runtime 1.918540, Loss 0.153264, forward nfe 2442, backward nfe 0, Train: 0.9786, Val: 0.8257, Test: 0.8223, Best time: 15.0000
Epoch: 018/100, Runtime 1.936797, Loss 0.124485, forward nfe 2578, backward nfe 0, Train: 0.9786, Val: 0.8257, Test: 0.8223, Best time: 15.0000
Epoch: 019/100, Runtime 1.866475, Loss 0.140880, forward nfe 2714, backward nfe 0, Train: 0.9786, Val: 0.8257, Test: 0.8223, Best time: 15.0000
Epoch: 020/100, Runtime 1.626203, Loss 0.217961, forward nfe 2838, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 37.8705
Epoch: 021/100, Runtime 1.743705, Loss 0.133431, forward nfe 2956, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 022/100, Runtime 1.733860, Loss 0.162680, forward nfe 3074, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 023/100, Runtime 1.771636, Loss 0.111647, forward nfe 3192, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 024/100, Runtime 1.836162, Loss 0.162587, forward nfe 3310, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 025/100, Runtime 1.854798, Loss 0.149817, forward nfe 3434, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 026/100, Runtime 1.779403, Loss 0.108803, forward nfe 3558, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 027/100, Runtime 1.855472, Loss 0.119368, forward nfe 3682, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 028/100, Runtime 1.806566, Loss 0.100465, forward nfe 3806, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 029/100, Runtime 1.783199, Loss 0.074380, forward nfe 3930, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 030/100, Runtime 1.791448, Loss 0.097824, forward nfe 4054, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 031/100, Runtime 1.658640, Loss 0.145425, forward nfe 4172, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 032/100, Runtime 1.697517, Loss 0.073657, forward nfe 4290, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 033/100, Runtime 1.570175, Loss 0.111140, forward nfe 4402, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 034/100, Runtime 1.715421, Loss 0.068523, forward nfe 4514, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 035/100, Runtime 1.568518, Loss 0.098801, forward nfe 4626, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 036/100, Runtime 1.679613, Loss 0.064374, forward nfe 4738, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 037/100, Runtime 1.607900, Loss 0.101968, forward nfe 4844, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 038/100, Runtime 1.730906, Loss 0.124996, forward nfe 4956, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 039/100, Runtime 1.585382, Loss 0.093329, forward nfe 5068, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 040/100, Runtime 1.731995, Loss 0.079105, forward nfe 5180, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 041/100, Runtime 1.587037, Loss 0.058638, forward nfe 5292, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 042/100, Runtime 1.715724, Loss 0.080181, forward nfe 5404, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 043/100, Runtime 1.596742, Loss 0.099109, forward nfe 5516, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 044/100, Runtime 1.728158, Loss 0.090563, forward nfe 5628, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 045/100, Runtime 1.533387, Loss 0.061959, forward nfe 5740, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 046/100, Runtime 1.634957, Loss 0.080128, forward nfe 5846, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 047/100, Runtime 1.495353, Loss 0.082915, forward nfe 5952, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 048/100, Runtime 1.596195, Loss 0.061301, forward nfe 6058, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 049/100, Runtime 1.512438, Loss 0.093678, forward nfe 6164, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 050/100, Runtime 1.554169, Loss 0.064722, forward nfe 6270, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 051/100, Runtime 1.516701, Loss 0.064701, forward nfe 6376, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 052/100, Runtime 1.568798, Loss 0.043559, forward nfe 6482, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 053/100, Runtime 1.600341, Loss 0.063013, forward nfe 6588, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 054/100, Runtime 1.512394, Loss 0.073048, forward nfe 6694, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 055/100, Runtime 1.682358, Loss 0.086623, forward nfe 6800, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 056/100, Runtime 1.582936, Loss 0.080408, forward nfe 6912, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 057/100, Runtime 1.678224, Loss 0.051584, forward nfe 7024, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 058/100, Runtime 1.688837, Loss 0.081171, forward nfe 7136, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 059/100, Runtime 1.663936, Loss 0.059790, forward nfe 7248, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 060/100, Runtime 1.768955, Loss 0.065802, forward nfe 7360, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 061/100, Runtime 1.001414, Loss 0.059371, forward nfe 7472, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 062/100, Runtime 0.669023, Loss 0.075680, forward nfe 7584, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 063/100, Runtime 0.860237, Loss 0.051669, forward nfe 7690, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 064/100, Runtime 0.777633, Loss 0.072687, forward nfe 7796, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 065/100, Runtime 0.689745, Loss 0.056636, forward nfe 7902, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 066/100, Runtime 0.833527, Loss 0.066652, forward nfe 8008, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 067/100, Runtime 0.794497, Loss 0.049869, forward nfe 8114, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 068/100, Runtime 0.695200, Loss 0.085543, forward nfe 8220, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 069/100, Runtime 0.715844, Loss 0.063016, forward nfe 8320, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 070/100, Runtime 0.768217, Loss 0.056986, forward nfe 8420, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 071/100, Runtime 0.671272, Loss 0.059128, forward nfe 8520, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 072/100, Runtime 0.643690, Loss 0.049012, forward nfe 8614, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 073/100, Runtime 0.629714, Loss 0.051084, forward nfe 8708, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 074/100, Runtime 0.749440, Loss 0.062658, forward nfe 8802, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 075/100, Runtime 0.707065, Loss 0.079469, forward nfe 8896, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 076/100, Runtime 0.668475, Loss 0.105549, forward nfe 8990, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 077/100, Runtime 0.601542, Loss 0.066542, forward nfe 9084, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 078/100, Runtime 0.639362, Loss 0.086749, forward nfe 9178, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 079/100, Runtime 0.696470, Loss 0.052607, forward nfe 9272, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 080/100, Runtime 0.763885, Loss 0.055278, forward nfe 9366, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 081/100, Runtime 0.678426, Loss 0.100020, forward nfe 9460, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 082/100, Runtime 0.627749, Loss 0.027828, forward nfe 9554, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 083/100, Runtime 0.632435, Loss 0.044632, forward nfe 9648, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 084/100, Runtime 0.741625, Loss 0.055731, forward nfe 9742, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 085/100, Runtime 0.705416, Loss 0.046597, forward nfe 9836, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 086/100, Runtime 0.677066, Loss 0.031471, forward nfe 9930, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 087/100, Runtime 0.644513, Loss 0.082231, forward nfe 10024, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 088/100, Runtime 0.656148, Loss 0.060134, forward nfe 10118, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 089/100, Runtime 0.772113, Loss 0.084356, forward nfe 10212, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 090/100, Runtime 0.692522, Loss 0.074052, forward nfe 10306, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 091/100, Runtime 0.687828, Loss 0.061230, forward nfe 10406, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 092/100, Runtime 0.641482, Loss 0.043129, forward nfe 10506, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 093/100, Runtime 0.892677, Loss 0.059848, forward nfe 10606, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 094/100, Runtime 0.735244, Loss 0.043103, forward nfe 10718, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 095/100, Runtime 0.823025, Loss 0.056766, forward nfe 10830, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 096/100, Runtime 0.780046, Loss 0.054883, forward nfe 10942, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 097/100, Runtime 0.755905, Loss 0.046836, forward nfe 11054, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 098/100, Runtime 0.945829, Loss 0.061148, forward nfe 11166, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
Epoch: 099/100, Runtime 0.882456, Loss 0.043714, forward nfe 11290, backward nfe 0, Train: 1.0000, Val: 0.8309, Test: 0.8274, Best time: 15.0000
best val accuracy 0.830882 with test accuracy 0.827411 at epoch 20 and best time 15.000000