/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 2.372152, Loss 1.947827, forward nfe 50, backward nfe 0, Train: 0.3500, Val: 0.2735, Test: 0.2558, Best time: 0.0932
Epoch: 002/100, Runtime 2.316168, Loss 1.873403, forward nfe 216, backward nfe 0, Train: 0.7143, Val: 0.4574, Test: 0.4640, Best time: 2.2508
Epoch: 003/100, Runtime 2.244486, Loss 1.730306, forward nfe 376, backward nfe 0, Train: 0.7929, Val: 0.6956, Test: 0.7056, Best time: 12.6469
Epoch: 004/100, Runtime 2.233386, Loss 1.526433, forward nfe 536, backward nfe 0, Train: 0.8714, Val: 0.7713, Test: 0.7645, Best time: 9.7373
Epoch: 005/100, Runtime 2.241993, Loss 1.285868, forward nfe 696, backward nfe 0, Train: 0.8643, Val: 0.8176, Test: 0.8000, Best time: 39.8439
Epoch: 006/100, Runtime 2.184939, Loss 1.029413, forward nfe 856, backward nfe 0, Train: 0.9071, Val: 0.8397, Test: 0.8315, Best time: 15.0000
Epoch: 007/100, Runtime 2.178848, Loss 0.746247, forward nfe 1010, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8365, Best time: 15.0000
Epoch: 008/100, Runtime 2.197571, Loss 0.527786, forward nfe 1164, backward nfe 0, Train: 0.9214, Val: 0.8574, Test: 0.8345, Best time: 48.4473
Epoch: 009/100, Runtime 2.174936, Loss 0.362890, forward nfe 1318, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 010/100, Runtime 2.064359, Loss 0.297006, forward nfe 1472, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 011/100, Runtime 2.039931, Loss 0.217974, forward nfe 1614, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 012/100, Runtime 1.849562, Loss 0.199775, forward nfe 1750, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 013/100, Runtime 1.939976, Loss 0.184307, forward nfe 1886, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 014/100, Runtime 1.921789, Loss 0.154884, forward nfe 2022, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 015/100, Runtime 1.794252, Loss 0.134446, forward nfe 2152, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 016/100, Runtime 1.932807, Loss 0.171495, forward nfe 2282, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 017/100, Runtime 1.949516, Loss 0.191632, forward nfe 2418, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 018/100, Runtime 1.838461, Loss 0.187292, forward nfe 2554, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 019/100, Runtime 1.671550, Loss 0.178260, forward nfe 2672, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 020/100, Runtime 1.810498, Loss 0.165944, forward nfe 2790, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 021/100, Runtime 1.697807, Loss 0.162269, forward nfe 2908, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 022/100, Runtime 1.746419, Loss 0.183182, forward nfe 3026, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 023/100, Runtime 1.816174, Loss 0.168840, forward nfe 3144, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 024/100, Runtime 1.612992, Loss 0.178747, forward nfe 3268, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 025/100, Runtime 1.705248, Loss 0.137953, forward nfe 3380, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 026/100, Runtime 1.624190, Loss 0.137818, forward nfe 3492, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 027/100, Runtime 1.720900, Loss 0.131522, forward nfe 3604, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 028/100, Runtime 1.537941, Loss 0.125239, forward nfe 3710, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 029/100, Runtime 1.664002, Loss 0.126404, forward nfe 3816, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 030/100, Runtime 1.522105, Loss 0.092325, forward nfe 3922, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 031/100, Runtime 1.614013, Loss 0.118130, forward nfe 4028, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 032/100, Runtime 1.538026, Loss 0.172749, forward nfe 4134, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 033/100, Runtime 1.735435, Loss 0.113521, forward nfe 4240, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 034/100, Runtime 1.635496, Loss 0.118306, forward nfe 4352, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 035/100, Runtime 1.725221, Loss 0.143032, forward nfe 4464, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 036/100, Runtime 1.612332, Loss 0.093219, forward nfe 4576, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 037/100, Runtime 1.716195, Loss 0.103909, forward nfe 4688, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 038/100, Runtime 1.601520, Loss 0.092511, forward nfe 4800, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 039/100, Runtime 1.716728, Loss 0.120039, forward nfe 4912, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 040/100, Runtime 1.598903, Loss 0.095279, forward nfe 5024, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 041/100, Runtime 1.739845, Loss 0.076988, forward nfe 5136, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 042/100, Runtime 1.520751, Loss 0.095008, forward nfe 5248, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 043/100, Runtime 1.508743, Loss 0.082189, forward nfe 5354, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 044/100, Runtime 1.491585, Loss 0.080834, forward nfe 5454, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 045/100, Runtime 1.423050, Loss 0.101020, forward nfe 5554, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 046/100, Runtime 1.551118, Loss 0.087849, forward nfe 5654, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 047/100, Runtime 1.481167, Loss 0.065102, forward nfe 5754, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 048/100, Runtime 1.453021, Loss 0.115798, forward nfe 5854, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 049/100, Runtime 1.559633, Loss 0.069200, forward nfe 5954, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 050/100, Runtime 1.442100, Loss 0.080956, forward nfe 6054, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 051/100, Runtime 1.464733, Loss 0.074359, forward nfe 6154, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 052/100, Runtime 1.539756, Loss 0.073587, forward nfe 6254, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 053/100, Runtime 1.399503, Loss 0.092349, forward nfe 6354, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 054/100, Runtime 1.471283, Loss 0.080408, forward nfe 6454, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 055/100, Runtime 1.565645, Loss 0.078027, forward nfe 6554, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 056/100, Runtime 1.441702, Loss 0.117316, forward nfe 6654, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 057/100, Runtime 1.469163, Loss 0.069688, forward nfe 6754, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 058/100, Runtime 1.519517, Loss 0.076888, forward nfe 6854, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 059/100, Runtime 1.395179, Loss 0.087324, forward nfe 6954, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 060/100, Runtime 1.582292, Loss 0.083271, forward nfe 7054, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 061/100, Runtime 1.591721, Loss 0.109636, forward nfe 7160, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 062/100, Runtime 1.462065, Loss 0.077329, forward nfe 7266, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 063/100, Runtime 1.598135, Loss 0.099148, forward nfe 7372, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 064/100, Runtime 1.456068, Loss 0.070307, forward nfe 7478, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 065/100, Runtime 1.637552, Loss 0.106585, forward nfe 7584, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 066/100, Runtime 1.469813, Loss 0.056411, forward nfe 7684, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 067/100, Runtime 1.599711, Loss 0.056958, forward nfe 7784, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 068/100, Runtime 1.502989, Loss 0.088263, forward nfe 7884, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 069/100, Runtime 1.501301, Loss 0.047903, forward nfe 7984, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 070/100, Runtime 1.594163, Loss 0.059641, forward nfe 8084, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 071/100, Runtime 1.494432, Loss 0.081401, forward nfe 8184, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 072/100, Runtime 1.583325, Loss 0.072705, forward nfe 8284, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 073/100, Runtime 1.530189, Loss 0.049575, forward nfe 8384, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 074/100, Runtime 1.452700, Loss 0.067088, forward nfe 8484, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 075/100, Runtime 1.351397, Loss 0.054579, forward nfe 8584, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 076/100, Runtime 1.390678, Loss 0.049568, forward nfe 8672, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 077/100, Runtime 1.254411, Loss 0.061797, forward nfe 8760, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 078/100, Runtime 1.265515, Loss 0.045574, forward nfe 8848, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 079/100, Runtime 1.432508, Loss 0.072328, forward nfe 8936, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 080/100, Runtime 1.267724, Loss 0.072097, forward nfe 9024, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 081/100, Runtime 1.285070, Loss 0.051559, forward nfe 9112, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 082/100, Runtime 1.311447, Loss 0.076014, forward nfe 9200, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 083/100, Runtime 1.375684, Loss 0.043122, forward nfe 9288, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 084/100, Runtime 1.263401, Loss 0.106083, forward nfe 9376, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 085/100, Runtime 1.442021, Loss 0.076159, forward nfe 9464, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 086/100, Runtime 1.596926, Loss 0.065723, forward nfe 9564, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 087/100, Runtime 1.438544, Loss 0.065976, forward nfe 9664, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 088/100, Runtime 1.544886, Loss 0.047619, forward nfe 9764, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 089/100, Runtime 1.433047, Loss 0.079343, forward nfe 9864, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 090/100, Runtime 1.743202, Loss 0.042404, forward nfe 9964, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 091/100, Runtime 1.574145, Loss 0.038607, forward nfe 10076, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 092/100, Runtime 1.711578, Loss 0.037893, forward nfe 10188, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 093/100, Runtime 1.938365, Loss 0.052450, forward nfe 10300, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 094/100, Runtime 1.765095, Loss 0.057214, forward nfe 10424, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 095/100, Runtime 2.114546, Loss 0.051709, forward nfe 10548, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 096/100, Runtime 2.098722, Loss 0.048956, forward nfe 10684, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 097/100, Runtime 2.062110, Loss 0.031809, forward nfe 10820, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 098/100, Runtime 2.082707, Loss 0.033366, forward nfe 10956, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
Epoch: 099/100, Runtime 2.127396, Loss 0.042039, forward nfe 11092, backward nfe 0, Train: 0.9214, Val: 0.8588, Test: 0.8396, Best time: 15.0000
best val accuracy 0.858824 with test accuracy 0.839594 at epoch 9 and best time 15.000000