/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.316550, Loss 1.790178, forward nfe 86, backward nfe 0, Train: 0.3500, Val: 0.4406, Test: 0.4516, Best time: 2.8876
Epoch: 002/100, Runtime 0.271096, Loss 1.764043, forward nfe 294, backward nfe 0, Train: 0.4333, Val: 0.5000, Test: 0.5210, Best time: 15.4457
Epoch: 003/100, Runtime 0.277920, Loss 1.723316, forward nfe 508, backward nfe 0, Train: 0.5833, Val: 0.5587, Test: 0.5742, Best time: 2.0343
Epoch: 004/100, Runtime 0.272808, Loss 1.701550, forward nfe 722, backward nfe 0, Train: 0.6917, Val: 0.6870, Test: 0.6645, Best time: 26.4398
Epoch: 005/100, Runtime 0.277822, Loss 1.656356, forward nfe 936, backward nfe 0, Train: 0.7667, Val: 0.7094, Test: 0.6952, Best time: 4.9771
Epoch: 006/100, Runtime 0.292952, Loss 1.624207, forward nfe 1150, backward nfe 0, Train: 0.8417, Val: 0.7261, Test: 0.7194, Best time: 8.1037
Epoch: 007/100, Runtime 0.272407, Loss 1.602355, forward nfe 1364, backward nfe 0, Train: 0.7917, Val: 0.7341, Test: 0.7339, Best time: 14.7059
Epoch: 008/100, Runtime 0.273246, Loss 1.572313, forward nfe 1578, backward nfe 0, Train: 0.7917, Val: 0.7341, Test: 0.7339, Best time: 10.0000
Epoch: 009/100, Runtime 0.267169, Loss 1.562842, forward nfe 1792, backward nfe 0, Train: 0.7917, Val: 0.7341, Test: 0.7339, Best time: 10.0000
Epoch: 010/100, Runtime 0.268898, Loss 1.530298, forward nfe 2006, backward nfe 0, Train: 0.7917, Val: 0.7341, Test: 0.7339, Best time: 10.0000
Epoch: 011/100, Runtime 0.260800, Loss 1.499147, forward nfe 2220, backward nfe 0, Train: 0.7917, Val: 0.7341, Test: 0.7339, Best time: 10.0000
Epoch: 012/100, Runtime 0.253785, Loss 1.488381, forward nfe 2422, backward nfe 0, Train: 0.7917, Val: 0.7341, Test: 0.7339, Best time: 10.0000
Epoch: 013/100, Runtime 0.251833, Loss 1.457791, forward nfe 2624, backward nfe 0, Train: 0.7917, Val: 0.7341, Test: 0.7339, Best time: 10.0000
Epoch: 014/100, Runtime 0.248951, Loss 1.418305, forward nfe 2826, backward nfe 0, Train: 0.7917, Val: 0.7341, Test: 0.7339, Best time: 10.0000
Epoch: 015/100, Runtime 0.249197, Loss 1.350994, forward nfe 3028, backward nfe 0, Train: 0.7917, Val: 0.7341, Test: 0.7339, Best time: 10.0000
Epoch: 016/100, Runtime 0.262317, Loss 1.331829, forward nfe 3230, backward nfe 0, Train: 0.8417, Val: 0.7406, Test: 0.7339, Best time: 18.0721
Epoch: 017/100, Runtime 0.237386, Loss 1.302229, forward nfe 3432, backward nfe 0, Train: 0.8417, Val: 0.7406, Test: 0.7339, Best time: 10.0000
Epoch: 018/100, Runtime 0.242340, Loss 1.271594, forward nfe 3628, backward nfe 0, Train: 0.8417, Val: 0.7406, Test: 0.7339, Best time: 10.0000
Epoch: 019/100, Runtime 0.246451, Loss 1.261132, forward nfe 3824, backward nfe 0, Train: 0.8417, Val: 0.7406, Test: 0.7339, Best time: 10.0000
Epoch: 020/100, Runtime 0.241087, Loss 1.183210, forward nfe 4014, backward nfe 0, Train: 0.8417, Val: 0.7406, Test: 0.7339, Best time: 10.0000
Epoch: 021/100, Runtime 0.236948, Loss 1.174454, forward nfe 4204, backward nfe 0, Train: 0.8417, Val: 0.7406, Test: 0.7339, Best time: 10.0000
Epoch: 022/100, Runtime 0.244366, Loss 1.190797, forward nfe 4394, backward nfe 0, Train: 0.8417, Val: 0.7406, Test: 0.7339, Best time: 10.0000
Epoch: 023/100, Runtime 0.234138, Loss 1.136093, forward nfe 4578, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 22.0257
Epoch: 024/100, Runtime 0.241368, Loss 1.078371, forward nfe 4762, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 025/100, Runtime 0.231760, Loss 1.081281, forward nfe 4946, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 026/100, Runtime 0.231874, Loss 1.140659, forward nfe 5130, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 027/100, Runtime 0.221634, Loss 1.032642, forward nfe 5308, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 028/100, Runtime 0.221259, Loss 1.092667, forward nfe 5480, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 029/100, Runtime 0.220838, Loss 1.121976, forward nfe 5652, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 030/100, Runtime 0.218712, Loss 0.978244, forward nfe 5824, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 031/100, Runtime 0.230430, Loss 1.049946, forward nfe 5996, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 032/100, Runtime 0.215601, Loss 0.996112, forward nfe 6168, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 033/100, Runtime 0.215706, Loss 0.948912, forward nfe 6340, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 034/100, Runtime 0.202270, Loss 1.002463, forward nfe 6500, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 035/100, Runtime 0.208981, Loss 0.958984, forward nfe 6660, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 036/100, Runtime 0.210038, Loss 0.943020, forward nfe 6820, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 037/100, Runtime 0.199798, Loss 0.991023, forward nfe 6980, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 038/100, Runtime 0.208092, Loss 1.030012, forward nfe 7140, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 039/100, Runtime 0.199885, Loss 0.960445, forward nfe 7294, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 040/100, Runtime 0.201540, Loss 0.961403, forward nfe 7442, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 041/100, Runtime 0.188172, Loss 0.967330, forward nfe 7590, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 042/100, Runtime 0.183675, Loss 1.026431, forward nfe 7738, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 043/100, Runtime 0.183653, Loss 1.021080, forward nfe 7880, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 044/100, Runtime 0.180629, Loss 1.003385, forward nfe 8022, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 045/100, Runtime 0.177166, Loss 0.935958, forward nfe 8158, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 046/100, Runtime 0.181767, Loss 0.988912, forward nfe 8294, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 047/100, Runtime 0.179354, Loss 0.960389, forward nfe 8430, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 048/100, Runtime 0.178919, Loss 0.990661, forward nfe 8566, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 049/100, Runtime 0.186641, Loss 0.989966, forward nfe 8702, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 050/100, Runtime 0.176184, Loss 0.956700, forward nfe 8838, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 051/100, Runtime 0.187803, Loss 0.879111, forward nfe 8974, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 052/100, Runtime 0.174578, Loss 0.928122, forward nfe 9110, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 053/100, Runtime 0.193959, Loss 0.922266, forward nfe 9252, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 054/100, Runtime 0.189139, Loss 0.921121, forward nfe 9394, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 055/100, Runtime 0.192049, Loss 0.896624, forward nfe 9542, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 056/100, Runtime 0.195810, Loss 0.946821, forward nfe 9690, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 057/100, Runtime 0.193430, Loss 0.936326, forward nfe 9838, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 058/100, Runtime 0.189108, Loss 1.008089, forward nfe 9986, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 059/100, Runtime 0.193218, Loss 0.904693, forward nfe 10134, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 060/100, Runtime 0.200520, Loss 0.901185, forward nfe 10282, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 061/100, Runtime 0.188761, Loss 0.954452, forward nfe 10430, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 062/100, Runtime 0.199320, Loss 0.928030, forward nfe 10578, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 063/100, Runtime 0.193756, Loss 0.995654, forward nfe 10726, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 064/100, Runtime 0.184177, Loss 0.940890, forward nfe 10874, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 065/100, Runtime 0.191612, Loss 0.929978, forward nfe 11022, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 066/100, Runtime 0.188541, Loss 0.913957, forward nfe 11170, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 067/100, Runtime 0.188433, Loss 0.916577, forward nfe 11318, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 068/100, Runtime 0.188005, Loss 0.928953, forward nfe 11466, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 069/100, Runtime 0.189782, Loss 0.903953, forward nfe 11614, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 070/100, Runtime 0.193684, Loss 0.916429, forward nfe 11762, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 071/100, Runtime 0.198936, Loss 0.930143, forward nfe 11910, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 072/100, Runtime 0.193358, Loss 1.058867, forward nfe 12058, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 073/100, Runtime 0.187410, Loss 0.929385, forward nfe 12206, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 074/100, Runtime 0.195198, Loss 0.825581, forward nfe 12354, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 075/100, Runtime 0.189067, Loss 0.853903, forward nfe 12502, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 076/100, Runtime 0.187949, Loss 0.893058, forward nfe 12650, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 077/100, Runtime 0.191460, Loss 0.869722, forward nfe 12798, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 078/100, Runtime 0.196751, Loss 0.845166, forward nfe 12946, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 079/100, Runtime 0.187752, Loss 1.000444, forward nfe 13094, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 080/100, Runtime 0.188707, Loss 0.875214, forward nfe 13242, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 081/100, Runtime 0.192576, Loss 0.966181, forward nfe 13390, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 082/100, Runtime 0.189107, Loss 0.896419, forward nfe 13538, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 083/100, Runtime 0.206387, Loss 0.843603, forward nfe 13686, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 084/100, Runtime 0.188377, Loss 0.935116, forward nfe 13834, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 085/100, Runtime 0.186655, Loss 0.941948, forward nfe 13982, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 086/100, Runtime 0.190487, Loss 0.914244, forward nfe 14130, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 087/100, Runtime 0.191732, Loss 0.843774, forward nfe 14278, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 088/100, Runtime 0.190967, Loss 0.967597, forward nfe 14426, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 089/100, Runtime 0.189774, Loss 0.883066, forward nfe 14574, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 090/100, Runtime 0.192948, Loss 0.910091, forward nfe 14722, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 091/100, Runtime 0.197568, Loss 0.948290, forward nfe 14870, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 092/100, Runtime 0.190010, Loss 0.856152, forward nfe 15018, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 093/100, Runtime 0.202163, Loss 0.861027, forward nfe 15166, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 094/100, Runtime 0.188484, Loss 0.906801, forward nfe 15308, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 095/100, Runtime 0.185769, Loss 0.870449, forward nfe 15450, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 096/100, Runtime 0.189478, Loss 0.917742, forward nfe 15592, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 097/100, Runtime 0.182202, Loss 0.858562, forward nfe 15734, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 098/100, Runtime 0.189574, Loss 0.939277, forward nfe 15876, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
Epoch: 099/100, Runtime 0.191250, Loss 0.845401, forward nfe 16018, backward nfe 0, Train: 0.8583, Val: 0.7449, Test: 0.7435, Best time: 10.0000
best val accuracy 0.744928 with test accuracy 0.743548 at epoch 23 and best time 10.000000