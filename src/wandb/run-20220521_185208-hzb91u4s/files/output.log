/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 2.172758, Loss 1.945673, forward nfe 74, backward nfe 0, Train: 0.4143, Val: 0.2765, Test: 0.2812, Best time: 0.0937
Epoch: 002/100, Runtime 2.200272, Loss 1.775918, forward nfe 348, backward nfe 0, Train: 0.7643, Val: 0.6051, Test: 0.6305, Best time: 5.3501
Epoch: 003/100, Runtime 2.095196, Loss 1.500109, forward nfe 622, backward nfe 0, Train: 0.8571, Val: 0.7654, Test: 0.7736, Best time: 7.3414
Epoch: 004/100, Runtime 2.067801, Loss 1.201459, forward nfe 878, backward nfe 0, Train: 0.9143, Val: 0.8287, Test: 0.8152, Best time: 5.4021
Epoch: 005/100, Runtime 2.087109, Loss 0.907178, forward nfe 1134, backward nfe 0, Train: 0.9286, Val: 0.8404, Test: 0.8406, Best time: 34.3628
Epoch: 006/100, Runtime 2.077226, Loss 0.691000, forward nfe 1390, backward nfe 0, Train: 0.9286, Val: 0.8404, Test: 0.8406, Best time: 32.0000
Epoch: 007/100, Runtime 1.977157, Loss 0.525260, forward nfe 1640, backward nfe 0, Train: 0.9286, Val: 0.8404, Test: 0.8406, Best time: 32.0000
Epoch: 008/100, Runtime 1.937596, Loss 0.410113, forward nfe 1884, backward nfe 0, Train: 0.9286, Val: 0.8404, Test: 0.8406, Best time: 32.0000
Epoch: 009/100, Runtime 1.873828, Loss 0.364574, forward nfe 2116, backward nfe 0, Train: 0.9429, Val: 0.8426, Test: 0.8406, Best time: 11.7220
Epoch: 010/100, Runtime 1.885424, Loss 0.300089, forward nfe 2348, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 21.6412
Epoch: 011/100, Runtime 1.744962, Loss 0.264278, forward nfe 2580, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 012/100, Runtime 1.723978, Loss 0.228581, forward nfe 2806, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 013/100, Runtime 1.647623, Loss 0.244217, forward nfe 3026, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 014/100, Runtime 1.719449, Loss 0.241634, forward nfe 3228, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 015/100, Runtime 1.655777, Loss 0.233803, forward nfe 3430, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 016/100, Runtime 1.718247, Loss 0.253072, forward nfe 3626, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 017/100, Runtime 1.700462, Loss 0.231872, forward nfe 3834, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 018/100, Runtime 1.620877, Loss 0.241499, forward nfe 4042, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 019/100, Runtime 1.536285, Loss 0.196353, forward nfe 4232, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 020/100, Runtime 1.559407, Loss 0.195972, forward nfe 4416, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 021/100, Runtime 1.435025, Loss 0.189125, forward nfe 4600, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 022/100, Runtime 1.398297, Loss 0.223425, forward nfe 4772, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 023/100, Runtime 1.565015, Loss 0.176294, forward nfe 4944, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 024/100, Runtime 1.489964, Loss 0.190191, forward nfe 5128, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 025/100, Runtime 1.463843, Loss 0.223123, forward nfe 5306, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 026/100, Runtime 1.398595, Loss 0.170328, forward nfe 5472, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 027/100, Runtime 1.411916, Loss 0.143184, forward nfe 5638, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 028/100, Runtime 1.421031, Loss 0.125176, forward nfe 5804, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 029/100, Runtime 1.459364, Loss 0.145917, forward nfe 5970, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 030/100, Runtime 1.345538, Loss 0.131822, forward nfe 6136, backward nfe 0, Train: 0.9357, Val: 0.8574, Test: 0.8518, Best time: 32.0000
Epoch: 031/100, Runtime 1.354599, Loss 0.139349, forward nfe 6296, backward nfe 0, Train: 0.9786, Val: 0.8625, Test: 0.8355, Best time: 46.6346
Epoch: 032/100, Runtime 1.401823, Loss 0.145460, forward nfe 6456, backward nfe 0, Train: 0.9786, Val: 0.8625, Test: 0.8355, Best time: 32.0000
Epoch: 033/100, Runtime 1.343701, Loss 0.128048, forward nfe 6616, backward nfe 0, Train: 0.9786, Val: 0.8625, Test: 0.8355, Best time: 32.0000
Epoch: 034/100, Runtime 1.337253, Loss 0.132712, forward nfe 6776, backward nfe 0, Train: 0.9786, Val: 0.8625, Test: 0.8355, Best time: 32.0000
Epoch: 035/100, Runtime 1.358176, Loss 0.121237, forward nfe 6936, backward nfe 0, Train: 0.9786, Val: 0.8625, Test: 0.8355, Best time: 32.0000
Epoch: 036/100, Runtime 1.346740, Loss 0.155830, forward nfe 7096, backward nfe 0, Train: 0.9786, Val: 0.8625, Test: 0.8355, Best time: 32.0000
Epoch: 037/100, Runtime 1.323032, Loss 0.088725, forward nfe 7256, backward nfe 0, Train: 0.9786, Val: 0.8625, Test: 0.8355, Best time: 32.0000
Epoch: 038/100, Runtime 1.321953, Loss 0.139467, forward nfe 7416, backward nfe 0, Train: 0.9786, Val: 0.8625, Test: 0.8355, Best time: 32.0000
Epoch: 039/100, Runtime 1.232373, Loss 0.140246, forward nfe 7570, backward nfe 0, Train: 0.9786, Val: 0.8625, Test: 0.8355, Best time: 32.0000
Epoch: 040/100, Runtime 1.254841, Loss 0.107501, forward nfe 7724, backward nfe 0, Train: 0.9786, Val: 0.8625, Test: 0.8355, Best time: 32.0000
Epoch: 041/100, Runtime 1.199328, Loss 0.130600, forward nfe 7878, backward nfe 0, Train: 0.9786, Val: 0.8625, Test: 0.8355, Best time: 32.0000
Epoch: 042/100, Runtime 1.244045, Loss 0.132471, forward nfe 8026, backward nfe 0, Train: 0.9786, Val: 0.8625, Test: 0.8355, Best time: 32.0000
Epoch: 043/100, Runtime 1.264006, Loss 0.115243, forward nfe 8174, backward nfe 0, Train: 0.9786, Val: 0.8625, Test: 0.8355, Best time: 32.0000
Epoch: 044/100, Runtime 1.285573, Loss 0.138075, forward nfe 8322, backward nfe 0, Train: 0.9786, Val: 0.8625, Test: 0.8355, Best time: 32.0000
Epoch: 045/100, Runtime 1.258342, Loss 0.089046, forward nfe 8470, backward nfe 0, Train: 0.9786, Val: 0.8625, Test: 0.8355, Best time: 32.0000
Epoch: 046/100, Runtime 1.257771, Loss 0.072559, forward nfe 8618, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 83.5394
Epoch: 047/100, Runtime 1.268705, Loss 0.121822, forward nfe 8766, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 048/100, Runtime 1.257821, Loss 0.117144, forward nfe 8914, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 049/100, Runtime 1.264817, Loss 0.097197, forward nfe 9062, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 050/100, Runtime 1.250666, Loss 0.076342, forward nfe 9210, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 051/100, Runtime 1.259823, Loss 0.085351, forward nfe 9358, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 052/100, Runtime 1.247512, Loss 0.104880, forward nfe 9506, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 053/100, Runtime 1.272084, Loss 0.081361, forward nfe 9654, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 054/100, Runtime 1.228386, Loss 0.090349, forward nfe 9802, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 055/100, Runtime 1.239711, Loss 0.084134, forward nfe 9944, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 056/100, Runtime 1.253317, Loss 0.051431, forward nfe 10086, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 057/100, Runtime 1.335900, Loss 0.081058, forward nfe 10228, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 058/100, Runtime 1.228357, Loss 0.084466, forward nfe 10370, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 059/100, Runtime 1.176270, Loss 0.050171, forward nfe 10512, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 060/100, Runtime 1.180506, Loss 0.063883, forward nfe 10654, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 061/100, Runtime 1.221482, Loss 0.073075, forward nfe 10796, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 062/100, Runtime 1.228732, Loss 0.087574, forward nfe 10938, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 063/100, Runtime 1.246611, Loss 0.065952, forward nfe 11080, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 064/100, Runtime 1.224405, Loss 0.097200, forward nfe 11222, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 065/100, Runtime 1.209030, Loss 0.092167, forward nfe 11358, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 066/100, Runtime 1.074941, Loss 0.064410, forward nfe 11494, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 067/100, Runtime 1.178169, Loss 0.050416, forward nfe 11630, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 068/100, Runtime 1.195929, Loss 0.079259, forward nfe 11766, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 069/100, Runtime 1.107238, Loss 0.085561, forward nfe 11902, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 070/100, Runtime 1.023255, Loss 0.061661, forward nfe 12038, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 071/100, Runtime 1.487612, Loss 0.042859, forward nfe 12174, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 072/100, Runtime 1.524029, Loss 0.072699, forward nfe 12310, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 073/100, Runtime 1.482797, Loss 0.094710, forward nfe 12446, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 074/100, Runtime 1.502964, Loss 0.033966, forward nfe 12582, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 075/100, Runtime 1.479796, Loss 0.046719, forward nfe 12718, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 076/100, Runtime 1.531961, Loss 0.035343, forward nfe 12854, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 077/100, Runtime 1.605981, Loss 0.041166, forward nfe 12996, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 078/100, Runtime 1.578835, Loss 0.068386, forward nfe 13138, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 079/100, Runtime 1.651022, Loss 0.074540, forward nfe 13280, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 080/100, Runtime 1.589402, Loss 0.067567, forward nfe 13422, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 081/100, Runtime 1.620480, Loss 0.056271, forward nfe 13558, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 082/100, Runtime 1.597905, Loss 0.036492, forward nfe 13694, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 083/100, Runtime 1.716429, Loss 0.044060, forward nfe 13830, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 084/100, Runtime 1.571033, Loss 0.045835, forward nfe 13972, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 085/100, Runtime 1.703288, Loss 0.062802, forward nfe 14114, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 086/100, Runtime 1.683433, Loss 0.036379, forward nfe 14256, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 087/100, Runtime 1.659091, Loss 0.030835, forward nfe 14398, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 088/100, Runtime 1.800441, Loss 0.035305, forward nfe 14540, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 089/100, Runtime 1.854074, Loss 0.029806, forward nfe 14694, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 090/100, Runtime 1.628899, Loss 0.046170, forward nfe 14848, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 091/100, Runtime 1.273593, Loss 0.048643, forward nfe 15002, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 092/100, Runtime 1.259445, Loss 0.043685, forward nfe 15162, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 093/100, Runtime 1.394046, Loss 0.074767, forward nfe 15322, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 094/100, Runtime 1.429686, Loss 0.051274, forward nfe 15494, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 095/100, Runtime 1.395419, Loss 0.040715, forward nfe 15672, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 096/100, Runtime 1.360594, Loss 0.039696, forward nfe 15850, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 097/100, Runtime 1.561034, Loss 0.049714, forward nfe 16028, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 098/100, Runtime 1.490678, Loss 0.018185, forward nfe 16212, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
Epoch: 099/100, Runtime 1.559862, Loss 0.037234, forward nfe 16396, backward nfe 0, Train: 0.9786, Val: 0.8647, Test: 0.8508, Best time: 32.0000
best val accuracy 0.864706 with test accuracy 0.850761 at epoch 46 and best time 32.000000