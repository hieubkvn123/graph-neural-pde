/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 6.604176, Loss 1.948344, forward nfe 164, backward nfe 0, Train: 0.3143, Val: 0.2699, Test: 0.2772, Best time: 3.6571
Epoch: 002/100, Runtime 6.466147, Loss 2.047440, forward nfe 798, backward nfe 0, Train: 0.3143, Val: 0.2699, Test: 0.2772, Best time: 85.0000
Epoch: 003/100, Runtime 6.307610, Loss 1.958891, forward nfe 1414, backward nfe 0, Train: 0.3143, Val: 0.2699, Test: 0.2772, Best time: 85.0000
Epoch: 004/100, Runtime 6.018803, Loss 1.953506, forward nfe 2024, backward nfe 0, Train: 0.3143, Val: 0.2699, Test: 0.2772, Best time: 85.0000
Epoch: 005/100, Runtime 6.187516, Loss 1.919363, forward nfe 2628, backward nfe 0, Train: 0.6000, Val: 0.5647, Test: 0.5655, Best time: 4.9918
Epoch: 006/100, Runtime 6.035713, Loss 1.851342, forward nfe 3220, backward nfe 0, Train: 0.5857, Val: 0.6287, Test: 0.6457, Best time: 26.4010
Epoch: 007/100, Runtime 5.864569, Loss 1.821520, forward nfe 3794, backward nfe 0, Train: 0.5857, Val: 0.6287, Test: 0.6457, Best time: 85.0000
Epoch: 008/100, Runtime 5.797033, Loss 1.736808, forward nfe 4356, backward nfe 0, Train: 0.5857, Val: 0.6287, Test: 0.6457, Best time: 85.0000
Epoch: 009/100, Runtime 5.616202, Loss 1.592806, forward nfe 4912, backward nfe 0, Train: 0.5857, Val: 0.6287, Test: 0.6457, Best time: 85.0000
Epoch: 010/100, Runtime 5.296721, Loss 1.495572, forward nfe 5438, backward nfe 0, Train: 0.5857, Val: 0.6287, Test: 0.6457, Best time: 85.0000
Epoch: 011/100, Runtime 5.159351, Loss 1.351757, forward nfe 5952, backward nfe 0, Train: 0.7571, Val: 0.6816, Test: 0.6802, Best time: 20.0670
Epoch: 012/100, Runtime 5.177732, Loss 1.180961, forward nfe 6454, backward nfe 0, Train: 0.7857, Val: 0.7735, Test: 0.7919, Best time: 12.1309
Epoch: 013/100, Runtime 5.015101, Loss 1.035581, forward nfe 6950, backward nfe 0, Train: 0.7929, Val: 0.7926, Test: 0.8081, Best time: 16.7169
Epoch: 014/100, Runtime 4.851788, Loss 0.962036, forward nfe 7440, backward nfe 0, Train: 0.8286, Val: 0.8074, Test: 0.8305, Best time: 9.8193
Epoch: 015/100, Runtime 4.751825, Loss 0.894103, forward nfe 7930, backward nfe 0, Train: 0.8286, Val: 0.8074, Test: 0.8305, Best time: 85.0000
Epoch: 016/100, Runtime 4.750989, Loss 0.761233, forward nfe 8390, backward nfe 0, Train: 0.8286, Val: 0.8074, Test: 0.8305, Best time: 85.0000
Epoch: 017/100, Runtime 4.563999, Loss 0.688821, forward nfe 8844, backward nfe 0, Train: 0.8286, Val: 0.8074, Test: 0.8305, Best time: 85.0000
Epoch: 018/100, Runtime 4.518306, Loss 0.696035, forward nfe 9286, backward nfe 0, Train: 0.8714, Val: 0.8103, Test: 0.8345, Best time: 21.1952
Epoch: 019/100, Runtime 4.297342, Loss 0.608663, forward nfe 9716, backward nfe 0, Train: 0.8786, Val: 0.8221, Test: 0.8528, Best time: 16.6095
Epoch: 020/100, Runtime 4.338738, Loss 0.556148, forward nfe 10128, backward nfe 0, Train: 0.8786, Val: 0.8221, Test: 0.8528, Best time: 85.0000
Epoch: 021/100, Runtime 4.309270, Loss 0.499857, forward nfe 10528, backward nfe 0, Train: 0.8786, Val: 0.8228, Test: 0.8497, Best time: 18.4094
Epoch: 022/100, Runtime 4.039075, Loss 0.514623, forward nfe 10928, backward nfe 0, Train: 0.8929, Val: 0.8353, Test: 0.8589, Best time: 53.3047
Epoch: 023/100, Runtime 4.073721, Loss 0.513589, forward nfe 11316, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8751, Best time: 47.2914
Epoch: 024/100, Runtime 3.974913, Loss 0.434700, forward nfe 11698, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8751, Best time: 85.0000
Epoch: 025/100, Runtime 3.816738, Loss 0.393484, forward nfe 12074, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8751, Best time: 85.0000
Epoch: 026/100, Runtime 3.721731, Loss 0.448734, forward nfe 12426, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8751, Best time: 85.0000
Epoch: 027/100, Runtime 3.696000, Loss 0.408445, forward nfe 12772, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8751, Best time: 85.0000
Epoch: 028/100, Runtime 3.548209, Loss 0.378648, forward nfe 13112, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8751, Best time: 85.0000
Epoch: 029/100, Runtime 3.506726, Loss 0.369406, forward nfe 13446, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8751, Best time: 85.0000
Epoch: 030/100, Runtime 3.466363, Loss 0.404729, forward nfe 13780, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8751, Best time: 85.0000
Epoch: 031/100, Runtime 3.383607, Loss 0.333278, forward nfe 14108, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8751, Best time: 85.0000
Epoch: 032/100, Runtime 3.257620, Loss 0.319213, forward nfe 14424, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8751, Best time: 85.0000
Epoch: 033/100, Runtime 3.363068, Loss 0.326269, forward nfe 14728, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8751, Best time: 85.0000
Epoch: 034/100, Runtime 3.140311, Loss 0.314427, forward nfe 15032, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8751, Best time: 85.0000
Epoch: 035/100, Runtime 3.321363, Loss 0.297734, forward nfe 15336, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8751, Best time: 85.0000
Epoch: 036/100, Runtime 3.131674, Loss 0.277456, forward nfe 15640, backward nfe 0, Train: 0.9071, Val: 0.8434, Test: 0.8751, Best time: 85.0000
Epoch: 037/100, Runtime 3.090099, Loss 0.251466, forward nfe 15938, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 53.3998
Epoch: 038/100, Runtime 3.109609, Loss 0.243721, forward nfe 16230, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 039/100, Runtime 2.988907, Loss 0.295296, forward nfe 16510, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 040/100, Runtime 2.951084, Loss 0.226490, forward nfe 16784, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 041/100, Runtime 2.929526, Loss 0.262435, forward nfe 17058, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 042/100, Runtime 2.784216, Loss 0.180758, forward nfe 17332, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 043/100, Runtime 2.751275, Loss 0.211576, forward nfe 17606, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 044/100, Runtime 2.786675, Loss 0.200278, forward nfe 17880, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 045/100, Runtime 2.785717, Loss 0.262721, forward nfe 18148, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 046/100, Runtime 2.891533, Loss 0.245647, forward nfe 18416, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 047/100, Runtime 2.962958, Loss 0.182057, forward nfe 18684, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 048/100, Runtime 2.838927, Loss 0.203017, forward nfe 18952, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 049/100, Runtime 2.908939, Loss 0.263825, forward nfe 19220, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 050/100, Runtime 2.834618, Loss 0.188629, forward nfe 19488, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 051/100, Runtime 2.875826, Loss 0.177437, forward nfe 19756, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 052/100, Runtime 2.854928, Loss 0.196283, forward nfe 20024, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 053/100, Runtime 2.905276, Loss 0.204403, forward nfe 20292, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 054/100, Runtime 2.891420, Loss 0.181778, forward nfe 20560, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 055/100, Runtime 2.885001, Loss 0.183759, forward nfe 20828, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 056/100, Runtime 2.906690, Loss 0.161560, forward nfe 21090, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 057/100, Runtime 2.851230, Loss 0.194662, forward nfe 21352, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 058/100, Runtime 2.846864, Loss 0.113502, forward nfe 21620, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 059/100, Runtime 2.843403, Loss 0.151416, forward nfe 21888, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 060/100, Runtime 2.829406, Loss 0.129778, forward nfe 22150, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 061/100, Runtime 2.786240, Loss 0.099838, forward nfe 22418, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 062/100, Runtime 2.722527, Loss 0.176653, forward nfe 22680, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 063/100, Runtime 2.807664, Loss 0.117318, forward nfe 22948, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 064/100, Runtime 2.858069, Loss 0.093253, forward nfe 23210, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 065/100, Runtime 2.808479, Loss 0.132082, forward nfe 23472, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 066/100, Runtime 2.892187, Loss 0.098376, forward nfe 23734, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 067/100, Runtime 2.821779, Loss 0.098610, forward nfe 23996, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 068/100, Runtime 2.788994, Loss 0.153311, forward nfe 24258, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 069/100, Runtime 2.804206, Loss 0.091167, forward nfe 24514, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 070/100, Runtime 2.740613, Loss 0.139709, forward nfe 24770, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 071/100, Runtime 2.775530, Loss 0.128473, forward nfe 25026, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 072/100, Runtime 2.822731, Loss 0.099653, forward nfe 25282, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 073/100, Runtime 2.743316, Loss 0.100402, forward nfe 25538, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 074/100, Runtime 2.765750, Loss 0.094336, forward nfe 25794, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 075/100, Runtime 2.717264, Loss 0.117434, forward nfe 26050, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 076/100, Runtime 2.800531, Loss 0.076937, forward nfe 26306, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 077/100, Runtime 2.810146, Loss 0.113716, forward nfe 26562, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 078/100, Runtime 2.784932, Loss 0.096248, forward nfe 26818, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 079/100, Runtime 2.815751, Loss 0.086815, forward nfe 27074, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 080/100, Runtime 2.818405, Loss 0.082077, forward nfe 27330, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 081/100, Runtime 2.677310, Loss 0.097836, forward nfe 27586, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 082/100, Runtime 2.796997, Loss 0.094775, forward nfe 27842, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 083/100, Runtime 2.812749, Loss 0.079235, forward nfe 28098, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 084/100, Runtime 2.798144, Loss 0.078788, forward nfe 28354, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 085/100, Runtime 2.834999, Loss 0.080417, forward nfe 28610, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 086/100, Runtime 2.724818, Loss 0.100126, forward nfe 28866, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 087/100, Runtime 2.793199, Loss 0.073683, forward nfe 29122, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 088/100, Runtime 2.679074, Loss 0.068582, forward nfe 29378, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 089/100, Runtime 2.662738, Loss 0.068716, forward nfe 29628, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 090/100, Runtime 2.548057, Loss 0.090640, forward nfe 29872, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 091/100, Runtime 2.692870, Loss 0.057307, forward nfe 30116, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 092/100, Runtime 2.552255, Loss 0.074826, forward nfe 30360, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 093/100, Runtime 2.674692, Loss 0.079095, forward nfe 30604, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 094/100, Runtime 2.606510, Loss 0.079755, forward nfe 30848, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 095/100, Runtime 2.552782, Loss 0.058741, forward nfe 31086, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 096/100, Runtime 2.644390, Loss 0.089593, forward nfe 31324, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 097/100, Runtime 2.538946, Loss 0.084938, forward nfe 31562, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 098/100, Runtime 2.617810, Loss 0.090007, forward nfe 31800, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
Epoch: 099/100, Runtime 2.423007, Loss 0.051088, forward nfe 32038, backward nfe 0, Train: 0.9714, Val: 0.8463, Test: 0.8670, Best time: 85.0000
best val accuracy 0.846324 with test accuracy 0.867005 at epoch 37 and best time 85.000000