/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 3.553071, Loss 1.948349, forward nfe 98, backward nfe 0, Train: 0.3643, Val: 0.4941, Test: 0.4629, Best time: 3.8288
Epoch: 002/100, Runtime 3.897585, Loss 1.966847, forward nfe 456, backward nfe 0, Train: 0.3643, Val: 0.4941, Test: 0.4629, Best time: 45.0000
Epoch: 003/100, Runtime 3.838416, Loss 1.932640, forward nfe 802, backward nfe 0, Train: 0.3643, Val: 0.4941, Test: 0.4629, Best time: 45.0000
Epoch: 004/100, Runtime 3.435507, Loss 1.894763, forward nfe 1142, backward nfe 0, Train: 0.3786, Val: 0.5147, Test: 0.5076, Best time: 2.2080
Epoch: 005/100, Runtime 3.313186, Loss 1.819416, forward nfe 1482, backward nfe 0, Train: 0.8143, Val: 0.7794, Test: 0.7746, Best time: 5.4040
Epoch: 006/100, Runtime 3.100187, Loss 1.676691, forward nfe 1816, backward nfe 0, Train: 0.8143, Val: 0.7794, Test: 0.7746, Best time: 45.0000
Epoch: 007/100, Runtime 2.483920, Loss 1.500337, forward nfe 2138, backward nfe 0, Train: 0.8143, Val: 0.7794, Test: 0.7746, Best time: 45.0000
Epoch: 008/100, Runtime 2.410119, Loss 1.332519, forward nfe 2442, backward nfe 0, Train: 0.8143, Val: 0.8000, Test: 0.8071, Best time: 72.0534
Epoch: 009/100, Runtime 2.511241, Loss 1.137644, forward nfe 2746, backward nfe 0, Train: 0.8929, Val: 0.8147, Test: 0.8315, Best time: 63.1836
Epoch: 010/100, Runtime 2.390960, Loss 0.945798, forward nfe 3038, backward nfe 0, Train: 0.8929, Val: 0.8147, Test: 0.8315, Best time: 45.0000
Epoch: 011/100, Runtime 2.372036, Loss 0.773156, forward nfe 3336, backward nfe 0, Train: 0.8929, Val: 0.8147, Test: 0.8315, Best time: 45.0000
Epoch: 012/100, Runtime 2.308954, Loss 0.679250, forward nfe 3628, backward nfe 0, Train: 0.8929, Val: 0.8147, Test: 0.8315, Best time: 45.0000
Epoch: 013/100, Runtime 2.198832, Loss 0.583136, forward nfe 3920, backward nfe 0, Train: 0.8929, Val: 0.8147, Test: 0.8315, Best time: 45.0000
Epoch: 014/100, Runtime 2.193194, Loss 0.493200, forward nfe 4194, backward nfe 0, Train: 0.9071, Val: 0.8184, Test: 0.8234, Best time: 67.7635
Epoch: 015/100, Runtime 2.010934, Loss 0.428574, forward nfe 4462, backward nfe 0, Train: 0.9214, Val: 0.8257, Test: 0.8305, Best time: 63.4918
Epoch: 016/100, Runtime 2.175641, Loss 0.363453, forward nfe 4718, backward nfe 0, Train: 0.9214, Val: 0.8257, Test: 0.8305, Best time: 45.0000
Epoch: 017/100, Runtime 2.142546, Loss 0.395162, forward nfe 4974, backward nfe 0, Train: 0.9214, Val: 0.8257, Test: 0.8305, Best time: 45.0000
Epoch: 018/100, Runtime 2.035941, Loss 0.346854, forward nfe 5224, backward nfe 0, Train: 0.9214, Val: 0.8265, Test: 0.8274, Best time: 77.6358
Epoch: 019/100, Runtime 2.091033, Loss 0.385608, forward nfe 5474, backward nfe 0, Train: 0.9214, Val: 0.8265, Test: 0.8274, Best time: 45.0000
Epoch: 020/100, Runtime 1.977037, Loss 0.312724, forward nfe 5724, backward nfe 0, Train: 0.9214, Val: 0.8265, Test: 0.8274, Best time: 45.0000
Epoch: 021/100, Runtime 2.023641, Loss 0.333071, forward nfe 5962, backward nfe 0, Train: 0.9214, Val: 0.8265, Test: 0.8274, Best time: 45.0000
Epoch: 022/100, Runtime 1.848936, Loss 0.312528, forward nfe 6188, backward nfe 0, Train: 0.9214, Val: 0.8265, Test: 0.8274, Best time: 45.0000
Epoch: 023/100, Runtime 1.705848, Loss 0.329977, forward nfe 6414, backward nfe 0, Train: 0.9571, Val: 0.8301, Test: 0.8213, Best time: 42.2617
Epoch: 024/100, Runtime 1.821370, Loss 0.252126, forward nfe 6634, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 91.7572
Epoch: 025/100, Runtime 1.764704, Loss 0.308124, forward nfe 6866, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 026/100, Runtime 1.680372, Loss 0.234918, forward nfe 7080, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 027/100, Runtime 1.676295, Loss 0.223499, forward nfe 7288, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 028/100, Runtime 1.665932, Loss 0.224329, forward nfe 7490, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 029/100, Runtime 1.760217, Loss 0.307767, forward nfe 7698, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 030/100, Runtime 1.736201, Loss 0.274458, forward nfe 7906, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 031/100, Runtime 1.734882, Loss 0.169969, forward nfe 8108, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 032/100, Runtime 1.648782, Loss 0.195728, forward nfe 8310, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 033/100, Runtime 1.648351, Loss 0.236112, forward nfe 8500, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 034/100, Runtime 1.538127, Loss 0.258064, forward nfe 8690, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 035/100, Runtime 1.509175, Loss 0.179891, forward nfe 8880, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 036/100, Runtime 1.299465, Loss 0.173316, forward nfe 9070, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 037/100, Runtime 1.416838, Loss 0.176539, forward nfe 9248, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 038/100, Runtime 1.446870, Loss 0.252289, forward nfe 9426, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 039/100, Runtime 1.589717, Loss 0.172608, forward nfe 9604, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 040/100, Runtime 1.534456, Loss 0.135707, forward nfe 9782, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 041/100, Runtime 1.523823, Loss 0.190206, forward nfe 9960, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 042/100, Runtime 1.584324, Loss 0.132920, forward nfe 10138, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 043/100, Runtime 1.542365, Loss 0.171654, forward nfe 10316, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 044/100, Runtime 1.635586, Loss 0.200043, forward nfe 10494, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 045/100, Runtime 1.562683, Loss 0.089296, forward nfe 10678, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 046/100, Runtime 1.605712, Loss 0.107384, forward nfe 10862, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 047/100, Runtime 1.535965, Loss 0.161959, forward nfe 11040, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 048/100, Runtime 1.490773, Loss 0.192919, forward nfe 11218, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 049/100, Runtime 1.460517, Loss 0.123893, forward nfe 11396, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 050/100, Runtime 1.515865, Loss 0.100965, forward nfe 11574, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 051/100, Runtime 1.505620, Loss 0.127224, forward nfe 11752, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 052/100, Runtime 1.522174, Loss 0.167507, forward nfe 11930, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 053/100, Runtime 1.552825, Loss 0.136798, forward nfe 12108, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 054/100, Runtime 1.520416, Loss 0.107423, forward nfe 12286, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 055/100, Runtime 1.357325, Loss 0.107679, forward nfe 12464, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 056/100, Runtime 1.375574, Loss 0.110110, forward nfe 12642, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 057/100, Runtime 1.339435, Loss 0.114433, forward nfe 12820, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 058/100, Runtime 1.395087, Loss 0.091040, forward nfe 12998, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 059/100, Runtime 1.311597, Loss 0.108488, forward nfe 13176, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 060/100, Runtime 1.451620, Loss 0.103898, forward nfe 13354, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 061/100, Runtime 1.551297, Loss 0.110924, forward nfe 13532, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 062/100, Runtime 1.518511, Loss 0.054036, forward nfe 13710, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 063/100, Runtime 1.579811, Loss 0.077895, forward nfe 13888, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 064/100, Runtime 1.529176, Loss 0.110887, forward nfe 14066, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 065/100, Runtime 1.584654, Loss 0.077710, forward nfe 14244, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 066/100, Runtime 1.573107, Loss 0.082644, forward nfe 14422, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 067/100, Runtime 1.521310, Loss 0.114123, forward nfe 14600, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 068/100, Runtime 1.557096, Loss 0.119207, forward nfe 14778, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 069/100, Runtime 1.547791, Loss 0.099540, forward nfe 14956, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 070/100, Runtime 1.548049, Loss 0.222698, forward nfe 15134, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 071/100, Runtime 1.547415, Loss 0.183021, forward nfe 15312, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 072/100, Runtime 1.548293, Loss 0.138859, forward nfe 15490, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 073/100, Runtime 1.516952, Loss 0.085309, forward nfe 15668, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 074/100, Runtime 1.565671, Loss 0.085770, forward nfe 15846, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 075/100, Runtime 1.567905, Loss 0.076952, forward nfe 16024, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 076/100, Runtime 1.528875, Loss 0.104212, forward nfe 16202, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 077/100, Runtime 1.486290, Loss 0.088044, forward nfe 16380, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 078/100, Runtime 1.454324, Loss 0.076284, forward nfe 16558, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 079/100, Runtime 1.454310, Loss 0.048031, forward nfe 16736, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 080/100, Runtime 1.489823, Loss 0.099213, forward nfe 16914, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 081/100, Runtime 1.233461, Loss 0.073986, forward nfe 17092, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 082/100, Runtime 1.366742, Loss 0.082589, forward nfe 17270, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 083/100, Runtime 1.397268, Loss 0.059636, forward nfe 17448, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 084/100, Runtime 1.263090, Loss 0.056352, forward nfe 17626, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 085/100, Runtime 1.386144, Loss 0.061473, forward nfe 17804, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 086/100, Runtime 1.336416, Loss 0.083169, forward nfe 17982, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 087/100, Runtime 1.302016, Loss 0.078281, forward nfe 18160, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 088/100, Runtime 1.404200, Loss 0.060267, forward nfe 18338, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 089/100, Runtime 1.353081, Loss 0.048805, forward nfe 18516, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 090/100, Runtime 1.385525, Loss 0.076854, forward nfe 18694, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 091/100, Runtime 1.438732, Loss 0.056617, forward nfe 18872, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 092/100, Runtime 1.442115, Loss 0.083989, forward nfe 19050, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 093/100, Runtime 1.377968, Loss 0.054951, forward nfe 19228, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 094/100, Runtime 1.369030, Loss 0.048145, forward nfe 19400, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 095/100, Runtime 1.367581, Loss 0.071831, forward nfe 19566, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 096/100, Runtime 1.484349, Loss 0.067047, forward nfe 19738, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 097/100, Runtime 1.520440, Loss 0.034562, forward nfe 19910, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 098/100, Runtime 1.570691, Loss 0.034262, forward nfe 20088, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
Epoch: 099/100, Runtime 1.653766, Loss 0.033857, forward nfe 20266, backward nfe 0, Train: 0.9429, Val: 0.8397, Test: 0.8355, Best time: 45.0000
best val accuracy 0.839706 with test accuracy 0.835533 at epoch 24 and best time 45.000000