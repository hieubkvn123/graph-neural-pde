/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 2.467039, Loss 1.948104, forward nfe 80, backward nfe 0, Train: 0.3714, Val: 0.3287, Test: 0.3371, Best time: 0.0967
Epoch: 002/100, Runtime 2.490446, Loss 1.948970, forward nfe 372, backward nfe 0, Train: 0.3714, Val: 0.3287, Test: 0.3371, Best time: 35.0000
Epoch: 003/100, Runtime 2.293042, Loss 1.889324, forward nfe 664, backward nfe 0, Train: 0.4357, Val: 0.4044, Test: 0.4122, Best time: 1.0011
Epoch: 004/100, Runtime 2.301090, Loss 1.762018, forward nfe 944, backward nfe 0, Train: 0.5857, Val: 0.5728, Test: 0.5645, Best time: 7.6562
Epoch: 005/100, Runtime 2.265548, Loss 1.549255, forward nfe 1224, backward nfe 0, Train: 0.7857, Val: 0.7743, Test: 0.7563, Best time: 13.6321
Epoch: 006/100, Runtime 2.222989, Loss 1.325300, forward nfe 1498, backward nfe 0, Train: 0.8143, Val: 0.8213, Test: 0.8112, Best time: 46.3814
Epoch: 007/100, Runtime 2.109200, Loss 1.067319, forward nfe 1760, backward nfe 0, Train: 0.8786, Val: 0.8279, Test: 0.8183, Best time: 58.2611
Epoch: 008/100, Runtime 2.144774, Loss 0.869108, forward nfe 2016, backward nfe 0, Train: 0.8786, Val: 0.8279, Test: 0.8183, Best time: 35.0000
Epoch: 009/100, Runtime 2.018854, Loss 0.664053, forward nfe 2272, backward nfe 0, Train: 0.8786, Val: 0.8279, Test: 0.8183, Best time: 35.0000
Epoch: 010/100, Runtime 2.111390, Loss 0.521583, forward nfe 2522, backward nfe 0, Train: 0.8786, Val: 0.8279, Test: 0.8183, Best time: 35.0000
Epoch: 011/100, Runtime 2.000814, Loss 0.461800, forward nfe 2772, backward nfe 0, Train: 0.9143, Val: 0.8478, Test: 0.8305, Best time: 84.0560
Epoch: 012/100, Runtime 1.931252, Loss 0.360373, forward nfe 3004, backward nfe 0, Train: 0.9214, Val: 0.8515, Test: 0.8386, Best time: 49.5472
Epoch: 013/100, Runtime 1.973637, Loss 0.370085, forward nfe 3242, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 44.9396
Epoch: 014/100, Runtime 1.912144, Loss 0.319488, forward nfe 3474, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 015/100, Runtime 1.792061, Loss 0.283836, forward nfe 3706, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 016/100, Runtime 1.828498, Loss 0.281425, forward nfe 3926, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 017/100, Runtime 1.685016, Loss 0.250207, forward nfe 4134, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 018/100, Runtime 1.808758, Loss 0.274287, forward nfe 4336, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 019/100, Runtime 1.663844, Loss 0.240446, forward nfe 4544, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 020/100, Runtime 1.614506, Loss 0.248062, forward nfe 4752, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 021/100, Runtime 1.676143, Loss 0.239524, forward nfe 4954, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 022/100, Runtime 1.519527, Loss 0.206002, forward nfe 5144, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 023/100, Runtime 1.546233, Loss 0.255088, forward nfe 5328, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 024/100, Runtime 1.626842, Loss 0.216892, forward nfe 5512, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 025/100, Runtime 1.588547, Loss 0.253944, forward nfe 5702, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 026/100, Runtime 1.598168, Loss 0.186173, forward nfe 5898, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 027/100, Runtime 1.574266, Loss 0.198692, forward nfe 6088, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 028/100, Runtime 1.548483, Loss 0.166179, forward nfe 6272, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 029/100, Runtime 1.516619, Loss 0.185594, forward nfe 6444, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 030/100, Runtime 1.446020, Loss 0.168865, forward nfe 6616, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 031/100, Runtime 1.446947, Loss 0.151823, forward nfe 6788, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 032/100, Runtime 1.545865, Loss 0.191708, forward nfe 6954, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 033/100, Runtime 1.384525, Loss 0.160528, forward nfe 7126, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 034/100, Runtime 1.474722, Loss 0.131886, forward nfe 7292, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 035/100, Runtime 1.385566, Loss 0.097314, forward nfe 7458, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 036/100, Runtime 1.512117, Loss 0.158960, forward nfe 7624, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 037/100, Runtime 1.493594, Loss 0.103572, forward nfe 7796, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 038/100, Runtime 1.436750, Loss 0.147574, forward nfe 7974, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 039/100, Runtime 1.508641, Loss 0.130500, forward nfe 8152, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 040/100, Runtime 1.546246, Loss 0.191765, forward nfe 8330, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 041/100, Runtime 1.388595, Loss 0.161844, forward nfe 8508, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 042/100, Runtime 1.469030, Loss 0.137645, forward nfe 8680, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 043/100, Runtime 1.455034, Loss 0.096095, forward nfe 8852, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 044/100, Runtime 1.435155, Loss 0.085234, forward nfe 9024, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 045/100, Runtime 1.452727, Loss 0.075011, forward nfe 9196, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 046/100, Runtime 1.403761, Loss 0.102337, forward nfe 9356, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 047/100, Runtime 1.487173, Loss 0.086797, forward nfe 9528, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 048/100, Runtime 1.335619, Loss 0.082043, forward nfe 9688, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 049/100, Runtime 1.638364, Loss 0.074529, forward nfe 9848, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 050/100, Runtime 1.834823, Loss 0.073576, forward nfe 10008, backward nfe 0, Train: 0.9571, Val: 0.8544, Test: 0.8487, Best time: 35.0000
Epoch: 051/100, Runtime 1.896868, Loss 0.063151, forward nfe 10168, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 052/100, Runtime 1.783003, Loss 0.081451, forward nfe 10328, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 053/100, Runtime 1.744713, Loss 0.069165, forward nfe 10488, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 054/100, Runtime 1.717503, Loss 0.073193, forward nfe 10648, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 055/100, Runtime 1.721391, Loss 0.060058, forward nfe 10802, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 056/100, Runtime 1.872841, Loss 0.083436, forward nfe 10956, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 057/100, Runtime 1.802622, Loss 0.062046, forward nfe 11110, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 058/100, Runtime 1.868949, Loss 0.098189, forward nfe 11264, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 059/100, Runtime 1.804531, Loss 0.094508, forward nfe 11418, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 060/100, Runtime 1.837223, Loss 0.098604, forward nfe 11572, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 061/100, Runtime 1.871233, Loss 0.097464, forward nfe 11726, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 062/100, Runtime 1.873548, Loss 0.070102, forward nfe 11880, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 063/100, Runtime 1.719673, Loss 0.092894, forward nfe 12034, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 064/100, Runtime 1.792864, Loss 0.093861, forward nfe 12188, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 065/100, Runtime 1.609734, Loss 0.118511, forward nfe 12342, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 066/100, Runtime 1.749269, Loss 0.079290, forward nfe 12496, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 067/100, Runtime 1.323676, Loss 0.042903, forward nfe 12650, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 068/100, Runtime 1.332295, Loss 0.080151, forward nfe 12804, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 069/100, Runtime 1.271672, Loss 0.056497, forward nfe 12958, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 070/100, Runtime 1.281078, Loss 0.052116, forward nfe 13106, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 071/100, Runtime 1.258837, Loss 0.050725, forward nfe 13254, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 072/100, Runtime 1.279945, Loss 0.061125, forward nfe 13402, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 073/100, Runtime 1.282810, Loss 0.089081, forward nfe 13550, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 074/100, Runtime 1.333456, Loss 0.046629, forward nfe 13698, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 075/100, Runtime 1.286048, Loss 0.096706, forward nfe 13846, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 076/100, Runtime 1.273059, Loss 0.041224, forward nfe 13994, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 077/100, Runtime 1.249863, Loss 0.028304, forward nfe 14142, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 078/100, Runtime 1.292362, Loss 0.039337, forward nfe 14290, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 079/100, Runtime 1.236315, Loss 0.068223, forward nfe 14438, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 080/100, Runtime 1.266885, Loss 0.081701, forward nfe 14580, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 081/100, Runtime 1.187620, Loss 0.031781, forward nfe 14722, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 082/100, Runtime 1.208739, Loss 0.033526, forward nfe 14858, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 083/100, Runtime 1.174266, Loss 0.067111, forward nfe 15000, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 084/100, Runtime 1.261196, Loss 0.050382, forward nfe 15142, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 085/100, Runtime 1.247301, Loss 0.047398, forward nfe 15284, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 086/100, Runtime 1.197602, Loss 0.047715, forward nfe 15426, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 087/100, Runtime 1.216424, Loss 0.058016, forward nfe 15562, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 088/100, Runtime 1.261760, Loss 0.041154, forward nfe 15698, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 089/100, Runtime 1.636625, Loss 0.021370, forward nfe 15834, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 090/100, Runtime 1.650768, Loss 0.024683, forward nfe 15976, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 091/100, Runtime 1.497031, Loss 0.055232, forward nfe 16124, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 092/100, Runtime 1.775971, Loss 0.038855, forward nfe 16272, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 093/100, Runtime 1.852752, Loss 0.038989, forward nfe 16420, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 094/100, Runtime 1.752256, Loss 0.031832, forward nfe 16574, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 095/100, Runtime 1.637265, Loss 0.067292, forward nfe 16728, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 096/100, Runtime 1.749728, Loss 0.041911, forward nfe 16882, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 097/100, Runtime 1.791169, Loss 0.058653, forward nfe 17036, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 098/100, Runtime 1.990883, Loss 0.053339, forward nfe 17190, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
Epoch: 099/100, Runtime 1.816227, Loss 0.032339, forward nfe 17350, backward nfe 0, Train: 0.9857, Val: 0.8566, Test: 0.8447, Best time: 35.0000
best val accuracy 0.856618 with test accuracy 0.844670 at epoch 51 and best time 35.000000