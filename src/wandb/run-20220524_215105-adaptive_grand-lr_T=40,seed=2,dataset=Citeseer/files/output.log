/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.563397, Loss 1.791410, forward nfe 140, backward nfe 0, Train: 0.4000, Val: 0.2920, Test: 0.2952, Best time: 123.8033
Epoch: 002/100, Runtime 0.485054, Loss 1.778827, forward nfe 558, backward nfe 0, Train: 0.4167, Val: 0.4196, Test: 0.3823, Best time: 82.8086
Epoch: 003/100, Runtime 0.499741, Loss 1.738973, forward nfe 964, backward nfe 0, Train: 0.5500, Val: 0.5928, Test: 0.5613, Best time: 77.0595
Epoch: 004/100, Runtime 0.507853, Loss 1.701664, forward nfe 1382, backward nfe 0, Train: 0.6250, Val: 0.6188, Test: 0.5887, Best time: 17.5869
Epoch: 005/100, Runtime 0.490993, Loss 1.686552, forward nfe 1812, backward nfe 0, Train: 0.6417, Val: 0.6210, Test: 0.6097, Best time: 18.1159
Epoch: 006/100, Runtime 0.472960, Loss 1.622223, forward nfe 2218, backward nfe 0, Train: 0.6500, Val: 0.6326, Test: 0.6194, Best time: 10.2736
Epoch: 007/100, Runtime 0.471273, Loss 1.637829, forward nfe 2624, backward nfe 0, Train: 0.6750, Val: 0.6681, Test: 0.6581, Best time: 14.5941
Epoch: 008/100, Runtime 0.468130, Loss 1.582063, forward nfe 3018, backward nfe 0, Train: 0.6917, Val: 0.6920, Test: 0.6952, Best time: 12.8978
Epoch: 009/100, Runtime 0.433672, Loss 1.550606, forward nfe 3412, backward nfe 0, Train: 0.7167, Val: 0.6942, Test: 0.6935, Best time: 11.3083
Epoch: 010/100, Runtime 0.459080, Loss 1.543213, forward nfe 3794, backward nfe 0, Train: 0.7167, Val: 0.6942, Test: 0.6935, Best time: 40.0000
Epoch: 011/100, Runtime 0.444531, Loss 1.522838, forward nfe 4182, backward nfe 0, Train: 0.7167, Val: 0.6942, Test: 0.6935, Best time: 40.0000
Epoch: 012/100, Runtime 0.444681, Loss 1.511137, forward nfe 4558, backward nfe 0, Train: 0.7583, Val: 0.7145, Test: 0.7113, Best time: 6.3977
Epoch: 013/100, Runtime 0.428131, Loss 1.471192, forward nfe 4928, backward nfe 0, Train: 0.7583, Val: 0.7377, Test: 0.7210, Best time: 9.2745
Epoch: 014/100, Runtime 0.421685, Loss 1.470722, forward nfe 5292, backward nfe 0, Train: 0.7583, Val: 0.7377, Test: 0.7210, Best time: 40.0000
Epoch: 015/100, Runtime 0.439531, Loss 1.458660, forward nfe 5668, backward nfe 0, Train: 0.7583, Val: 0.7377, Test: 0.7210, Best time: 40.0000
Epoch: 016/100, Runtime 0.426649, Loss 1.423989, forward nfe 6026, backward nfe 0, Train: 0.7583, Val: 0.7420, Test: 0.7242, Best time: 19.2084
Epoch: 017/100, Runtime 0.429133, Loss 1.358605, forward nfe 6378, backward nfe 0, Train: 0.7583, Val: 0.7420, Test: 0.7242, Best time: 40.0000
Epoch: 018/100, Runtime 0.415266, Loss 1.339535, forward nfe 6730, backward nfe 0, Train: 0.7583, Val: 0.7420, Test: 0.7242, Best time: 40.0000
Epoch: 019/100, Runtime 0.407115, Loss 1.260915, forward nfe 7076, backward nfe 0, Train: 0.7583, Val: 0.7420, Test: 0.7242, Best time: 40.0000
Epoch: 020/100, Runtime 0.399757, Loss 1.276864, forward nfe 7416, backward nfe 0, Train: 0.7583, Val: 0.7420, Test: 0.7242, Best time: 40.0000
Epoch: 021/100, Runtime 0.377811, Loss 1.204898, forward nfe 7750, backward nfe 0, Train: 0.7583, Val: 0.7420, Test: 0.7242, Best time: 40.0000
Epoch: 022/100, Runtime 0.415395, Loss 1.242250, forward nfe 8078, backward nfe 0, Train: 0.7750, Val: 0.7464, Test: 0.7177, Best time: 22.3291
Epoch: 023/100, Runtime 0.386824, Loss 1.138520, forward nfe 8406, backward nfe 0, Train: 0.7750, Val: 0.7464, Test: 0.7177, Best time: 40.0000
Epoch: 024/100, Runtime 0.406007, Loss 1.146831, forward nfe 8728, backward nfe 0, Train: 0.7750, Val: 0.7464, Test: 0.7177, Best time: 40.0000
Epoch: 025/100, Runtime 0.387319, Loss 1.164274, forward nfe 9050, backward nfe 0, Train: 0.7750, Val: 0.7464, Test: 0.7177, Best time: 40.0000
Epoch: 026/100, Runtime 0.370461, Loss 1.166248, forward nfe 9372, backward nfe 0, Train: 0.7750, Val: 0.7464, Test: 0.7177, Best time: 40.0000
Epoch: 027/100, Runtime 0.372888, Loss 1.096953, forward nfe 9676, backward nfe 0, Train: 0.7750, Val: 0.7464, Test: 0.7177, Best time: 40.0000
Epoch: 028/100, Runtime 0.375418, Loss 1.237682, forward nfe 9980, backward nfe 0, Train: 0.7750, Val: 0.7464, Test: 0.7177, Best time: 40.0000
Epoch: 029/100, Runtime 0.362917, Loss 1.112073, forward nfe 10290, backward nfe 0, Train: 0.7750, Val: 0.7464, Test: 0.7177, Best time: 40.0000
Epoch: 030/100, Runtime 0.362118, Loss 1.101950, forward nfe 10588, backward nfe 0, Train: 0.7750, Val: 0.7464, Test: 0.7177, Best time: 40.0000
Epoch: 031/100, Runtime 0.353114, Loss 1.044770, forward nfe 10886, backward nfe 0, Train: 0.7750, Val: 0.7464, Test: 0.7177, Best time: 40.0000
Epoch: 032/100, Runtime 0.343746, Loss 1.141900, forward nfe 11172, backward nfe 0, Train: 0.7750, Val: 0.7464, Test: 0.7177, Best time: 40.0000
Epoch: 033/100, Runtime 0.368434, Loss 1.044914, forward nfe 11458, backward nfe 0, Train: 0.7750, Val: 0.7464, Test: 0.7177, Best time: 40.0000
Epoch: 034/100, Runtime 0.349492, Loss 1.204207, forward nfe 11744, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 41.1300
Epoch: 035/100, Runtime 0.336140, Loss 1.154469, forward nfe 12024, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 036/100, Runtime 0.339554, Loss 1.233247, forward nfe 12304, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 037/100, Runtime 0.332687, Loss 1.147982, forward nfe 12578, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 038/100, Runtime 0.314480, Loss 1.076927, forward nfe 12846, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 039/100, Runtime 0.328044, Loss 1.129896, forward nfe 13114, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 040/100, Runtime 0.284192, Loss 1.075248, forward nfe 13382, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 041/100, Runtime 0.297924, Loss 1.043033, forward nfe 13638, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 042/100, Runtime 0.322620, Loss 1.092335, forward nfe 13894, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 043/100, Runtime 0.316910, Loss 1.108993, forward nfe 14144, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 044/100, Runtime 0.298057, Loss 1.102018, forward nfe 14394, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 045/100, Runtime 0.317082, Loss 1.100375, forward nfe 14638, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 046/100, Runtime 0.314060, Loss 1.182618, forward nfe 14882, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 047/100, Runtime 0.306845, Loss 1.058944, forward nfe 15132, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 048/100, Runtime 0.296524, Loss 1.075660, forward nfe 15376, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 049/100, Runtime 0.295963, Loss 1.119238, forward nfe 15620, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 050/100, Runtime 0.299994, Loss 0.980198, forward nfe 15864, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 051/100, Runtime 0.293271, Loss 1.000630, forward nfe 16108, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 052/100, Runtime 0.309808, Loss 1.126765, forward nfe 16352, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 053/100, Runtime 0.294032, Loss 1.098449, forward nfe 16590, backward nfe 0, Train: 0.7917, Val: 0.7543, Test: 0.7323, Best time: 40.0000
Epoch: 054/100, Runtime 0.296609, Loss 1.074212, forward nfe 16828, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 41.4594
Epoch: 055/100, Runtime 0.297414, Loss 1.034890, forward nfe 17072, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 056/100, Runtime 0.302918, Loss 1.128090, forward nfe 17316, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 057/100, Runtime 0.309879, Loss 1.158942, forward nfe 17560, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 058/100, Runtime 0.310366, Loss 1.065173, forward nfe 17804, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 059/100, Runtime 0.303070, Loss 1.030881, forward nfe 18048, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 060/100, Runtime 0.311126, Loss 1.062218, forward nfe 18298, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 061/100, Runtime 0.341017, Loss 1.083779, forward nfe 18548, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 062/100, Runtime 0.306052, Loss 0.998468, forward nfe 18798, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 063/100, Runtime 0.306144, Loss 1.071748, forward nfe 19048, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 064/100, Runtime 0.297005, Loss 0.976789, forward nfe 19298, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 065/100, Runtime 0.318897, Loss 0.966592, forward nfe 19548, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 066/100, Runtime 0.315288, Loss 1.062328, forward nfe 19798, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 067/100, Runtime 0.309110, Loss 1.052819, forward nfe 20048, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 068/100, Runtime 0.310382, Loss 1.168188, forward nfe 20292, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 069/100, Runtime 0.300660, Loss 1.113470, forward nfe 20542, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 070/100, Runtime 0.444676, Loss 1.102787, forward nfe 20786, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 071/100, Runtime 0.315937, Loss 1.003775, forward nfe 21030, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 072/100, Runtime 0.300963, Loss 1.041365, forward nfe 21274, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 073/100, Runtime 0.303896, Loss 1.151579, forward nfe 21518, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 074/100, Runtime 0.302420, Loss 1.053588, forward nfe 21762, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 075/100, Runtime 0.299311, Loss 1.135732, forward nfe 22006, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 076/100, Runtime 0.304915, Loss 1.137111, forward nfe 22250, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 077/100, Runtime 0.304773, Loss 1.050324, forward nfe 22494, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 078/100, Runtime 0.294507, Loss 1.185755, forward nfe 22738, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 079/100, Runtime 0.296467, Loss 1.123765, forward nfe 22982, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 080/100, Runtime 0.302479, Loss 1.103767, forward nfe 23226, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 081/100, Runtime 0.293505, Loss 1.029146, forward nfe 23470, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 082/100, Runtime 0.297028, Loss 1.006716, forward nfe 23714, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 083/100, Runtime 0.297899, Loss 1.165177, forward nfe 23958, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 084/100, Runtime 0.308899, Loss 1.097432, forward nfe 24202, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 085/100, Runtime 0.304751, Loss 1.091906, forward nfe 24446, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 086/100, Runtime 0.307416, Loss 1.027873, forward nfe 24690, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 087/100, Runtime 0.311609, Loss 1.044950, forward nfe 24934, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 088/100, Runtime 0.306802, Loss 1.158725, forward nfe 25178, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 089/100, Runtime 0.305308, Loss 1.031346, forward nfe 25416, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 090/100, Runtime 0.299536, Loss 1.022720, forward nfe 25654, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 091/100, Runtime 0.311735, Loss 1.142756, forward nfe 25892, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 092/100, Runtime 0.303220, Loss 1.135729, forward nfe 26130, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 093/100, Runtime 0.295832, Loss 1.047036, forward nfe 26368, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 094/100, Runtime 0.304840, Loss 1.078922, forward nfe 26606, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 095/100, Runtime 0.305933, Loss 1.240371, forward nfe 26844, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 096/100, Runtime 0.289636, Loss 1.184468, forward nfe 27082, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 097/100, Runtime 0.307330, Loss 1.088870, forward nfe 27320, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 098/100, Runtime 0.300763, Loss 1.209656, forward nfe 27558, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
Epoch: 099/100, Runtime 0.293764, Loss 1.032704, forward nfe 27796, backward nfe 0, Train: 0.8250, Val: 0.7659, Test: 0.7661, Best time: 40.0000
best val accuracy 0.765942 with test accuracy 0.766129 at epoch 54 and best time 40.000000