/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 4.949142, Loss 1.948358, forward nfe 164, backward nfe 0, Train: 0.2571, Val: 0.2787, Test: 0.2609, Best time: 5.4520
Epoch: 002/100, Runtime 5.118379, Loss 1.987954, forward nfe 798, backward nfe 0, Train: 0.2571, Val: 0.2787, Test: 0.2609, Best time: 85.0000
Epoch: 003/100, Runtime 5.100309, Loss 1.954378, forward nfe 1414, backward nfe 0, Train: 0.2571, Val: 0.2787, Test: 0.2609, Best time: 85.0000
Epoch: 004/100, Runtime 5.100038, Loss 1.940737, forward nfe 2024, backward nfe 0, Train: 0.2571, Val: 0.2787, Test: 0.2609, Best time: 85.0000
Epoch: 005/100, Runtime 4.758084, Loss 1.907979, forward nfe 2622, backward nfe 0, Train: 0.4714, Val: 0.5140, Test: 0.4985, Best time: 5.3297
Epoch: 006/100, Runtime 4.551330, Loss 1.860287, forward nfe 3202, backward nfe 0, Train: 0.7214, Val: 0.7353, Test: 0.7330, Best time: 7.6008
Epoch: 007/100, Runtime 4.581303, Loss 1.798784, forward nfe 3752, backward nfe 0, Train: 0.7357, Val: 0.7485, Test: 0.7381, Best time: 5.7826
Epoch: 008/100, Runtime 4.577821, Loss 1.682620, forward nfe 4296, backward nfe 0, Train: 0.8286, Val: 0.7890, Test: 0.7736, Best time: 25.4409
Epoch: 009/100, Runtime 4.443747, Loss 1.516732, forward nfe 4834, backward nfe 0, Train: 0.8286, Val: 0.7890, Test: 0.7736, Best time: 85.0000
Epoch: 010/100, Runtime 4.311670, Loss 1.350587, forward nfe 5372, backward nfe 0, Train: 0.8286, Val: 0.7890, Test: 0.7736, Best time: 85.0000
Epoch: 011/100, Runtime 4.122487, Loss 1.132170, forward nfe 5892, backward nfe 0, Train: 0.8286, Val: 0.7890, Test: 0.7736, Best time: 85.0000
Epoch: 012/100, Runtime 4.071494, Loss 0.967289, forward nfe 6406, backward nfe 0, Train: 0.8357, Val: 0.8132, Test: 0.7797, Best time: 120.2419
Epoch: 013/100, Runtime 4.091380, Loss 0.837393, forward nfe 6908, backward nfe 0, Train: 0.8357, Val: 0.8132, Test: 0.7797, Best time: 85.0000
Epoch: 014/100, Runtime 3.871498, Loss 0.756827, forward nfe 7392, backward nfe 0, Train: 0.8357, Val: 0.8132, Test: 0.7797, Best time: 85.0000
Epoch: 015/100, Runtime 3.723649, Loss 0.637259, forward nfe 7864, backward nfe 0, Train: 0.8286, Val: 0.8213, Test: 0.7888, Best time: 54.7120
Epoch: 016/100, Runtime 3.543354, Loss 0.658131, forward nfe 8318, backward nfe 0, Train: 0.8786, Val: 0.8250, Test: 0.7878, Best time: 76.0962
Epoch: 017/100, Runtime 3.520454, Loss 0.541897, forward nfe 8766, backward nfe 0, Train: 0.8786, Val: 0.8250, Test: 0.7878, Best time: 85.0000
Epoch: 018/100, Runtime 3.333850, Loss 0.561051, forward nfe 9196, backward nfe 0, Train: 0.8786, Val: 0.8250, Test: 0.7878, Best time: 85.0000
Epoch: 019/100, Runtime 3.372238, Loss 0.516113, forward nfe 9626, backward nfe 0, Train: 0.8786, Val: 0.8250, Test: 0.7878, Best time: 85.0000
Epoch: 020/100, Runtime 3.249137, Loss 0.485779, forward nfe 10050, backward nfe 0, Train: 0.9071, Val: 0.8294, Test: 0.8020, Best time: 71.8406
Epoch: 021/100, Runtime 3.348234, Loss 0.470437, forward nfe 10462, backward nfe 0, Train: 0.9071, Val: 0.8294, Test: 0.8020, Best time: 85.0000
Epoch: 022/100, Runtime 3.247359, Loss 0.502858, forward nfe 10862, backward nfe 0, Train: 0.9071, Val: 0.8294, Test: 0.8020, Best time: 85.0000
Epoch: 023/100, Runtime 3.143945, Loss 0.440688, forward nfe 11256, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 41.4056
Epoch: 024/100, Runtime 2.971875, Loss 0.477165, forward nfe 11638, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 025/100, Runtime 3.076890, Loss 0.441688, forward nfe 12020, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 026/100, Runtime 2.973561, Loss 0.404734, forward nfe 12396, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 027/100, Runtime 2.919106, Loss 0.478254, forward nfe 12760, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 028/100, Runtime 2.824939, Loss 0.472937, forward nfe 13112, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 029/100, Runtime 2.821294, Loss 0.429067, forward nfe 13458, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 030/100, Runtime 2.443812, Loss 0.448774, forward nfe 13798, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 031/100, Runtime 2.701544, Loss 0.379891, forward nfe 14138, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 032/100, Runtime 2.744010, Loss 0.447780, forward nfe 14478, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 033/100, Runtime 2.881799, Loss 0.430314, forward nfe 14806, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 034/100, Runtime 2.714219, Loss 0.496463, forward nfe 15128, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 035/100, Runtime 2.608960, Loss 0.382055, forward nfe 15438, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 036/100, Runtime 2.732848, Loss 0.438722, forward nfe 15748, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 037/100, Runtime 2.624549, Loss 0.486975, forward nfe 16052, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 038/100, Runtime 2.369522, Loss 0.396985, forward nfe 16344, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 039/100, Runtime 2.430522, Loss 0.326818, forward nfe 16636, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 040/100, Runtime 2.401320, Loss 0.330247, forward nfe 16928, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 041/100, Runtime 2.283095, Loss 0.401093, forward nfe 17208, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 042/100, Runtime 2.160697, Loss 0.305867, forward nfe 17482, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 043/100, Runtime 2.247490, Loss 0.260764, forward nfe 17762, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 044/100, Runtime 2.131080, Loss 0.336006, forward nfe 18036, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 045/100, Runtime 2.195951, Loss 0.304355, forward nfe 18304, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 046/100, Runtime 2.216740, Loss 0.270811, forward nfe 18572, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 047/100, Runtime 2.164549, Loss 0.257086, forward nfe 18834, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 048/100, Runtime 2.102312, Loss 0.216032, forward nfe 19090, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 049/100, Runtime 2.035421, Loss 0.233098, forward nfe 19334, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 050/100, Runtime 1.989546, Loss 0.230351, forward nfe 19578, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 051/100, Runtime 2.057615, Loss 0.236856, forward nfe 19828, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 052/100, Runtime 2.124242, Loss 0.233413, forward nfe 20078, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 053/100, Runtime 1.966638, Loss 0.230118, forward nfe 20322, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 054/100, Runtime 1.925612, Loss 0.233764, forward nfe 20566, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 055/100, Runtime 1.906281, Loss 0.226606, forward nfe 20804, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 056/100, Runtime 1.950523, Loss 0.192915, forward nfe 21042, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 057/100, Runtime 1.949731, Loss 0.209735, forward nfe 21280, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 058/100, Runtime 1.982530, Loss 0.205224, forward nfe 21518, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 059/100, Runtime 1.970988, Loss 0.189062, forward nfe 21756, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 060/100, Runtime 1.947664, Loss 0.251369, forward nfe 21994, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 061/100, Runtime 1.874078, Loss 0.194800, forward nfe 22232, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 062/100, Runtime 1.937654, Loss 0.203589, forward nfe 22464, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 063/100, Runtime 1.926487, Loss 0.185139, forward nfe 22696, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 064/100, Runtime 1.936753, Loss 0.169755, forward nfe 22928, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 065/100, Runtime 1.881690, Loss 0.141368, forward nfe 23148, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 066/100, Runtime 1.812209, Loss 0.150546, forward nfe 23368, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 067/100, Runtime 1.836119, Loss 0.162571, forward nfe 23588, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 068/100, Runtime 1.779862, Loss 0.106986, forward nfe 23808, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 069/100, Runtime 1.851206, Loss 0.207263, forward nfe 24040, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 070/100, Runtime 1.896962, Loss 0.094850, forward nfe 24254, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 071/100, Runtime 1.732795, Loss 0.137729, forward nfe 24468, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 072/100, Runtime 1.760051, Loss 0.112824, forward nfe 24682, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 073/100, Runtime 1.723819, Loss 0.096677, forward nfe 24896, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 074/100, Runtime 1.838034, Loss 0.116745, forward nfe 25110, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 075/100, Runtime 1.815838, Loss 0.202018, forward nfe 25324, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 076/100, Runtime 1.828588, Loss 0.085652, forward nfe 25538, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 077/100, Runtime 1.830620, Loss 0.154315, forward nfe 25752, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 078/100, Runtime 1.836234, Loss 0.171899, forward nfe 25966, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 079/100, Runtime 1.916033, Loss 0.094221, forward nfe 26180, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 080/100, Runtime 1.869475, Loss 0.165793, forward nfe 26388, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 081/100, Runtime 1.794734, Loss 0.198167, forward nfe 26608, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 082/100, Runtime 1.833468, Loss 0.113989, forward nfe 26828, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 083/100, Runtime 1.948671, Loss 0.107306, forward nfe 27054, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 084/100, Runtime 1.956697, Loss 0.101805, forward nfe 27280, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 085/100, Runtime 1.840168, Loss 0.107965, forward nfe 27506, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 086/100, Runtime 1.853591, Loss 0.089917, forward nfe 27720, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 087/100, Runtime 1.939874, Loss 0.063951, forward nfe 27934, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 088/100, Runtime 1.923855, Loss 0.093879, forward nfe 28148, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 089/100, Runtime 1.934587, Loss 0.073122, forward nfe 28368, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 090/100, Runtime 1.892853, Loss 0.090213, forward nfe 28588, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 091/100, Runtime 1.849178, Loss 0.049986, forward nfe 28808, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 092/100, Runtime 1.992300, Loss 0.052134, forward nfe 29028, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 093/100, Runtime 1.881627, Loss 0.065098, forward nfe 29254, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 094/100, Runtime 1.935180, Loss 0.037033, forward nfe 29480, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 095/100, Runtime 2.299111, Loss 0.068808, forward nfe 29706, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 096/100, Runtime 2.521543, Loss 0.076906, forward nfe 29932, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 097/100, Runtime 2.586780, Loss 0.041159, forward nfe 30146, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 098/100, Runtime 2.585703, Loss 0.051226, forward nfe 30366, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
Epoch: 099/100, Runtime 2.462526, Loss 0.083466, forward nfe 30580, backward nfe 0, Train: 0.9071, Val: 0.8382, Test: 0.8213, Best time: 85.0000
best val accuracy 0.838235 with test accuracy 0.821320 at epoch 23 and best time 85.000000