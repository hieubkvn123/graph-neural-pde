/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 1.893280, Loss 1.949038, forward nfe 44, backward nfe 0, Train: 0.5357, Val: 0.3449, Test: 0.3624, Best time: 1.0917
Epoch: 002/100, Runtime 1.933489, Loss 1.869680, forward nfe 168, backward nfe 0, Train: 0.7143, Val: 0.5125, Test: 0.5289, Best time: 2.3205
Epoch: 003/100, Runtime 1.752460, Loss 1.700066, forward nfe 304, backward nfe 0, Train: 0.7929, Val: 0.6456, Test: 0.6680, Best time: 9.7173
Epoch: 004/100, Runtime 1.867050, Loss 1.496453, forward nfe 434, backward nfe 0, Train: 0.8429, Val: 0.7426, Test: 0.7482, Best time: 9.6013
Epoch: 005/100, Runtime 1.896914, Loss 1.233058, forward nfe 564, backward nfe 0, Train: 0.8786, Val: 0.7824, Test: 0.7766, Best time: 7.2592
Epoch: 006/100, Runtime 1.793561, Loss 0.983713, forward nfe 694, backward nfe 0, Train: 0.8786, Val: 0.8243, Test: 0.8203, Best time: 16.4667
Epoch: 007/100, Runtime 1.874816, Loss 0.744469, forward nfe 824, backward nfe 0, Train: 0.9214, Val: 0.8449, Test: 0.8416, Best time: 21.8191
Epoch: 008/100, Runtime 1.894485, Loss 0.545430, forward nfe 954, backward nfe 0, Train: 0.9000, Val: 0.8463, Test: 0.8365, Best time: 29.1845
Epoch: 009/100, Runtime 1.537596, Loss 0.426022, forward nfe 1078, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 23.0643
Epoch: 010/100, Runtime 1.673696, Loss 0.328272, forward nfe 1190, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 011/100, Runtime 1.599526, Loss 0.293174, forward nfe 1302, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 012/100, Runtime 1.669291, Loss 0.192208, forward nfe 1414, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 013/100, Runtime 1.584089, Loss 0.172848, forward nfe 1526, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 014/100, Runtime 1.677617, Loss 0.165115, forward nfe 1638, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 015/100, Runtime 1.537976, Loss 0.147224, forward nfe 1750, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 016/100, Runtime 1.520825, Loss 0.141808, forward nfe 1856, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 017/100, Runtime 1.529878, Loss 0.123157, forward nfe 1956, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 018/100, Runtime 1.408999, Loss 0.156651, forward nfe 2056, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 019/100, Runtime 1.497886, Loss 0.187586, forward nfe 2156, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 020/100, Runtime 1.538913, Loss 0.178849, forward nfe 2256, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 021/100, Runtime 1.284508, Loss 0.228904, forward nfe 2356, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 022/100, Runtime 1.324210, Loss 0.175198, forward nfe 2450, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 023/100, Runtime 1.465198, Loss 0.173020, forward nfe 2544, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 024/100, Runtime 1.308829, Loss 0.144216, forward nfe 2638, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 025/100, Runtime 1.299051, Loss 0.174712, forward nfe 2732, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 026/100, Runtime 1.397282, Loss 0.106899, forward nfe 2826, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 027/100, Runtime 1.372802, Loss 0.181725, forward nfe 2914, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 028/100, Runtime 1.267043, Loss 0.121223, forward nfe 3002, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 029/100, Runtime 1.254350, Loss 0.206132, forward nfe 3090, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 030/100, Runtime 1.187590, Loss 0.169295, forward nfe 3172, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 031/100, Runtime 1.315360, Loss 0.137323, forward nfe 3254, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 032/100, Runtime 1.315858, Loss 0.169944, forward nfe 3336, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 033/100, Runtime 1.243705, Loss 0.122688, forward nfe 3418, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 034/100, Runtime 1.224335, Loss 0.114116, forward nfe 3500, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 035/100, Runtime 1.247118, Loss 0.105123, forward nfe 3582, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 036/100, Runtime 1.255537, Loss 0.136043, forward nfe 3664, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 037/100, Runtime 1.221657, Loss 0.076793, forward nfe 3746, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 038/100, Runtime 1.244079, Loss 0.103986, forward nfe 3828, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 039/100, Runtime 1.301712, Loss 0.077781, forward nfe 3910, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 040/100, Runtime 1.272848, Loss 0.089890, forward nfe 3992, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 041/100, Runtime 1.222746, Loss 0.096924, forward nfe 4074, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 042/100, Runtime 1.212495, Loss 0.121920, forward nfe 4156, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 043/100, Runtime 1.267462, Loss 0.109197, forward nfe 4238, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 044/100, Runtime 1.197250, Loss 0.095963, forward nfe 4320, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 045/100, Runtime 1.107349, Loss 0.096261, forward nfe 4402, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 046/100, Runtime 1.150808, Loss 0.094036, forward nfe 4478, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 047/100, Runtime 1.171660, Loss 0.069892, forward nfe 4554, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 048/100, Runtime 1.175450, Loss 0.095079, forward nfe 4630, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 049/100, Runtime 1.167031, Loss 0.096022, forward nfe 4706, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 050/100, Runtime 1.191967, Loss 0.091649, forward nfe 4782, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 051/100, Runtime 1.159125, Loss 0.073710, forward nfe 4858, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 052/100, Runtime 1.174746, Loss 0.079222, forward nfe 4934, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 053/100, Runtime 1.173606, Loss 0.085817, forward nfe 5010, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 054/100, Runtime 1.126832, Loss 0.132289, forward nfe 5080, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 055/100, Runtime 1.119788, Loss 0.107051, forward nfe 5150, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 056/100, Runtime 1.084225, Loss 0.074725, forward nfe 5220, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 057/100, Runtime 1.050282, Loss 0.076918, forward nfe 5290, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 058/100, Runtime 1.066795, Loss 0.074105, forward nfe 5360, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 059/100, Runtime 1.069258, Loss 0.115669, forward nfe 5430, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 060/100, Runtime 1.096747, Loss 0.071515, forward nfe 5500, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 061/100, Runtime 1.124712, Loss 0.070039, forward nfe 5570, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 062/100, Runtime 1.058612, Loss 0.094998, forward nfe 5640, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 063/100, Runtime 1.033132, Loss 0.073596, forward nfe 5710, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 064/100, Runtime 1.095038, Loss 0.062906, forward nfe 5780, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 065/100, Runtime 1.088646, Loss 0.088078, forward nfe 5850, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 066/100, Runtime 1.079383, Loss 0.066497, forward nfe 5920, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 067/100, Runtime 1.052496, Loss 0.076549, forward nfe 5990, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 068/100, Runtime 1.060166, Loss 0.093793, forward nfe 6060, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 069/100, Runtime 1.090641, Loss 0.098444, forward nfe 6130, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 070/100, Runtime 1.078079, Loss 0.078520, forward nfe 6200, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 071/100, Runtime 1.054453, Loss 0.071004, forward nfe 6270, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 072/100, Runtime 1.063581, Loss 0.107546, forward nfe 6340, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 073/100, Runtime 1.086157, Loss 0.075657, forward nfe 6410, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 074/100, Runtime 1.115532, Loss 0.079026, forward nfe 6480, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 075/100, Runtime 1.091673, Loss 0.076490, forward nfe 6550, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 076/100, Runtime 1.097848, Loss 0.070078, forward nfe 6620, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 077/100, Runtime 1.048959, Loss 0.060564, forward nfe 6690, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 078/100, Runtime 1.093907, Loss 0.099846, forward nfe 6760, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 079/100, Runtime 1.114636, Loss 0.051578, forward nfe 6830, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 080/100, Runtime 1.130670, Loss 0.051898, forward nfe 6900, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 081/100, Runtime 1.078448, Loss 0.063280, forward nfe 6970, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 082/100, Runtime 1.055943, Loss 0.089270, forward nfe 7040, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 083/100, Runtime 1.087337, Loss 0.100209, forward nfe 7110, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 084/100, Runtime 1.113547, Loss 0.074583, forward nfe 7180, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 085/100, Runtime 1.051438, Loss 0.063304, forward nfe 7250, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 086/100, Runtime 1.041831, Loss 0.079094, forward nfe 7320, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 087/100, Runtime 1.036792, Loss 0.084100, forward nfe 7390, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 088/100, Runtime 1.076117, Loss 0.077004, forward nfe 7460, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 089/100, Runtime 1.117143, Loss 0.170066, forward nfe 7530, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 090/100, Runtime 1.083487, Loss 0.061610, forward nfe 7600, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 091/100, Runtime 1.037831, Loss 0.082657, forward nfe 7670, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 092/100, Runtime 1.085608, Loss 0.111160, forward nfe 7740, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 093/100, Runtime 1.104024, Loss 0.067601, forward nfe 7810, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 094/100, Runtime 1.094461, Loss 0.087730, forward nfe 7880, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 095/100, Runtime 1.125892, Loss 0.059197, forward nfe 7950, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 096/100, Runtime 1.194609, Loss 0.069759, forward nfe 8026, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 097/100, Runtime 1.153936, Loss 0.076975, forward nfe 8102, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 098/100, Runtime 1.167467, Loss 0.044278, forward nfe 8178, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
Epoch: 099/100, Runtime 1.285820, Loss 0.041298, forward nfe 8254, backward nfe 0, Train: 0.9286, Val: 0.8471, Test: 0.8386, Best time: 10.0000
best val accuracy 0.847059 with test accuracy 0.838579 at epoch 9 and best time 10.000000