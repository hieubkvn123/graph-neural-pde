/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 1.630213, Loss 1.945955, forward nfe 56, backward nfe 0, Train: 0.6571, Val: 0.4235, Test: 0.4193, Best time: 2.4342
Epoch: 002/100, Runtime 1.593267, Loss 1.801085, forward nfe 246, backward nfe 0, Train: 0.7286, Val: 0.5176, Test: 0.4944, Best time: 2.3455
Epoch: 003/100, Runtime 1.591239, Loss 1.528013, forward nfe 436, backward nfe 0, Train: 0.8714, Val: 0.7140, Test: 0.6914, Best time: 17.4580
Epoch: 004/100, Runtime 1.481055, Loss 1.224508, forward nfe 626, backward nfe 0, Train: 0.9143, Val: 0.7904, Test: 0.7635, Best time: 13.2335
Epoch: 005/100, Runtime 1.482310, Loss 0.943838, forward nfe 804, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8051, Best time: 13.3562
Epoch: 006/100, Runtime 1.495294, Loss 0.677777, forward nfe 982, backward nfe 0, Train: 0.9286, Val: 0.8478, Test: 0.8305, Best time: 17.8633
Epoch: 007/100, Runtime 1.465640, Loss 0.511198, forward nfe 1160, backward nfe 0, Train: 0.9286, Val: 0.8515, Test: 0.8274, Best time: 10.7430
Epoch: 008/100, Runtime 1.443208, Loss 0.382698, forward nfe 1338, backward nfe 0, Train: 0.9500, Val: 0.8522, Test: 0.8071, Best time: 14.6486
Epoch: 009/100, Runtime 1.448970, Loss 0.280252, forward nfe 1510, backward nfe 0, Train: 0.9500, Val: 0.8522, Test: 0.8071, Best time: 20.0000
Epoch: 010/100, Runtime 1.340911, Loss 0.248642, forward nfe 1682, backward nfe 0, Train: 0.9643, Val: 0.8529, Test: 0.8193, Best time: 21.0487
Epoch: 011/100, Runtime 1.381748, Loss 0.212181, forward nfe 1842, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 22.1532
Epoch: 012/100, Runtime 1.376682, Loss 0.215135, forward nfe 2002, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 013/100, Runtime 1.387852, Loss 0.193280, forward nfe 2168, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 014/100, Runtime 1.316341, Loss 0.189843, forward nfe 2328, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 015/100, Runtime 1.304659, Loss 0.206007, forward nfe 2482, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 016/100, Runtime 1.227586, Loss 0.177222, forward nfe 2630, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 017/100, Runtime 1.197950, Loss 0.229279, forward nfe 2778, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 018/100, Runtime 1.229414, Loss 0.238114, forward nfe 2920, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 019/100, Runtime 1.085954, Loss 0.201537, forward nfe 3062, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 020/100, Runtime 1.262665, Loss 0.191539, forward nfe 3204, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 021/100, Runtime 1.156080, Loss 0.182648, forward nfe 3352, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 022/100, Runtime 1.193047, Loss 0.179801, forward nfe 3494, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 023/100, Runtime 1.109814, Loss 0.169587, forward nfe 3636, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 024/100, Runtime 1.127812, Loss 0.170866, forward nfe 3766, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 025/100, Runtime 1.079841, Loss 0.194782, forward nfe 3896, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 026/100, Runtime 1.074922, Loss 0.168069, forward nfe 4020, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 027/100, Runtime 1.067893, Loss 0.167363, forward nfe 4144, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 028/100, Runtime 1.112602, Loss 0.127237, forward nfe 4274, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 029/100, Runtime 1.074119, Loss 0.117299, forward nfe 4404, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 030/100, Runtime 1.141166, Loss 0.159707, forward nfe 4534, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 031/100, Runtime 1.135787, Loss 0.124527, forward nfe 4664, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 032/100, Runtime 1.101975, Loss 0.157532, forward nfe 4794, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 033/100, Runtime 1.069028, Loss 0.132346, forward nfe 4930, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 034/100, Runtime 1.070609, Loss 0.132912, forward nfe 5060, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 035/100, Runtime 0.992921, Loss 0.078922, forward nfe 5190, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 036/100, Runtime 1.064186, Loss 0.131653, forward nfe 5320, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 037/100, Runtime 0.970756, Loss 0.150426, forward nfe 5450, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 038/100, Runtime 1.072944, Loss 0.117372, forward nfe 5580, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 039/100, Runtime 1.049162, Loss 0.151493, forward nfe 5710, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 040/100, Runtime 1.024997, Loss 0.115010, forward nfe 5834, backward nfe 0, Train: 0.9714, Val: 0.8551, Test: 0.8264, Best time: 20.0000
Epoch: 041/100, Runtime 1.104458, Loss 0.116003, forward nfe 5964, backward nfe 0, Train: 0.9857, Val: 0.8618, Test: 0.8284, Best time: 20.0000
Epoch: 042/100, Runtime 1.073731, Loss 0.142935, forward nfe 6094, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 49.1055
Epoch: 043/100, Runtime 1.145558, Loss 0.087528, forward nfe 6224, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 044/100, Runtime 1.176356, Loss 0.092624, forward nfe 6354, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 045/100, Runtime 1.219394, Loss 0.090839, forward nfe 6484, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 046/100, Runtime 1.127371, Loss 0.092102, forward nfe 6614, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 047/100, Runtime 1.147439, Loss 0.082781, forward nfe 6744, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 048/100, Runtime 1.013871, Loss 0.074906, forward nfe 6874, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 049/100, Runtime 1.130670, Loss 0.075139, forward nfe 7004, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 050/100, Runtime 1.043533, Loss 0.056281, forward nfe 7134, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 051/100, Runtime 1.180256, Loss 0.099198, forward nfe 7264, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 052/100, Runtime 1.064474, Loss 0.097547, forward nfe 7400, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 053/100, Runtime 1.047082, Loss 0.082499, forward nfe 7518, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 054/100, Runtime 1.016918, Loss 0.085915, forward nfe 7636, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 055/100, Runtime 1.133161, Loss 0.078973, forward nfe 7760, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 056/100, Runtime 1.036617, Loss 0.062670, forward nfe 7884, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 057/100, Runtime 1.076077, Loss 0.087881, forward nfe 8008, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 058/100, Runtime 0.996506, Loss 0.106307, forward nfe 8126, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 059/100, Runtime 0.994848, Loss 0.096113, forward nfe 8244, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 060/100, Runtime 1.075370, Loss 0.138488, forward nfe 8362, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 061/100, Runtime 1.004775, Loss 0.072607, forward nfe 8480, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 062/100, Runtime 0.989153, Loss 0.088835, forward nfe 8598, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 063/100, Runtime 1.027163, Loss 0.044570, forward nfe 8716, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 064/100, Runtime 0.995934, Loss 0.053568, forward nfe 8834, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 065/100, Runtime 1.010162, Loss 0.046270, forward nfe 8952, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 066/100, Runtime 1.057965, Loss 0.046903, forward nfe 9070, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 067/100, Runtime 1.039618, Loss 0.053505, forward nfe 9188, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 068/100, Runtime 1.007954, Loss 0.073704, forward nfe 9306, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 069/100, Runtime 1.064821, Loss 0.082081, forward nfe 9424, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 070/100, Runtime 1.017604, Loss 0.045162, forward nfe 9542, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 071/100, Runtime 1.029810, Loss 0.055603, forward nfe 9660, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 072/100, Runtime 1.014729, Loss 0.090334, forward nfe 9778, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 073/100, Runtime 0.961634, Loss 0.054397, forward nfe 9890, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 074/100, Runtime 0.966200, Loss 0.073656, forward nfe 10002, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 075/100, Runtime 0.974723, Loss 0.057181, forward nfe 10114, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 076/100, Runtime 1.012621, Loss 0.073852, forward nfe 10226, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 077/100, Runtime 1.022771, Loss 0.054416, forward nfe 10338, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 078/100, Runtime 0.942832, Loss 0.075729, forward nfe 10450, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 079/100, Runtime 0.961811, Loss 0.032113, forward nfe 10562, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 080/100, Runtime 0.960639, Loss 0.053518, forward nfe 10674, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 081/100, Runtime 1.105061, Loss 0.043990, forward nfe 10786, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 082/100, Runtime 1.038482, Loss 0.034076, forward nfe 10910, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 083/100, Runtime 1.142008, Loss 0.069624, forward nfe 11034, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 084/100, Runtime 1.048945, Loss 0.056781, forward nfe 11158, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 085/100, Runtime 1.118628, Loss 0.061252, forward nfe 11282, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 086/100, Runtime 1.034428, Loss 0.042437, forward nfe 11406, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 087/100, Runtime 1.159772, Loss 0.046322, forward nfe 11530, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 088/100, Runtime 1.185669, Loss 0.032843, forward nfe 11660, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 089/100, Runtime 1.225481, Loss 0.058105, forward nfe 11796, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 090/100, Runtime 1.226740, Loss 0.040688, forward nfe 11938, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 091/100, Runtime 1.222779, Loss 0.036648, forward nfe 12080, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 092/100, Runtime 1.286655, Loss 0.050007, forward nfe 12222, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 093/100, Runtime 1.274127, Loss 0.050822, forward nfe 12370, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 094/100, Runtime 1.430000, Loss 0.050798, forward nfe 12518, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 095/100, Runtime 1.403902, Loss 0.040601, forward nfe 12678, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 096/100, Runtime 1.304368, Loss 0.046313, forward nfe 12850, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 097/100, Runtime 1.821182, Loss 0.064699, forward nfe 13022, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 098/100, Runtime 1.725604, Loss 0.068225, forward nfe 13188, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
Epoch: 099/100, Runtime 1.944308, Loss 0.052682, forward nfe 13348, backward nfe 0, Train: 1.0000, Val: 0.8647, Test: 0.8508, Best time: 20.0000
best val accuracy 0.864706 with test accuracy 0.850761 at epoch 42 and best time 20.000000