/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.559124, Loss 1.793577, forward nfe 140, backward nfe 0, Train: 0.2250, Val: 0.2920, Test: 0.2694, Best time: 0.0405
Epoch: 002/100, Runtime 0.482658, Loss 1.758607, forward nfe 558, backward nfe 0, Train: 0.4417, Val: 0.5246, Test: 0.5032, Best time: 120.9093
Epoch: 003/100, Runtime 0.480798, Loss 1.732271, forward nfe 976, backward nfe 0, Train: 0.5750, Val: 0.6152, Test: 0.5968, Best time: 75.6893
Epoch: 004/100, Runtime 0.511447, Loss 1.686606, forward nfe 1400, backward nfe 0, Train: 0.6583, Val: 0.6870, Test: 0.6984, Best time: 70.6333
Epoch: 005/100, Runtime 0.483448, Loss 1.616148, forward nfe 1818, backward nfe 0, Train: 0.7000, Val: 0.7043, Test: 0.7274, Best time: 23.5424
Epoch: 006/100, Runtime 0.481189, Loss 1.599539, forward nfe 2242, backward nfe 0, Train: 0.7250, Val: 0.7225, Test: 0.7226, Best time: 3.5463
Epoch: 007/100, Runtime 0.472198, Loss 1.525909, forward nfe 2648, backward nfe 0, Train: 0.7250, Val: 0.7225, Test: 0.7226, Best time: 40.0000
Epoch: 008/100, Runtime 0.473263, Loss 1.546584, forward nfe 3048, backward nfe 0, Train: 0.7500, Val: 0.7391, Test: 0.7500, Best time: 3.7512
Epoch: 009/100, Runtime 0.455690, Loss 1.484324, forward nfe 3448, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 12.7708
Epoch: 010/100, Runtime 0.444619, Loss 1.523511, forward nfe 3842, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 011/100, Runtime 0.451513, Loss 1.421241, forward nfe 4224, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 012/100, Runtime 0.448078, Loss 1.467655, forward nfe 4612, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 013/100, Runtime 0.443164, Loss 1.428539, forward nfe 4988, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 014/100, Runtime 0.413682, Loss 1.368167, forward nfe 5352, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 015/100, Runtime 0.422365, Loss 1.331437, forward nfe 5716, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 016/100, Runtime 0.426410, Loss 1.318861, forward nfe 6080, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 017/100, Runtime 0.421860, Loss 1.320160, forward nfe 6444, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 018/100, Runtime 0.414654, Loss 1.251295, forward nfe 6796, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 019/100, Runtime 0.406189, Loss 1.222509, forward nfe 7148, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 020/100, Runtime 0.399902, Loss 1.163560, forward nfe 7488, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 021/100, Runtime 0.401328, Loss 1.189361, forward nfe 7828, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 022/100, Runtime 0.418897, Loss 1.263760, forward nfe 8168, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 023/100, Runtime 0.397783, Loss 1.162278, forward nfe 8496, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 024/100, Runtime 0.380723, Loss 1.238505, forward nfe 8824, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 025/100, Runtime 0.369421, Loss 1.192955, forward nfe 9146, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 026/100, Runtime 0.410984, Loss 1.163043, forward nfe 9462, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 027/100, Runtime 0.376610, Loss 1.070342, forward nfe 9784, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 028/100, Runtime 0.361504, Loss 1.095317, forward nfe 10094, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 029/100, Runtime 0.360928, Loss 1.152425, forward nfe 10398, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 030/100, Runtime 0.360366, Loss 1.004834, forward nfe 10702, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 031/100, Runtime 0.364467, Loss 1.168385, forward nfe 11000, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 032/100, Runtime 0.365110, Loss 1.118327, forward nfe 11304, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 033/100, Runtime 0.356036, Loss 1.140496, forward nfe 11602, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 034/100, Runtime 0.338386, Loss 1.053663, forward nfe 11894, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 035/100, Runtime 0.334596, Loss 1.043965, forward nfe 12180, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 036/100, Runtime 0.342102, Loss 1.101785, forward nfe 12466, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 037/100, Runtime 0.344640, Loss 1.073669, forward nfe 12746, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 038/100, Runtime 0.326344, Loss 0.954615, forward nfe 13026, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 039/100, Runtime 0.339488, Loss 1.105167, forward nfe 13306, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 040/100, Runtime 0.340700, Loss 1.050373, forward nfe 13586, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 041/100, Runtime 0.344022, Loss 0.990549, forward nfe 13848, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 042/100, Runtime 0.338793, Loss 1.006031, forward nfe 14110, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 043/100, Runtime 0.333165, Loss 0.948446, forward nfe 14372, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 044/100, Runtime 0.313941, Loss 1.012336, forward nfe 14634, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 045/100, Runtime 0.314164, Loss 1.032564, forward nfe 14890, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 046/100, Runtime 0.304430, Loss 0.992622, forward nfe 15140, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 047/100, Runtime 0.296852, Loss 0.958169, forward nfe 15396, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 048/100, Runtime 0.300237, Loss 0.976571, forward nfe 15646, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 049/100, Runtime 0.308540, Loss 1.100314, forward nfe 15890, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 050/100, Runtime 0.303469, Loss 0.980615, forward nfe 16134, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 051/100, Runtime 0.319883, Loss 0.964554, forward nfe 16378, backward nfe 0, Train: 0.7417, Val: 0.7616, Test: 0.7694, Best time: 40.0000
Epoch: 052/100, Runtime 0.306365, Loss 0.992436, forward nfe 16622, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 36.4440
Epoch: 053/100, Runtime 0.298965, Loss 0.972337, forward nfe 16866, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 054/100, Runtime 0.301812, Loss 1.145506, forward nfe 17110, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 055/100, Runtime 0.304945, Loss 0.951311, forward nfe 17354, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 056/100, Runtime 0.310288, Loss 1.038598, forward nfe 17598, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 057/100, Runtime 0.292723, Loss 0.976911, forward nfe 17842, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 058/100, Runtime 0.300761, Loss 0.982573, forward nfe 18086, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 059/100, Runtime 0.293377, Loss 1.181948, forward nfe 18330, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 060/100, Runtime 0.308043, Loss 0.984470, forward nfe 18574, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 061/100, Runtime 0.298821, Loss 0.958809, forward nfe 18818, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 062/100, Runtime 0.311311, Loss 1.077843, forward nfe 19068, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 063/100, Runtime 0.315786, Loss 1.012439, forward nfe 19318, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 064/100, Runtime 0.310734, Loss 1.048367, forward nfe 19568, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 065/100, Runtime 0.318380, Loss 1.003613, forward nfe 19818, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 066/100, Runtime 0.323769, Loss 0.962827, forward nfe 20068, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 067/100, Runtime 0.308449, Loss 0.857755, forward nfe 20318, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 068/100, Runtime 0.308465, Loss 0.990403, forward nfe 20568, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 069/100, Runtime 0.451202, Loss 1.071372, forward nfe 20818, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 070/100, Runtime 0.322430, Loss 0.991089, forward nfe 21068, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 071/100, Runtime 0.305634, Loss 1.057870, forward nfe 21318, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 072/100, Runtime 0.305419, Loss 1.089066, forward nfe 21568, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 073/100, Runtime 0.293674, Loss 1.101874, forward nfe 21818, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 074/100, Runtime 0.288290, Loss 1.059265, forward nfe 22068, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 075/100, Runtime 0.289098, Loss 0.984366, forward nfe 22312, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 076/100, Runtime 0.307504, Loss 1.052487, forward nfe 22556, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 077/100, Runtime 0.308043, Loss 0.938830, forward nfe 22800, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 078/100, Runtime 0.306315, Loss 0.896555, forward nfe 23044, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 079/100, Runtime 0.301277, Loss 1.017050, forward nfe 23288, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 080/100, Runtime 0.315248, Loss 0.952740, forward nfe 23532, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 081/100, Runtime 0.303169, Loss 1.048797, forward nfe 23776, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 082/100, Runtime 0.304423, Loss 0.895565, forward nfe 24020, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 083/100, Runtime 0.299413, Loss 1.001671, forward nfe 24264, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 084/100, Runtime 0.311224, Loss 1.019892, forward nfe 24508, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 085/100, Runtime 0.305878, Loss 0.968522, forward nfe 24752, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 086/100, Runtime 0.306792, Loss 0.834900, forward nfe 24996, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 087/100, Runtime 0.303417, Loss 0.979573, forward nfe 25240, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 088/100, Runtime 0.298865, Loss 0.918084, forward nfe 25484, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 089/100, Runtime 0.296345, Loss 1.027810, forward nfe 25728, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 090/100, Runtime 0.308992, Loss 0.956225, forward nfe 25966, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 091/100, Runtime 0.310530, Loss 0.978888, forward nfe 26210, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 092/100, Runtime 0.312454, Loss 0.998154, forward nfe 26454, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 093/100, Runtime 0.303811, Loss 1.036419, forward nfe 26698, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 094/100, Runtime 0.305070, Loss 0.970562, forward nfe 26942, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 095/100, Runtime 0.311534, Loss 0.964595, forward nfe 27186, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 096/100, Runtime 0.309554, Loss 0.931016, forward nfe 27430, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 097/100, Runtime 0.309070, Loss 0.955817, forward nfe 27674, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 098/100, Runtime 0.317492, Loss 1.013425, forward nfe 27918, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
Epoch: 099/100, Runtime 0.287865, Loss 0.929371, forward nfe 28162, backward nfe 0, Train: 0.8833, Val: 0.7688, Test: 0.7726, Best time: 40.0000
best val accuracy 0.768841 with test accuracy 0.772581 at epoch 52 and best time 40.000000