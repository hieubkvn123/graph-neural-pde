/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.623602, Loss 1.794724, forward nfe 158, backward nfe 0, Train: 0.1750, Val: 0.2645, Test: 0.2387, Best time: 1.4862
Epoch: 002/100, Runtime 0.559727, Loss 1.782718, forward nfe 648, backward nfe 0, Train: 0.2000, Val: 0.2761, Test: 0.2565, Best time: 0.0384
Epoch: 003/100, Runtime 0.577895, Loss 1.764665, forward nfe 1138, backward nfe 0, Train: 0.4000, Val: 0.3391, Test: 0.3371, Best time: 0.0376
Epoch: 004/100, Runtime 0.554401, Loss 1.737930, forward nfe 1628, backward nfe 0, Train: 0.5083, Val: 0.3804, Test: 0.3726, Best time: 1.4127
Epoch: 005/100, Runtime 0.567335, Loss 1.709590, forward nfe 2112, backward nfe 0, Train: 0.5750, Val: 0.4739, Test: 0.4629, Best time: 44.2069
Epoch: 006/100, Runtime 0.537982, Loss 1.692958, forward nfe 2590, backward nfe 0, Train: 0.7250, Val: 0.5674, Test: 0.5419, Best time: 5.3298
Epoch: 007/100, Runtime 0.545761, Loss 1.666522, forward nfe 3056, backward nfe 0, Train: 0.7750, Val: 0.6551, Test: 0.6371, Best time: 3.7362
Epoch: 008/100, Runtime 0.519618, Loss 1.634510, forward nfe 3522, backward nfe 0, Train: 0.8250, Val: 0.7246, Test: 0.7048, Best time: 9.4663
Epoch: 009/100, Runtime 0.505020, Loss 1.605736, forward nfe 3976, backward nfe 0, Train: 0.8250, Val: 0.7246, Test: 0.7048, Best time: 50.0000
Epoch: 010/100, Runtime 0.502709, Loss 1.575023, forward nfe 4418, backward nfe 0, Train: 0.8250, Val: 0.7246, Test: 0.7048, Best time: 50.0000
Epoch: 011/100, Runtime 0.510005, Loss 1.564412, forward nfe 4866, backward nfe 0, Train: 0.8250, Val: 0.7246, Test: 0.7048, Best time: 50.0000
Epoch: 012/100, Runtime 0.499987, Loss 1.518141, forward nfe 5308, backward nfe 0, Train: 0.8250, Val: 0.7246, Test: 0.7048, Best time: 50.0000
Epoch: 013/100, Runtime 0.488719, Loss 1.537176, forward nfe 5750, backward nfe 0, Train: 0.8250, Val: 0.7246, Test: 0.7048, Best time: 50.0000
Epoch: 014/100, Runtime 0.480243, Loss 1.444075, forward nfe 6174, backward nfe 0, Train: 0.8250, Val: 0.7246, Test: 0.7048, Best time: 50.0000
Epoch: 015/100, Runtime 0.494900, Loss 1.399657, forward nfe 6598, backward nfe 0, Train: 0.8250, Val: 0.7246, Test: 0.7048, Best time: 50.0000
Epoch: 016/100, Runtime 0.479867, Loss 1.360224, forward nfe 7016, backward nfe 0, Train: 0.8250, Val: 0.7246, Test: 0.7048, Best time: 50.0000
Epoch: 017/100, Runtime 0.493624, Loss 1.260224, forward nfe 7440, backward nfe 0, Train: 0.8250, Val: 0.7246, Test: 0.7048, Best time: 50.0000
Epoch: 018/100, Runtime 0.480629, Loss 1.281565, forward nfe 7858, backward nfe 0, Train: 0.8250, Val: 0.7246, Test: 0.7048, Best time: 50.0000
Epoch: 019/100, Runtime 0.477714, Loss 1.212921, forward nfe 8264, backward nfe 0, Train: 0.8250, Val: 0.7246, Test: 0.7048, Best time: 50.0000
Epoch: 020/100, Runtime 0.454463, Loss 1.155311, forward nfe 8670, backward nfe 0, Train: 0.8250, Val: 0.7246, Test: 0.7048, Best time: 50.0000
Epoch: 021/100, Runtime 0.445353, Loss 1.186187, forward nfe 9058, backward nfe 0, Train: 0.8250, Val: 0.7246, Test: 0.7048, Best time: 50.0000
Epoch: 022/100, Runtime 0.450436, Loss 1.159176, forward nfe 9452, backward nfe 0, Train: 0.8250, Val: 0.7246, Test: 0.7048, Best time: 50.0000
Epoch: 023/100, Runtime 0.434424, Loss 1.114640, forward nfe 9840, backward nfe 0, Train: 0.8250, Val: 0.7246, Test: 0.7048, Best time: 50.0000
Epoch: 024/100, Runtime 0.442393, Loss 1.166687, forward nfe 10210, backward nfe 0, Train: 0.8500, Val: 0.7391, Test: 0.7210, Best time: 24.1101
Epoch: 025/100, Runtime 0.420392, Loss 1.118877, forward nfe 10586, backward nfe 0, Train: 0.8500, Val: 0.7391, Test: 0.7210, Best time: 50.0000
Epoch: 026/100, Runtime 0.407383, Loss 1.030967, forward nfe 10956, backward nfe 0, Train: 0.8500, Val: 0.7391, Test: 0.7210, Best time: 50.0000
Epoch: 027/100, Runtime 0.418421, Loss 1.079673, forward nfe 11320, backward nfe 0, Train: 0.8333, Val: 0.7435, Test: 0.7323, Best time: 26.3990
Epoch: 028/100, Runtime 0.418506, Loss 1.050978, forward nfe 11684, backward nfe 0, Train: 0.8333, Val: 0.7435, Test: 0.7323, Best time: 50.0000
Epoch: 029/100, Runtime 0.401019, Loss 1.105726, forward nfe 12030, backward nfe 0, Train: 0.8333, Val: 0.7435, Test: 0.7323, Best time: 50.0000
Epoch: 030/100, Runtime 0.405227, Loss 1.006274, forward nfe 12370, backward nfe 0, Train: 0.8500, Val: 0.7449, Test: 0.7258, Best time: 13.9459
Epoch: 031/100, Runtime 0.390747, Loss 0.943950, forward nfe 12704, backward nfe 0, Train: 0.8500, Val: 0.7449, Test: 0.7258, Best time: 50.0000
Epoch: 032/100, Runtime 0.395186, Loss 0.925969, forward nfe 13038, backward nfe 0, Train: 0.8500, Val: 0.7449, Test: 0.7258, Best time: 50.0000
Epoch: 033/100, Runtime 0.384301, Loss 1.065401, forward nfe 13372, backward nfe 0, Train: 0.8500, Val: 0.7449, Test: 0.7258, Best time: 50.0000
Epoch: 034/100, Runtime 0.381950, Loss 1.043014, forward nfe 13694, backward nfe 0, Train: 0.8500, Val: 0.7449, Test: 0.7258, Best time: 50.0000
Epoch: 035/100, Runtime 0.378453, Loss 1.016384, forward nfe 14016, backward nfe 0, Train: 0.8500, Val: 0.7449, Test: 0.7258, Best time: 50.0000
Epoch: 036/100, Runtime 0.363283, Loss 1.068428, forward nfe 14332, backward nfe 0, Train: 0.8500, Val: 0.7449, Test: 0.7258, Best time: 50.0000
Epoch: 037/100, Runtime 0.370366, Loss 1.008590, forward nfe 14642, backward nfe 0, Train: 0.8500, Val: 0.7449, Test: 0.7258, Best time: 50.0000
Epoch: 038/100, Runtime 0.367932, Loss 1.026691, forward nfe 14952, backward nfe 0, Train: 0.8500, Val: 0.7449, Test: 0.7258, Best time: 50.0000
Epoch: 039/100, Runtime 0.376708, Loss 0.910589, forward nfe 15256, backward nfe 0, Train: 0.8500, Val: 0.7449, Test: 0.7258, Best time: 50.0000
Epoch: 040/100, Runtime 0.371463, Loss 1.013862, forward nfe 15560, backward nfe 0, Train: 0.8667, Val: 0.7486, Test: 0.7226, Best time: 40.5056
Epoch: 041/100, Runtime 0.346737, Loss 1.102700, forward nfe 15858, backward nfe 0, Train: 0.8667, Val: 0.7486, Test: 0.7226, Best time: 50.0000
Epoch: 042/100, Runtime 0.342746, Loss 1.060943, forward nfe 16150, backward nfe 0, Train: 0.8667, Val: 0.7486, Test: 0.7226, Best time: 50.0000
Epoch: 043/100, Runtime 0.351784, Loss 0.939975, forward nfe 16442, backward nfe 0, Train: 0.8667, Val: 0.7486, Test: 0.7226, Best time: 50.0000
Epoch: 044/100, Runtime 0.334211, Loss 1.051774, forward nfe 16734, backward nfe 0, Train: 0.8667, Val: 0.7486, Test: 0.7226, Best time: 50.0000
Epoch: 045/100, Runtime 0.348600, Loss 1.157706, forward nfe 17014, backward nfe 0, Train: 0.8667, Val: 0.7486, Test: 0.7226, Best time: 50.0000
Epoch: 046/100, Runtime 0.339207, Loss 0.979756, forward nfe 17300, backward nfe 0, Train: 0.8250, Val: 0.7507, Test: 0.7290, Best time: 23.7498
Epoch: 047/100, Runtime 0.337074, Loss 0.951639, forward nfe 17580, backward nfe 0, Train: 0.8500, Val: 0.7514, Test: 0.7371, Best time: 34.8851
Epoch: 048/100, Runtime 0.325531, Loss 1.092329, forward nfe 17854, backward nfe 0, Train: 0.8500, Val: 0.7514, Test: 0.7371, Best time: 50.0000
Epoch: 049/100, Runtime 0.328587, Loss 1.044582, forward nfe 18122, backward nfe 0, Train: 0.8500, Val: 0.7514, Test: 0.7371, Best time: 50.0000
Epoch: 050/100, Runtime 0.325397, Loss 1.025501, forward nfe 18390, backward nfe 0, Train: 0.8500, Val: 0.7514, Test: 0.7371, Best time: 50.0000
Epoch: 051/100, Runtime 0.340335, Loss 1.015340, forward nfe 18658, backward nfe 0, Train: 0.8500, Val: 0.7514, Test: 0.7371, Best time: 50.0000
Epoch: 052/100, Runtime 0.322108, Loss 1.092454, forward nfe 18932, backward nfe 0, Train: 0.8500, Val: 0.7514, Test: 0.7371, Best time: 50.0000
Epoch: 053/100, Runtime 0.317333, Loss 1.036625, forward nfe 19200, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 32.3232
Epoch: 054/100, Runtime 0.323933, Loss 1.061825, forward nfe 19468, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 055/100, Runtime 0.315295, Loss 0.967864, forward nfe 19730, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 056/100, Runtime 0.315066, Loss 1.110074, forward nfe 19992, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 057/100, Runtime 0.349665, Loss 1.069424, forward nfe 20254, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 058/100, Runtime 0.331997, Loss 1.036465, forward nfe 20522, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 059/100, Runtime 0.338248, Loss 1.003974, forward nfe 20796, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 060/100, Runtime 0.328630, Loss 0.934754, forward nfe 21070, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 061/100, Runtime 0.339108, Loss 1.051650, forward nfe 21344, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 062/100, Runtime 0.332202, Loss 1.060165, forward nfe 21618, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 063/100, Runtime 0.479054, Loss 0.945203, forward nfe 21892, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 064/100, Runtime 0.328620, Loss 1.073270, forward nfe 22166, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 065/100, Runtime 0.326375, Loss 0.981797, forward nfe 22434, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 066/100, Runtime 0.322964, Loss 0.973531, forward nfe 22702, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 067/100, Runtime 0.329574, Loss 0.963795, forward nfe 22970, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 068/100, Runtime 0.328113, Loss 1.164488, forward nfe 23238, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 069/100, Runtime 0.341651, Loss 1.045901, forward nfe 23506, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 070/100, Runtime 0.332245, Loss 0.978684, forward nfe 23774, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 071/100, Runtime 0.350512, Loss 0.966713, forward nfe 24048, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 072/100, Runtime 0.345090, Loss 1.036775, forward nfe 24322, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 073/100, Runtime 0.342854, Loss 0.933190, forward nfe 24596, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 074/100, Runtime 0.336154, Loss 1.036039, forward nfe 24870, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 075/100, Runtime 0.334454, Loss 0.853067, forward nfe 25138, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 076/100, Runtime 0.330486, Loss 1.105151, forward nfe 25406, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 077/100, Runtime 0.332232, Loss 1.072738, forward nfe 25674, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 078/100, Runtime 0.335187, Loss 0.943161, forward nfe 25942, backward nfe 0, Train: 0.9000, Val: 0.7551, Test: 0.7323, Best time: 50.0000
Epoch: 079/100, Runtime 0.330221, Loss 1.001811, forward nfe 26210, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.6387
Epoch: 080/100, Runtime 0.343160, Loss 1.009129, forward nfe 26478, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 081/100, Runtime 0.361731, Loss 1.142028, forward nfe 26746, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 082/100, Runtime 0.341269, Loss 0.849977, forward nfe 27014, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 083/100, Runtime 0.326059, Loss 0.997871, forward nfe 27282, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 084/100, Runtime 0.336331, Loss 0.921380, forward nfe 27550, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 085/100, Runtime 0.313112, Loss 1.152739, forward nfe 27812, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 086/100, Runtime 0.348408, Loss 0.976273, forward nfe 28068, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 087/100, Runtime 0.317338, Loss 0.984030, forward nfe 28324, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 088/100, Runtime 0.324283, Loss 0.916775, forward nfe 28580, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 089/100, Runtime 0.318432, Loss 0.967307, forward nfe 28836, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 090/100, Runtime 0.309588, Loss 1.002512, forward nfe 29092, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 091/100, Runtime 0.309856, Loss 0.976507, forward nfe 29348, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 092/100, Runtime 0.329299, Loss 1.078031, forward nfe 29604, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 093/100, Runtime 0.315993, Loss 0.891076, forward nfe 29860, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 094/100, Runtime 0.320387, Loss 0.994234, forward nfe 30116, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 095/100, Runtime 0.311431, Loss 1.054974, forward nfe 30372, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 096/100, Runtime 0.324228, Loss 0.993050, forward nfe 30628, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 097/100, Runtime 0.311782, Loss 0.934969, forward nfe 30884, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 098/100, Runtime 0.321866, Loss 0.974467, forward nfe 31140, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
Epoch: 099/100, Runtime 0.330710, Loss 0.930419, forward nfe 31396, backward nfe 0, Train: 0.9167, Val: 0.7616, Test: 0.7371, Best time: 50.0000
best val accuracy 0.761594 with test accuracy 0.737097 at epoch 79 and best time 50.000000