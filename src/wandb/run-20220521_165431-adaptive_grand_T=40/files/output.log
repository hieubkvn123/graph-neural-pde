/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 2.778865, Loss 1.947197, forward nfe 92, backward nfe 0, Train: 0.1000, Val: 0.2816, Test: 0.2477, Best time: 50.3813
Epoch: 002/100, Runtime 2.555680, Loss 1.954330, forward nfe 426, backward nfe 0, Train: 0.1000, Val: 0.2816, Test: 0.2477, Best time: 40.0000
Epoch: 003/100, Runtime 2.561045, Loss 1.903656, forward nfe 736, backward nfe 0, Train: 0.1000, Val: 0.2816, Test: 0.2477, Best time: 40.0000
Epoch: 004/100, Runtime 2.554186, Loss 1.808391, forward nfe 1052, backward nfe 0, Train: 0.6286, Val: 0.4706, Test: 0.4944, Best time: 3.7033
Epoch: 005/100, Runtime 2.469624, Loss 1.627737, forward nfe 1356, backward nfe 0, Train: 0.7786, Val: 0.7213, Test: 0.7198, Best time: 10.1814
Epoch: 006/100, Runtime 2.410712, Loss 1.418003, forward nfe 1654, backward nfe 0, Train: 0.7929, Val: 0.8088, Test: 0.8051, Best time: 13.8009
Epoch: 007/100, Runtime 2.414272, Loss 1.195638, forward nfe 1946, backward nfe 0, Train: 0.8214, Val: 0.8301, Test: 0.8416, Best time: 31.9960
Epoch: 008/100, Runtime 2.084408, Loss 1.010010, forward nfe 2232, backward nfe 0, Train: 0.8214, Val: 0.8301, Test: 0.8416, Best time: 40.0000
Epoch: 009/100, Runtime 2.241339, Loss 0.807557, forward nfe 2512, backward nfe 0, Train: 0.8214, Val: 0.8301, Test: 0.8416, Best time: 40.0000
Epoch: 010/100, Runtime 2.149311, Loss 0.675245, forward nfe 2792, backward nfe 0, Train: 0.8214, Val: 0.8301, Test: 0.8416, Best time: 40.0000
Epoch: 011/100, Runtime 2.243420, Loss 0.584295, forward nfe 3066, backward nfe 0, Train: 0.8214, Val: 0.8301, Test: 0.8416, Best time: 40.0000
Epoch: 012/100, Runtime 2.253876, Loss 0.489908, forward nfe 3340, backward nfe 0, Train: 0.8214, Val: 0.8301, Test: 0.8416, Best time: 40.0000
Epoch: 013/100, Runtime 2.039811, Loss 0.412637, forward nfe 3608, backward nfe 0, Train: 0.8929, Val: 0.8338, Test: 0.8447, Best time: 103.0259
Epoch: 014/100, Runtime 2.133057, Loss 0.374588, forward nfe 3864, backward nfe 0, Train: 0.8929, Val: 0.8338, Test: 0.8447, Best time: 40.0000
Epoch: 015/100, Runtime 1.973087, Loss 0.336068, forward nfe 4108, backward nfe 0, Train: 0.8929, Val: 0.8338, Test: 0.8447, Best time: 40.0000
Epoch: 016/100, Runtime 1.932933, Loss 0.313360, forward nfe 4346, backward nfe 0, Train: 0.8929, Val: 0.8338, Test: 0.8447, Best time: 40.0000
Epoch: 017/100, Runtime 1.933399, Loss 0.273745, forward nfe 4578, backward nfe 0, Train: 0.8929, Val: 0.8338, Test: 0.8447, Best time: 40.0000
Epoch: 018/100, Runtime 1.835350, Loss 0.277400, forward nfe 4798, backward nfe 0, Train: 0.8929, Val: 0.8338, Test: 0.8447, Best time: 40.0000
Epoch: 019/100, Runtime 1.775013, Loss 0.282136, forward nfe 5018, backward nfe 0, Train: 0.8929, Val: 0.8338, Test: 0.8447, Best time: 40.0000
Epoch: 020/100, Runtime 1.776031, Loss 0.244442, forward nfe 5238, backward nfe 0, Train: 0.8929, Val: 0.8338, Test: 0.8447, Best time: 40.0000
Epoch: 021/100, Runtime 1.730890, Loss 0.285262, forward nfe 5446, backward nfe 0, Train: 0.8929, Val: 0.8338, Test: 0.8447, Best time: 40.0000
Epoch: 022/100, Runtime 1.652538, Loss 0.259497, forward nfe 5654, backward nfe 0, Train: 0.8929, Val: 0.8338, Test: 0.8447, Best time: 40.0000
Epoch: 023/100, Runtime 1.687283, Loss 0.261362, forward nfe 5844, backward nfe 0, Train: 0.8929, Val: 0.8338, Test: 0.8447, Best time: 40.0000
Epoch: 024/100, Runtime 1.623397, Loss 0.263992, forward nfe 6040, backward nfe 0, Train: 0.8929, Val: 0.8338, Test: 0.8447, Best time: 40.0000
Epoch: 025/100, Runtime 1.587086, Loss 0.214863, forward nfe 6236, backward nfe 0, Train: 0.8929, Val: 0.8338, Test: 0.8447, Best time: 40.0000
Epoch: 026/100, Runtime 1.566656, Loss 0.266277, forward nfe 6426, backward nfe 0, Train: 0.8929, Val: 0.8338, Test: 0.8447, Best time: 40.0000
Epoch: 027/100, Runtime 1.560435, Loss 0.170308, forward nfe 6616, backward nfe 0, Train: 0.8929, Val: 0.8338, Test: 0.8447, Best time: 40.0000
Epoch: 028/100, Runtime 1.484195, Loss 0.237156, forward nfe 6788, backward nfe 0, Train: 0.8929, Val: 0.8338, Test: 0.8447, Best time: 40.0000
Epoch: 029/100, Runtime 1.393997, Loss 0.253776, forward nfe 6960, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 030/100, Runtime 1.542918, Loss 0.199953, forward nfe 7132, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 031/100, Runtime 1.390035, Loss 0.268574, forward nfe 7310, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 032/100, Runtime 1.430438, Loss 0.199952, forward nfe 7476, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 033/100, Runtime 1.406426, Loss 0.186302, forward nfe 7642, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 034/100, Runtime 1.406708, Loss 0.178254, forward nfe 7808, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 035/100, Runtime 1.522209, Loss 0.180651, forward nfe 7974, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 036/100, Runtime 1.466159, Loss 0.212281, forward nfe 8146, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 037/100, Runtime 1.447079, Loss 0.188191, forward nfe 8318, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 038/100, Runtime 1.428925, Loss 0.181936, forward nfe 8490, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 039/100, Runtime 1.423010, Loss 0.158186, forward nfe 8656, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 040/100, Runtime 1.409475, Loss 0.167071, forward nfe 8822, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 041/100, Runtime 1.314369, Loss 0.222291, forward nfe 8988, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 042/100, Runtime 1.430493, Loss 0.173277, forward nfe 9142, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 043/100, Runtime 1.366918, Loss 0.115200, forward nfe 9302, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 044/100, Runtime 1.358559, Loss 0.169402, forward nfe 9462, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 045/100, Runtime 1.315468, Loss 0.125725, forward nfe 9622, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 046/100, Runtime 1.348548, Loss 0.156210, forward nfe 9782, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 047/100, Runtime 1.283242, Loss 0.156557, forward nfe 9936, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 048/100, Runtime 1.313696, Loss 0.141402, forward nfe 10090, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 049/100, Runtime 1.297972, Loss 0.134975, forward nfe 10244, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 050/100, Runtime 1.295505, Loss 0.126463, forward nfe 10398, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 051/100, Runtime 1.381316, Loss 0.125781, forward nfe 10552, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 052/100, Runtime 1.367672, Loss 0.136277, forward nfe 10712, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 053/100, Runtime 1.427013, Loss 0.129446, forward nfe 10872, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 054/100, Runtime 1.350208, Loss 0.102225, forward nfe 11038, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 055/100, Runtime 1.332989, Loss 0.104863, forward nfe 11204, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 056/100, Runtime 1.403266, Loss 0.080235, forward nfe 11370, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 057/100, Runtime 1.390818, Loss 0.111923, forward nfe 11536, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 058/100, Runtime 1.328541, Loss 0.101672, forward nfe 11708, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 059/100, Runtime 1.356283, Loss 0.124868, forward nfe 11880, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 060/100, Runtime 1.353334, Loss 0.129318, forward nfe 12040, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 061/100, Runtime 1.438776, Loss 0.118091, forward nfe 12200, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 062/100, Runtime 1.440781, Loss 0.097249, forward nfe 12360, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 063/100, Runtime 1.519238, Loss 0.100026, forward nfe 12532, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 064/100, Runtime 1.468712, Loss 0.066501, forward nfe 12704, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 065/100, Runtime 1.417606, Loss 0.075586, forward nfe 12876, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 066/100, Runtime 1.366453, Loss 0.074853, forward nfe 13036, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 067/100, Runtime 1.334020, Loss 0.087474, forward nfe 13196, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 068/100, Runtime 1.386240, Loss 0.061107, forward nfe 13356, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 069/100, Runtime 1.406587, Loss 0.075089, forward nfe 13516, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 070/100, Runtime 1.367917, Loss 0.066004, forward nfe 13676, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 071/100, Runtime 1.371222, Loss 0.125109, forward nfe 13836, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 072/100, Runtime 1.396618, Loss 0.079574, forward nfe 13996, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 073/100, Runtime 1.343774, Loss 0.138457, forward nfe 14156, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 074/100, Runtime 1.417738, Loss 0.111387, forward nfe 14316, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 075/100, Runtime 1.364562, Loss 0.103848, forward nfe 14476, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 076/100, Runtime 1.386365, Loss 0.062905, forward nfe 14636, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 077/100, Runtime 1.369625, Loss 0.083799, forward nfe 14796, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 078/100, Runtime 1.348377, Loss 0.093601, forward nfe 14956, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 079/100, Runtime 1.331305, Loss 0.058534, forward nfe 15116, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 080/100, Runtime 1.368914, Loss 0.099153, forward nfe 15276, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 081/100, Runtime 1.430263, Loss 0.051888, forward nfe 15436, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 082/100, Runtime 1.352562, Loss 0.071027, forward nfe 15596, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 083/100, Runtime 1.368364, Loss 0.091875, forward nfe 15756, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 084/100, Runtime 1.350317, Loss 0.086935, forward nfe 15916, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 085/100, Runtime 1.429691, Loss 0.056895, forward nfe 16076, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 086/100, Runtime 1.368330, Loss 0.065412, forward nfe 16236, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 087/100, Runtime 1.379560, Loss 0.037252, forward nfe 16396, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 088/100, Runtime 1.445140, Loss 0.104538, forward nfe 16556, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 089/100, Runtime 1.364840, Loss 0.045859, forward nfe 16716, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 090/100, Runtime 1.355900, Loss 0.122207, forward nfe 16876, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 091/100, Runtime 1.455204, Loss 0.050617, forward nfe 17036, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 092/100, Runtime 1.341746, Loss 0.077468, forward nfe 17196, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 093/100, Runtime 1.369139, Loss 0.051220, forward nfe 17356, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 094/100, Runtime 1.313189, Loss 0.075870, forward nfe 17516, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 095/100, Runtime 1.443959, Loss 0.065360, forward nfe 17676, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 096/100, Runtime 1.358516, Loss 0.051007, forward nfe 17836, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 097/100, Runtime 1.359000, Loss 0.053330, forward nfe 17996, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 098/100, Runtime 1.562517, Loss 0.097128, forward nfe 18156, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
Epoch: 099/100, Runtime 1.357739, Loss 0.070532, forward nfe 18316, backward nfe 0, Train: 0.9357, Val: 0.8434, Test: 0.8396, Best time: 40.0000
best val accuracy 0.843382 with test accuracy 0.839594 at epoch 29 and best time 40.000000