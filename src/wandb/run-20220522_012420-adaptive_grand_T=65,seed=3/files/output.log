/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 3.961055, Loss 1.946648, forward nfe 122, backward nfe 0, Train: 0.4643, Val: 0.4140, Test: 0.3949, Best time: 3.8841
Epoch: 002/100, Runtime 3.814021, Loss 1.832983, forward nfe 600, backward nfe 0, Train: 0.7071, Val: 0.7110, Test: 0.7025, Best time: 13.5314
Epoch: 003/100, Runtime 3.705639, Loss 1.600749, forward nfe 1072, backward nfe 0, Train: 0.7714, Val: 0.7206, Test: 0.7198, Best time: 7.7289
Epoch: 004/100, Runtime 3.685154, Loss 1.309323, forward nfe 1538, backward nfe 0, Train: 0.7643, Val: 0.7272, Test: 0.7269, Best time: 18.4381
Epoch: 005/100, Runtime 3.515244, Loss 1.019802, forward nfe 1992, backward nfe 0, Train: 0.8429, Val: 0.8125, Test: 0.7980, Best time: 36.5494
Epoch: 006/100, Runtime 3.450521, Loss 0.818846, forward nfe 2434, backward nfe 0, Train: 0.8429, Val: 0.8125, Test: 0.7980, Best time: 65.0000
Epoch: 007/100, Runtime 3.372327, Loss 0.639574, forward nfe 2870, backward nfe 0, Train: 0.8429, Val: 0.8125, Test: 0.7980, Best time: 65.0000
Epoch: 008/100, Runtime 3.352662, Loss 0.545512, forward nfe 3294, backward nfe 0, Train: 0.8929, Val: 0.8140, Test: 0.8030, Best time: 28.9921
Epoch: 009/100, Runtime 3.233409, Loss 0.490010, forward nfe 3706, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 30.5519
Epoch: 010/100, Runtime 3.057201, Loss 0.471604, forward nfe 4100, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 011/100, Runtime 3.049028, Loss 0.467194, forward nfe 4482, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 012/100, Runtime 2.932542, Loss 0.407455, forward nfe 4858, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 013/100, Runtime 2.950628, Loss 0.463846, forward nfe 5222, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 014/100, Runtime 2.908332, Loss 0.424000, forward nfe 5592, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 015/100, Runtime 2.948124, Loss 0.394067, forward nfe 5962, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 016/100, Runtime 2.729122, Loss 0.433663, forward nfe 6320, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 017/100, Runtime 2.734706, Loss 0.373837, forward nfe 6666, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 018/100, Runtime 2.718517, Loss 0.421508, forward nfe 7012, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 019/100, Runtime 2.633816, Loss 0.319312, forward nfe 7340, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 020/100, Runtime 2.571898, Loss 0.412222, forward nfe 7662, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 021/100, Runtime 2.524488, Loss 0.332530, forward nfe 7978, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 022/100, Runtime 2.494114, Loss 0.258579, forward nfe 8294, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 023/100, Runtime 2.474237, Loss 0.332504, forward nfe 8604, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 024/100, Runtime 2.533661, Loss 0.219773, forward nfe 8914, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 025/100, Runtime 2.450634, Loss 0.268964, forward nfe 9218, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 026/100, Runtime 2.493736, Loss 0.289551, forward nfe 9522, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 027/100, Runtime 2.489823, Loss 0.312609, forward nfe 9826, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 028/100, Runtime 2.377957, Loss 0.242802, forward nfe 10130, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 029/100, Runtime 2.370803, Loss 0.283723, forward nfe 10422, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 030/100, Runtime 2.432198, Loss 0.295541, forward nfe 10720, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 031/100, Runtime 2.402342, Loss 0.213515, forward nfe 11012, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 032/100, Runtime 2.542245, Loss 0.220266, forward nfe 11304, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 033/100, Runtime 2.780072, Loss 0.256709, forward nfe 11584, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 034/100, Runtime 2.911040, Loss 0.245371, forward nfe 11858, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 035/100, Runtime 2.849616, Loss 0.208222, forward nfe 12132, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 036/100, Runtime 2.745862, Loss 0.221066, forward nfe 12400, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 037/100, Runtime 3.034226, Loss 0.231187, forward nfe 12674, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 038/100, Runtime 3.072845, Loss 0.210286, forward nfe 12942, backward nfe 0, Train: 0.9071, Val: 0.8309, Test: 0.8132, Best time: 65.0000
Epoch: 039/100, Runtime 3.104405, Loss 0.219476, forward nfe 13216, backward nfe 0, Train: 0.9571, Val: 0.8419, Test: 0.8365, Best time: 109.5658
Epoch: 040/100, Runtime 3.200837, Loss 0.153124, forward nfe 13490, backward nfe 0, Train: 0.9571, Val: 0.8419, Test: 0.8365, Best time: 65.0000
Epoch: 041/100, Runtime 3.063707, Loss 0.170457, forward nfe 13764, backward nfe 0, Train: 0.9571, Val: 0.8419, Test: 0.8365, Best time: 65.0000
Epoch: 042/100, Runtime 2.121872, Loss 0.208517, forward nfe 14038, backward nfe 0, Train: 0.9571, Val: 0.8419, Test: 0.8365, Best time: 65.0000
Epoch: 043/100, Runtime 2.102815, Loss 0.193789, forward nfe 14312, backward nfe 0, Train: 0.9571, Val: 0.8419, Test: 0.8365, Best time: 65.0000
Epoch: 044/100, Runtime 2.120686, Loss 0.168288, forward nfe 14580, backward nfe 0, Train: 0.9571, Val: 0.8419, Test: 0.8365, Best time: 65.0000
Epoch: 045/100, Runtime 2.087548, Loss 0.142563, forward nfe 14848, backward nfe 0, Train: 0.9571, Val: 0.8419, Test: 0.8365, Best time: 65.0000
Epoch: 046/100, Runtime 2.248662, Loss 0.215407, forward nfe 15110, backward nfe 0, Train: 0.9571, Val: 0.8419, Test: 0.8365, Best time: 65.0000
Epoch: 047/100, Runtime 2.130815, Loss 0.188292, forward nfe 15372, backward nfe 0, Train: 0.9571, Val: 0.8419, Test: 0.8365, Best time: 65.0000
Epoch: 048/100, Runtime 2.134111, Loss 0.148820, forward nfe 15634, backward nfe 0, Train: 0.9571, Val: 0.8419, Test: 0.8365, Best time: 65.0000
Epoch: 049/100, Runtime 2.073488, Loss 0.193554, forward nfe 15896, backward nfe 0, Train: 0.9571, Val: 0.8419, Test: 0.8365, Best time: 65.0000
Epoch: 050/100, Runtime 2.102506, Loss 0.136684, forward nfe 16158, backward nfe 0, Train: 0.9571, Val: 0.8419, Test: 0.8365, Best time: 65.0000
Epoch: 051/100, Runtime 2.164451, Loss 0.158364, forward nfe 16414, backward nfe 0, Train: 0.9571, Val: 0.8419, Test: 0.8365, Best time: 65.0000
Epoch: 052/100, Runtime 2.173861, Loss 0.170623, forward nfe 16676, backward nfe 0, Train: 0.9571, Val: 0.8419, Test: 0.8365, Best time: 65.0000
Epoch: 053/100, Runtime 2.181818, Loss 0.166502, forward nfe 16938, backward nfe 0, Train: 0.9571, Val: 0.8419, Test: 0.8365, Best time: 65.0000
Epoch: 054/100, Runtime 2.160854, Loss 0.111689, forward nfe 17194, backward nfe 0, Train: 0.9857, Val: 0.8449, Test: 0.8335, Best time: 76.3743
Epoch: 055/100, Runtime 1.988266, Loss 0.140528, forward nfe 17450, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 159.6817
Epoch: 056/100, Runtime 2.065119, Loss 0.106659, forward nfe 17694, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 057/100, Runtime 1.977487, Loss 0.153917, forward nfe 17938, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 058/100, Runtime 2.075862, Loss 0.115703, forward nfe 18182, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 059/100, Runtime 1.983052, Loss 0.097711, forward nfe 18426, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 060/100, Runtime 2.007907, Loss 0.090244, forward nfe 18670, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 061/100, Runtime 1.986011, Loss 0.145867, forward nfe 18908, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 062/100, Runtime 1.948437, Loss 0.085301, forward nfe 19146, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 063/100, Runtime 1.832692, Loss 0.148786, forward nfe 19384, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 064/100, Runtime 1.965020, Loss 0.141379, forward nfe 19622, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 065/100, Runtime 1.840954, Loss 0.069598, forward nfe 19854, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 066/100, Runtime 1.948948, Loss 0.126005, forward nfe 20080, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 067/100, Runtime 1.791986, Loss 0.159878, forward nfe 20306, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 068/100, Runtime 1.788838, Loss 0.070312, forward nfe 20526, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 069/100, Runtime 1.834183, Loss 0.077426, forward nfe 20746, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 070/100, Runtime 1.789419, Loss 0.087751, forward nfe 20966, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 071/100, Runtime 1.737892, Loss 0.059280, forward nfe 21180, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 072/100, Runtime 1.778994, Loss 0.068178, forward nfe 21394, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 073/100, Runtime 1.806253, Loss 0.037124, forward nfe 21608, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 074/100, Runtime 1.610644, Loss 0.070203, forward nfe 21822, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 075/100, Runtime 2.294580, Loss 0.078902, forward nfe 22036, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 076/100, Runtime 2.333360, Loss 0.044289, forward nfe 22250, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 077/100, Runtime 2.306993, Loss 0.030101, forward nfe 22464, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 078/100, Runtime 2.434837, Loss 0.029006, forward nfe 22672, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 079/100, Runtime 2.330769, Loss 0.050867, forward nfe 22880, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 080/100, Runtime 2.312969, Loss 0.046361, forward nfe 23082, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 081/100, Runtime 2.198438, Loss 0.093056, forward nfe 23284, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 082/100, Runtime 2.117360, Loss 0.033509, forward nfe 23486, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 083/100, Runtime 2.109522, Loss 0.053287, forward nfe 23688, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 084/100, Runtime 2.094802, Loss 0.055176, forward nfe 23890, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 085/100, Runtime 1.997969, Loss 0.093123, forward nfe 24092, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 086/100, Runtime 2.064221, Loss 0.054970, forward nfe 24294, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 087/100, Runtime 2.020581, Loss 0.094825, forward nfe 24496, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 088/100, Runtime 2.174794, Loss 0.031704, forward nfe 24698, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 089/100, Runtime 2.003780, Loss 0.056978, forward nfe 24900, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 090/100, Runtime 1.644200, Loss 0.053663, forward nfe 25102, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 091/100, Runtime 1.707439, Loss 0.051310, forward nfe 25304, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 092/100, Runtime 1.780029, Loss 0.050266, forward nfe 25512, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 093/100, Runtime 1.708942, Loss 0.054292, forward nfe 25720, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 094/100, Runtime 1.729000, Loss 0.111357, forward nfe 25928, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 095/100, Runtime 1.733838, Loss 0.077170, forward nfe 26136, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 096/100, Runtime 1.643201, Loss 0.080686, forward nfe 26338, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 097/100, Runtime 1.590813, Loss 0.036226, forward nfe 26540, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 098/100, Runtime 1.464047, Loss 0.043997, forward nfe 26742, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
Epoch: 099/100, Runtime 1.443394, Loss 0.064826, forward nfe 26932, backward nfe 0, Train: 0.9643, Val: 0.8500, Test: 0.8284, Best time: 65.0000
best val accuracy 0.850000 with test accuracy 0.828426 at epoch 55 and best time 65.000000