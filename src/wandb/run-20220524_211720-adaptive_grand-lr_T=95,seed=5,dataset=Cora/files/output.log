/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.821464, Loss 1.948294, forward nfe 176, backward nfe 0, Train: 0.1357, Val: 0.1074, Test: 0.1157, Best time: 286.2777
Epoch: 002/100, Runtime 0.763356, Loss 2.020730, forward nfe 864, backward nfe 0, Train: 0.1357, Val: 0.1074, Test: 0.1157, Best time: 95.0000
Epoch: 003/100, Runtime 0.745856, Loss 1.969464, forward nfe 1546, backward nfe 0, Train: 0.1357, Val: 0.1074, Test: 0.1157, Best time: 95.0000
Epoch: 004/100, Runtime 0.755152, Loss 1.916643, forward nfe 2228, backward nfe 0, Train: 0.1357, Val: 0.1074, Test: 0.1157, Best time: 95.0000
Epoch: 005/100, Runtime 0.711591, Loss 1.876449, forward nfe 2898, backward nfe 0, Train: 0.3357, Val: 0.2515, Test: 0.2599, Best time: 2.1228
Epoch: 006/100, Runtime 0.684715, Loss 1.805616, forward nfe 3550, backward nfe 0, Train: 0.5000, Val: 0.3919, Test: 0.3706, Best time: 3.5638
Epoch: 007/100, Runtime 0.708823, Loss 1.706210, forward nfe 4190, backward nfe 0, Train: 0.6000, Val: 0.4890, Test: 0.4690, Best time: 5.3642
Epoch: 008/100, Runtime 0.673690, Loss 1.581513, forward nfe 4818, backward nfe 0, Train: 0.6857, Val: 0.6081, Test: 0.5868, Best time: 13.2237
Epoch: 009/100, Runtime 0.640305, Loss 1.414016, forward nfe 5416, backward nfe 0, Train: 0.7500, Val: 0.6824, Test: 0.6599, Best time: 23.5749
Epoch: 010/100, Runtime 0.615535, Loss 1.215818, forward nfe 6002, backward nfe 0, Train: 0.7714, Val: 0.7162, Test: 0.7157, Best time: 18.8701
Epoch: 011/100, Runtime 0.584672, Loss 1.057836, forward nfe 6570, backward nfe 0, Train: 0.7714, Val: 0.7360, Test: 0.7401, Best time: 15.0937
Epoch: 012/100, Runtime 0.616405, Loss 0.914165, forward nfe 7120, backward nfe 0, Train: 0.7714, Val: 0.7684, Test: 0.7848, Best time: 11.9649
Epoch: 013/100, Runtime 0.602649, Loss 0.794724, forward nfe 7670, backward nfe 0, Train: 0.7786, Val: 0.8037, Test: 0.7949, Best time: 16.5038
Epoch: 014/100, Runtime 0.579208, Loss 0.737518, forward nfe 8208, backward nfe 0, Train: 0.7786, Val: 0.8037, Test: 0.7949, Best time: 95.0000
Epoch: 015/100, Runtime 0.578007, Loss 0.699622, forward nfe 8734, backward nfe 0, Train: 0.7786, Val: 0.8037, Test: 0.7949, Best time: 95.0000
Epoch: 016/100, Runtime 0.560592, Loss 0.632914, forward nfe 9248, backward nfe 0, Train: 0.7786, Val: 0.8037, Test: 0.7949, Best time: 95.0000
Epoch: 017/100, Runtime 0.570750, Loss 0.610456, forward nfe 9756, backward nfe 0, Train: 0.8429, Val: 0.8191, Test: 0.8122, Best time: 50.5135
Epoch: 018/100, Runtime 0.514150, Loss 0.574442, forward nfe 10240, backward nfe 0, Train: 0.8429, Val: 0.8191, Test: 0.8122, Best time: 95.0000
Epoch: 019/100, Runtime 0.499677, Loss 0.502282, forward nfe 10712, backward nfe 0, Train: 0.8429, Val: 0.8191, Test: 0.8122, Best time: 95.0000
Epoch: 020/100, Runtime 0.490515, Loss 0.500770, forward nfe 11166, backward nfe 0, Train: 0.8429, Val: 0.8191, Test: 0.8122, Best time: 95.0000
Epoch: 021/100, Runtime 0.495650, Loss 0.487433, forward nfe 11608, backward nfe 0, Train: 0.8929, Val: 0.8368, Test: 0.8193, Best time: 66.4553
Epoch: 022/100, Runtime 0.542137, Loss 0.481221, forward nfe 12050, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 68.6726
Epoch: 023/100, Runtime 0.476190, Loss 0.450009, forward nfe 12486, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 024/100, Runtime 0.457083, Loss 0.397532, forward nfe 12910, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 025/100, Runtime 0.457751, Loss 0.452071, forward nfe 13322, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 026/100, Runtime 0.452076, Loss 0.419899, forward nfe 13734, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 027/100, Runtime 0.459300, Loss 0.447598, forward nfe 14134, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 028/100, Runtime 0.429692, Loss 0.427781, forward nfe 14516, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 029/100, Runtime 0.433069, Loss 0.445316, forward nfe 14892, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 030/100, Runtime 0.420751, Loss 0.406965, forward nfe 15268, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 031/100, Runtime 0.406609, Loss 0.439070, forward nfe 15644, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 032/100, Runtime 0.419204, Loss 0.370385, forward nfe 16020, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 033/100, Runtime 0.421439, Loss 0.338874, forward nfe 16396, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 034/100, Runtime 0.401477, Loss 0.382530, forward nfe 16766, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 035/100, Runtime 0.403355, Loss 0.303790, forward nfe 17130, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 036/100, Runtime 0.392995, Loss 0.298656, forward nfe 17494, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 037/100, Runtime 0.396866, Loss 0.314254, forward nfe 17846, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 038/100, Runtime 0.382777, Loss 0.247142, forward nfe 18198, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 039/100, Runtime 0.385512, Loss 0.315938, forward nfe 18544, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 040/100, Runtime 0.394520, Loss 0.314861, forward nfe 18890, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 041/100, Runtime 0.378922, Loss 0.262011, forward nfe 19230, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 042/100, Runtime 0.382603, Loss 0.258281, forward nfe 19570, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 043/100, Runtime 0.372096, Loss 0.248583, forward nfe 19910, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 044/100, Runtime 0.373165, Loss 0.255217, forward nfe 20244, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 045/100, Runtime 0.381234, Loss 0.229610, forward nfe 20578, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 046/100, Runtime 0.380395, Loss 0.221684, forward nfe 20912, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 047/100, Runtime 0.383770, Loss 0.235421, forward nfe 21240, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 048/100, Runtime 0.374602, Loss 0.177714, forward nfe 21568, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 049/100, Runtime 0.358073, Loss 0.208368, forward nfe 21896, backward nfe 0, Train: 0.8786, Val: 0.8390, Test: 0.8264, Best time: 95.0000
Epoch: 050/100, Runtime 0.362811, Loss 0.250433, forward nfe 22212, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 83.5437
Epoch: 051/100, Runtime 0.370358, Loss 0.254269, forward nfe 22528, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 052/100, Runtime 0.361892, Loss 0.170654, forward nfe 22844, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 053/100, Runtime 0.358291, Loss 0.193684, forward nfe 23160, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 054/100, Runtime 0.352028, Loss 0.226731, forward nfe 23476, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 055/100, Runtime 0.360267, Loss 0.197473, forward nfe 23792, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 056/100, Runtime 0.363081, Loss 0.233325, forward nfe 24108, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 057/100, Runtime 0.374999, Loss 0.174755, forward nfe 24424, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 058/100, Runtime 0.373288, Loss 0.173659, forward nfe 24740, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 059/100, Runtime 0.361144, Loss 0.133949, forward nfe 25056, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 060/100, Runtime 0.359278, Loss 0.134641, forward nfe 25372, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 061/100, Runtime 0.362736, Loss 0.141460, forward nfe 25694, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 062/100, Runtime 0.359104, Loss 0.097091, forward nfe 26010, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 063/100, Runtime 0.355807, Loss 0.198761, forward nfe 26326, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 064/100, Runtime 0.398440, Loss 0.120363, forward nfe 26648, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 065/100, Runtime 0.355169, Loss 0.167054, forward nfe 26970, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 066/100, Runtime 0.348991, Loss 0.144494, forward nfe 27292, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 067/100, Runtime 0.350713, Loss 0.107258, forward nfe 27614, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 068/100, Runtime 0.357502, Loss 0.107115, forward nfe 27936, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 069/100, Runtime 0.357182, Loss 0.109811, forward nfe 28252, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 070/100, Runtime 0.351881, Loss 0.110288, forward nfe 28568, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 071/100, Runtime 0.348130, Loss 0.082159, forward nfe 28884, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 072/100, Runtime 0.354254, Loss 0.121097, forward nfe 29194, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 073/100, Runtime 0.340772, Loss 0.104655, forward nfe 29498, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 074/100, Runtime 0.348673, Loss 0.066129, forward nfe 29802, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 075/100, Runtime 0.356293, Loss 0.124986, forward nfe 30106, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 076/100, Runtime 0.346893, Loss 0.086922, forward nfe 30410, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 077/100, Runtime 0.356662, Loss 0.072606, forward nfe 30714, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 078/100, Runtime 0.347027, Loss 0.068500, forward nfe 31018, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 079/100, Runtime 0.331640, Loss 0.060787, forward nfe 31322, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 080/100, Runtime 0.481073, Loss 0.084050, forward nfe 31620, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 081/100, Runtime 0.338742, Loss 0.063238, forward nfe 31918, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 082/100, Runtime 0.339282, Loss 0.058565, forward nfe 32216, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 083/100, Runtime 0.347718, Loss 0.050622, forward nfe 32514, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 084/100, Runtime 0.342955, Loss 0.044815, forward nfe 32806, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 085/100, Runtime 0.317189, Loss 0.067289, forward nfe 33098, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 086/100, Runtime 0.328600, Loss 0.078508, forward nfe 33390, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 087/100, Runtime 0.318533, Loss 0.064165, forward nfe 33676, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 088/100, Runtime 0.318017, Loss 0.041813, forward nfe 33962, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 089/100, Runtime 0.319632, Loss 0.082189, forward nfe 34248, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 090/100, Runtime 0.312970, Loss 0.047772, forward nfe 34534, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 091/100, Runtime 0.317881, Loss 0.041823, forward nfe 34814, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 092/100, Runtime 0.314962, Loss 0.053763, forward nfe 35094, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 093/100, Runtime 0.334935, Loss 0.062308, forward nfe 35374, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 094/100, Runtime 0.324927, Loss 0.035959, forward nfe 35660, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 095/100, Runtime 0.322826, Loss 0.064076, forward nfe 35946, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 096/100, Runtime 0.327200, Loss 0.051930, forward nfe 36226, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 097/100, Runtime 0.325007, Loss 0.069205, forward nfe 36512, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 098/100, Runtime 0.317117, Loss 0.043360, forward nfe 36798, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
Epoch: 099/100, Runtime 0.335605, Loss 0.051906, forward nfe 37078, backward nfe 0, Train: 0.9571, Val: 0.8426, Test: 0.8264, Best time: 95.0000
best val accuracy 0.842647 with test accuracy 0.826396 at epoch 50 and best time 95.000000