/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.680325, Loss 1.792446, forward nfe 164, backward nfe 0, Train: 0.3750, Val: 0.3261, Test: 0.2758, Best time: 0.0408
Epoch: 002/100, Runtime 0.589745, Loss 1.753275, forward nfe 678, backward nfe 0, Train: 0.4667, Val: 0.4522, Test: 0.4113, Best time: 63.1987
Epoch: 003/100, Runtime 0.489472, Loss 1.708142, forward nfe 1198, backward nfe 0, Train: 0.4667, Val: 0.4522, Test: 0.4113, Best time: 55.0000
Epoch: 004/100, Runtime 0.385443, Loss 1.659309, forward nfe 1724, backward nfe 0, Train: 0.6167, Val: 0.5507, Test: 0.4855, Best time: 9.7336
Epoch: 005/100, Runtime 0.439976, Loss 1.582773, forward nfe 2244, backward nfe 0, Train: 0.6750, Val: 0.6493, Test: 0.5871, Best time: 2.8263
Epoch: 006/100, Runtime 0.467261, Loss 1.575343, forward nfe 2752, backward nfe 0, Train: 0.7500, Val: 0.7428, Test: 0.6613, Best time: 8.9616
Epoch: 007/100, Runtime 0.444492, Loss 1.543587, forward nfe 3254, backward nfe 0, Train: 0.7417, Val: 0.7652, Test: 0.6839, Best time: 24.0244
Epoch: 008/100, Runtime 0.443387, Loss 1.461954, forward nfe 3744, backward nfe 0, Train: 0.7417, Val: 0.7652, Test: 0.6839, Best time: 55.0000
Epoch: 009/100, Runtime 0.447742, Loss 1.480846, forward nfe 4216, backward nfe 0, Train: 0.7417, Val: 0.7652, Test: 0.6839, Best time: 55.0000
Epoch: 010/100, Runtime 0.480871, Loss 1.458628, forward nfe 4694, backward nfe 0, Train: 0.7417, Val: 0.7652, Test: 0.6839, Best time: 55.0000
Epoch: 011/100, Runtime 0.451194, Loss 1.460713, forward nfe 5166, backward nfe 0, Train: 0.7417, Val: 0.7652, Test: 0.6839, Best time: 55.0000
Epoch: 012/100, Runtime 0.444237, Loss 1.425502, forward nfe 5632, backward nfe 0, Train: 0.7417, Val: 0.7652, Test: 0.6839, Best time: 55.0000
Epoch: 013/100, Runtime 0.418251, Loss 1.418437, forward nfe 6080, backward nfe 0, Train: 0.7083, Val: 0.7681, Test: 0.7032, Best time: 60.5212
Epoch: 014/100, Runtime 0.409712, Loss 1.318966, forward nfe 6522, backward nfe 0, Train: 0.7083, Val: 0.7681, Test: 0.7032, Best time: 55.0000
Epoch: 015/100, Runtime 0.497311, Loss 1.368255, forward nfe 6976, backward nfe 0, Train: 0.7083, Val: 0.7681, Test: 0.7032, Best time: 55.0000
Epoch: 016/100, Runtime 0.506682, Loss 1.281063, forward nfe 7412, backward nfe 0, Train: 0.7083, Val: 0.7681, Test: 0.7032, Best time: 55.0000
Epoch: 017/100, Runtime 0.488689, Loss 1.253903, forward nfe 7836, backward nfe 0, Train: 0.7083, Val: 0.7681, Test: 0.7032, Best time: 55.0000
Epoch: 018/100, Runtime 0.468553, Loss 1.242416, forward nfe 8254, backward nfe 0, Train: 0.7083, Val: 0.7681, Test: 0.7032, Best time: 55.0000
Epoch: 019/100, Runtime 0.490485, Loss 1.144688, forward nfe 8672, backward nfe 0, Train: 0.7083, Val: 0.7681, Test: 0.7032, Best time: 55.0000
Epoch: 020/100, Runtime 0.509631, Loss 1.210093, forward nfe 9096, backward nfe 0, Train: 0.8167, Val: 0.7732, Test: 0.7065, Best time: 46.3416
Epoch: 021/100, Runtime 0.496494, Loss 1.195795, forward nfe 9514, backward nfe 0, Train: 0.8167, Val: 0.7732, Test: 0.7065, Best time: 55.0000
Epoch: 022/100, Runtime 0.493831, Loss 1.238490, forward nfe 9914, backward nfe 0, Train: 0.8167, Val: 0.7732, Test: 0.7065, Best time: 55.0000
Epoch: 023/100, Runtime 0.475991, Loss 1.160722, forward nfe 10314, backward nfe 0, Train: 0.8167, Val: 0.7732, Test: 0.7065, Best time: 55.0000
Epoch: 024/100, Runtime 0.461430, Loss 1.182381, forward nfe 10702, backward nfe 0, Train: 0.8167, Val: 0.7732, Test: 0.7065, Best time: 55.0000
Epoch: 025/100, Runtime 0.468629, Loss 1.162999, forward nfe 11090, backward nfe 0, Train: 0.8167, Val: 0.7732, Test: 0.7065, Best time: 55.0000
Epoch: 026/100, Runtime 0.445267, Loss 1.080119, forward nfe 11472, backward nfe 0, Train: 0.8333, Val: 0.7819, Test: 0.7258, Best time: 39.1583
Epoch: 027/100, Runtime 0.436443, Loss 1.139710, forward nfe 11848, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 67.5282
Epoch: 028/100, Runtime 0.428268, Loss 1.269583, forward nfe 12218, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 029/100, Runtime 0.438310, Loss 1.232478, forward nfe 12582, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 030/100, Runtime 0.426507, Loss 1.164451, forward nfe 12946, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 031/100, Runtime 0.414284, Loss 1.155696, forward nfe 13292, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 032/100, Runtime 0.412198, Loss 1.138417, forward nfe 13638, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 033/100, Runtime 0.403625, Loss 1.131423, forward nfe 13984, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 034/100, Runtime 0.403741, Loss 1.135099, forward nfe 14324, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 035/100, Runtime 0.388179, Loss 1.159192, forward nfe 14658, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 036/100, Runtime 0.398104, Loss 1.130335, forward nfe 14986, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 037/100, Runtime 0.381519, Loss 1.044498, forward nfe 15314, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 038/100, Runtime 0.378244, Loss 1.162725, forward nfe 15630, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 039/100, Runtime 0.381372, Loss 1.112059, forward nfe 15946, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 040/100, Runtime 0.386566, Loss 1.083453, forward nfe 16268, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 041/100, Runtime 0.384596, Loss 1.118257, forward nfe 16584, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 042/100, Runtime 0.405426, Loss 1.068677, forward nfe 16894, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 043/100, Runtime 0.353511, Loss 1.147284, forward nfe 17204, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 044/100, Runtime 0.348772, Loss 1.089949, forward nfe 17502, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 045/100, Runtime 0.367473, Loss 1.162188, forward nfe 17800, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 046/100, Runtime 0.357132, Loss 1.094512, forward nfe 18098, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 047/100, Runtime 0.347981, Loss 1.119498, forward nfe 18390, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 048/100, Runtime 0.342332, Loss 1.091711, forward nfe 18682, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 049/100, Runtime 0.352973, Loss 1.149413, forward nfe 18974, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 050/100, Runtime 0.342265, Loss 1.279831, forward nfe 19266, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 051/100, Runtime 0.346444, Loss 1.104723, forward nfe 19546, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 052/100, Runtime 0.354958, Loss 1.076757, forward nfe 19826, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 053/100, Runtime 0.331304, Loss 1.027310, forward nfe 20106, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 054/100, Runtime 0.356195, Loss 1.074053, forward nfe 20380, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 055/100, Runtime 0.329774, Loss 1.032375, forward nfe 20648, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 056/100, Runtime 0.331411, Loss 0.974229, forward nfe 20916, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 057/100, Runtime 0.350946, Loss 1.066219, forward nfe 21184, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 058/100, Runtime 0.334170, Loss 1.165099, forward nfe 21452, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 059/100, Runtime 0.326964, Loss 1.148420, forward nfe 21726, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 060/100, Runtime 0.337405, Loss 1.072744, forward nfe 22000, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 061/100, Runtime 0.475358, Loss 1.032569, forward nfe 22280, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 062/100, Runtime 0.337927, Loss 0.967251, forward nfe 22554, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 063/100, Runtime 0.351543, Loss 1.011329, forward nfe 22828, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 064/100, Runtime 0.359223, Loss 1.128412, forward nfe 23102, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 065/100, Runtime 0.342604, Loss 1.040150, forward nfe 23376, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 066/100, Runtime 0.339420, Loss 1.068625, forward nfe 23650, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 067/100, Runtime 0.344450, Loss 1.005391, forward nfe 23924, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 068/100, Runtime 0.344730, Loss 1.017365, forward nfe 24198, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 069/100, Runtime 0.367568, Loss 1.031169, forward nfe 24472, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 070/100, Runtime 0.341016, Loss 1.103328, forward nfe 24746, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 071/100, Runtime 0.342014, Loss 1.002010, forward nfe 25020, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 072/100, Runtime 0.341934, Loss 0.914619, forward nfe 25300, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 073/100, Runtime 0.347899, Loss 1.072151, forward nfe 25580, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 074/100, Runtime 0.354561, Loss 1.021546, forward nfe 25860, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 075/100, Runtime 0.350241, Loss 1.057039, forward nfe 26140, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 076/100, Runtime 0.340206, Loss 1.028579, forward nfe 26420, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 077/100, Runtime 0.341659, Loss 1.068438, forward nfe 26700, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 078/100, Runtime 0.337989, Loss 1.088741, forward nfe 26980, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 079/100, Runtime 0.347420, Loss 1.079284, forward nfe 27260, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 080/100, Runtime 0.348278, Loss 1.100594, forward nfe 27540, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 081/100, Runtime 0.341430, Loss 1.066748, forward nfe 27820, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 082/100, Runtime 0.343490, Loss 1.011031, forward nfe 28100, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 083/100, Runtime 0.349237, Loss 0.983402, forward nfe 28374, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 084/100, Runtime 0.345773, Loss 1.143113, forward nfe 28642, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 085/100, Runtime 0.356522, Loss 1.037526, forward nfe 28910, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 086/100, Runtime 0.349312, Loss 0.912357, forward nfe 29184, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 087/100, Runtime 0.334596, Loss 0.971356, forward nfe 29458, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 088/100, Runtime 0.333558, Loss 1.049790, forward nfe 29726, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 089/100, Runtime 0.332818, Loss 0.914219, forward nfe 29994, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 090/100, Runtime 0.333470, Loss 0.922188, forward nfe 30268, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 091/100, Runtime 0.338963, Loss 1.081880, forward nfe 30542, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 092/100, Runtime 0.327476, Loss 1.031102, forward nfe 30810, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 093/100, Runtime 0.337739, Loss 1.007397, forward nfe 31078, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 094/100, Runtime 0.330000, Loss 1.082080, forward nfe 31346, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 095/100, Runtime 0.329499, Loss 0.989890, forward nfe 31614, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 096/100, Runtime 0.330504, Loss 1.015484, forward nfe 31882, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 097/100, Runtime 0.335576, Loss 1.071633, forward nfe 32150, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 098/100, Runtime 0.331472, Loss 1.023146, forward nfe 32418, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
Epoch: 099/100, Runtime 0.339141, Loss 1.009757, forward nfe 32686, backward nfe 0, Train: 0.8000, Val: 0.7848, Test: 0.7177, Best time: 55.0000
best val accuracy 0.784783 with test accuracy 0.717742 at epoch 27 and best time 55.000000