/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.888808, Loss 1.793531, forward nfe 212, backward nfe 0, Train: 0.2750, Val: 0.2819, Test: 0.2387, Best time: 0.0413
Epoch: 002/100, Runtime 0.787707, Loss 1.791211, forward nfe 888, backward nfe 0, Train: 0.3750, Val: 0.4123, Test: 0.3758, Best time: 2.7397
Epoch: 003/100, Runtime 0.785418, Loss 1.777321, forward nfe 1588, backward nfe 0, Train: 0.3750, Val: 0.4123, Test: 0.3758, Best time: 80.0000
Epoch: 004/100, Runtime 0.788778, Loss 1.759960, forward nfe 2276, backward nfe 0, Train: 0.4917, Val: 0.5696, Test: 0.5758, Best time: 242.7654
Epoch: 005/100, Runtime 0.762527, Loss 1.719426, forward nfe 2958, backward nfe 0, Train: 0.4917, Val: 0.5696, Test: 0.5758, Best time: 80.0000
Epoch: 006/100, Runtime 0.755398, Loss 1.689020, forward nfe 3622, backward nfe 0, Train: 0.4917, Val: 0.5696, Test: 0.5758, Best time: 80.0000
Epoch: 007/100, Runtime 0.737184, Loss 1.663288, forward nfe 4274, backward nfe 0, Train: 0.4917, Val: 0.5696, Test: 0.5758, Best time: 80.0000
Epoch: 008/100, Runtime 0.714204, Loss 1.642307, forward nfe 4920, backward nfe 0, Train: 0.6083, Val: 0.6572, Test: 0.6597, Best time: 80.0000
Epoch: 009/100, Runtime 0.712461, Loss 1.625586, forward nfe 5554, backward nfe 0, Train: 0.6083, Val: 0.6572, Test: 0.6597, Best time: 80.0000
Epoch: 010/100, Runtime 0.696262, Loss 1.567382, forward nfe 6170, backward nfe 0, Train: 0.6083, Val: 0.6572, Test: 0.6597, Best time: 80.0000
Epoch: 011/100, Runtime 0.669835, Loss 1.536980, forward nfe 6786, backward nfe 0, Train: 0.6417, Val: 0.7029, Test: 0.7032, Best time: 219.6687
Epoch: 012/100, Runtime 0.674616, Loss 1.531816, forward nfe 7396, backward nfe 0, Train: 0.6417, Val: 0.7029, Test: 0.7032, Best time: 80.0000
Epoch: 013/100, Runtime 0.651306, Loss 1.536418, forward nfe 7988, backward nfe 0, Train: 0.6417, Val: 0.7029, Test: 0.7032, Best time: 80.0000
Epoch: 014/100, Runtime 0.640629, Loss 1.443315, forward nfe 8568, backward nfe 0, Train: 0.6417, Val: 0.7029, Test: 0.7032, Best time: 80.0000
Epoch: 015/100, Runtime 0.648166, Loss 1.416717, forward nfe 9148, backward nfe 0, Train: 0.6417, Val: 0.7029, Test: 0.7032, Best time: 80.0000
Epoch: 016/100, Runtime 0.639495, Loss 1.412709, forward nfe 9722, backward nfe 0, Train: 0.6667, Val: 0.7130, Test: 0.7097, Best time: 28.2023
Epoch: 017/100, Runtime 0.639903, Loss 1.387409, forward nfe 10284, backward nfe 0, Train: 0.7000, Val: 0.7196, Test: 0.7177, Best time: 35.4198
Epoch: 018/100, Runtime 0.639046, Loss 1.347124, forward nfe 10828, backward nfe 0, Train: 0.7000, Val: 0.7196, Test: 0.7177, Best time: 80.0000
Epoch: 019/100, Runtime 0.647159, Loss 1.335119, forward nfe 11384, backward nfe 0, Train: 0.7000, Val: 0.7196, Test: 0.7177, Best time: 80.0000
Epoch: 020/100, Runtime 0.615343, Loss 1.327290, forward nfe 11928, backward nfe 0, Train: 0.7000, Val: 0.7196, Test: 0.7177, Best time: 80.0000
Epoch: 021/100, Runtime 0.596220, Loss 1.341273, forward nfe 12472, backward nfe 0, Train: 0.6833, Val: 0.7275, Test: 0.7452, Best time: 83.4442
Epoch: 022/100, Runtime 0.594042, Loss 1.303324, forward nfe 12998, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 49.2826
Epoch: 023/100, Runtime 0.585936, Loss 1.369699, forward nfe 13512, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 024/100, Runtime 0.578473, Loss 1.298135, forward nfe 14026, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 025/100, Runtime 0.572806, Loss 1.345389, forward nfe 14528, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 026/100, Runtime 0.564978, Loss 1.262157, forward nfe 15036, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 027/100, Runtime 0.564810, Loss 1.306894, forward nfe 15520, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 028/100, Runtime 0.549900, Loss 1.300880, forward nfe 15998, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 029/100, Runtime 0.550603, Loss 1.307685, forward nfe 16470, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 030/100, Runtime 0.530320, Loss 1.311171, forward nfe 16942, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 031/100, Runtime 0.509150, Loss 1.357409, forward nfe 17408, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 032/100, Runtime 0.509902, Loss 1.283562, forward nfe 17856, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 033/100, Runtime 0.523120, Loss 1.352234, forward nfe 18304, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 034/100, Runtime 0.527559, Loss 1.261609, forward nfe 18746, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 035/100, Runtime 0.495268, Loss 1.309429, forward nfe 19176, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 036/100, Runtime 0.490986, Loss 1.286439, forward nfe 19600, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 037/100, Runtime 0.505794, Loss 1.263268, forward nfe 20024, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 038/100, Runtime 0.492224, Loss 1.313274, forward nfe 20448, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 039/100, Runtime 0.479738, Loss 1.439000, forward nfe 20866, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 040/100, Runtime 0.463919, Loss 1.299569, forward nfe 21266, backward nfe 0, Train: 0.7167, Val: 0.7290, Test: 0.7548, Best time: 80.0000
Epoch: 041/100, Runtime 0.480222, Loss 1.380805, forward nfe 21672, backward nfe 0, Train: 0.7417, Val: 0.7297, Test: 0.7500, Best time: 98.0193
Epoch: 042/100, Runtime 0.452859, Loss 1.243862, forward nfe 22072, backward nfe 0, Train: 0.7417, Val: 0.7297, Test: 0.7500, Best time: 80.0000
Epoch: 043/100, Runtime 0.457096, Loss 1.267334, forward nfe 22466, backward nfe 0, Train: 0.7417, Val: 0.7297, Test: 0.7500, Best time: 80.0000
Epoch: 044/100, Runtime 0.451996, Loss 1.168626, forward nfe 22854, backward nfe 0, Train: 0.7250, Val: 0.7312, Test: 0.7419, Best time: 87.8235
Epoch: 045/100, Runtime 0.458948, Loss 1.251456, forward nfe 23236, backward nfe 0, Train: 0.7250, Val: 0.7312, Test: 0.7419, Best time: 80.0000
Epoch: 046/100, Runtime 0.447726, Loss 1.292624, forward nfe 23618, backward nfe 0, Train: 0.7250, Val: 0.7312, Test: 0.7419, Best time: 80.0000
Epoch: 047/100, Runtime 0.580647, Loss 1.219639, forward nfe 23988, backward nfe 0, Train: 0.7250, Val: 0.7312, Test: 0.7419, Best time: 80.0000
Epoch: 048/100, Runtime 0.420348, Loss 1.286164, forward nfe 24358, backward nfe 0, Train: 0.7250, Val: 0.7312, Test: 0.7419, Best time: 80.0000
Epoch: 049/100, Runtime 0.423624, Loss 1.255028, forward nfe 24716, backward nfe 0, Train: 0.7667, Val: 0.7420, Test: 0.7726, Best time: 20.6489
Epoch: 050/100, Runtime 0.429909, Loss 1.280630, forward nfe 25074, backward nfe 0, Train: 0.7667, Val: 0.7420, Test: 0.7726, Best time: 80.0000
Epoch: 051/100, Runtime 0.418548, Loss 1.264765, forward nfe 25438, backward nfe 0, Train: 0.7667, Val: 0.7420, Test: 0.7726, Best time: 80.0000
Epoch: 052/100, Runtime 0.405494, Loss 1.233262, forward nfe 25790, backward nfe 0, Train: 0.7667, Val: 0.7420, Test: 0.7726, Best time: 80.0000
Epoch: 053/100, Runtime 0.412275, Loss 1.237528, forward nfe 26148, backward nfe 0, Train: 0.7667, Val: 0.7420, Test: 0.7726, Best time: 80.0000
Epoch: 054/100, Runtime 0.406383, Loss 1.165207, forward nfe 26488, backward nfe 0, Train: 0.7667, Val: 0.7420, Test: 0.7726, Best time: 80.0000
Epoch: 055/100, Runtime 0.409172, Loss 1.256794, forward nfe 26822, backward nfe 0, Train: 0.7667, Val: 0.7420, Test: 0.7726, Best time: 80.0000
Epoch: 056/100, Runtime 0.396608, Loss 1.221398, forward nfe 27156, backward nfe 0, Train: 0.7667, Val: 0.7420, Test: 0.7726, Best time: 80.0000
Epoch: 057/100, Runtime 0.390087, Loss 1.252637, forward nfe 27484, backward nfe 0, Train: 0.7667, Val: 0.7420, Test: 0.7726, Best time: 80.0000
Epoch: 058/100, Runtime 0.385937, Loss 1.347343, forward nfe 27812, backward nfe 0, Train: 0.7667, Val: 0.7420, Test: 0.7726, Best time: 80.0000
Epoch: 059/100, Runtime 0.388330, Loss 1.265078, forward nfe 28140, backward nfe 0, Train: 0.7667, Val: 0.7420, Test: 0.7726, Best time: 80.0000
Epoch: 060/100, Runtime 0.402773, Loss 1.225977, forward nfe 28468, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 52.2921
Epoch: 061/100, Runtime 0.410651, Loss 1.301944, forward nfe 28796, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 062/100, Runtime 0.393346, Loss 1.247366, forward nfe 29124, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 063/100, Runtime 0.388009, Loss 1.161257, forward nfe 29446, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 064/100, Runtime 0.382536, Loss 1.274197, forward nfe 29768, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 065/100, Runtime 0.396037, Loss 1.223853, forward nfe 30090, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 066/100, Runtime 0.391119, Loss 1.163099, forward nfe 30412, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 067/100, Runtime 0.390364, Loss 1.303297, forward nfe 30740, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 068/100, Runtime 0.402154, Loss 1.195997, forward nfe 31056, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 069/100, Runtime 0.401243, Loss 1.256491, forward nfe 31384, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 070/100, Runtime 0.394661, Loss 1.284290, forward nfe 31712, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 071/100, Runtime 0.401493, Loss 1.269178, forward nfe 32034, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 072/100, Runtime 0.382865, Loss 1.237065, forward nfe 32356, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 073/100, Runtime 0.382661, Loss 1.319186, forward nfe 32672, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 074/100, Runtime 0.380059, Loss 1.161165, forward nfe 32988, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 075/100, Runtime 0.385043, Loss 1.135923, forward nfe 33304, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 076/100, Runtime 0.380226, Loss 1.245751, forward nfe 33620, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 077/100, Runtime 0.392437, Loss 1.188115, forward nfe 33936, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 078/100, Runtime 0.374825, Loss 1.269714, forward nfe 34252, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 079/100, Runtime 0.382921, Loss 1.285398, forward nfe 34574, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 080/100, Runtime 0.384923, Loss 1.220135, forward nfe 34896, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 081/100, Runtime 0.387552, Loss 1.252032, forward nfe 35218, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 082/100, Runtime 0.383866, Loss 1.174349, forward nfe 35540, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 083/100, Runtime 0.396249, Loss 1.296319, forward nfe 35856, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 084/100, Runtime 0.381869, Loss 1.236128, forward nfe 36166, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 085/100, Runtime 0.387995, Loss 1.206650, forward nfe 36476, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 086/100, Runtime 0.367708, Loss 1.212599, forward nfe 36786, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 087/100, Runtime 0.386928, Loss 1.302362, forward nfe 37102, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 088/100, Runtime 0.387237, Loss 1.181960, forward nfe 37418, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 089/100, Runtime 0.390340, Loss 1.192696, forward nfe 37734, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 090/100, Runtime 0.385537, Loss 1.301658, forward nfe 38050, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 091/100, Runtime 0.389425, Loss 1.167000, forward nfe 38360, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 092/100, Runtime 0.384953, Loss 1.290231, forward nfe 38670, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 093/100, Runtime 0.369465, Loss 1.262582, forward nfe 38980, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 094/100, Runtime 0.379965, Loss 1.216574, forward nfe 39290, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 095/100, Runtime 0.387465, Loss 1.200447, forward nfe 39600, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 096/100, Runtime 0.377338, Loss 1.171667, forward nfe 39910, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 097/100, Runtime 0.389137, Loss 1.267795, forward nfe 40220, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 098/100, Runtime 0.388245, Loss 1.163726, forward nfe 40530, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
Epoch: 099/100, Runtime 0.381098, Loss 1.231338, forward nfe 40840, backward nfe 0, Train: 0.7583, Val: 0.7435, Test: 0.7903, Best time: 80.0000
best val accuracy 0.743478 with test accuracy 0.790323 at epoch 60 and best time 80.000000