/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: AdaptiveHeunSolver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([128, 500])
m1.module.bias
torch.Size([128])
m2.module.weight
torch.Size([3, 128])
m2.module.bias
torch.Size([3])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([128, 128])
odeblock.odefunc.d
torch.Size([128])
odeblock.odefunc.k_d
torch.Size([128])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([128, 128])
odeblock.reg_odefunc.odefunc.d
torch.Size([128])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([128])
odeblock.multihead_att_layer.Q.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.Q.bias
torch.Size([16])
odeblock.multihead_att_layer.V.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.V.bias
torch.Size([16])
odeblock.multihead_att_layer.K.weight
torch.Size([16, 128])
odeblock.multihead_att_layer.K.bias
torch.Size([16])
odeblock.multihead_att_layer.Wout.weight
torch.Size([128, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([128])
Epoch: 001/100, Runtime 35.060447, Loss 1.098968, forward nfe 92, backward nfe 3348, Train: 0.7167, Val: 0.6493, Test: 0.6605, Best time: 0.2390
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 002/100, Runtime 52.326103, Loss 1.096925, forward nfe 570, backward nfe 8634, Train: 0.6667, Val: 0.6701, Test: 0.6802, Best time: 67.9571
Epoch: 003/100, Runtime 93.544293, Loss 1.090323, forward nfe 1036, backward nfe 18868, Train: 0.6667, Val: 0.6701, Test: 0.6802, Best time: 40.0000
Epoch: 004/100, Runtime 76.234807, Loss 1.075289, forward nfe 1514, backward nfe 27124, Train: 0.7667, Val: 0.6813, Test: 0.6832, Best time: 10.0487
Epoch: 005/100, Runtime 90.502940, Loss 1.055428, forward nfe 1986, backward nfe 37142, Train: 0.8167, Val: 0.7083, Test: 0.7083, Best time: 2.4938
Epoch: 006/100, Runtime 72.871555, Loss 1.021457, forward nfe 2470, backward nfe 45061, Train: 0.8167, Val: 0.7250, Test: 0.7190, Best time: 2.4301
Epoch: 007/100, Runtime 34.348545, Loss 0.988413, forward nfe 2954, backward nfe 48453, Train: 0.8167, Val: 0.7326, Test: 0.7230, Best time: 2.3781
Epoch: 008/100, Runtime 34.985736, Loss 0.937102, forward nfe 3438, backward nfe 51905, Train: 0.8167, Val: 0.7326, Test: 0.7230, Best time: 40.0000
Epoch: 009/100, Runtime 102.782752, Loss 0.882757, forward nfe 3922, backward nfe 63477, Train: 0.8000, Val: 0.7333, Test: 0.7267, Best time: 2.2944
Epoch: 010/100, Runtime 42.700203, Loss 0.810496, forward nfe 4406, backward nfe 67801, Train: 0.8000, Val: 0.7403, Test: 0.7261, Best time: 5.2128
Epoch: 011/100, Runtime 50.615766, Loss 0.747158, forward nfe 4890, backward nfe 73105, Train: 0.8167, Val: 0.7431, Test: 0.7291, Best time: 5.1702
Epoch: 012/100, Runtime 42.521786, Loss 0.688990, forward nfe 5374, backward nfe 77494, Train: 0.8167, Val: 0.7479, Test: 0.7356, Best time: 5.1375
Epoch: 013/100, Runtime 62.322115, Loss 0.635321, forward nfe 5858, backward nfe 84296, Train: 0.8500, Val: 0.7528, Test: 0.7412, Best time: 5.1128
Epoch: 014/100, Runtime 116.295424, Loss 0.568317, forward nfe 6354, backward nfe 97500, Train: 0.8500, Val: 0.7569, Test: 0.7458, Best time: 5.0949
Epoch: 015/100, Runtime 100.446325, Loss 0.520583, forward nfe 6850, backward nfe 108674, Train: 0.8500, Val: 0.7625, Test: 0.7491, Best time: 5.0846
Epoch: 016/100, Runtime 86.566690, Loss 0.487332, forward nfe 7346, backward nfe 118195, Train: 0.8500, Val: 0.7681, Test: 0.7544, Best time: 5.0835
Epoch: 017/100, Runtime 106.194331, Loss 0.437896, forward nfe 7842, backward nfe 130198, Train: 0.8833, Val: 0.7799, Test: 0.7568, Best time: 2.0702
Epoch: 018/100, Runtime 159.656811, Loss 0.420866, forward nfe 8344, backward nfe 148555, Train: 0.8833, Val: 0.7799, Test: 0.7568, Best time: 40.0000
Epoch: 019/100, Runtime 150.452748, Loss 0.384841, forward nfe 8852, backward nfe 165798, Train: 0.8833, Val: 0.7799, Test: 0.7568, Best time: 40.0000
Epoch: 020/100, Runtime 99.064705, Loss 0.432877, forward nfe 9360, backward nfe 176910, Train: 0.9500, Val: 0.7812, Test: 0.7652, Best time: 8.9906
Epoch: 021/100, Runtime 123.855275, Loss 0.405866, forward nfe 9862, backward nfe 191111, Train: 0.9000, Val: 0.7861, Test: 0.7691, Best time: 30.8040
Epoch: 022/100, Runtime 170.151279, Loss 0.374006, forward nfe 10364, backward nfe 210842, Train: 0.9000, Val: 0.7861, Test: 0.7691, Best time: 40.0000
Epoch: 023/100, Runtime 151.054705, Loss 0.363732, forward nfe 10860, backward nfe 228214, Train: 0.9000, Val: 0.7861, Test: 0.7691, Best time: 40.0000
Epoch: 024/100, Runtime 108.994271, Loss 0.376628, forward nfe 11356, backward nfe 240612, Train: 0.9000, Val: 0.7861, Test: 0.7691, Best time: 40.0000
Epoch: 025/100, Runtime 81.668316, Loss 0.359843, forward nfe 11852, backward nfe 249647, Train: 0.9000, Val: 0.7861, Test: 0.7691, Best time: 40.0000
Epoch: 026/100, Runtime 163.256489, Loss 0.388155, forward nfe 12348, backward nfe 268394, Train: 0.9000, Val: 0.7861, Test: 0.7691, Best time: 40.0000
Epoch: 027/100, Runtime 151.880812, Loss 0.377073, forward nfe 12844, backward nfe 285635, Train: 0.9000, Val: 0.7861, Test: 0.7691, Best time: 40.0000
Epoch: 028/100, Runtime 141.513713, Loss 0.339250, forward nfe 13340, backward nfe 301896, Train: 0.9000, Val: 0.7861, Test: 0.7691, Best time: 40.0000
Epoch: 029/100, Runtime 205.090562, Loss 0.393443, forward nfe 13836, backward nfe 325724, Train: 0.9333, Val: 0.7868, Test: 0.7731, Best time: 23.0375
Epoch: 030/100, Runtime 168.016632, Loss 0.310259, forward nfe 14332, backward nfe 345101, Train: 0.9333, Val: 0.7868, Test: 0.7731, Best time: 40.0000
Epoch: 031/100, Runtime 182.386071, Loss 0.322421, forward nfe 14828, backward nfe 366126, Train: 0.9333, Val: 0.7868, Test: 0.7731, Best time: 40.0000
Epoch: 032/100, Runtime 210.877682, Loss 0.330817, forward nfe 15324, backward nfe 390405, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 9.7161
Epoch: 033/100, Runtime 185.836888, Loss 0.311651, forward nfe 15820, backward nfe 411745, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 034/100, Runtime 130.297580, Loss 0.301492, forward nfe 16316, backward nfe 426752, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 035/100, Runtime 166.351828, Loss 0.322582, forward nfe 16818, backward nfe 446105, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 036/100, Runtime 70.173482, Loss 0.270251, forward nfe 17320, backward nfe 453797, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 037/100, Runtime 76.481910, Loss 0.243755, forward nfe 17822, backward nfe 462348, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 038/100, Runtime 68.991361, Loss 0.305709, forward nfe 18324, backward nfe 469955, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 039/100, Runtime 53.868971, Loss 0.222500, forward nfe 18826, backward nfe 475785, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 040/100, Runtime 81.743691, Loss 0.276846, forward nfe 19328, backward nfe 485029, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 041/100, Runtime 164.307606, Loss 0.288482, forward nfe 19830, backward nfe 504322, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 042/100, Runtime 102.836754, Loss 0.324289, forward nfe 20332, backward nfe 515823, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 043/100, Runtime 84.249476, Loss 0.264066, forward nfe 20834, backward nfe 525165, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 044/100, Runtime 86.464312, Loss 0.264972, forward nfe 21336, backward nfe 534947, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 045/100, Runtime 135.839193, Loss 0.256383, forward nfe 21838, backward nfe 550555, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 046/100, Runtime 145.265061, Loss 0.291684, forward nfe 22340, backward nfe 567369, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 047/100, Runtime 255.202513, Loss 0.242949, forward nfe 22836, backward nfe 597385, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 048/100, Runtime 169.576011, Loss 0.314141, forward nfe 23332, backward nfe 617248, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 049/100, Runtime 192.746508, Loss 0.283598, forward nfe 23828, backward nfe 639768, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 050/100, Runtime 163.684373, Loss 0.359627, forward nfe 24330, backward nfe 658907, Train: 0.9667, Val: 0.7910, Test: 0.7784, Best time: 40.0000
Epoch: 051/100, Runtime 108.365940, Loss 0.235074, forward nfe 24832, backward nfe 671383, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 34.7250
Epoch: 052/100, Runtime 178.987993, Loss 0.232726, forward nfe 25334, backward nfe 692053, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 053/100, Runtime 144.150715, Loss 0.233285, forward nfe 25836, backward nfe 708961, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 054/100, Runtime 147.135741, Loss 0.214203, forward nfe 26338, backward nfe 726373, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 055/100, Runtime 94.850609, Loss 0.230766, forward nfe 26840, backward nfe 737283, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 056/100, Runtime 142.913442, Loss 0.270520, forward nfe 27342, backward nfe 754189, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 057/100, Runtime 101.514406, Loss 0.244439, forward nfe 27844, backward nfe 765825, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 058/100, Runtime 169.466016, Loss 0.227772, forward nfe 28346, backward nfe 785755, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 059/100, Runtime 52.512706, Loss 0.225586, forward nfe 28848, backward nfe 791481, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 060/100, Runtime 179.932926, Loss 0.216413, forward nfe 29350, backward nfe 812840, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 061/100, Runtime 167.849112, Loss 0.223443, forward nfe 29852, backward nfe 832795, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 062/100, Runtime 83.207112, Loss 0.209759, forward nfe 30354, backward nfe 842237, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 063/100, Runtime 132.859643, Loss 0.257191, forward nfe 30856, backward nfe 857845, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 064/100, Runtime 124.645566, Loss 0.219087, forward nfe 31358, backward nfe 872432, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 065/100, Runtime 136.237541, Loss 0.223016, forward nfe 31860, backward nfe 888202, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 066/100, Runtime 171.135615, Loss 0.206035, forward nfe 32362, backward nfe 908112, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 067/100, Runtime 164.766489, Loss 0.173251, forward nfe 32864, backward nfe 927427, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 068/100, Runtime 205.880184, Loss 0.247253, forward nfe 33366, backward nfe 951966, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 069/100, Runtime 160.020947, Loss 0.165462, forward nfe 33868, backward nfe 970563, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 070/100, Runtime 212.496855, Loss 0.178832, forward nfe 34376, backward nfe 995834, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 071/100, Runtime 287.096330, Loss 0.266644, forward nfe 34884, backward nfe 1030470, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 072/100, Runtime 109.287699, Loss 0.114103, forward nfe 35392, backward nfe 1043166, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 073/100, Runtime 205.562080, Loss 0.162035, forward nfe 35900, backward nfe 1067489, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 074/100, Runtime 111.443724, Loss 0.128852, forward nfe 36408, backward nfe 1080385, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 075/100, Runtime 131.190904, Loss 0.146646, forward nfe 36916, backward nfe 1095832, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 076/100, Runtime 183.247983, Loss 0.150377, forward nfe 37424, backward nfe 1117227, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 077/100, Runtime 169.796235, Loss 0.094308, forward nfe 37938, backward nfe 1136899, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 078/100, Runtime 139.843085, Loss 0.107195, forward nfe 38452, backward nfe 1153177, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 079/100, Runtime 162.734295, Loss 0.154788, forward nfe 38954, backward nfe 1172341, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 080/100, Runtime 180.553713, Loss 0.155870, forward nfe 39468, backward nfe 1193633, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 081/100, Runtime 177.183034, Loss 0.116056, forward nfe 39982, backward nfe 1214666, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 082/100, Runtime 201.906582, Loss 0.142063, forward nfe 40496, backward nfe 1238608, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 083/100, Runtime 67.904261, Loss 0.099672, forward nfe 41016, backward nfe 1246278, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 084/100, Runtime 99.329734, Loss 0.146727, forward nfe 41536, backward nfe 1257625, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 085/100, Runtime 125.085493, Loss 0.094646, forward nfe 42056, backward nfe 1272244, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 086/100, Runtime 144.337587, Loss 0.173424, forward nfe 42576, backward nfe 1288980, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 087/100, Runtime 60.173182, Loss 0.118206, forward nfe 43096, backward nfe 1295638, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 088/100, Runtime 129.112331, Loss 0.120701, forward nfe 43610, backward nfe 1310496, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 089/100, Runtime 92.223211, Loss 0.080106, forward nfe 44124, backward nfe 1321051, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 090/100, Runtime 42.265963, Loss 0.072799, forward nfe 44638, backward nfe 1325570, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 091/100, Runtime 85.399083, Loss 0.077586, forward nfe 45146, backward nfe 1335205, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 092/100, Runtime 58.422252, Loss 0.105004, forward nfe 45654, backward nfe 1341588, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 093/100, Runtime 73.027083, Loss 0.083797, forward nfe 46162, backward nfe 1349790, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 094/100, Runtime 51.020170, Loss 0.116275, forward nfe 46670, backward nfe 1355341, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 095/100, Runtime 39.037339, Loss 0.057431, forward nfe 47172, backward nfe 1359481, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 096/100, Runtime 135.100208, Loss 0.097052, forward nfe 47674, backward nfe 1374892, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 097/100, Runtime 62.085905, Loss 0.050866, forward nfe 48176, backward nfe 1381776, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 098/100, Runtime 35.529830, Loss 0.094817, forward nfe 48678, backward nfe 1385474, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
Epoch: 099/100, Runtime 32.317798, Loss 0.046925, forward nfe 49180, backward nfe 1388722, Train: 0.9500, Val: 0.8000, Test: 0.7943, Best time: 40.0000
best val accuracy 0.800000 with test accuracy 0.794313 at epoch 51 and best time 40.000000