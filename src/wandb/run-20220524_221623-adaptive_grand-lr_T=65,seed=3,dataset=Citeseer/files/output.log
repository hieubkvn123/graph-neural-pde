/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 3703])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([6, 80])
m2.module.bias
torch.Size([6])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.output_var
torch.Size([1])
odeblock.multihead_att_layer.lengthscale
torch.Size([1])
odeblock.multihead_att_layer.Q.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([32])
odeblock.multihead_att_layer.V.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([32])
odeblock.multihead_att_layer.K.weight
torch.Size([32, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([32])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 4])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 0.753229, Loss 1.793687, forward nfe 182, backward nfe 0, Train: 0.3917, Val: 0.4268, Test: 0.4097, Best time: 74.0187
Epoch: 002/100, Runtime 0.649267, Loss 1.766958, forward nfe 768, backward nfe 0, Train: 0.4500, Val: 0.4696, Test: 0.4435, Best time: 0.8797
Epoch: 003/100, Runtime 0.695660, Loss 1.722823, forward nfe 1354, backward nfe 0, Train: 0.5750, Val: 0.5246, Test: 0.5129, Best time: 0.8605
Epoch: 004/100, Runtime 0.709592, Loss 1.636718, forward nfe 1952, backward nfe 0, Train: 0.6917, Val: 0.6536, Test: 0.6371, Best time: 2.7020
Epoch: 005/100, Runtime 0.663250, Loss 1.637218, forward nfe 2538, backward nfe 0, Train: 0.6917, Val: 0.7014, Test: 0.6726, Best time: 0.8744
Epoch: 006/100, Runtime 0.641422, Loss 1.566509, forward nfe 3112, backward nfe 0, Train: 0.7583, Val: 0.7341, Test: 0.7000, Best time: 5.4045
Epoch: 007/100, Runtime 0.617892, Loss 1.570688, forward nfe 3674, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 6.7413
Epoch: 008/100, Runtime 0.616418, Loss 1.521524, forward nfe 4224, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 009/100, Runtime 0.601951, Loss 1.533031, forward nfe 4774, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 010/100, Runtime 0.587460, Loss 1.520839, forward nfe 5312, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 011/100, Runtime 0.530563, Loss 1.511223, forward nfe 5832, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 012/100, Runtime 0.584296, Loss 1.483168, forward nfe 6346, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 013/100, Runtime 0.593378, Loss 1.448975, forward nfe 6860, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 014/100, Runtime 0.563684, Loss 1.430164, forward nfe 7374, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 015/100, Runtime 0.547030, Loss 1.334012, forward nfe 7876, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 016/100, Runtime 0.563613, Loss 1.352638, forward nfe 8366, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 017/100, Runtime 0.548486, Loss 1.346092, forward nfe 8850, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 018/100, Runtime 0.552275, Loss 1.283761, forward nfe 9328, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 019/100, Runtime 0.547184, Loss 1.232913, forward nfe 9812, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 020/100, Runtime 0.543143, Loss 1.229024, forward nfe 10290, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 021/100, Runtime 0.536005, Loss 1.168309, forward nfe 10750, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 022/100, Runtime 0.507859, Loss 1.291263, forward nfe 11210, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 023/100, Runtime 0.519809, Loss 1.163242, forward nfe 11658, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 024/100, Runtime 0.512586, Loss 1.266690, forward nfe 12094, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 025/100, Runtime 0.511032, Loss 1.168170, forward nfe 12524, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 026/100, Runtime 0.485018, Loss 1.164849, forward nfe 12942, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 027/100, Runtime 0.496335, Loss 1.209027, forward nfe 13360, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 028/100, Runtime 0.479454, Loss 1.174184, forward nfe 13778, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 029/100, Runtime 0.485890, Loss 1.194513, forward nfe 14196, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 030/100, Runtime 0.464041, Loss 1.053953, forward nfe 14608, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 031/100, Runtime 0.447577, Loss 1.165363, forward nfe 15008, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 032/100, Runtime 0.480728, Loss 1.265994, forward nfe 15396, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 033/100, Runtime 0.455770, Loss 1.148860, forward nfe 15778, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 034/100, Runtime 0.419009, Loss 1.263437, forward nfe 16160, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 035/100, Runtime 0.452152, Loss 1.217842, forward nfe 16536, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 036/100, Runtime 0.436086, Loss 1.208939, forward nfe 16912, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 037/100, Runtime 0.434289, Loss 1.145610, forward nfe 17282, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 038/100, Runtime 0.414165, Loss 1.258076, forward nfe 17640, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 039/100, Runtime 0.401748, Loss 1.219233, forward nfe 17992, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 040/100, Runtime 0.406449, Loss 1.228512, forward nfe 18338, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 041/100, Runtime 0.419744, Loss 1.199705, forward nfe 18684, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 042/100, Runtime 0.395088, Loss 1.221669, forward nfe 19024, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 043/100, Runtime 0.395899, Loss 1.161372, forward nfe 19358, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 044/100, Runtime 0.382891, Loss 1.119796, forward nfe 19692, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 045/100, Runtime 0.388823, Loss 1.263510, forward nfe 20026, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 046/100, Runtime 0.399990, Loss 1.144806, forward nfe 20354, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 047/100, Runtime 0.392611, Loss 1.202956, forward nfe 20682, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 048/100, Runtime 0.393274, Loss 1.115038, forward nfe 21004, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 049/100, Runtime 0.371723, Loss 1.299703, forward nfe 21320, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 050/100, Runtime 0.375354, Loss 1.145545, forward nfe 21636, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 051/100, Runtime 0.365459, Loss 1.280673, forward nfe 21946, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 052/100, Runtime 0.382471, Loss 1.164893, forward nfe 22250, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 053/100, Runtime 0.370429, Loss 1.157504, forward nfe 22554, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 054/100, Runtime 0.367546, Loss 1.140797, forward nfe 22852, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 055/100, Runtime 0.357436, Loss 1.112238, forward nfe 23150, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 056/100, Runtime 0.372860, Loss 1.137838, forward nfe 23448, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 057/100, Runtime 0.375421, Loss 1.116199, forward nfe 23746, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 058/100, Runtime 0.383444, Loss 1.254551, forward nfe 24044, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 059/100, Runtime 0.360292, Loss 1.155243, forward nfe 24342, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 060/100, Runtime 0.360571, Loss 1.260486, forward nfe 24646, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 061/100, Runtime 0.361370, Loss 1.152594, forward nfe 24950, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 062/100, Runtime 0.350501, Loss 1.174038, forward nfe 25254, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 063/100, Runtime 0.370907, Loss 1.125995, forward nfe 25558, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 064/100, Runtime 0.370999, Loss 1.133584, forward nfe 25862, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 065/100, Runtime 0.355584, Loss 1.160141, forward nfe 26166, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 066/100, Runtime 0.354225, Loss 1.009595, forward nfe 26464, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 067/100, Runtime 0.354660, Loss 0.997566, forward nfe 26762, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 068/100, Runtime 0.384868, Loss 1.051266, forward nfe 27054, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 069/100, Runtime 0.356845, Loss 1.195354, forward nfe 27346, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 070/100, Runtime 0.357487, Loss 1.165544, forward nfe 27638, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 071/100, Runtime 0.357374, Loss 1.100464, forward nfe 27930, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 072/100, Runtime 0.481234, Loss 1.086861, forward nfe 28222, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 073/100, Runtime 0.375143, Loss 1.090724, forward nfe 28514, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 074/100, Runtime 0.346413, Loss 1.213424, forward nfe 28806, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 075/100, Runtime 0.353008, Loss 1.184963, forward nfe 29098, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 076/100, Runtime 0.346590, Loss 1.117104, forward nfe 29390, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 077/100, Runtime 0.364362, Loss 1.139621, forward nfe 29688, backward nfe 0, Train: 0.7750, Val: 0.7449, Test: 0.7113, Best time: 65.0000
Epoch: 078/100, Runtime 0.366934, Loss 1.073475, forward nfe 29986, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 54.1163
Epoch: 079/100, Runtime 0.369827, Loss 0.937481, forward nfe 30284, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 080/100, Runtime 0.351541, Loss 1.043406, forward nfe 30582, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 081/100, Runtime 0.351343, Loss 1.210872, forward nfe 30880, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 082/100, Runtime 0.366824, Loss 1.174404, forward nfe 31172, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 083/100, Runtime 0.371326, Loss 1.026591, forward nfe 31464, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 084/100, Runtime 0.356327, Loss 1.250515, forward nfe 31756, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 085/100, Runtime 0.363303, Loss 1.148927, forward nfe 32048, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 086/100, Runtime 0.375121, Loss 1.163741, forward nfe 32340, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 087/100, Runtime 0.369029, Loss 1.220335, forward nfe 32632, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 088/100, Runtime 0.354184, Loss 1.119626, forward nfe 32924, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 089/100, Runtime 0.364070, Loss 1.064961, forward nfe 33216, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 090/100, Runtime 0.371543, Loss 1.073608, forward nfe 33508, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 091/100, Runtime 0.344534, Loss 1.135832, forward nfe 33800, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 092/100, Runtime 0.357638, Loss 1.113071, forward nfe 34092, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 093/100, Runtime 0.339748, Loss 1.107337, forward nfe 34372, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 094/100, Runtime 0.341935, Loss 1.091677, forward nfe 34652, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 095/100, Runtime 0.336401, Loss 0.992686, forward nfe 34932, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 096/100, Runtime 0.333323, Loss 1.071306, forward nfe 35206, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 097/100, Runtime 0.342550, Loss 1.011782, forward nfe 35486, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 098/100, Runtime 0.349645, Loss 1.184298, forward nfe 35766, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
Epoch: 099/100, Runtime 0.341791, Loss 1.213283, forward nfe 36046, backward nfe 0, Train: 0.8583, Val: 0.7514, Test: 0.7355, Best time: 65.0000
best val accuracy 0.751449 with test accuracy 0.735484 at epoch 78 and best time 65.000000