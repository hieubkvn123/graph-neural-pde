/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Adaptive GRAND laplacian function ******************
****************** Adaptive GRAND laplacian function ******************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
Epoch: 001/100, Runtime 3.879726, Loss 1.947909, forward nfe 122, backward nfe 0, Train: 0.1643, Val: 0.1581, Test: 0.1624, Best time: 0.0936
Epoch: 002/100, Runtime 4.319142, Loss 1.980884, forward nfe 606, backward nfe 0, Train: 0.3571, Val: 0.3154, Test: 0.3218, Best time: 96.1017
Epoch: 003/100, Runtime 4.164855, Loss 1.846077, forward nfe 1078, backward nfe 0, Train: 0.4000, Val: 0.3684, Test: 0.3736, Best time: 10.3910
Epoch: 004/100, Runtime 4.246979, Loss 1.817708, forward nfe 1544, backward nfe 0, Train: 0.5071, Val: 0.4390, Test: 0.4365, Best time: 3.9719
Epoch: 005/100, Runtime 3.763991, Loss 1.710780, forward nfe 1998, backward nfe 0, Train: 0.6786, Val: 0.6434, Test: 0.6315, Best time: 41.9979
Epoch: 006/100, Runtime 3.613235, Loss 1.529610, forward nfe 2440, backward nfe 0, Train: 0.7786, Val: 0.7426, Test: 0.7218, Best time: 11.1266
Epoch: 007/100, Runtime 3.568769, Loss 1.354045, forward nfe 2876, backward nfe 0, Train: 0.8857, Val: 0.7625, Test: 0.7421, Best time: 11.3397
Epoch: 008/100, Runtime 3.592899, Loss 1.137606, forward nfe 3294, backward nfe 0, Train: 0.8786, Val: 0.7684, Test: 0.7584, Best time: 45.0969
Epoch: 009/100, Runtime 3.287452, Loss 0.952970, forward nfe 3706, backward nfe 0, Train: 0.8786, Val: 0.7684, Test: 0.7584, Best time: 65.0000
Epoch: 010/100, Runtime 3.225274, Loss 0.816066, forward nfe 4106, backward nfe 0, Train: 0.8429, Val: 0.7985, Test: 0.7817, Best time: 65.8853
Epoch: 011/100, Runtime 3.180022, Loss 0.696706, forward nfe 4500, backward nfe 0, Train: 0.9071, Val: 0.8324, Test: 0.8213, Best time: 29.7676
Epoch: 012/100, Runtime 3.102357, Loss 0.568398, forward nfe 4888, backward nfe 0, Train: 0.9071, Val: 0.8324, Test: 0.8213, Best time: 65.0000
Epoch: 013/100, Runtime 3.238268, Loss 0.516188, forward nfe 5270, backward nfe 0, Train: 0.9071, Val: 0.8324, Test: 0.8213, Best time: 65.0000
Epoch: 014/100, Runtime 3.087462, Loss 0.486659, forward nfe 5646, backward nfe 0, Train: 0.9071, Val: 0.8324, Test: 0.8213, Best time: 65.0000
Epoch: 015/100, Runtime 3.127098, Loss 0.425286, forward nfe 6010, backward nfe 0, Train: 0.9071, Val: 0.8324, Test: 0.8213, Best time: 65.0000
Epoch: 016/100, Runtime 2.924985, Loss 0.406715, forward nfe 6362, backward nfe 0, Train: 0.9286, Val: 0.8338, Test: 0.8244, Best time: 52.6854
Epoch: 017/100, Runtime 2.887956, Loss 0.406177, forward nfe 6696, backward nfe 0, Train: 0.9071, Val: 0.8463, Test: 0.8173, Best time: 76.6953
Epoch: 018/100, Runtime 2.765421, Loss 0.456011, forward nfe 7024, backward nfe 0, Train: 0.9071, Val: 0.8463, Test: 0.8173, Best time: 65.0000
Epoch: 019/100, Runtime 2.847163, Loss 0.337263, forward nfe 7346, backward nfe 0, Train: 0.9071, Val: 0.8463, Test: 0.8173, Best time: 65.0000
Epoch: 020/100, Runtime 2.779518, Loss 0.341332, forward nfe 7668, backward nfe 0, Train: 0.9071, Val: 0.8463, Test: 0.8173, Best time: 65.0000
Epoch: 021/100, Runtime 2.757528, Loss 0.369794, forward nfe 7984, backward nfe 0, Train: 0.9071, Val: 0.8463, Test: 0.8173, Best time: 65.0000
Epoch: 022/100, Runtime 2.671578, Loss 0.332381, forward nfe 8300, backward nfe 0, Train: 0.9071, Val: 0.8463, Test: 0.8173, Best time: 65.0000
Epoch: 023/100, Runtime 2.688545, Loss 0.344847, forward nfe 8610, backward nfe 0, Train: 0.9071, Val: 0.8463, Test: 0.8173, Best time: 65.0000
Epoch: 024/100, Runtime 2.567185, Loss 0.363571, forward nfe 8908, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 76.5381
Epoch: 025/100, Runtime 2.492494, Loss 0.355571, forward nfe 9188, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 026/100, Runtime 2.532433, Loss 0.333247, forward nfe 9468, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 027/100, Runtime 2.499849, Loss 0.306643, forward nfe 9760, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 028/100, Runtime 2.575630, Loss 0.298390, forward nfe 10052, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 029/100, Runtime 2.537537, Loss 0.309283, forward nfe 10332, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 030/100, Runtime 2.395915, Loss 0.295343, forward nfe 10612, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 031/100, Runtime 2.128122, Loss 0.345305, forward nfe 10886, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 032/100, Runtime 2.228116, Loss 0.248797, forward nfe 11154, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 033/100, Runtime 2.284902, Loss 0.301646, forward nfe 11416, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 034/100, Runtime 2.400398, Loss 0.305418, forward nfe 11684, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 035/100, Runtime 2.289830, Loss 0.328412, forward nfe 11952, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 036/100, Runtime 2.370494, Loss 0.317623, forward nfe 12220, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 037/100, Runtime 2.107336, Loss 0.319994, forward nfe 12482, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 038/100, Runtime 2.218898, Loss 0.249126, forward nfe 12744, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 039/100, Runtime 2.376709, Loss 0.300732, forward nfe 13006, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 040/100, Runtime 2.054472, Loss 0.253120, forward nfe 13268, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 041/100, Runtime 2.073702, Loss 0.255806, forward nfe 13524, backward nfe 0, Train: 0.9286, Val: 0.8500, Test: 0.8274, Best time: 65.0000
Epoch: 042/100, Runtime 2.091783, Loss 0.281232, forward nfe 13780, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 68.6432
Epoch: 043/100, Runtime 2.120684, Loss 0.239241, forward nfe 14030, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 044/100, Runtime 2.166912, Loss 0.233046, forward nfe 14280, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 045/100, Runtime 2.149703, Loss 0.197895, forward nfe 14530, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 046/100, Runtime 2.194813, Loss 0.220349, forward nfe 14780, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 047/100, Runtime 2.178590, Loss 0.235690, forward nfe 15030, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 048/100, Runtime 2.291333, Loss 0.226516, forward nfe 15280, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 049/100, Runtime 2.223248, Loss 0.179128, forward nfe 15530, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 050/100, Runtime 2.155267, Loss 0.173875, forward nfe 15780, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 051/100, Runtime 2.178647, Loss 0.238886, forward nfe 16030, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 052/100, Runtime 2.195422, Loss 0.182291, forward nfe 16280, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 053/100, Runtime 2.286924, Loss 0.176531, forward nfe 16530, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 054/100, Runtime 2.195071, Loss 0.204719, forward nfe 16780, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 055/100, Runtime 2.234640, Loss 0.175426, forward nfe 17030, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 056/100, Runtime 2.182564, Loss 0.139676, forward nfe 17280, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 057/100, Runtime 2.146988, Loss 0.157013, forward nfe 17530, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 058/100, Runtime 2.258294, Loss 0.187878, forward nfe 17774, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 059/100, Runtime 2.232446, Loss 0.191724, forward nfe 18024, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 060/100, Runtime 2.113420, Loss 0.114280, forward nfe 18268, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 061/100, Runtime 2.184180, Loss 0.096351, forward nfe 18512, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 062/100, Runtime 2.187506, Loss 0.173185, forward nfe 18756, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 063/100, Runtime 2.085494, Loss 0.126059, forward nfe 19000, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 064/100, Runtime 2.150233, Loss 0.127879, forward nfe 19238, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 065/100, Runtime 2.118526, Loss 0.134797, forward nfe 19476, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 066/100, Runtime 2.180077, Loss 0.090232, forward nfe 19720, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 067/100, Runtime 2.039882, Loss 0.117778, forward nfe 19964, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 068/100, Runtime 1.994047, Loss 0.143319, forward nfe 20208, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 069/100, Runtime 2.106875, Loss 0.093734, forward nfe 20446, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 070/100, Runtime 2.064019, Loss 0.106590, forward nfe 20684, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 071/100, Runtime 2.148161, Loss 0.051755, forward nfe 20922, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 072/100, Runtime 2.052255, Loss 0.071295, forward nfe 21154, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 073/100, Runtime 2.099784, Loss 0.044808, forward nfe 21386, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 074/100, Runtime 2.140183, Loss 0.049373, forward nfe 21618, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 075/100, Runtime 2.054571, Loss 0.053638, forward nfe 21850, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 076/100, Runtime 2.036244, Loss 0.071114, forward nfe 22082, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 077/100, Runtime 2.073810, Loss 0.037760, forward nfe 22314, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 078/100, Runtime 2.105278, Loss 0.063594, forward nfe 22546, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 079/100, Runtime 1.980902, Loss 0.095882, forward nfe 22778, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 080/100, Runtime 1.921703, Loss 0.092146, forward nfe 22998, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 081/100, Runtime 1.915767, Loss 0.044378, forward nfe 23218, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 082/100, Runtime 1.988293, Loss 0.064525, forward nfe 23438, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 083/100, Runtime 1.895976, Loss 0.081289, forward nfe 23658, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 084/100, Runtime 2.050465, Loss 0.028892, forward nfe 23878, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 085/100, Runtime 2.044014, Loss 0.064627, forward nfe 24104, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 086/100, Runtime 2.131501, Loss 0.060631, forward nfe 24330, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 087/100, Runtime 2.143070, Loss 0.051567, forward nfe 24574, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 088/100, Runtime 2.192847, Loss 0.088692, forward nfe 24812, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 089/100, Runtime 2.096007, Loss 0.078746, forward nfe 25050, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 090/100, Runtime 2.072668, Loss 0.039131, forward nfe 25282, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 091/100, Runtime 2.149284, Loss 0.024827, forward nfe 25514, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 092/100, Runtime 2.126554, Loss 0.050573, forward nfe 25746, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 093/100, Runtime 2.102226, Loss 0.056012, forward nfe 25984, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 094/100, Runtime 1.926334, Loss 0.049989, forward nfe 26216, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 095/100, Runtime 2.057613, Loss 0.044156, forward nfe 26442, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 096/100, Runtime 2.049728, Loss 0.035035, forward nfe 26674, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 097/100, Runtime 2.063930, Loss 0.031368, forward nfe 26900, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 098/100, Runtime 2.050931, Loss 0.024122, forward nfe 27132, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
Epoch: 099/100, Runtime 2.181104, Loss 0.042334, forward nfe 27364, backward nfe 0, Train: 0.9286, Val: 0.8507, Test: 0.8325, Best time: 65.0000
best val accuracy 0.850735 with test accuracy 0.832487 at epoch 42 and best time 65.000000