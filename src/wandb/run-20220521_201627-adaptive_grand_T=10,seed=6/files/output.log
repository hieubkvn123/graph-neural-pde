/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 1.022521, Loss 1.948645, forward nfe 38, backward nfe 0, Train: 0.7071, Val: 0.6059, Test: 0.5635, Best time: 2.4805
Epoch: 002/100, Runtime 1.100502, Loss 1.858161, forward nfe 156, backward nfe 0, Train: 0.9429, Val: 0.8051, Test: 0.7807, Best time: 5.5676
Epoch: 003/100, Runtime 1.100706, Loss 1.645563, forward nfe 286, backward nfe 0, Train: 0.9429, Val: 0.8051, Test: 0.7807, Best time: 10.0000
Epoch: 004/100, Runtime 1.082147, Loss 1.394585, forward nfe 416, backward nfe 0, Train: 0.9429, Val: 0.8051, Test: 0.7807, Best time: 10.0000
Epoch: 005/100, Runtime 1.139231, Loss 1.102939, forward nfe 546, backward nfe 0, Train: 0.9429, Val: 0.8051, Test: 0.7807, Best time: 10.0000
Epoch: 006/100, Runtime 1.102634, Loss 0.809089, forward nfe 676, backward nfe 0, Train: 0.9571, Val: 0.8132, Test: 0.7909, Best time: 21.1657
Epoch: 007/100, Runtime 1.137959, Loss 0.547569, forward nfe 806, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8020, Best time: 16.7005
Epoch: 008/100, Runtime 1.084651, Loss 0.383794, forward nfe 936, backward nfe 0, Train: 0.9571, Val: 0.8265, Test: 0.8061, Best time: 10.0000
Epoch: 009/100, Runtime 0.966165, Loss 0.259916, forward nfe 1060, backward nfe 0, Train: 0.9571, Val: 0.8265, Test: 0.8061, Best time: 10.0000
Epoch: 010/100, Runtime 0.979568, Loss 0.219649, forward nfe 1172, backward nfe 0, Train: 0.9857, Val: 0.8287, Test: 0.8041, Best time: 18.5273
Epoch: 011/100, Runtime 0.967371, Loss 0.163357, forward nfe 1284, backward nfe 0, Train: 0.9857, Val: 0.8287, Test: 0.8041, Best time: 10.0000
Epoch: 012/100, Runtime 0.977290, Loss 0.131073, forward nfe 1396, backward nfe 0, Train: 0.9857, Val: 0.8287, Test: 0.8041, Best time: 10.0000
Epoch: 013/100, Runtime 0.961826, Loss 0.102970, forward nfe 1508, backward nfe 0, Train: 0.9857, Val: 0.8287, Test: 0.8041, Best time: 10.0000
Epoch: 014/100, Runtime 0.972796, Loss 0.112202, forward nfe 1620, backward nfe 0, Train: 0.9857, Val: 0.8287, Test: 0.8041, Best time: 10.0000
Epoch: 015/100, Runtime 0.910897, Loss 0.119921, forward nfe 1732, backward nfe 0, Train: 0.9857, Val: 0.8287, Test: 0.8041, Best time: 10.0000
Epoch: 016/100, Runtime 0.947258, Loss 0.133708, forward nfe 1838, backward nfe 0, Train: 0.9857, Val: 0.8287, Test: 0.8041, Best time: 10.0000
Epoch: 017/100, Runtime 0.893419, Loss 0.144281, forward nfe 1938, backward nfe 0, Train: 0.9857, Val: 0.8287, Test: 0.8041, Best time: 10.0000
Epoch: 018/100, Runtime 0.857420, Loss 0.115628, forward nfe 2038, backward nfe 0, Train: 0.9857, Val: 0.8287, Test: 0.8041, Best time: 10.0000
Epoch: 019/100, Runtime 0.886159, Loss 0.142145, forward nfe 2138, backward nfe 0, Train: 0.9857, Val: 0.8287, Test: 0.8041, Best time: 10.0000
Epoch: 020/100, Runtime 0.887457, Loss 0.159295, forward nfe 2238, backward nfe 0, Train: 0.9857, Val: 0.8287, Test: 0.8041, Best time: 10.0000
Epoch: 021/100, Runtime 0.796546, Loss 0.154420, forward nfe 2338, backward nfe 0, Train: 0.9929, Val: 0.8301, Test: 0.8081, Best time: 10.0000
Epoch: 022/100, Runtime 0.832293, Loss 0.153299, forward nfe 2432, backward nfe 0, Train: 0.9929, Val: 0.8301, Test: 0.8081, Best time: 10.0000
Epoch: 023/100, Runtime 0.889358, Loss 0.192169, forward nfe 2526, backward nfe 0, Train: 0.9929, Val: 0.8301, Test: 0.8081, Best time: 10.0000
Epoch: 024/100, Runtime 0.774745, Loss 0.190542, forward nfe 2620, backward nfe 0, Train: 0.9929, Val: 0.8301, Test: 0.8081, Best time: 10.0000
Epoch: 025/100, Runtime 0.873302, Loss 0.166973, forward nfe 2714, backward nfe 0, Train: 0.9929, Val: 0.8301, Test: 0.8081, Best time: 10.0000
Epoch: 026/100, Runtime 0.856605, Loss 0.141873, forward nfe 2808, backward nfe 0, Train: 1.0000, Val: 0.8338, Test: 0.8244, Best time: 35.8182
Epoch: 027/100, Runtime 0.790656, Loss 0.124654, forward nfe 2902, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 36.6324
Epoch: 028/100, Runtime 0.860699, Loss 0.134177, forward nfe 2996, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 029/100, Runtime 0.744384, Loss 0.100374, forward nfe 3084, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 030/100, Runtime 0.854481, Loss 0.101711, forward nfe 3172, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 031/100, Runtime 0.749555, Loss 0.072915, forward nfe 3260, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 032/100, Runtime 0.846164, Loss 0.112799, forward nfe 3348, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 033/100, Runtime 0.711502, Loss 0.085994, forward nfe 3436, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 034/100, Runtime 0.741310, Loss 0.107092, forward nfe 3518, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 035/100, Runtime 0.785711, Loss 0.083313, forward nfe 3600, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 036/100, Runtime 0.714978, Loss 0.086157, forward nfe 3682, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 037/100, Runtime 0.733140, Loss 0.073808, forward nfe 3764, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 038/100, Runtime 0.748202, Loss 0.087588, forward nfe 3846, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 039/100, Runtime 0.718059, Loss 0.061616, forward nfe 3928, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 040/100, Runtime 0.712370, Loss 0.081094, forward nfe 4010, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 041/100, Runtime 0.794374, Loss 0.081553, forward nfe 4092, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 042/100, Runtime 0.720526, Loss 0.097892, forward nfe 4174, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 043/100, Runtime 0.719974, Loss 0.100489, forward nfe 4256, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 044/100, Runtime 0.778190, Loss 0.099603, forward nfe 4338, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 045/100, Runtime 0.738475, Loss 0.112820, forward nfe 4420, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 046/100, Runtime 0.679515, Loss 0.078375, forward nfe 4502, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 047/100, Runtime 0.711237, Loss 0.118877, forward nfe 4584, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 048/100, Runtime 0.644970, Loss 0.085128, forward nfe 4666, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 049/100, Runtime 0.635852, Loss 0.090015, forward nfe 4742, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 050/100, Runtime 0.634150, Loss 0.067061, forward nfe 4818, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 051/100, Runtime 0.649330, Loss 0.070292, forward nfe 4894, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 052/100, Runtime 0.663007, Loss 0.065608, forward nfe 4970, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 053/100, Runtime 0.717094, Loss 0.067301, forward nfe 5046, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 054/100, Runtime 0.703158, Loss 0.063262, forward nfe 5122, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 055/100, Runtime 0.675627, Loss 0.083927, forward nfe 5198, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 056/100, Runtime 0.653871, Loss 0.069078, forward nfe 5268, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 057/100, Runtime 0.651119, Loss 0.071055, forward nfe 5338, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 058/100, Runtime 0.644708, Loss 0.062917, forward nfe 5408, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 059/100, Runtime 0.649571, Loss 0.088335, forward nfe 5478, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 060/100, Runtime 0.642133, Loss 0.090347, forward nfe 5548, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 061/100, Runtime 0.643091, Loss 0.083180, forward nfe 5618, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 062/100, Runtime 0.634539, Loss 0.044476, forward nfe 5688, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 063/100, Runtime 0.638910, Loss 0.076711, forward nfe 5758, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 064/100, Runtime 0.666658, Loss 0.065092, forward nfe 5828, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 065/100, Runtime 0.654379, Loss 0.096028, forward nfe 5898, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 066/100, Runtime 0.643614, Loss 0.058565, forward nfe 5968, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 067/100, Runtime 0.692704, Loss 0.047851, forward nfe 6038, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 068/100, Runtime 0.678999, Loss 0.058303, forward nfe 6108, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 069/100, Runtime 0.650455, Loss 0.081979, forward nfe 6178, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 070/100, Runtime 0.678709, Loss 0.072182, forward nfe 6248, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 071/100, Runtime 0.663104, Loss 0.044632, forward nfe 6318, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 072/100, Runtime 0.659202, Loss 0.066269, forward nfe 6388, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 073/100, Runtime 0.644806, Loss 0.076924, forward nfe 6458, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 074/100, Runtime 0.656777, Loss 0.055321, forward nfe 6528, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 075/100, Runtime 0.654164, Loss 0.064779, forward nfe 6598, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 076/100, Runtime 0.637455, Loss 0.076203, forward nfe 6668, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 077/100, Runtime 0.643762, Loss 0.068298, forward nfe 6738, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 078/100, Runtime 0.651735, Loss 0.073987, forward nfe 6808, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 079/100, Runtime 0.650215, Loss 0.087199, forward nfe 6878, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 080/100, Runtime 0.640706, Loss 0.094913, forward nfe 6948, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 081/100, Runtime 0.636982, Loss 0.088121, forward nfe 7018, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 082/100, Runtime 0.646367, Loss 0.063769, forward nfe 7088, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 083/100, Runtime 0.629562, Loss 0.073913, forward nfe 7158, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 084/100, Runtime 0.641853, Loss 0.069327, forward nfe 7228, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 085/100, Runtime 0.634201, Loss 0.060384, forward nfe 7298, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 086/100, Runtime 0.774046, Loss 0.050042, forward nfe 7368, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 087/100, Runtime 0.660206, Loss 0.062577, forward nfe 7444, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 088/100, Runtime 0.700403, Loss 0.053472, forward nfe 7520, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 089/100, Runtime 0.753937, Loss 0.073167, forward nfe 7596, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 090/100, Runtime 0.732093, Loss 0.063376, forward nfe 7672, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 091/100, Runtime 0.755863, Loss 0.073577, forward nfe 7754, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 092/100, Runtime 0.759437, Loss 0.085732, forward nfe 7836, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 093/100, Runtime 0.731006, Loss 0.042318, forward nfe 7918, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 094/100, Runtime 0.867737, Loss 0.046425, forward nfe 8000, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 095/100, Runtime 0.825007, Loss 0.048412, forward nfe 8094, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 096/100, Runtime 0.857922, Loss 0.043838, forward nfe 8188, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 097/100, Runtime 0.886495, Loss 0.087636, forward nfe 8282, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 098/100, Runtime 0.872028, Loss 0.059471, forward nfe 8376, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
Epoch: 099/100, Runtime 0.913396, Loss 0.051286, forward nfe 8470, backward nfe 0, Train: 1.0000, Val: 0.8426, Test: 0.8376, Best time: 10.0000
best val accuracy 0.842647 with test accuracy 0.837563 at epoch 27 and best time 10.000000