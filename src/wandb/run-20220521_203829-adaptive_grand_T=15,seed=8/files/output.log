/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: Dopri5Solver: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
/home/hieunm60/anaconda3/envs/deepgrand/lib/python3.8/site-packages/torchdiffeq/_impl/misc.py:11: UserWarning: EarlyStopDopri5: Unexpected arguments {'step_size': 1}
  warnings.warn('{}: Unexpected arguments {}'.format(solver.__class__.__name__, unused_kwargs))
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
****************** Extended Laplacian Function V.3 ******************
K =  None
Alpha =  1.0
*********************************************************************
GNNEarly
m1.module.weight
torch.Size([80, 1433])
m1.module.bias
torch.Size([80])
m2.module.weight
torch.Size([7, 80])
m2.module.bias
torch.Size([7])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.odefunc.k_d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.k_d
torch.Size([80])
odeblock.multihead_att_layer.Q.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.Q.bias
torch.Size([128])
odeblock.multihead_att_layer.V.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.V.bias
torch.Size([128])
odeblock.multihead_att_layer.K.weight
torch.Size([128, 80])
odeblock.multihead_att_layer.K.bias
torch.Size([128])
odeblock.multihead_att_layer.Wout.weight
torch.Size([80, 16])
odeblock.multihead_att_layer.Wout.bias
torch.Size([80])
Epoch: 001/100, Runtime 1.394066, Loss 1.946162, forward nfe 50, backward nfe 0, Train: 0.4357, Val: 0.2206, Test: 0.2142, Best time: 0.0950
Epoch: 002/100, Runtime 1.354454, Loss 1.809021, forward nfe 210, backward nfe 0, Train: 0.6929, Val: 0.4301, Test: 0.4305, Best time: 10.1045
Epoch: 003/100, Runtime 1.341923, Loss 1.567428, forward nfe 370, backward nfe 0, Train: 0.7786, Val: 0.5353, Test: 0.5482, Best time: 5.5258
Epoch: 004/100, Runtime 1.157372, Loss 1.315625, forward nfe 530, backward nfe 0, Train: 0.8500, Val: 0.6875, Test: 0.6883, Best time: 7.6806
Epoch: 005/100, Runtime 1.138055, Loss 1.032166, forward nfe 678, backward nfe 0, Train: 0.9143, Val: 0.7500, Test: 0.7584, Best time: 30.6042
Epoch: 006/100, Runtime 1.296477, Loss 0.782515, forward nfe 826, backward nfe 0, Train: 0.9429, Val: 0.7949, Test: 0.8244, Best time: 13.8416
Epoch: 007/100, Runtime 1.238854, Loss 0.543332, forward nfe 974, backward nfe 0, Train: 0.9571, Val: 0.8316, Test: 0.8508, Best time: 24.4235
Epoch: 008/100, Runtime 1.268649, Loss 0.386703, forward nfe 1122, backward nfe 0, Train: 0.9786, Val: 0.8456, Test: 0.8508, Best time: 11.1173
Epoch: 009/100, Runtime 1.210824, Loss 0.285405, forward nfe 1270, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8660, Best time: 15.2239
Epoch: 010/100, Runtime 1.169689, Loss 0.224944, forward nfe 1412, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8660, Best time: 15.0000
Epoch: 011/100, Runtime 1.198606, Loss 0.190069, forward nfe 1554, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8660, Best time: 15.0000
Epoch: 012/100, Runtime 1.210425, Loss 0.147664, forward nfe 1696, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8660, Best time: 15.0000
Epoch: 013/100, Runtime 1.113351, Loss 0.119157, forward nfe 1832, backward nfe 0, Train: 0.9643, Val: 0.8478, Test: 0.8660, Best time: 15.0000
Epoch: 014/100, Runtime 1.098595, Loss 0.116352, forward nfe 1962, backward nfe 0, Train: 0.9786, Val: 0.8493, Test: 0.8467, Best time: 49.4585
Epoch: 015/100, Runtime 1.076608, Loss 0.091636, forward nfe 2092, backward nfe 0, Train: 0.9786, Val: 0.8493, Test: 0.8467, Best time: 15.0000
Epoch: 016/100, Runtime 0.975524, Loss 0.089688, forward nfe 2216, backward nfe 0, Train: 0.9786, Val: 0.8493, Test: 0.8467, Best time: 15.0000
Epoch: 017/100, Runtime 0.996617, Loss 0.151601, forward nfe 2334, backward nfe 0, Train: 0.9786, Val: 0.8493, Test: 0.8467, Best time: 15.0000
Epoch: 018/100, Runtime 1.005288, Loss 0.161770, forward nfe 2458, backward nfe 0, Train: 0.9786, Val: 0.8493, Test: 0.8467, Best time: 15.0000
Epoch: 019/100, Runtime 1.075033, Loss 0.112059, forward nfe 2582, backward nfe 0, Train: 0.9786, Val: 0.8493, Test: 0.8467, Best time: 15.0000
Epoch: 020/100, Runtime 0.864033, Loss 0.123938, forward nfe 2706, backward nfe 0, Train: 0.9786, Val: 0.8493, Test: 0.8467, Best time: 15.0000
Epoch: 021/100, Runtime 0.975533, Loss 0.183889, forward nfe 2824, backward nfe 0, Train: 0.9786, Val: 0.8493, Test: 0.8467, Best time: 15.0000
Epoch: 022/100, Runtime 0.901111, Loss 0.161407, forward nfe 2936, backward nfe 0, Train: 0.9786, Val: 0.8493, Test: 0.8467, Best time: 15.0000
Epoch: 023/100, Runtime 0.926723, Loss 0.173737, forward nfe 3042, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 41.5303
Epoch: 024/100, Runtime 0.896380, Loss 0.106903, forward nfe 3148, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 025/100, Runtime 0.922295, Loss 0.143296, forward nfe 3254, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 026/100, Runtime 0.947482, Loss 0.171357, forward nfe 3366, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 027/100, Runtime 0.987378, Loss 0.116971, forward nfe 3478, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 028/100, Runtime 0.890087, Loss 0.064245, forward nfe 3590, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 029/100, Runtime 0.868805, Loss 0.101665, forward nfe 3690, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 030/100, Runtime 0.904735, Loss 0.094608, forward nfe 3790, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 031/100, Runtime 0.834260, Loss 0.065339, forward nfe 3890, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 032/100, Runtime 0.854365, Loss 0.097377, forward nfe 3990, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 033/100, Runtime 0.903304, Loss 0.095538, forward nfe 4090, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 034/100, Runtime 0.781982, Loss 0.093774, forward nfe 4190, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 035/100, Runtime 0.796602, Loss 0.122166, forward nfe 4290, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 036/100, Runtime 0.843175, Loss 0.077066, forward nfe 4384, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 037/100, Runtime 0.812924, Loss 0.049880, forward nfe 4478, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 038/100, Runtime 0.794279, Loss 0.090776, forward nfe 4572, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 039/100, Runtime 0.708166, Loss 0.107327, forward nfe 4654, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 040/100, Runtime 0.730329, Loss 0.064667, forward nfe 4736, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 041/100, Runtime 0.743706, Loss 0.074437, forward nfe 4818, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 042/100, Runtime 0.626499, Loss 0.081777, forward nfe 4900, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 043/100, Runtime 0.760413, Loss 0.146948, forward nfe 4982, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 044/100, Runtime 0.730339, Loss 0.066141, forward nfe 5064, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 045/100, Runtime 0.757459, Loss 0.097882, forward nfe 5146, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 046/100, Runtime 0.746605, Loss 0.075930, forward nfe 5228, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 047/100, Runtime 0.758610, Loss 0.086880, forward nfe 5310, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 048/100, Runtime 0.789572, Loss 0.084435, forward nfe 5392, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 049/100, Runtime 0.760886, Loss 0.061011, forward nfe 5474, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 050/100, Runtime 0.672767, Loss 0.049164, forward nfe 5556, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 051/100, Runtime 0.748260, Loss 0.073234, forward nfe 5638, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 052/100, Runtime 0.723393, Loss 0.125306, forward nfe 5720, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 053/100, Runtime 0.729307, Loss 0.078076, forward nfe 5802, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 054/100, Runtime 0.681120, Loss 0.057989, forward nfe 5884, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 055/100, Runtime 0.745398, Loss 0.055389, forward nfe 5966, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 056/100, Runtime 0.726071, Loss 0.077883, forward nfe 6048, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 057/100, Runtime 0.724426, Loss 0.051111, forward nfe 6130, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 058/100, Runtime 0.736439, Loss 0.081142, forward nfe 6212, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 059/100, Runtime 0.708734, Loss 0.051543, forward nfe 6294, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 060/100, Runtime 0.686235, Loss 0.055626, forward nfe 6376, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 061/100, Runtime 0.659122, Loss 0.050469, forward nfe 6458, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 062/100, Runtime 0.732013, Loss 0.058060, forward nfe 6540, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 063/100, Runtime 0.753918, Loss 0.080705, forward nfe 6622, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 064/100, Runtime 0.732318, Loss 0.072191, forward nfe 6704, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 065/100, Runtime 0.730980, Loss 0.056853, forward nfe 6786, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 066/100, Runtime 0.713923, Loss 0.049417, forward nfe 6868, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 067/100, Runtime 0.763083, Loss 0.055893, forward nfe 6950, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 068/100, Runtime 0.725294, Loss 0.048078, forward nfe 7032, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 069/100, Runtime 0.720481, Loss 0.089928, forward nfe 7114, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 070/100, Runtime 0.713034, Loss 0.064255, forward nfe 7196, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 071/100, Runtime 0.751355, Loss 0.116775, forward nfe 7278, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 072/100, Runtime 0.729800, Loss 0.053460, forward nfe 7360, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 073/100, Runtime 0.708556, Loss 0.044090, forward nfe 7442, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 074/100, Runtime 0.710161, Loss 0.059080, forward nfe 7524, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 075/100, Runtime 0.730253, Loss 0.030368, forward nfe 7606, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 076/100, Runtime 0.735636, Loss 0.077440, forward nfe 7688, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 077/100, Runtime 0.775372, Loss 0.039009, forward nfe 7770, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 078/100, Runtime 0.731563, Loss 0.037503, forward nfe 7852, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 079/100, Runtime 0.739279, Loss 0.070462, forward nfe 7934, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 080/100, Runtime 0.640536, Loss 0.064865, forward nfe 8016, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 081/100, Runtime 0.685639, Loss 0.050030, forward nfe 8098, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 082/100, Runtime 0.700063, Loss 0.046333, forward nfe 8180, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 083/100, Runtime 0.746901, Loss 0.042200, forward nfe 8262, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 084/100, Runtime 0.711906, Loss 0.070898, forward nfe 8344, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 085/100, Runtime 0.746953, Loss 0.084712, forward nfe 8426, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 086/100, Runtime 0.817132, Loss 0.057754, forward nfe 8508, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 087/100, Runtime 0.892987, Loss 0.043420, forward nfe 8602, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 088/100, Runtime 0.862750, Loss 0.045106, forward nfe 8696, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 089/100, Runtime 0.930149, Loss 0.061492, forward nfe 8796, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 090/100, Runtime 0.808570, Loss 0.068038, forward nfe 8896, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 091/100, Runtime 0.828121, Loss 0.052214, forward nfe 8996, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 092/100, Runtime 0.874220, Loss 0.037048, forward nfe 9096, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 093/100, Runtime 0.899354, Loss 0.067587, forward nfe 9196, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 094/100, Runtime 0.984352, Loss 0.066380, forward nfe 9296, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 095/100, Runtime 0.927776, Loss 0.037536, forward nfe 9402, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 096/100, Runtime 0.941875, Loss 0.035762, forward nfe 9514, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 097/100, Runtime 1.024998, Loss 0.029524, forward nfe 9626, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 098/100, Runtime 0.946181, Loss 0.039294, forward nfe 9738, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
Epoch: 099/100, Runtime 0.997522, Loss 0.040139, forward nfe 9850, backward nfe 0, Train: 1.0000, Val: 0.8500, Test: 0.8558, Best time: 15.0000
best val accuracy 0.850000 with test accuracy 0.855838 at epoch 23 and best time 15.000000